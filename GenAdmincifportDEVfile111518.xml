<SETUP>
<CONTACT_PORTFOLIO_CODE code="GENERAL ADMINISTRATION" description="Form to act as a page for holding manually initiated  administrative actions and automations." numbering_mask="%d" option_flags="163713" disabled_flag="0" allow_documents_flag="0" show_description_flag="0" comment_type="0" ecoa_code="" relationship_type="0" field_order="0" collateral_type="0" location_flag="0" taxes_flag="0" insurance_flag="0" object_def="&lt;NLSObjectDef&gt;
&lt;ScreenObject/&gt;
&lt;/NLSObjectDef&gt;
" class_1_label="" class_2_label="">
<USERDEFFIELDS field_id="122" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="121" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="120" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="119" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="118" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="117" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="116" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="115" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="114" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="113" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="112" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="111" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="110" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="109" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="108" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="107" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="106" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5201" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5105" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5104" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5103" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5102" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5101" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2066" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2065" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2064" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2063" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2062" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2061" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2060" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2059" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2058" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2057" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2056" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2055" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2054" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2053" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2052" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="2051" field_type="0" field_attribute="0" label_text="" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="0" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="200" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5205" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5204" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5203" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5202" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot;/&gt;" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="199" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="198" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="197" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="196" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="195" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="194" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="193" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="192" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="191" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="190" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="189" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="188" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="187" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="186" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="185" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="184" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="183" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="182" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="181" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="180" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="179" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="178" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="177" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="176" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="175" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="174" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="173" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="172" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="171" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="170" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="169" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="168" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="167" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="166" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="165" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="164" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="163" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="162" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="161" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="160" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="159" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="158" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="157" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="156" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="155" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="154" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="153" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="152" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="151" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="150" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="149" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="148" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="147" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="146" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="145" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="144" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="143" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="142" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="141" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="140" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="139" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="138" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="137" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="136" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="135" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="449.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="134" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="133" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="132" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="131" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="130" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="129" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="128" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="127" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="126" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="125" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="124" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="123" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="230.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="105" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="104" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="103" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="102" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="101" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot;/&gt;" StaticLeftPos="11.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight=".0000000000" ScreenWidth=".0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5005" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;154&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;87&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;1&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="154.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="87.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="1"/>
<USERDEFFIELDS field_id="5004" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;154&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;87&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;3&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="154.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="87.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="3"/>
<USERDEFFIELDS field_id="5003" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;154&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;87&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;5&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="154.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="87.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="5"/>
<USERDEFFIELDS field_id="5002" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;154&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;87&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;7&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="154.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="87.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="7"/>
<USERDEFFIELDS field_id="5001" field_type="8" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;154&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;427&quot; FieldTopPos=&quot;210&quot; FieldWidth=&quot;263&quot; FieldHeight=&quot;236&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;9&quot; ReadOnly=&quot;0&quot;&gt;
&lt;TABLE DoNotSave=&quot;False&quot; DoNotDirty=&quot;False&quot; StretchLastColumn=&quot;False&quot; GridType=&quot;Generic&quot;/&gt;
&lt;ROW NumberOfRows=&quot;Grow as needed&quot;/&gt;
&lt;COLUMN Name=&quot;Daily Process&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;100&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;On/Off&quot; TableLink=&quot;None&quot; Type=&quot;Drop List&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;On;Off&quot; Alignment=&quot;Center&quot; Width=&quot;45&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Last Successful Proc&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;150&quot; ReadOnly=&quot;True&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;/UDF&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="154.0000000000" StaticHeight="25.0000000000" FieldLeftPos="427.0000000000" FieldTopPos="210.0000000000" FieldWidth="263.0000000000" FieldHeight="236.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="9"/>
<USERDEFFIELDS field_id="100" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;11&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="332.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="332.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="11"/>
<USERDEFFIELDS field_id="99" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;13&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="310.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="310.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="13"/>
<USERDEFFIELDS field_id="98" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;15&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="288.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="288.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="15"/>
<USERDEFFIELDS field_id="97" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;17&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="266.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="266.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="17"/>
<USERDEFFIELDS field_id="96" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;19&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="244.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="244.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="19"/>
<USERDEFFIELDS field_id="95" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;21&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="222.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="222.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="21"/>
<USERDEFFIELDS field_id="94" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;23&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="200.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="200.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="23"/>
<USERDEFFIELDS field_id="93" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;25&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="178.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="178.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="25"/>
<USERDEFFIELDS field_id="92" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;27&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="156.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="156.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="27"/>
<USERDEFFIELDS field_id="91" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;29&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="134.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="134.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="29"/>
<USERDEFFIELDS field_id="90" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;31&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="112.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="112.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="31"/>
<USERDEFFIELDS field_id="89" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;33&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="90.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="90.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="33"/>
<USERDEFFIELDS field_id="88" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;35&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="68.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="68.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="35"/>
<USERDEFFIELDS field_id="87" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;37&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="46.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="46.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="37"/>
<USERDEFFIELDS field_id="86" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;39&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="24.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="24.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="39"/>
<USERDEFFIELDS field_id="85" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;772&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;883&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;41&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="772.0000000000" StaticTopPos="2.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="883.0000000000" FieldTopPos="2.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="41"/>
<USERDEFFIELDS field_id="84" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;43&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="354.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="354.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="43"/>
<USERDEFFIELDS field_id="83" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;45&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="332.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="332.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="45"/>
<USERDEFFIELDS field_id="82" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;47&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="310.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="310.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="47"/>
<USERDEFFIELDS field_id="81" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;49&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="288.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="288.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="49"/>
<USERDEFFIELDS field_id="80" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;51&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="266.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="266.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="51"/>
<USERDEFFIELDS field_id="79" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;53&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="244.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="244.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="53"/>
<USERDEFFIELDS field_id="78" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;55&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="222.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="222.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="55"/>
<USERDEFFIELDS field_id="77" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;57&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="200.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="200.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="57"/>
<USERDEFFIELDS field_id="76" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;59&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="178.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="178.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="59"/>
<USERDEFFIELDS field_id="75" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;61&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="156.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="156.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="61"/>
<USERDEFFIELDS field_id="74" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;63&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="134.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="134.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="63"/>
<USERDEFFIELDS field_id="73" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;65&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="112.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="112.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="65"/>
<USERDEFFIELDS field_id="72" field_type="6" field_attribute="0" label_text="Processing" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;141&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;555&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;91&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;67&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="90.0000000000" StaticWidth="141.0000000000" StaticHeight="20.0000000000" FieldLeftPos="555.0000000000" FieldTopPos="90.0000000000" FieldWidth="91.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="67"/>
<USERDEFFIELDS field_id="71" field_type="3" field_attribute="0" label_text="Loan Batch Limit" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**NLSApp.SaveScreen()**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;121&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;555&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;91&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;69&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="68.0000000000" StaticWidth="121.0000000000" StaticHeight="20.0000000000" FieldLeftPos="555.0000000000" FieldTopPos="68.0000000000" FieldWidth="91.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="69">
<USERDEFDATA row_id="141" field_reference="6381" field_data="&apos;NO LIMIT&apos;" field_order="0" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="70" field_type="3" field_attribute="0" label_text="Owner Allocation Limit" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**NLSApp.SaveScreen()**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;121&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;555&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;91&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;71&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="46.0000000000" StaticWidth="121.0000000000" StaticHeight="20.0000000000" FieldLeftPos="555.0000000000" FieldTopPos="46.0000000000" FieldWidth="91.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="71">
<USERDEFDATA row_id="142" field_reference="6380" field_data="&apos;NO LIMIT&apos;" field_order="0" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="69" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;73&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="24.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="24.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="73"/>
<USERDEFFIELDS field_id="68" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;504&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;75&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="2.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="504.0000000000" FieldTopPos="2.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="75"/>
<USERDEFFIELDS field_id="67" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;77&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="354.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="354.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="77"/>
<USERDEFFIELDS field_id="66" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;79&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="332.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="332.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="79"/>
<USERDEFFIELDS field_id="65" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;81&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="310.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="310.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="81"/>
<USERDEFFIELDS field_id="64" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;83&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="288.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="288.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="83"/>
<USERDEFFIELDS field_id="63" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;85&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="266.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="266.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="85"/>
<USERDEFFIELDS field_id="62" field_type="6" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;2&quot; Script=&quot;settings = currdailyprocsettings


For each x in settings
   list = list &amp;amp; x &amp;amp; chr(10)
exesub = split(x,&amp;quot;,&amp;quot;)
If  ltrim(exesub(1)) = &amp;quot;On&amp;quot; Then 
   processingdetail = procselect(exesub(0))
   If processingdetail = -1 Then
    msgbox(&amp;quot;Could not find process  &amp;quot; &amp;amp; exesub(0) &amp;amp; &amp;quot; to run.&amp;quot;)
    Else 
   end If
End if

Next

Function procselect(proc)
    Starttime = NOW()
    Endtime = &amp;quot;&amp;quot;
    procselect = &amp;quot;&amp;quot;
    Select Case Proc
    Case &amp;quot;AUTOCLOSE&amp;quot;
        MsgBox(&amp;quot;AutoCloseaddCompleted2018()&amp;quot;)
    Case &amp;quot;AUTOWO&amp;quot;
        MsgBox(&amp;quot;AutoWOaddCompletePending2018()&amp;quot;)
    Case &amp;quot;SYNCACH&amp;quot;
        MsgBox(&amp;quot;SyncACHWebpay()&amp;quot;)
                                SyncACHWebpay()
    Case &amp;quot;ACHCO&amp;quot;
        MsgBox(&amp;quot;ACHCompanyUDF()&amp;quot;)
    Case &amp;quot;NONACH&amp;quot;
        MsgBox(&amp;quot;NonACHDetail2udf45Maint()&amp;quot;)
                                NonACHDetail2udf45Maint()
    Case &amp;quot;LOANCOMM&amp;quot;
        MsgBox(&amp;quot;LoanCommPrefs()&amp;quot;)
                                LoanCommPrefs()
    Case &amp;quot;PDFP&amp;quot;
        MsgBox(&amp;quot;PDFP()&amp;quot;)
    Case &amp;quot;FIRSTPAY&amp;quot;
        MsgBox(&amp;quot;FirstPayDefaultFlag()&amp;quot;)
    Case &amp;quot;WEBPAY&amp;quot;
        MsgBox(&amp;quot;WebPayments()&amp;quot;)
    Case &amp;quot;DSPAYMNT&amp;quot;
        MsgBox(&amp;quot;DSpaymntMaint()&amp;quot;)
    Case &amp;quot;DEBTSETFEE&amp;quot;
        MsgBox(&amp;quot;DebtsetFeeTransMaint()&amp;quot;)
    Case &amp;quot;DSBILL&amp;quot;
        MsgBox(&amp;quot;DSBilltransMaint()&amp;quot;)
    Case &amp;quot;REVERSEDS&amp;quot;
        MsgBox(&amp;quot;reverseDSpayments()&amp;quot;)
    Case &amp;quot;LOANDETAIL2&amp;quot;
        MsgBox(&amp;quot;LoanDetail2udf46Maint()&amp;quot;)
    Case &amp;quot;ADDSSN&amp;quot;
        MsgBox(&amp;quot;addssntocifudf15 &amp;quot;Top 20000&amp;quot;,&amp;quot;(0,1)&amp;quot;&amp;quot;)
    Case Else
        procselect = -1
    End Select
    Endtime = NOW()
                Runtime = DateDiff(&amp;quot;s&amp;quot;,Starttime,Endtime)
    procselect = Proc &amp;amp; &amp;quot;, &amp;quot; &amp;amp; Starttime &amp;amp; &amp;quot;, &amp;quot; &amp;amp; Runtime
End Function

Function currdailyprocsettings
        
        strXMl = Replace(NLSApp.GetField(&amp;quot;CIF_DETAIL_UDF51&amp;quot;), &amp;quot;&amp;amp;&amp;quot;, &amp;quot;&amp;amp;amp;&amp;quot;)
        Set xmlDoc = CreateObject(&amp;quot;Msxml2.DOMDocument&amp;quot;)                                                                                                                                             
        xmlDoc.setProperty &amp;quot;SelectionLanguage&amp;quot;, &amp;quot;XPath&amp;quot;                                                                                                                                             

        Err.Clear
        On Error Resume Next
        xmlDoc.loadxml(strXMl)
        If Err.Number &amp;lt;&amp;gt; 0 Then
            &amp;apos;Exit Function                                                                                                                                                                          
            NLSapp.MessageBox(Err.Description)
        End If
        On Error GoTo 0
                                                                                                                                                                                                       
        Set nodesList = xmlDoc.documentelement.selectNodes(&amp;quot;/DATA/ROW&amp;quot;)                                                                                                                             
        counter = nodesList.length
        redim gridarray(counter-1)
        count = 1

        For x = 1 To counter
                                                                                                                                                                                                       
           Set currNode=nodesList.nextNode                                                                                                                                                             
           CurrNodeName = currNode.nodename
                                                                                                                                                                                                       
           Set cnode = currNode.childnodes                                                                                                                                                             
                                                                                                                                                                                                       
           For Each c In cnode
                row =  x-1
                name = c.getAttribute(&amp;quot;Name&amp;quot;)
                value = c.getAttribute(&amp;quot;Value&amp;quot;)

                If name = &amp;quot;Daily Process&amp;quot; Then
                    col1 = value
                End If
                If name = &amp;quot;On/Off&amp;quot; Then
                    col2 = ltrim(value)
                End If
                If name = &amp;quot;Last Successful Proc&amp;quot; Then
                    col3 = value
                End If

            Next
            &amp;apos;msgbox(row &amp;amp; &amp;quot;, &amp;quot; &amp;amp; col1 &amp;amp; &amp;quot;, &amp;quot; &amp;amp; col2 &amp;amp; &amp;quot;, &amp;quot; &amp;amp; col3)            
            gridarray(row) = col1 &amp;amp; &amp;quot;, &amp;quot; &amp;amp; col2 &amp;amp; &amp;quot;, &amp;quot; &amp;amp; col3
        Next
    currdailyprocsettings = gridarray
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;1&quot; Script=&quot;NLSApp.MessageBox(NLSApp.GetField(&amp;quot;CIF_DETAIL_UDF51&amp;quot;))&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;87&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="244.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="244.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="87"/>
<USERDEFFIELDS field_id="61" field_type="0" field_attribute="0" label_text=" Last Run Date/time" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;124&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;235&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;151&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;89&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="124.0000000000" StaticTopPos="222.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="235.0000000000" FieldTopPos="222.0000000000" FieldWidth="151.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="89"/>
<USERDEFFIELDS field_id="60" field_type="6" field_attribute="0" label_text="Sys Admin" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Debt Val Lett&quot; Script=&quot;&amp;apos;NLS objects
        Set DT5 = NLSApp.GetDocumentTemplates(5)
        Set DT6 = NLSApp.GetDocumentTemplates(6)
Set DT10 = NLSApp.GetDocumentTemplates(10)
Set DT11= NLSApp.GetDocumentTemplates(11)
&amp;apos;Set DT10 = NLSApp.GetDocumentTemplates(DOCTEMPL_CPLUS_DEBT_VALIDATION_LETTER)
&amp;apos;Set DT11= NLSApp.GetDocumentTemplates(DOCTEMPL_FPLUS_DEBT_VALIDATION_LETTER)

rowcnt = NLSApp.SQLSelectStatement(firstdpdlookupsql)
rowcnt = 8
redim loanlist(rowcnt)

loanlist(0) = &amp;quot;60803,APP-00455510,0,748.36,05/24/2018,Jun 10 2016 12:00AM&amp;quot;
loanlist(1) = &amp;quot;60804,APP-00455510,0,748.36,05/24/2018,Jun 10 2016 12:00AM&amp;quot;
loanlist(2) = &amp;quot;78591,APP-00655556,0,888.22,05/24/2018,Nov 29 2016 12:00AM&amp;quot;
loanlist(3) = &amp;quot;78592,APP-00655556,0,888.22,05/24/2018,Nov 29 2016 12:00AM&amp;quot;
loanlist(4) = &amp;quot;95159,APP-00865890,0,689.82,05/25/2018,Apr  7 2017 12:00AM&amp;quot;
loanlist(5) = &amp;quot;105888,APP-01000085,0,367.06,04/25/2018,Jun  8 2017 12:00AM&amp;quot;
loanlist(6) = &amp;quot;76089,CP0184736,1,469.00,05/25/2018,Mar 27 2017 12:00AM&amp;quot;
loanlist(7) = &amp;quot;81918,CP0192183,1,429.69,05/25/2018,Mar 31 2017 12:00AM&amp;quot;

    &amp;apos;For each selected contact, update the cif udf fields that will be used for the document merge fields
    &amp;apos;Then generate the document, saving a copy to contact comments and sending to the print queue

    For rownumb = 0 to rowcnt-1
        letterdetail = Split(loanlist(rownumb),&amp;quot;,&amp;quot;)

        docmergedetailsql = &amp;quot;select 0; UPDATE cif_detail &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SET userdef12 = &amp;apos;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;apos;, userdef13 = &amp;apos;&amp;quot; &amp;amp; letterdetail(1) &amp;amp; &amp;quot;&amp;apos;, userdef14 = &amp;apos;&amp;quot; &amp;amp; letterdetail(3) &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;, userdef15 = &amp;apos;&amp;quot; &amp;amp; letterdetail(4) &amp;amp; &amp;quot;&amp;apos;, userdef16 = &amp;apos;&amp;quot; &amp;amp; letterdetail(5) &amp;amp; _ 
        &amp;quot;&amp;apos; WHERE cifno = &amp;quot;  &amp;amp; letterdetail(0)
        NLSApp.SQLSelectStatement(docmergedetailsql)
        NLSApp.MessageBox(docmergedetailsql)

        &amp;apos;generate doc
        If letterdetail(2) = &amp;quot;0&amp;quot; then
            if DT10.GenerateDocument(letterdetail(0), &amp;quot;TRUE&amp;quot;, &amp;quot;COMPLIANCE COM&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;) Then
               DT5.GenerateDocument 84183, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue,&amp;quot;T:\Temp\&amp;quot;
              msgbox(&amp;quot;True&amp;quot;)
            end if
        Else
            DT11.GenerateDocument letterdetail(0), &amp;quot;TRUE&amp;quot;, &amp;quot;COMPLIANCE COM&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
        End if
    Next&quot;/&gt;
&lt;BUTTON Name=&quot;DS Fees part&quot; Script=&quot;&amp;apos;###Cif  Detail 1 UDF21/SysAdmin
&amp;apos;on Button click option selection as part of daily runs
&amp;apos;Adds transaction codes that increase DS off loan balance when a fee is assessed while the loan is in active debt settlement or broken settlement status

DebtsetFeeTransMaint()


Sub DebtsetFeeTransMaint()

    &amp;apos;Set the list of transaction codes to include in the query i.e., &amp;apos;150&amp;apos;,&amp;apos;180&amp;apos;,&amp;apos;504&amp;apos;
    transcodestrg = &amp;quot;&amp;apos;&amp;quot; &amp;amp; LOAN_TRANS_CODE_LATE_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_NSF_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_CHECK_FEE &amp;amp; &amp;quot;&amp;apos;&amp;quot;
    
    &amp;apos;SQL command that will lookup the loans with required fields to create transaction records. Output is an importable XML string and a SQL command string
    &amp;apos;***Sample SQL output***
    &amp;apos;CP000123, &amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8280&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;02/26/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00463650&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;15.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;7135687&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;5318695&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;
    &amp;apos;,SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;Debt Settlement transaction&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where transrefno = 7135687

    dsfeestblsql = &amp;quot;Select convert(varchar(15),l.acctrefno) as acctrefno,   &amp;apos;transimportxml&amp;apos; =  &amp;quot; &amp;amp; chr(13) &amp;amp; _                     
        &amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +    &amp;quot; &amp;amp; chr(13) &amp;amp; _                                                                                                                  
        &amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8&amp;apos; + convert(varchar,lth.transaction_code) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.transaction_date,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;quot; &amp;amp; chr(13) &amp;amp; _                                        
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,   &amp;quot; &amp;amp; chr(13) &amp;amp; _                  
        &amp;quot;&amp;apos;transupdatesql&amp;apos; = &amp;apos;SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;&amp;apos;DEBT SETTLEMENT TRANS&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where transrefno = &amp;apos; + convert(varchar,lth.transrefno)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;from loanacct_trans_history lth,  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;loanacct l, &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;loanacct_statuses ls,&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;(           &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    Select acctrefno, max(mod_datestamp) as activetime   &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    from (                &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    SELECT row_id,acctrefno,mod_datestamp  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    from loanacct_mod_history     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    where item_changed = &amp;apos;Status&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    group by acctrefno) times  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;where times.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.acctrefno = lth.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.status_code_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and ls.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and ls.status_code_no IN  (32, 34)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and (userdef01 not like &amp;apos;DEBT SETTLEMENT TRANS&amp;apos;   or userdef01 IS NULL)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.transaction_code IN (&amp;quot; &amp;amp; transcodestrg &amp;amp; &amp;quot;)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.reversal_transrefno = 0     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.current_ol1_balance &amp;gt; 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.transaction_date &amp;gt;= times.activetime &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot; order by l.acctrefno,[transimportxml]&amp;quot;
        
    &amp;apos;dim dynamic array to hold sql results
    redim DSfeeslist(2,1)

    &amp;apos;populate array data with sql output
    Do until nextrefno = &amp;quot;***END OF RESULT***&amp;quot;
        rowcnt = UBound(DSfeeslist,2)
        
        If rowcnt = 1 Then
            DSfeeslist(0,rowcnt) = NLSApp.SQLSelectStatement(dsfeestblsql)
        else
            DSfeeslist(0,rowcnt) = nextrefno
        end if
        
        DSfeeslist(1,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        DSfeeslist(2,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        nextrefno = NLSApp.SQLSelectStatementReadNext()

        If not nextrefno = &amp;quot;***END OF RESULT***&amp;quot; Then
           redim Preserve DSfeeslist(2,rowcnt + 1)
        End if

    Loop 

    &amp;apos;Run XML Import process and SQL updates to Add and Update transaction records
    For counter = 1 to 5 &amp;apos;rowcnt

        msgbox(Mid(DSfeeslist(1,counter),InStr(DSfeeslist(1,counter), &amp;quot;LoanNumber=&amp;quot;)+12,12))
        
        ImportXML(DSfeeslist(1,counter))
        NLSApp.SQLSelectStatement(DSfeeslist(2,counter))
       
    Next
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;Daily Maintenance Processes&quot; Script=&quot;NLSApp.SetScriptTimeOut(1200000)
AutoCloseaddCompleted2018()
&amp;apos;AutoWOaddCompletePending2018()
&amp;apos;SyncACHWebpay()
&amp;apos;ACHCompanyUDF()
&amp;apos;NonACHDetail2udf45Maint()
&amp;apos;LoanCommPrefs()
&amp;apos;PDFP()
&amp;apos;FirstPayDefaultFlag()
&amp;apos;WebPayments()
&amp;apos;DSpaymntMaint()
&amp;apos;DebtsetFeeTransMaint()
&amp;apos;DSBilltransMaint()
&amp;apos;reverseDSpayments()
&amp;apos;LoanDetail2udf46Maint()

&amp;apos;Task edit trailing period(.). see INCCRM-417
NLSapp.SQLSelectStatement(&amp;quot;Select 0; UPDATE task_detail SET userdef06 = left(userdef06,len(userdef06)-1) from task_detail where task_refno IN (Select t.task_refno from task_detail td, task t  where t.task_refno = td.task_refno and t.task_template_no = 6 and right(td.userdef06,1) = &amp;apos;.&amp;apos;)&amp;quot;)
&amp;apos;Remove micro balances on open accounts
NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET current_interest_balance = 0 ,current_payoff_balance = 0 where current_payoff_balance &amp;lt;= .01 and current_payoff_balance &amp;gt; 0 and status_code_no = 0&amp;quot;)

NLSApp.SetField &amp;quot;CIF_DETAIL_UDF11&amp;quot;, NOW()
NLSApp.MessageBox(&amp;quot;Completed!&amp;quot;)
NLSApp.SaveScreen()



&amp;apos;SUBS AND FUNCTIONS
&amp;apos;----------------------------------------------------------------------------------------------

&amp;apos;SUBS-------------------------------------------------------------
sub LoanDetail2udf46Maint()
&amp;apos;Maintains the next ACH payment date field in LoanDeatail2 udf46 to stay in sync with the ach.billing_next_date field
&amp;apos;This is to be used as a endpoint in a get command on the custom web portal.

	d2_userdef46sql = &amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef46 = u.next_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;FROM loanacct_detail_2 ld2,&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;(&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;SELECT convert(int, l.acctrefno) as acctrefno, ld2.userdef46, convert(char(10),max(ach.billing_next_date),101) as next_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;from loanacct_ach ach, loanacct l, loanacct_detail_2 ld2&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;where l.acctrefno = ach.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ach.status = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;group by  l.acctrefno,ld2.userdef46&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;having (case when ld2.userdef46 is null then&amp;apos;&amp;apos; else ld2.userdef46 end ) &amp;lt;&amp;gt; convert(char(10),max(ach.billing_next_date),101)&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;) u&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;Where ld2.acctrefno = u.acctrefno&amp;quot;

NLSApp.SQLSelectStatement(d2_userdef46sql)
End sub

&amp;apos;--------------------------------------------------------------------

&amp;apos;ReverseDSpayments.vb
&amp;apos;Looks for un-reversed debt settlement payment transactions (TC8200) and their corresponding loan payment transactions 
&amp;apos;that have been reversed. it then uses XML import to reverse the TC8200 transaction

Sub reverseDSpayments()

	revtranslookupsql = &amp;quot;select distinct  &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8201&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),getdate(),1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;apos;&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;&amp;apos; + + convert(varchar,lth1.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth1.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;&amp;apos; + lth1.userdef01  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_trans_history lth1,  	/*lth1 represents the DS transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct_trans_history lth2, 			/*lth2 represents the loan payment transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct l &amp;quot; &amp;amp; chr(13) &amp;amp; _								
	&amp;quot;where lth1.userdef04 is not null &amp;quot; &amp;amp; chr(13) &amp;amp; _		
	&amp;quot;and lth1.acctrefno = l.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and cast(lth2.transaction_reference_no as varchar) = lth1.userdef04  		/*pairs DS transaction to it loan payment transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and (lth1.reversal_transrefno = 0 and not lth2.reversal_transrefno = 0) 	/*DS transaction has not been reversed but the loan payment has been reversed*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth2.transaction_date &amp;gt; &amp;apos;02/01/18&amp;apos; 									/*not valid for transactions prior to implementation date*/&amp;quot;

		Do 	
			RevtransXML = NLSApp.SQLSelectStatement(revtranslookupsql)

			&amp;apos;Sample output
			&amp;apos;RevtransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8201&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/21/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00553272&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;5256551&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;500.00&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;3089124&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

			If Not RevtransXML = &amp;quot;&amp;quot; Then
				ImportXML(RevtransXML)
			End If

		Loop Until RevtransXML = &amp;quot;&amp;quot;
	
End Sub

Sub AutoCloseaddCompleted2018()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Close Loans in COMPLETE PENDING status for prescribed waiting period or more and queue up ZERO Balance letter for printing or email
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Define Document template objects
    Set DT5 = NLSApp.GetDocumentTemplates(5)
    Set DT6 = NLSApp.GetDocumentTemplates(6)
  
    arrayUB = NLSapp.SQLSelectStatement(PENDING_COMPLETE_CLOSE_LOAN_SQL)   

    detailcnt = 0

    If arrayUB = &amp;quot;&amp;quot; then
        Exit Sub
     End if

    &amp;apos;Dim array to hold sql lookup results of list of valid loan numbers
    Redim loanlist(arrayUB) 

    For count = 0 to arrayUB
        loandetail = NLSapp.SQLSelectStatementNextColumn()  
NLSApp.MessageBox( loandetail)
        loanlist(count) = loandetail
        skipcol = NLSapp. SQLSelectStatementReadNext()
    Next


    For Each detail in  loanlist

        rowdetails = Split (detail,&amp;quot;,&amp;quot;)
        loannumber = rowdetails(0)
        refno = rowdetails(1)
        Suspense = rowdetails(2)
        template = rowdetails(3)
        SendToQueue = rowdetails(4)
        emailtoaddr = rowdetails(5)
        name = rowdetails(6)
        fname = rowdetails(7)
        lname = rowdetails(8)
        datenow = date()
        detailcnt = detailcnt + 1
        If detailcnt = 1 Then 
            refnolist = refno
        Else 
            refnolist = refnolist &amp;amp; &amp;quot;,&amp;quot; &amp;amp; refno
        End If

        If Not CDbl(Suspense) = 0 Then
            ClosureImportXMLp1 = &amp;quot;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;462&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; datenow &amp;amp; _
            &amp;quot;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Suspense &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;quot;
        Else
            ClosureImportXMLp1 = &amp;quot;&amp;quot;
        End if
        
        ClosureImportXMLp2 = &amp;quot;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;CLOSED&amp;quot;&amp;quot; ClosedDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; datenow &amp;amp; &amp;quot;&amp;quot;&amp;quot; &amp;gt;&amp;quot; &amp;amp; _
            &amp;quot;&amp;lt;LOANSTATUSES Operation=&amp;quot;&amp;quot;DELETE&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;PENDING COMPLETE&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; datenow &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; _              
            &amp;quot;&amp;lt;LOANSTATUSES Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;COMPLETED&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; datenow &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/LOAN&amp;gt; &amp;quot;
        &amp;apos;XML string Format:
        &amp;apos;&amp;lt;NLS&amp;gt;
        &amp;apos;&amp;lt;TRANSACTIONS&amp;gt;                                                                                                
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;462&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot; LoanNumber=&amp;quot;APP-00999999&amp;quot; Amount=&amp;quot;537.43&amp;quot; /&amp;gt;
        &amp;apos;  &amp;lt;/TRANSACTIONS&amp;gt;                                                                                               
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-00999999&amp;quot; LoanStatusCode=&amp;quot;CLOSED&amp;quot; ClosedDate=&amp;quot;07/21/17&amp;quot; &amp;gt;                
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;DELETE&amp;quot; LoanStatusCode=&amp;quot;PENDING COMPLETE&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;               
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;ADD&amp;quot; LoanStatusCode=&amp;quot;COMPLETED&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;                         
        &amp;apos;  &amp;lt;/LOAN&amp;gt;                                                                                                       
        &amp;apos;&amp;lt;/NLS&amp;gt;             
       &amp;apos;nlsApp.messageBox(&amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; ClosureImportXMLp1 &amp;amp; ClosureImportXMLp2 &amp;amp; &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;)
       If PendingCompleteClosureImportXML(&amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; ClosureImportXMLp1 &amp;amp; ClosureImportXMLp2 &amp;amp; &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;, refno) = &amp;quot;&amp;quot; Then

            If SendToQueue = &amp;quot;TRUE&amp;quot; Then

            &amp;apos;Generate zero balance Document
                If template = &amp;quot;5&amp;quot; Then
                    DT5.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
                End if
                If template = &amp;quot;6&amp;quot; Then
                    DT6.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
                End if
                docqueueID = NLSapp.SQLSelectStatement(&amp;quot;SELECT cast(MAX(documentqueueid) as varchar) from DocumentQueue where len(DocumentName) = 0 and parentrefno = &amp;quot; &amp;amp; refno)
                NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE DocumentQueue SET DocumentName = &amp;apos;ZERO BALANCE LETTER&amp;apos;, DocumentPageCount = 1 where DocumentQueueID = &amp;quot; &amp;amp; docqueueID)
            End If

            Logmsg = &amp;quot;Daily Auto-Closure process &amp;amp;#13;Refno: &amp;quot; &amp;amp; refno 
            logXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;NLSLOG LogTypeDescription=&amp;quot;&amp;quot;Scripting&amp;quot;&amp;quot; ErrorStatus=&amp;quot;&amp;quot;0&amp;quot;&amp;quot; Log=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Logmsg &amp;amp;&amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
            ImportXML(logXML)

        Else
            &amp;apos;PLACEHOLDER
            NLSApp.MessageBox(&amp;quot;There was a problem closing refno &amp;quot; &amp;amp;  refno &amp;amp; &amp;quot;.&amp;quot;)
        End If
  Next  

    &amp;apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    refnolist =  &amp;quot;(&amp;quot; &amp;amp; refnolist &amp;amp; &amp;quot;)&amp;quot;
    If SetAdminuser(refnolist) = -1 Then
       subject = &amp;quot;Pending Complete Admin update FAILURE!&amp;quot;
       toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
       body1 = NLSApp.GetDataBaseName() &amp;amp; CHR(10) &amp;amp; CHR(10) &amp;amp;   &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Update Error setting script user to Admin. Please investigate.&amp;quot;
       NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
    End if
    
End Sub

Sub AutoWOaddCompletePending2018()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automatic Write-off loan balances $10 or less set loan status to COMPLETE PENDING
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    userno = NLSApp.GetCurrentUserNo()
    authuser = NLSapp.SQLSelectStatement(&amp;quot;select convert(varchar(12),groupno) from nlsgroupmembers where userno = &amp;quot; &amp;amp; userno &amp;amp; &amp;quot; and groupno IN (11)&amp;quot;)
    &amp;apos;Current Authrized User group(s) 11-Admin

    lookupallloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)
    lookuponeloansql =  lookupallloanssql &amp;amp; Chr(13) &amp;amp; &amp;quot;and l.acctrefno in (&amp;quot; &amp;amp; NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;  
    lookupsql = lookuponeloansql
    
    &amp;apos;Members of authorized user groups can opt to process all eligible loans
    If authuser &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
        &amp;apos;If NLSApp.YseNoMessageBox(&amp;quot;Select Yes to process all available loans.&amp;quot;) Then 
            lookupsql = lookupallloanssql
        &amp;apos;End If           
    End If
 
    writeoffxml = NLSapp.SQLSelectStatement(lookupsql)

    If len(writeoffxml) = 0 Then
        writeoffxml = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until writeoffxml = &amp;quot;***END OF RESULT***&amp;quot;
        refno = NLSapp.SQLSelectStatementNextColumn()
        refnolist = refnolist &amp;amp; refno &amp;amp; &amp;quot;, &amp;quot;

       AddWOandPendingComplete(writeoffxml &amp;amp; refno)
        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                         
        &amp;apos;  &amp;lt;TRANSACTIONS&amp;gt;                                                                                              
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;540&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;544&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;448&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;452&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;                        
        &amp;apos;  &amp;lt;/TRANSACTIONS&amp;gt;                                                                                             
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot;&amp;gt;                                                             
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;ADD&amp;quot; LoanStatusCode=&amp;quot;PENDING COMPLETE&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;
        &amp;apos;    &amp;lt;LOANCOMMENTS Comment=&amp;quot;Remaining loan balance written-off due to balance below $10. &amp;quot; Category=&amp;quot;SERVICING NOTES&amp;quot; CommentDescription=&amp;quot;Balance write-off&amp;quot; CreatedBy=&amp;quot;0&amp;quot;/&amp;gt;              
        &amp;apos;  &amp;lt;/LOAN&amp;gt;                                                                                                     
        &amp;apos;&amp;lt;/NLS&amp;gt;

        writeoffxml = NLSApp.SQLSelectStatementReadNext()

    Loop

    If not refnolist = &amp;quot;&amp;quot; Then
        refnolist = &amp;quot;(&amp;quot; &amp;amp; Left(refnolist, Len(refnolist) - 2) &amp;amp; &amp;quot;)&amp;quot;
    End if 

    &amp;apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    If SetAdminuser(refnolist) = -1 Then
       subject = &amp;quot;Pending Complete Admin update FAILURE!&amp;quot;
       toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
       body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Update Error setting script user to Admin. Please investigate.&amp;quot;
       NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
    End If
    
End Sub

Sub SyncACHWebpay()
	acctrefno = 9999
	acctsyncsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef44 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
	
	
	Do Until acctrefno = &amp;quot;&amp;quot;
	    acctrefno =  NLSapp.SQLSelectStatement(acctsyncsql)
	
	    investorname = NLSApp.SQLSelectStatementNextColumn()
	    port_code = NLSApp.SQLSelectStatementNextColumn()
	    If port_code = &amp;quot;0&amp;quot; Then
	         port_code = &amp;quot;PLUS PORTFOLIO&amp;quot;
	     Else
	         port_code = &amp;quot;CONSOL PLUS&amp;quot;
	    End If
	    detail2udf45 = NLSApp.SQLSelectStatementNextColumn()
	
	    ACHCompanySyncatupdate2018 acctrefno,investorname,port_code,detail2udf45
	    loopcnt = loopcnt + 1
	Loop 
	&amp;apos;Loop until loopcnt = 4

End Sub

Sub ACHCompanyUDF()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;ACH Company UDF Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    refnosql = &amp;quot;SELECT nonachUDFs.acctrefno,nonachUDFs.UDFtarget&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(SELECT distinct &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;convert(varchar(10),la.acctrefno) as acctrefno,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;la.loan_class2_no,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lach.ach_company_id,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;la.portfolio_code_id,ld2.userdef45,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;&amp;apos;UDFtarget&amp;apos;= CASE&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 0 THEN 1&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 1 THEN 4&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 4 THEN 3&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 7 THEN 7&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 8 THEN 8&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 9 THEN 9&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 10 THEN 10&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 11 THEN 11&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 0 THEN 12&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 1 THEN 15&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 13 THEN 13&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 15 THEN 16&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 16 THEN 17&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 17 THEN 18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 18 THEN 19&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 19 THEN 20&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 20 THEN 21&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 21 THEN 22&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 22 THEN 23&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 23 THEN 24&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 24 THEN 25&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 25 THEN 26&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 26 THEN 27&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 27 THEN 32&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 28 THEN 28&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 29 THEN 30&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 30 THEN 31&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 31 THEN 29&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 32 THEN 34&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 33 AND la.portfolio_code_id = 0 THEN 35&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 33 AND la.portfolio_code_id = 1 THEN 38&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 34 AND la.portfolio_code_id = 0 THEN 36&amp;quot; &amp;amp; chr(13) &amp;amp;_ 
    &amp;quot;WHEN la.loan_class2_no = 34 AND la.portfolio_code_id = 1 THEN 37&amp;quot; &amp;amp; chr(13) &amp;amp;_  
    &amp;quot;WHEN la.loan_class2_no = 35 THEN 39&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 36 AND la.portfolio_code_id = 0 THEN 41&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 36 AND la.portfolio_code_id = 1 THEN 40&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 37 AND la.portfolio_code_id = 0 THEN 43&amp;quot; &amp;amp; chr(13) &amp;amp;_ 
    &amp;quot;WHEN la.loan_class2_no = 37 AND la.portfolio_code_id = 1 THEN 42&amp;quot; &amp;amp; chr(13) &amp;amp;_ 
    &amp;quot;ELSE 9999&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;END&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct_ach lach, loanacct_detail_2 ld2, loanacct la, loan_class lc,ach_company ach&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE lach.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lc.codenum = la.loan_class2_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lach.ach_company_id = ach.ach_company_id&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and lach.status = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;/*AND la.loan_class1_no 1*/) nonachUDFs&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE nonachUDFs.UDFtarget &amp;lt;&amp;gt; nonachUDFs.userdef45 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;OR nonachUDFs.userdef45  IS NULL&amp;quot;

    LoanRefNo = NLSapp.SQLSelectStatement(refnosql)
    &amp;apos;NLSApp.MessageBox( LoanRefNo)

    If LoanRefNo = &amp;quot;&amp;quot; Then
        LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
        Lcount = Lcount + 1
        achid = NLSApp.SQLSelectStatementNextColumn()

        achxml = &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;    &amp;lt;LOANDETAIL2 UserDefined45=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achid &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;


        ImportXML(achxml)


        LoanRefNo = NLSApp.SQLSelectStatementReadNext()

    Loop
    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;ACH Company UDF Proccessing&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount
        &amp;apos;NLSApp.MessageBox(&amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount)
    End If

End Sub


Sub LoanCommPrefs()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Communication Preferences Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    Commsetuplookupsqltxt = &amp;quot;SELECT distinct  la.loan_number, convert(varchar(15),la.acctrefno) as acctrefno,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;convert(char(1),lcp.StatementOptionFlags),lca.Address,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;&amp;apos;MailOptIn&amp;apos; = CASE When la.portfolio_code_id=0 THEN ld1.userdef18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;cif.email, cif.cifnumber&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from cif cif, loanacct_detail ld1,loanacct la&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;LoanCommunicationPreferences lcp&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;on &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;la.acctrefno = lcp.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;LoanCommunicationAddress lca&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;on&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lca.LoanCommunicationPreferencesID = lcp.LoanCommunicationPreferencesID&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Where ld1.acctrefno = la.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND cif.cifno = la.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ((lcp.StatementOptionFlags IS NULL AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;OR (lcp.StatementOptionFlags = 2 AND lca.Address IS NULL)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;OR (lcp.StatementOptionFlags = 1 AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0) )&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.loan_number  not like &amp;apos;CP%A&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.loan_number not like &amp;apos;%dummy%&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;order by acctrefno ,mailoptin desc&amp;quot;

    LoanNumber = NLSapp.SQLSelectStatement(Commsetuplookupsqltxt)
    loopcnt = 0

    If LoanNumber = &amp;quot;&amp;quot; Then
        LoanNumber = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until LoanNumber = &amp;quot;***END OF RESULT***&amp;quot;

        Loanrefno = NLSapp.SQLSelectStatementNextColumn()
        Flag = NLSapp.SQLSelectStatementNextColumn()
        Commemail = NLSapp.SQLSelectStatementNextColumn()
        Optin = NLSapp.SQLSelectStatementNextColumn()
        Cntemail = NLSapp.SQLSelectStatementNextColumn()

        If Optin = 1 Then
            Optinflag = 1
        Else
            Optinflag = 2
        End If
        CIFNum = NLSapp.SQLSelectStatementNextColumn()

        If Cntemail = &amp;quot;&amp;quot; Then
            Optinflag = 1
            Cntemail = &amp;quot;LScontact@ffn.com&amp;quot;
            cifemailxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;   &amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; CIFNum &amp;amp; &amp;quot;&amp;quot;&amp;quot; Entity=&amp;quot;&amp;quot;INDIVIDUAL&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;LScontact@ffn.com&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

            ImportXML(cifemailxml)

        End If


        commprefxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;UTF-8&amp;quot;&amp;quot; standalone=&amp;quot;&amp;quot;yes&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;	&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanNumber &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;		&amp;lt;COMMUNICATION&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;EMAILADDRESSES&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;				&amp;lt;EMAILADDRESS Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; Address=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Cntemail &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;/EMAILADDRESSES&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;ALERTS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;				&amp;lt;ALERT AlertType=&amp;quot;&amp;quot;Statement&amp;quot;&amp;quot; OptionFlags=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Optinflag &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;/ALERTS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;		&amp;lt;/COMMUNICATION&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;	&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        &amp;apos;NLSApp.MessageBox(loopcnt &amp;amp; &amp;quot; - &amp;quot; &amp;amp; LoanNumber)

        ImportXML(commprefxml)
        LoanNumber = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;Loan Comm Prefs Proccessing&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount 
        &amp;apos; NLSApp.MessageBox( &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount)
    End If
End Sub

Sub WebPayments()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Web payments Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;SET PENDING STATUSES-----------------------------------------------------------

    sqlstring1 = &amp;quot;select convert(varchar(10),la.acctrefno) as acctrefno, pt.ach_trace_number,&amp;apos;PENDING&amp;apos; as Status,ld2.userdef41,null&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM pending_transactions pt, loanacct la, loanacct_detail_2 ld2&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = pt.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef35 = &amp;apos;SUBMITTED&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND convert(datetime,ld2.userdef41) = pt.effective_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;select convert(varchar(10),la.acctrefno) as acctrefno, lph.ach_trace_number,&amp;apos;COMPLETED&amp;apos;, ld2.userdef41,lph.date_paid&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct_payment_history lph, loanacct la, loanacct_detail_2 ld2&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = lph.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef35 = &amp;apos;SUBMITTED&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;select convert(varchar(10),ld2.acctrefno) ,null,&amp;apos;COMPLETED&amp;apos;,ld2.userdef41,lph.date_paid&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct_payment_history lph, loanacct_detail_2 ld2 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE ld2.acctrefno = lph.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef35 = &amp;apos;PENDING&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef34 =lph.ach_trace_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&amp;quot;


    LoanRefNo = NLSapp.SQLSelectStatement(sqlstring1)

    If LoanRefNo = &amp;quot;&amp;quot; Then
        LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
    End If
    Lcount = 0
    Do Until LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;

        achtrace = NLSapp.SQLSelectStatementNextColumn()
        status = NLSapp.SQLSelectStatementNextColumn()

        If status = &amp;quot;PENDING&amp;quot; Then

            xmlstrng1 = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;  standalone=&amp;quot;&amp;quot;yes&amp;quot;&amp;quot; ?&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;    &amp;lt;LOANDETAIL2  UserDefined34=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achtrace &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined35=&amp;quot;&amp;quot;&amp;quot; &amp;amp; status &amp;amp; &amp;quot;&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
        End If

        If status = &amp;quot;COMPLETED&amp;quot; Then

            xmlstrng1 = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;  standalone=&amp;quot;&amp;quot;yes&amp;quot;&amp;quot; ?&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;    &amp;lt;LOANDETAIL2  UserDefined35=&amp;quot;&amp;quot;&amp;quot; &amp;amp; status &amp;amp; &amp;quot;&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
        End If

        &amp;apos;NLSApp.MessageBox(xmlstrng1)

        &amp;apos;XML Imports
        ImportXML(xmlstrng1)

        LoanRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;Web Payments&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount 
    End If
&amp;apos;-------------------------------------------------------------------------------------------------------------------------------------------------
&amp;apos;WebPay Clean up -- to catch any remaining loans that were not updated by previous process
&amp;apos;-------------------------------------------------------------------------------------------------------------------------------------------------

 sysadmincifnum = &amp;quot;WEB PAY MAINT&amp;quot;
 userdefno = &amp;quot;18&amp;quot;
 Targetsql1 = &amp;quot;SELECT cd.userdef&amp;quot; &amp;amp; userdefno &amp;amp; &amp;quot; from cif c, cif_detail cd where c.cifno = cd.cifno  AND c.cifnumber = &amp;apos;&amp;quot; &amp;amp; sysadmincifnum &amp;amp; &amp;quot;&amp;apos;&amp;quot;
 
 acctrefno = NLSApp.SQLSelectStatement(NLSApp.SQLSelectStatement(Targetsql1))

    If acctrefno = &amp;quot;&amp;quot; Then
        acctrefno = &amp;quot;***END OF RESULT***&amp;quot;
    End If
    Lcount = 0

    Do Until acctrefno = &amp;quot;***END OF RESULT***&amp;quot;
    	      wpxml = &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;apos;1&amp;apos;&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;apos;1&amp;apos; AcctRefno=&amp;apos;&amp;quot; &amp;amp; acctrefno &amp;amp; &amp;quot;&amp;apos;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;&amp;lt;LOANDETAIL2 UserDefined35=&amp;apos;COMPLETED&amp;apos;/&amp;gt;&amp;lt;/LOAN&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
     
              ImportXML(wpxml)
              acctrefno = NLSApp.SQLSelectStatementReadNext()
    
    Loop

End Sub

Sub PDFP()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;PDFP Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    TranRefNosql = &amp;quot;SELECT convert(varchar(12),lth.transrefno),lth.transaction_date,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lth.effective_date,lth.date_due,la.current_suspense,la.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct la,loanacct_trans_history lth,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(SELECT DISTINCT la.loan_number,max(lth.transaction_date) as transaction_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct la,loanacct_trans_history lth WHERE la.acctrefno = lth.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lth.transaction_code = &amp;apos;124&amp;apos; AND la.current_suspense &amp;gt; 0 AND la.current_suspense = la.total_past_due_balance&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0 AND lth.date_due &amp;lt; getdate() group by  la.loan_number) lt&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = lth.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lt.loan_number = la.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lt.transaction_date = lth.transaction_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lth.transaction_code = &amp;apos;124&amp;apos;  &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;SELECT distinct convert(varchar(12),lth.transrefno),lth.transaction_date,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lth.effective_date,lth.date_due,la.total_past_due_balance,la.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct la,loanacct_trans_history lth, loanacct_payments_due lpd&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = lth.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lpd.payment_reference_no = lth.transaction_reference_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lth.transaction_code = &amp;apos;124&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.total_past_due_balance between .000010 and .01&amp;quot;

    TranRefNo = NLSapp.SQLSelectStatement(TranRefNosql)

    If  TranRefNo = &amp;quot;&amp;quot; Then
           TranRefNo =  &amp;quot;***END OF RESULT***&amp;quot;
    End If
    
    Lcount = 0

    Do Until TranRefNo =&amp;quot;***END OF RESULT***&amp;quot;
       
        transdate = NLSapp.SQLSelectStatementNextColumn()
        effdate = NLSapp.SQLSelectStatementNextColumn()
        duedate = NLSapp.SQLSelectStatementNextColumn()
        amount = NLSapp.SQLSelectStatementNextColumn()
        loannum = NLSapp.SQLSelectStatementNextColumn()

        revtransxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;125&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; effdate &amp;amp; &amp;quot;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannum &amp;amp; &amp;quot;&amp;quot;&amp;quot;  Amount=&amp;quot;&amp;quot;&amp;quot; &amp;amp; amount &amp;amp; &amp;quot;&amp;quot;&amp;quot; DateDue=&amp;quot;&amp;quot;&amp;quot; &amp;amp; duedate &amp;amp; &amp;quot;&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; transdate &amp;amp; &amp;quot;&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;&amp;quot; &amp;amp; TranRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        ImportXML(revtransxml)

        TranRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;PDFP Proccessing&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount
    End if
End Sub

Sub NonACHDetail2udf45Maint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;For Updating Detail2 UDF45 with the ACH Company ID to be utilized by web portal one-tine ACH payment function
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    importsxml = NLSApp.SQLSelectStatement(NLSApp.SQLSelectStatement(&amp;quot;SELECT cd.userdef35 FROM cif c, cif_detail cd Where c.cifno = cd.cifno and cifnumber = &amp;apos;WEB PAY MAINT&amp;apos;&amp;quot;))
    If len(importsxml) = 0 Then
        importsxml = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until importsxml = &amp;quot;***END OF RESULT***&amp;quot;

        ImportXML(importsxml)
        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                           
        &amp;apos;  &amp;lt;LOAN  UpdateFlag = &amp;quot;1&amp;quot; AcctRefno=&amp;quot;155190&amp;quot; &amp;gt;
        &amp;apos;   &amp;lt;LOANDETAIL2 UserDefined45 = &amp;quot;31&amp;quot; /&amp;gt;
        &amp;apos;  &amp;lt;/LOAN&amp;gt;
        &amp;apos;&amp;lt;/NLS&amp;gt;

        importsxml = NLSApp.SQLSelectStatementReadNext()
    Loop
End Sub

Sub FirstPayDefaultFlag()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;First Pay Default Flag UDF Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    timecheck = NLSapp.SQLSelectStatement(&amp;quot;SELECT Case When substring(cd.userdef03,10,25) &amp;gt; getdate() Then &amp;apos;N&amp;apos; Else &amp;apos;Y&amp;apos; End FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;FIRST PAY DEFAULTS&amp;apos;&amp;quot;)
    
    If timecheck = &amp;quot;Y&amp;quot; Then
        xmlsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;FIRST PAY DEFAULTS&amp;apos;&amp;quot;)
        
        detail2udf13xml = NLSapp.SQLSelectStatement(xmlsql)
        
        If detail2udf13xml = &amp;quot;&amp;quot; Then
            detail2udf13xml = &amp;quot;***END OF RESULT***&amp;quot;
        End If
        
        Do Until detail2udf13xml = &amp;quot;***END OF RESULT***&amp;quot;
        
           ImportXML(detail2udf13xml)
            &amp;apos;Expected XML string output Format:
            &amp;apos;&amp;lt;NLS EnforceTagExistence=&amp;quot;1&amp;quot;&amp;gt;
            &amp;apos;  &amp;lt;LOAN  UpdateFlag=&amp;quot;1&amp;quot; AcctRefno=&amp;quot;999999&amp;quot; &amp;gt;
            &amp;apos;    &amp;lt;LOANDETAIL2 UserDefined13 = &amp;quot;1&amp;quot; /&amp;gt;
            &amp;apos;  &amp;lt;/LOAN&amp;gt;
            &amp;apos;&amp;lt;/NLS&amp;gt;
        
            detail2udf13xml = NLSApp.SQLSelectStatementReadNext()
        
        Loop
        &amp;apos;Update last/Next Run datetime and Last user record
        Runstamp = NOW()
        NextRun = Date() + 1 &amp;amp; &amp;quot; 8:00:00 AM&amp;quot;
         NextRun = NOW()
        UID = NLSApp.GetCurrentUserNo()
        
        Cifupdate = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;apos;1&amp;apos;CIFNumber=&amp;apos;FIRST PAY DEFAULTS&amp;apos;&amp;gt;&amp;lt;CIFDETAIL CIFDetail3=&amp;apos;Next Run: &amp;quot; &amp;amp; NextRun &amp;amp; _
            &amp;quot;&amp;apos; CIFDetail4=&amp;apos;Last Run: &amp;quot; &amp;amp; Runstamp &amp;amp; &amp;quot;&amp;apos; CIFDetail5=&amp;apos; UserID: &amp;quot; &amp;amp; UID &amp;amp; &amp;quot;&amp;apos; /&amp;gt;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
        
        ImportXML(Cifupdate)
    End if

End Sub



Sub DSpaymntMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Settlement payment TC Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	paymentlookupsql = &amp;quot;Select                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +                                                                                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number +                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.row_id) + &amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;&amp;apos;Debt Settlement Payment&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lth.row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;from loanacct_payment_history lth,                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct l,                                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct_statuses ls,                                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;(                                                                  &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	Select acctrefno, max(mod_datestamp) as activetime              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from (                                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	SELECT row_id,acctrefno,mod_datestamp                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from loanacct_mod_history                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	where item_changed = &amp;apos;Status&amp;apos;                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	group by acctrefno) times                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;where times.acctrefno = lth.acctrefno                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.acctrefno = lth.acctrefno                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.acctrefno = lth.acctrefno                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.status_code_no IN  (32, 34)                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos;                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and payment_type = &amp;apos;ZZ&amp;apos;                                            &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and lth.nsf_flag = 0                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.current_ol1_balance &amp;gt; 0                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and date_paid &amp;gt;= times.activetime &amp;quot;



		
	Do 	
		AddDStransXML = NLSApp.SQLSelectStatement(paymentlookupsql)
		payHistUpdatesql = NLSapp.SQLSelectStatementNextColumn()
		
		&amp;apos;Sample output
		&amp;apos;AddDStransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/07/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0162960&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;463.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;5138899&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
		&amp;apos;payHistUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where row_id = 5138899&amp;quot;

		If Not AddDStransXML = &amp;quot;&amp;quot; Then
			ImportXML(AddDStransXML)
			NLSApp.SQLSelectStatement(payHistUpdatesql)
		End If
		count = count + 1
	Loop Until AddDStransXML = &amp;quot;&amp;quot;
	
	&amp;apos;USER ID update 
	NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0 Where transaction_code IN (&amp;apos;8460&amp;apos;,&amp;apos;8440&amp;apos;,&amp;apos;8100&amp;apos;,&amp;apos;8200&amp;apos;) and  enteredby_uid in (39)&amp;quot;)

	
End Sub

    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Settlement Fee Maint
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;

Sub DebtsetFeeTransMaint()

    &amp;apos;Set the list of transaction codes to include in the query i.e., &amp;apos;150&amp;apos;,&amp;apos;180&amp;apos;,&amp;apos;504&amp;apos;
    transcodestrg = &amp;quot;&amp;apos;&amp;quot; &amp;amp; LOAN_TRANS_CODE_LATE_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_NSF_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_CHECK_FEE &amp;amp; &amp;quot;&amp;apos;&amp;quot;
    &amp;apos;Set the list of loan status codes to include in the query i.e., &amp;apos;32&amp;apos;,&amp;apos;34&amp;apos;
    statcodestrg = &amp;quot;&amp;apos;&amp;quot; &amp;amp; LOAN_STATUS_ACTIVE_SETTLEMENT &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_STATUS_BROKEN_SETTLEMENT &amp;amp; &amp;quot;&amp;apos;&amp;quot; 
    
    &amp;apos;SQL command that will lookup the loans with required fields to create transaction records. Output is an importable XML string and a SQL command string
    &amp;apos;***Sample SQL output***
    &amp;apos;CP000123, &amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8280&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;02/26/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00463650&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;15.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;7135687&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;5318695&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;
    &amp;apos;,SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;Debt Settlement transaction&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where transrefno = 7135687

    dsfeestblsql = &amp;quot;Select convert(varchar(15),l.acctrefno) as acctrefno,   &amp;apos;transimportxml&amp;apos; =  &amp;quot; &amp;amp; chr(13) &amp;amp; _                     
        &amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +    &amp;quot; &amp;amp; chr(13) &amp;amp; _                                                                                                                  
        &amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8&amp;apos; + convert(varchar,lth.transaction_code) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.transaction_date,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;quot; &amp;amp; chr(13) &amp;amp; _                                        
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,   &amp;quot; &amp;amp; chr(13) &amp;amp; _                  
        &amp;quot;&amp;apos;transupdatesql&amp;apos; = &amp;apos;SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;&amp;apos;DEBT SETTLEMENT TRANS&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where transrefno = &amp;apos; + convert(varchar,lth.transrefno)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;from loanacct_trans_history lth,  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;loanacct l, &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;loanacct_statuses ls,&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;(           &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    Select acctrefno, max(mod_datestamp) as activetime   &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    from (                &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    SELECT row_id,acctrefno,mod_datestamp  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    from loanacct_mod_history     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    where item_changed = &amp;apos;Status&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    group by acctrefno) times  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;where times.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.acctrefno = lth.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.status_code_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and ls.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and ls.status_code_no IN  (&amp;quot; &amp;amp; statcodestrg &amp;amp; &amp;quot;)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and (userdef01 not like &amp;apos;DEBT SETTLEMENT TRANS&amp;apos;   or userdef01 IS NULL)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.transaction_code IN (&amp;quot; &amp;amp; transcodestrg &amp;amp; &amp;quot;)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.reversal_transrefno = 0     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.current_ol1_balance &amp;gt; 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.transaction_date &amp;gt;= times.activetime &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot; order by l.acctrefno,[transimportxml]&amp;quot;
        
    &amp;apos;dim dynamic array to hold sql results
    redim DSfeeslist(2,1)

    &amp;apos;populate array data with sql output
    Do until nextrefno = &amp;quot;***END OF RESULT***&amp;quot;
        rowcnt = UBound(DSfeeslist,2)
        
        If rowcnt = 1 Then
            DSfeeslist(0,rowcnt) = NLSApp.SQLSelectStatement(dsfeestblsql)
        else
            DSfeeslist(0,rowcnt) = nextrefno
        end if
        
        DSfeeslist(1,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        DSfeeslist(2,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        nextrefno = NLSApp.SQLSelectStatementReadNext()

        If not nextrefno = &amp;quot;***END OF RESULT***&amp;quot; Then
           redim Preserve DSfeeslist(2,rowcnt + 1)
        End if

    Loop 

    &amp;apos;Run XML Import process and SQL updates to Add and Update transaction records
    For counter = 1 to rowcnt
        
        ImportXML(DSfeeslist(1,counter))
        NLSApp.SQLSelectStatement(DSfeeslist(2,counter))
       
    Next
End Sub


Sub DSBilltransMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Billing Transaction (124) TC Maintainance
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	translookupsql = &amp;quot;Select distinct &amp;apos;UPDATE loanacct_recurring_trans set event_transaction_due_date = &amp;apos;&amp;apos;&amp;apos; + convert(char(10),event_startdate+16,101) + &amp;apos;&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar(10),row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;from loanacct_recurring_trans                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;where rec_trans_description = &amp;apos;Debt Settlment Billing Transactions&amp;apos;          &amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;and event_startdate+16 &amp;lt;&amp;gt; event_transaction_due_date&amp;quot;

	 
    transupdatesrow = NLSApp.SQLSelectStatement(translookupsql)
      
    If Not  transupdatesrow = &amp;quot;&amp;quot; Then  
                 	
		Do 	Until  transupdatesrow = &amp;quot;***END OF RESULT***&amp;quot;
		&amp;apos;Do 	Until count = 2  
			transupdates =  transupdates &amp;amp; chr(13) &amp;amp;  transupdatesrow
                                                transupdatesrow = NLSApp.SQLSelectStatementReadNext()
        count = count + 1
		Loop 
    End If
    &amp;apos;NLSapp.MessageBox(&amp;quot;SELECT 0; &amp;quot; &amp;amp; transupdates)	
    NLSapp.SQLSelectStatement(&amp;quot;SELECT 0;  &amp;quot; &amp;amp; transupdates)

End Sub

&amp;apos;FUNCTIONS-------------------------------------------------------------

Function AddWOandPendingComplete(xml)
    NLSApp.ClearErrorString()
    endmark =  &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
    refno = Mid(xml, InStr(xml, endmark) + len(endmark), len(xml) - InStr(xml, endmark) + len(endmark))
    
    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            errormsg = NLSApp.GetErrorString()
            subject = &amp;quot;Pending Complete Loan Closure process IMPORT FAILURE!&amp;quot;
            toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
            body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Import Error: &amp;quot; &amp;amp; chr(13) &amp;amp; errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
            NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
        End If
        AddWOandPendingComplete = errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
    Else
        &amp;apos; NLSApp.MessageBox(&amp;quot;&amp;quot;)
        AddWOandPendingComplete = &amp;quot;&amp;quot;
    End If
End Function

Function ACHCompanySyncatupdate2018(refno,Investor,Portfolio,WebACH)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &amp;apos;Triggered when individual loan account is changed or updated.
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    
    &amp;apos;Declare variables
    runtimestamp = Now()
    emailyn = &amp;quot;N&amp;quot;
    userno = NLSApp.GetCurrentUserNo()
    &amp;apos;refno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
    &amp;apos;Investor = NLSApp.GetField(&amp;quot;LOAN_CLASS2&amp;quot;)
    &amp;apos;Portfolio = NLSApp.GetField(&amp;quot;LOAN_PORTFOLIO&amp;quot;)
    &amp;apos;WebACH = NLSApp.GetField(&amp;quot;LOAN_DETAIL2_UDF45&amp;quot;)
    targetACH =  InvestorACHSync(Investor, Portfolio)
    &amp;apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &amp;quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &amp;quot; &amp;amp; refno &amp;amp; &amp;quot; and ach_company_id &amp;lt;&amp;gt; &amp;quot; &amp;amp; targetACH
    &amp;apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 

    &amp;apos;Other variables
    modhistupdatesql = &amp;quot;&amp;quot;  
    loanach = &amp;quot;&amp;quot;
    loandetail = &amp;quot;&amp;quot;
    achxml = &amp;quot;&amp;quot;
    Detail2pdatesql = &amp;quot;&amp;quot;
    ACHUpdatesql = &amp;quot;&amp;quot;

    &amp;apos;MsgBox(&amp;quot;acctrefno = &amp;quot; &amp;amp; acctrefno &amp;amp; chr(13) &amp;amp; &amp;quot;Port = &amp;quot; &amp;amp; Portfolio)
   &amp;apos; MsgBox(&amp;quot;target ach = &amp;quot; &amp;amp; targetACH)
    &amp;apos;MsgBox(&amp;quot;ach row id = &amp;quot; &amp;amp; nomatchACHrowID)
   &amp;apos; MsgBox(&amp;quot;udf 45 = &amp;quot; &amp;amp; WebACH)

    &amp;apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &amp;quot;&amp;quot; Then
        Do Until nomatchACHrowID = &amp;quot;&amp;quot; &amp;apos;&amp;quot;***END OF RESULT***&amp;quot;
            ACHUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot; Where row_id = &amp;quot; &amp;amp; nomatchACHrowID

            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &amp;apos;MsgBox(&amp;quot;all match&amp;quot;)
    End If    

    &amp;apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &amp;apos;&amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
    ACHCompanySyncatupdate2018 = &amp;quot;&amp;quot;  
End Function


&quot;/&gt;
&lt;BUTTON Name=&quot;DS maint Only&quot; Script=&quot;DSpaymntMaint()
DebtsetFeeTransMaint()
DSBilltransMaint()
reverseDSpayments()

Sub DSpaymntMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Settlement payment TC Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	paymentlookupsql = &amp;quot;Select                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +                                                                                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number +                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.row_id) + &amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;&amp;apos;Debt Settlement Payment&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lth.row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;from loanacct_payment_history lth,                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct l,                                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct_statuses ls,                                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;(                                                                  &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	Select acctrefno, max(mod_datestamp) as activetime              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from (                                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	SELECT row_id,acctrefno,mod_datestamp                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from loanacct_mod_history                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	where item_changed = &amp;apos;Status&amp;apos;                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	group by acctrefno) times                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;where times.acctrefno = lth.acctrefno                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.acctrefno = lth.acctrefno                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.acctrefno = lth.acctrefno                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.status_code_no IN  (32, 34)                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos;                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and payment_type = &amp;apos;ZZ&amp;apos;                                            &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and lth.nsf_flag = 0                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.current_ol1_balance &amp;gt; 0                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and date_paid &amp;gt;= times.activetime &amp;quot;



		
	Do 	
		AddDStransXML = NLSApp.SQLSelectStatement(paymentlookupsql)
		payHistUpdatesql = NLSapp.SQLSelectStatementNextColumn()
		
		&amp;apos;Sample output
		&amp;apos;AddDStransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/07/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0162960&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;463.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;5138899&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
		&amp;apos;payHistUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where row_id = 5138899&amp;quot;

		If Not AddDStransXML = &amp;quot;&amp;quot; Then
			ImportXML(AddDStransXML)
			NLSApp.SQLSelectStatement(payHistUpdatesql)
		End If
		count = count + 1
	Loop Until AddDStransXML = &amp;quot;&amp;quot;
	
	&amp;apos;USER ID update 
	NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0 Where transaction_code IN (&amp;apos;8460&amp;apos;,&amp;apos;8440&amp;apos;,&amp;apos;8100&amp;apos;,&amp;apos;8200&amp;apos;) and  enteredby_uid in (39)&amp;quot;)

	
End Sub

    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Settlement Fee Maint
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;

Sub DebtsetFeeTransMaint()

    &amp;apos;Set the list of transaction codes to include in the query i.e., &amp;apos;150&amp;apos;,&amp;apos;180&amp;apos;,&amp;apos;504&amp;apos;
    transcodestrg = &amp;quot;&amp;apos;&amp;quot; &amp;amp; LOAN_TRANS_CODE_LATE_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_NSF_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_CHECK_FEE &amp;amp; &amp;quot;&amp;apos;&amp;quot;
    &amp;apos;Set the list of loan status codes to include in the query i.e., &amp;apos;32&amp;apos;,&amp;apos;34&amp;apos;
    statcodestrg = &amp;quot;&amp;apos;&amp;quot; &amp;amp; LOAN_STATUS_ACTIVE_SETTLEMENT &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_STATUS_BROKEN_SETTLEMENT &amp;amp; &amp;quot;&amp;apos;&amp;quot; 
    
    &amp;apos;SQL command that will lookup the loans with required fields to create transaction records. Output is an importable XML string and a SQL command string
    &amp;apos;***Sample SQL output***
    &amp;apos;CP000123, &amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8280&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;02/26/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00463650&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;15.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;7135687&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;5318695&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;
    &amp;apos;,SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;Debt Settlement transaction&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where transrefno = 7135687

    dsfeestblsql = &amp;quot;Select convert(varchar(15),l.acctrefno) as acctrefno,   &amp;apos;transimportxml&amp;apos; =  &amp;quot; &amp;amp; chr(13) &amp;amp; _                     
        &amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +    &amp;quot; &amp;amp; chr(13) &amp;amp; _                                                                                                                  
        &amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8&amp;apos; + convert(varchar,lth.transaction_code) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.transaction_date,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;quot; &amp;amp; chr(13) &amp;amp; _                                        
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,   &amp;quot; &amp;amp; chr(13) &amp;amp; _                  
        &amp;quot;&amp;apos;transupdatesql&amp;apos; = &amp;apos;SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;&amp;apos;DEBT SETTLEMENT TRANS&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where transrefno = &amp;apos; + convert(varchar,lth.transrefno)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;from loanacct_trans_history lth,  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;loanacct l, &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;loanacct_statuses ls,&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;(           &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    Select acctrefno, max(mod_datestamp) as activetime   &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    from (                &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    SELECT row_id,acctrefno,mod_datestamp  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    from loanacct_mod_history     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    where item_changed = &amp;apos;Status&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;    group by acctrefno) times  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;where times.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.acctrefno = lth.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.status_code_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and ls.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and ls.status_code_no IN  (&amp;quot; &amp;amp; statcodestrg &amp;amp; &amp;quot;)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and (userdef01 not like &amp;apos;DEBT SETTLEMENT TRANS&amp;apos;   or userdef01 IS NULL)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.transaction_code IN (&amp;quot; &amp;amp; transcodestrg &amp;amp; &amp;quot;)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.reversal_transrefno = 0     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and l.current_ol1_balance &amp;gt; 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot;and lth.transaction_date &amp;gt;= times.activetime &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
        &amp;quot; order by l.acctrefno,[transimportxml]&amp;quot;
        
    &amp;apos;dim dynamic array to hold sql results
    redim DSfeeslist(2,1)

    &amp;apos;populate array data with sql output
    Do until nextrefno = &amp;quot;***END OF RESULT***&amp;quot;
        rowcnt = UBound(DSfeeslist,2)
        
        If rowcnt = 1 Then
            DSfeeslist(0,rowcnt) = NLSApp.SQLSelectStatement(dsfeestblsql)
        else
            DSfeeslist(0,rowcnt) = nextrefno
        end if
        
        DSfeeslist(1,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        DSfeeslist(2,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        nextrefno = NLSApp.SQLSelectStatementReadNext()

        If not nextrefno = &amp;quot;***END OF RESULT***&amp;quot; Then
           redim Preserve DSfeeslist(2,rowcnt + 1)
        End if

    Loop 

    &amp;apos;Run XML Import process and SQL updates to Add and Update transaction records
    For counter = 1 to rowcnt
        
        ImportXML(DSfeeslist(1,counter))
        NLSApp.SQLSelectStatement(DSfeeslist(2,counter))
       
    Next
End Sub


Sub DSBilltransMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Billing Transaction (124) TC Maintainance
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	translookupsql = &amp;quot;Select distinct &amp;apos;UPDATE loanacct_recurring_trans set event_transaction_due_date = &amp;apos;&amp;apos;&amp;apos; + convert(char(10),event_startdate+16,101) + &amp;apos;&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar(10),row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;from loanacct_recurring_trans                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;where rec_trans_description = &amp;apos;Debt Settlment Billing Transactions&amp;apos;          &amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;and event_startdate+16 &amp;lt;&amp;gt; event_transaction_due_date&amp;quot;

	 
    transupdatesrow = NLSApp.SQLSelectStatement(translookupsql)
      
    If Not  transupdatesrow = &amp;quot;&amp;quot; Then  
                 	
		Do 	Until  transupdatesrow = &amp;quot;***END OF RESULT***&amp;quot;
		&amp;apos;Do 	Until count = 2  
			transupdates =  transupdates &amp;amp; chr(13) &amp;amp;  transupdatesrow
                                                transupdatesrow = NLSApp.SQLSelectStatementReadNext()
        count = count + 1
		Loop 
    End If
    &amp;apos;NLSapp.MessageBox(&amp;quot;SELECT 0; &amp;quot; &amp;amp; transupdates)	
    NLSapp.SQLSelectStatement(&amp;quot;SELECT 0;  &amp;quot; &amp;amp; transupdates)

End Sub

Sub reverseDSpayments()

	revtranslookupsql = &amp;quot;select distinct  &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8201&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),getdate(),1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;apos;&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;&amp;apos; + + convert(varchar,lth1.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth1.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;&amp;apos; + lth1.userdef01  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_trans_history lth1,  	/*lth1 represents the DS transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct_trans_history lth2, 			/*lth2 represents the loan payment transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct l &amp;quot; &amp;amp; chr(13) &amp;amp; _								
	&amp;quot;where lth1.userdef04 is not null &amp;quot; &amp;amp; chr(13) &amp;amp; _		
	&amp;quot;and lth1.acctrefno = l.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and cast(lth2.transaction_reference_no as varchar) = lth1.userdef04  		/*pairs DS transaction to it loan payment transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and (lth1.reversal_transrefno = 0 and not lth2.reversal_transrefno = 0) 	/*DS transaction has not been reversed but the loan payment has been reversed*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth2.transaction_date &amp;gt; &amp;apos;02/01/18&amp;apos; 									/*not valid for transactions prior to implementation date*/&amp;quot;

		Do 	
			RevtransXML = NLSApp.SQLSelectStatement(revtranslookupsql)

			&amp;apos;Sample output
			&amp;apos;RevtransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8201&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/21/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00553272&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;5256551&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;500.00&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;3089124&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

			If Not RevtransXML = &amp;quot;&amp;quot; Then
				ImportXML(RevtransXML)
			End If

		Loop Until RevtransXML = &amp;quot;&amp;quot;
	
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;zero bal let&quot; Script=&quot;template = Inputbox(&amp;quot;Enter your message&amp;quot;,&amp;quot;Input Required&amp;quot;)

If InStr(&amp;quot;5,6&amp;quot;,&amp;quot;,&amp;quot; &amp;amp; template) = 0 Then
      acctno = 30905
Else
     acctno = 16175
End if
     acctno = 30905

AutoCloseaddCompleted2018(acctno)

Sub AutoCloseaddCompleted2018(refno)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Close Loans in COMPLETE PENDING status for prescribed waiting period or more and queue up ZERO Balance letter for printing or email
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;

        Set DT5 = NLSApp.GetDocumentTemplates(5)
        Set DT6 = NLSApp.GetDocumentTemplates(6)
        Set DT10 = NLSApp.GetDocumentTemplates(10)
        Set DT11 = NLSApp.GetDocumentTemplates(11)



            If template = 5 Then
                 DT5.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, &amp;quot;TRUE&amp;quot;, &amp;quot;T:\Temp\&amp;quot;
            End if
            If template = 6 Then
                 DT6.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, &amp;quot;TRUE&amp;quot;, &amp;quot;T:\Temp\&amp;quot;
            End if
            If template = 10 Then
                 DT10.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, &amp;quot;TRUE&amp;quot;, &amp;quot;T:\Temp\&amp;quot;
            End if
            If template = 11 Then
                 DT11.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, &amp;quot;TRUE&amp;quot;, &amp;quot;T:\Temp\&amp;quot;
            End if

    
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;new const&quot; Script=&quot;ACHCompanysync()

Sub ACHCompanysync()
    loanACHlistsql = &amp;quot;SELECT distinct convert(varchar,l.acctrefno) + &amp;apos;,&amp;apos;+ convert(varchar,l.portfolio_code_id) + &amp;apos;,&amp;apos;+  convert(varchar,l.loan_class2_no) + &amp;apos;,&amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;CASE WHEN lach.row_id IS NULL THEN &amp;apos;&amp;apos; Else convert(varchar,lach.row_id) END + &amp;apos;,&amp;apos;+  &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;CASE WHEN lach.ach_company_id IS NULL THEN &amp;apos;&amp;apos; Else convert(varchar,lach.ach_company_id) END + &amp;apos;,&amp;apos;+ &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;CASE WHEN ld2.userdef45 IS NULL THEN &amp;apos;&amp;apos; Else convert(varchar,ld2.userdef45) END as list &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Into #loanachlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct_detail_2 ld2,&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct_ach lach&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;l.acctrefno = lach.acctrefno and lach.status = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (Select count(*) from #loanachlist),list from #loanachlist /*where list like &amp;apos;111618%&amp;apos;*/ order by list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #loanachlist&amp;quot;

    p = 0
    u = 0

    &amp;apos;Disable ALL outside scripting
    NLSapp.ScriptOn(false)

    loanACHlistcnt = NLSapp.SQLSelectStatement(loanACHlistsql )

    ReDim loanACHlist(loanACHlistcnt-1)

    start = Time()
    For rowno = 1 to loanACHlistcnt
        r = rowno-1
        loanACHlist(r) = NLSapp.SQLSelectStatementNextColumn()

        nextrow = NLSapp.SQLSelectStatementReadNext()
    Next

    For Each record in loanACHlist

        loandetail = split(record,&amp;quot;,&amp;quot;)
        sourceclass2no = loandetail(2)
        targetinvestor = split(investormatrix(sourceclass2no),&amp;quot;,&amp;quot;)
        
        If Not loandetail(2) = 0 Then
            If loandetail(1) = 0 Then
                targetACHno = targetinvestor(2)
            Else 
                targetACHno = targetinvestor(4)
            End if 
            
            If NOT Len(loandetail(4)) = 0 then
                If NOT loandetail(4) = targetACHno Then
                    p = P + 1
                    achidupdatesqlp = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;UPDATE loanacct_ach SET ach_company_id = &amp;quot; &amp;amp; targetACHno &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;where row_id = &amp;quot; &amp;amp; loandetail(3)
                    
                    NLSapp.SQLSelectStatement(achidupdatesqlp)
                    
                End If
            End If
            
            If NOT loandetail(5) = targetACHno Then
                u = u + 1
                achidupdatesqlu = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;UPDATE loanacct_detail_2 SET userdef45 = &amp;quot; &amp;amp; targetACHno &amp;amp; chr(13) &amp;amp; _
                &amp;quot;WHERE acctrefno = &amp;quot; &amp;amp; loandetail(0)
                
                NLSapp.SQLSelectStatement(achidupdatesqlu)
                
            End If
        End If
    Next

    &amp;apos;Re-Enable outside scripting
    NLSapp.ScriptOn(true)

    finish = Time()
    dailynote = &amp;quot;   Miss-matched ACH setups: &amp;quot; &amp;amp; p &amp;amp; &amp;quot;&amp;amp;#13;&amp;amp;#10;Miss-matched UDF45s: &amp;quot; &amp;amp; u &amp;amp; &amp;quot;&amp;amp;#13;&amp;amp;#10;Start time: &amp;quot; &amp;amp; FormatDateTime(start,vbLongTime) &amp;amp; &amp;quot;&amp;amp;#13;&amp;amp;#10;Finish time: &amp;quot; &amp;amp; FormatDateTime(finish,vbLongTime)
    NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot;, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, &amp;quot;Daily ACH Sync&amp;quot;, dailynote 
    logXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;NLSLOG LogTypeDescription=&amp;quot;&amp;quot;Scripting&amp;quot;&amp;quot; ErrorStatus=&amp;quot;&amp;quot;0&amp;quot;&amp;quot; Log=&amp;quot;&amp;quot;&amp;quot; &amp;amp; dailynote &amp;amp;&amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
    ImportXML(logXML)
    msgbox(dailynote)

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;Processing&quot; Script=&quot;StartTime = Timer()


Do While lapseTime &amp;lt; 30
    lapseTime = round(Timer() - StartTime,0)
   &amp;apos; msgbox( lapseTime) : Rem Comment after a statement separated by a colon.

loop

    logXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;NLSLOG LogTypeDescription=&amp;quot;&amp;quot;Scripting&amp;quot;&amp;quot; ErrorStatus=&amp;quot;&amp;quot;0&amp;quot;&amp;quot; Log=&amp;quot;&amp;quot;&amp;quot; &amp;amp;  lapseTime &amp;amp;&amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
    ImportXML(logXML)
msgbox( lapseTime) : Rem Comment after a statement separated by a colon.&quot;/&gt;
&lt;BUTTON Name=&quot;test12&quot; Script=&quot;deleteskips = &amp;quot;&amp;lt;DATA&amp;gt;&amp;lt;ROW RowNumber=&amp;apos;0&amp;apos;&amp;gt;&amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt;&amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;AUTO CLOSE&amp;apos;/&amp;gt;                  &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;1&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt;                        &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;AUTO W/O&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;2&amp;apos;&amp;gt;         &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;ACHCO SYNC&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt;       &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;3&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;COMM PREFS&amp;apos;/&amp;gt;               &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;4&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt;                        &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;PDFP&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;5&amp;apos;&amp;gt;             &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;FIRSTPAYDEFAULT&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt;  &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;6&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;DS PAYMNT&amp;apos;/&amp;gt;                &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;7&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt;                        &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;DS FEE&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;Off&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;8&amp;apos;&amp;gt;          &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;DS BILL&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt;          &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;9&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;DS PAYMNT REV&amp;apos;/&amp;gt;            &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;ROW RowNumber=&amp;apos;10&amp;apos;&amp;gt; &amp;lt;COLUMN Name=&amp;apos;&amp;apos; Value=&amp;apos;&amp;apos;/&amp;gt;                       &amp;quot; &amp;amp; _
&amp;quot;&amp;lt;COLUMN Name=&amp;apos;Daily Process&amp;apos; Value=&amp;apos;UDF46MAINT&amp;apos;/&amp;gt; &amp;lt;COLUMN Name=&amp;apos;On/Off&amp;apos; Value=&amp;apos;On&amp;apos;/&amp;gt; &amp;lt;/ROW&amp;gt; &amp;lt;/DATA&amp;gt;                   &amp;quot;

NLSApp.Setfield &amp;quot;CIF_DETAIL_UDF51&amp;quot;, deleteskips

&amp;apos;NLSapp.SQLSelectStatement(deleteskips )&quot;/&gt;
&lt;BUTTON Name=&quot;delete all skip numbers&quot; Script=&quot;deleteskips  = &amp;quot;DELETE FROM cif_phone_nums where  phone_description like &amp;apos;%skip%&amp;apos;&amp;quot;

NLSapp.SQLSelectStatement(deleteskips )&quot;/&gt;
&lt;BUTTON Name=&quot;test13&quot; Script=&quot;NLSApp.SetScriptTimeOut(1200000)
UDF51procs = NLSApp.GetField(&amp;quot;CIF_DETAIL_UDF51&amp;quot;)

dailyprocs = getprocessstatuses (UDF51procs)

x = Split(dailyprocs(0),&amp;quot;,&amp;quot;)
If x(1) = &amp;quot;On&amp;quot; Then
    msgbox(&amp;quot;ON&amp;quot;)
End If&quot;/&gt;
&lt;BUTTON Name=&quot;test14&quot; Script=&quot;
Set objShell = CreateObject(&amp;quot;Wscript.Shell&amp;quot;) 
objShell.Run &amp;quot;https://www.textmagic.com/free-tools/email-validation-tool&amp;quot;
&amp;apos;objShell.Run &amp;quot;https://email-checker.p.mashape.com/verify/v1?email=12345%40little.com &amp;quot;
&amp;apos;objShell.Run &amp;quot;https://email-checker.net/&amp;quot;&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;91&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="200.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="200.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="91"/>
<USERDEFFIELDS field_id="59" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;93&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="178.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="178.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="93"/>
<USERDEFFIELDS field_id="58" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;95&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="156.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="156.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="95"/>
<USERDEFFIELDS field_id="57" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;97&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="134.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="134.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="97"/>
<USERDEFFIELDS field_id="56" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;99&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="112.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="112.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="99"/>
<USERDEFFIELDS field_id="55" field_type="6" field_attribute="0" label_text="TBD" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;FUSE import&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE FUSE Import field 
&amp;apos;on Button click option selection
&amp;apos;For selected file in designated directory, processes list of loans for updates
    
Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidloans = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = FUSE_IMPORTS_PENDING_DIR
completefolder = FUSE_SCORE_IMPORTS_COMPLETED_DIR
targetfolder = &amp;quot;\\tsclient\C\Users\smuhammad\OneDrive - Freedom Financial Network\Fuse\Pending&amp;quot;
completefolder = &amp;quot;\\tsclient\C\Users\smuhammad\OneDrive - Freedom Financial Network\Fuse\Completed&amp;quot;
targetbackupsavfolder = &amp;quot;\\tsclient&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim loanlist(1)

&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile,objShellFolderSavFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;, &amp;amp;H0008+&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    &amp;apos; set objFsFolder = objFs.GetFolder(targetfolder)
    &amp;apos; Foldersize = objFsFolder.size
    &amp;apos; If Foldersize &amp;gt; 0 Then 
        &amp;apos; &amp;apos;msgBox(objFsFolder.size)
        &amp;apos; &amp;apos;msgBox(objShellFolderFileItems.count)
    &amp;apos; End If
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellVal = objExcel.Cells(allrowcount,1).Value
            InvVal = objExcel.Cells(allrowcount,3).Value
            validloan = NLSApp.SQLSelectStatement(&amp;quot;Select count(*) from loanacct where loan_number = &amp;apos;&amp;quot; &amp;amp; CellVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
            validclass2 = 1        
            If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1        

                If validloan = 0 Then
                    Invalidloans = Invalidloans + 1
                End if
                &amp;apos;Set failure code - 
                SELECT Case validloan
                    case &amp;quot;1&amp;quot;
                    validrecords = validrecords + 1
                    objExcel.Cells(allrowcount, 2).Value = &amp;quot;OK&amp;quot;
                    
                    case &amp;quot;0&amp;quot;
                    objExcel.Cells(allrowcount, 2).Value = &amp;quot;F1&amp;quot;

                End select

                loanlist(datarows-1) = CellVal &amp;amp; validloan
                redim preserve loanlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        &amp;apos;msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(10) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid Loan Numbers (F1): &amp;quot; &amp;amp; Invalidloans &amp;amp; chr(13)
        &amp;apos;msgline3 = &amp;quot;Invalid Investor Designations (F2): &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid loan records submitted for update: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1,1).Value = &amp;quot;Account&amp;quot;
        objExcel.Cells(1,2).Value = &amp;quot;SuccessCode&amp;quot;	
        objExcel.Cells(1,3).Value = &amp;quot;Propensity To Pay&amp;quot;
        objExcel.Cells(1,4).Value = &amp;quot;Weighted Dollar&amp;quot;
        objExcel.Cells(1,5).Value = &amp;quot;Decile&amp;quot;
        objExcel.Cells(1,7).Value = &amp;quot;PROCESSING SUMARY &amp;quot; &amp;amp; NOW()
        objExcel.Cells(2,7).Value = msgheader
        &amp;apos;objExcel.Cells(3,7).Value = msgline1
        objExcel.Cells(3,7).Value = msgline2
        &amp;apos;objExcel.Cells(5,7).Value = msgline3
        objExcel.Cells(4,7).Value = msgline4
        
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing if &amp;quot;NO&amp;quot;
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder if there are no errors
        processresult = processFUSEupdates (allrowcount,Startrowno,1)
        If processresult = &amp;quot;1&amp;quot; Then
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        Else
            &amp;apos;If there are errors in processing all valid loans
            NLSApp.MessageBox(&amp;quot;There was a problem with Updating the loans below.&amp;quot; &amp;amp; chr(13) &amp;amp; processresult)
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        End if
        
    &amp;apos;Close Excel object and move processed file to completed folder
        objWorkbook.Save 
        objWorkbook.Close
        objExcel.quit

        &amp;apos;set objExcel = nothing
        &amp;apos;set objShell = nothing
        objFs.GetFolder(targetfolder)
        &amp;apos;Set objShellFolderSavFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;,&amp;amp;H0008+&amp;amp;H0020,targetsavfolder)

        completefolder = CStr(objShellFolderSavFile.Self.path) &amp;amp; &amp;quot;\&amp;quot;
        savefilepath = completefolder &amp;amp; &amp;quot;FUSEImport&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
        objFs.MoveFile strExcelPath,savefilepath
		
        If objFs.FileExists(savefilepath) = True Then
            MsgBox(&amp;quot;Results file saved to:  &amp;quot; &amp;amp; savefilepath)
        Else
            MsgBox(&amp;quot;There was a problem saving Results file to:  &amp;quot; &amp;amp; savedfilepath)
        End If
        
        set objExcel = nothing
        set objShell = nothing

    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function processFUSEupdates (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
        LoanNumber = objExcel.Cells(rowno, colno).Value
        scode = objExcel.Cells(rowno, colno+1).Value
        score1 = objExcel.Cells(rowno, colno+2).Value
        score2 = objExcel.Cells(rowno, colno+3).Value
        score3 = objExcel.Cells(rowno, colno+4).Value
        LoanRefno = NLSapp.SQLSelectStatement(&amp;quot;SELECT convert(varchar,acctrefno)FROM loanacct WHERE loan_number = &amp;apos;&amp;quot; &amp;amp; LoanNumber &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
        If scode = &amp;quot;OK&amp;quot; Then
            If score1 = &amp;quot;&amp;quot; Then
                score1 = &amp;quot;NULL&amp;quot;
            End If	
            If score2 = &amp;quot;&amp;quot; Then
                score2 = &amp;quot;NULL&amp;quot;
            End If
            If score3 = &amp;quot;&amp;quot; Then
                score3 = &amp;quot;NULL&amp;quot;
            End If
            NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef26 = &amp;quot; &amp;amp; score1 &amp;amp; &amp;quot;, userdef27 = &amp;quot; &amp;amp; score2 &amp;amp; &amp;quot;, userdef28 = &amp;quot; &amp;amp; score3 &amp;amp; &amp;quot;  where acctrefno = &amp;quot; &amp;amp; LoanRefno)
            &amp;apos; If (Counter Mod 33) = 0 Then
                &amp;apos; NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef24 = &amp;apos;09/01/2018&amp;apos;  where acctrefno = &amp;quot; &amp;amp; LoanRefno)
            &amp;apos; End if
            &amp;apos;Update validation (based on udf24(last update) field
            &amp;apos;newdate = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef24 FROM loanacct_detail_2 WHERE acctrefno = &amp;quot; &amp;amp; LoanRefno)
            If score1 &amp;amp; score2 &amp;amp; score3 = &amp;quot;&amp;quot; Then
                notupdated = notupdated &amp;amp; LoanNumber &amp;amp; chr(10)
                objExcel.Cells(rowno, 2).Value = &amp;quot;F2&amp;quot;
                updatefail = updatefail + 1
            End If
        End If
        rowno = rowno +1
    Next
    If notupdated = &amp;quot;&amp;quot; Then
        processFUSEupdates = &amp;quot;1&amp;quot;
    Else
        objExcel.Cells(5,8).Value = &amp;quot;Update Failures(F2): &amp;quot; &amp;amp; updatefail
        processFUSEupdates = notupdated
    End If 
End Function



&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;101&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="90.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="90.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="101"/>
<USERDEFFIELDS field_id="54" field_type="6" field_attribute="0" label_text="Experian" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Score File Import&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Experian Import field 
&amp;apos;on Button click option selection
&amp;apos;For selected file in designated directory, processes list of loans for updates
    
Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidloans = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = EXPERIAN_IMPORTS_PENDING_DIR
completefolder = EXPERIAN_SCORE_IMPORTS_COMPLETED_DIR
targetbackupsavfolder = &amp;quot;\\tsclient&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim loanlist(1)

&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile,objShellFolderSavFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;, &amp;amp;H0008+&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    &amp;apos; set objFsFolder = objFs.GetFolder(targetfolder)
    &amp;apos; Foldersize = objFsFolder.size
    &amp;apos; If Foldersize &amp;gt; 0 Then 
        &amp;apos; &amp;apos;msgBox(objFsFolder.size)
        &amp;apos; &amp;apos;msgBox(objShellFolderFileItems.count)
    &amp;apos; End If
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellVal = objExcel.Cells(allrowcount,1).Value
            InvVal = objExcel.Cells(allrowcount,3).Value
            validloan = NLSApp.SQLSelectStatement(&amp;quot;Select count(*) from loanacct where loan_number = &amp;apos;&amp;quot; &amp;amp; CellVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
            validclass2 = 1        
            If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1        

                If validloan = 0 Then
                    Invalidloans = Invalidloans + 1
                End if
                &amp;apos;Set failure code - 
                SELECT Case validloan
                    case &amp;quot;1&amp;quot;
                    validrecords = validrecords + 1
                    objExcel.Cells(allrowcount, 4).Value = &amp;quot;OK&amp;quot;
                    
                    case &amp;quot;0&amp;quot;
                    objExcel.Cells(allrowcount, 4).Value = &amp;quot;F1&amp;quot;

                End select

                loanlist(datarows-1) = CellVal &amp;amp; validloan
                redim preserve loanlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        &amp;apos;msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(10) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid Loan Numbers (F1): &amp;quot; &amp;amp; Invalidloans &amp;amp; chr(13)
        &amp;apos;msgline3 = &amp;quot;Invalid Investor Designations (F2): &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid loan records submitted for update: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1,4).Value = &amp;quot;RESULT CODE&amp;quot;
        objExcel.Cells(1,7).Value = &amp;quot;PROCESSING SUMARY &amp;quot; &amp;amp; NOW()
        objExcel.Cells(2,7).Value = msgheader
        &amp;apos;objExcel.Cells(3,7).Value = msgline1
        objExcel.Cells(4,7).Value = msgline2
        &amp;apos;objExcel.Cells(5,7).Value = msgline3
        objExcel.Cells(6,7).Value = msgline4
        
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing if &amp;quot;NO&amp;quot;
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder if there are no errors
        processresult = processupdates (allrowcount,Startrowno,1)
        If processresult = &amp;quot;1&amp;quot; Then
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        Else
            &amp;apos;If there are errors in processing all valid loans
            NLSApp.MessageBox(&amp;quot;There was a problem with Updating the loans below.&amp;quot; &amp;amp; chr(13) &amp;amp; processresult)
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        End if
        
    &amp;apos;Close Excel object and move processed file to completed folder
        objWorkbook.Save 
        objWorkbook.Close
        objExcel.quit

        &amp;apos;set objExcel = nothing
        &amp;apos;set objShell = nothing
        objFs.GetFolder(targetfolder)
        &amp;apos;Set objShellFolderSavFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;,&amp;amp;H0008+&amp;amp;H0020,targetsavfolder)

        &amp;apos;completefolder = CStr(objShellFolderSavFile.Self.path) &amp;amp; &amp;quot;\&amp;quot;
        savefilepath = completefolder &amp;amp; &amp;quot;ExperianImport&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
        objFs.MoveFile strExcelPath,savefilepath
		
        If objFs.FileExists(savefilepath) = True Then
            MsgBox(&amp;quot;Results file saved to:  &amp;quot; &amp;amp; savefilepath)
        Else
            MsgBox(&amp;quot;There was a problem saving Results file to:  &amp;quot; &amp;amp; savedfilepath)
        End If
        
        set objExcel = nothing
        set objShell = nothing

    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function processupdates (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
        LoanNumber = objExcel.Cells(rowno, colno).Value
        score1 = objExcel.Cells(rowno, colno+1).Value
        score2 = objExcel.Cells(rowno, colno+2).Value
        scode = objExcel.Cells(rowno, colno+3).Value
        LoanRefno = NLSapp.SQLSelectStatement(&amp;quot;SELECT convert(varchar,acctrefno)FROM loanacct WHERE loan_number = &amp;apos;&amp;quot; &amp;amp; LoanNumber &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
        If scode = &amp;quot;OK&amp;quot; Then
            If score1 = &amp;quot;&amp;quot; Then
                score1 = &amp;quot;NULL&amp;quot;
            End If	
            If score2 = &amp;quot;&amp;quot; Then
                score2 = &amp;quot;NULL&amp;quot;
            End If
            NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef15 = &amp;quot; &amp;amp; score1 &amp;amp; &amp;quot;, userdef20 = &amp;quot; &amp;amp; score2 &amp;amp; &amp;quot;, userdef24 = convert(char(10),getdate(),101)  where acctrefno = &amp;quot; &amp;amp; LoanRefno)
            &amp;apos; If (Counter Mod 33) = 0 Then
                &amp;apos; NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef24 = &amp;apos;09/01/2018&amp;apos;  where acctrefno = &amp;quot; &amp;amp; LoanRefno)
            &amp;apos; End if
            &amp;apos;Update validation (based on udf24(last update) field
            newdate = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef24 FROM loanacct_detail_2 WHERE acctrefno = &amp;quot; &amp;amp; LoanRefno)
            If Not CDate(newdate) = Date() Then
                notupdated = notupdated &amp;amp; LoanNumber &amp;amp; chr(10)
                objExcel.Cells(rowno, 4).Value = &amp;quot;F2&amp;quot;
                updatefail = updatefail + 1
            End If
            
        End If
        rowno = rowno +1
    Next
    If notupdated = &amp;quot;&amp;quot; Then
        processupdates = &amp;quot;1&amp;quot;
    Else
        objExcel.Cells(5,7).Value = &amp;quot;Update Failures(F2): &amp;quot; &amp;amp; updatefail
        processupdates = notupdated
    End If 
End Function



&quot;/&gt;
&lt;BUTTON Name=&quot;Skip Trace File Import&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Experian Import field 
&amp;apos;on Button click option selection
&amp;apos;For selected file in designated directory, processes list of loans for updates
    
Startrowno = 2
CellcifVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidcifs = 0
&amp;apos;Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
updatefail = 0
noskipno = 0
targetfolder = EXPERIAN_IMPORTS_PENDING_DIR
completefolder = EXPERIAN_SKIP_IMPORTS_COMPLETED_DIR
targetbackupsavfolder = &amp;quot;\\tsclient&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim contactlist(1)

&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile,objShellFolderSavFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;,&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
&amp;apos;Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;, &amp;amp;H0008+&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellcifVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellcifVal = objExcel.Cells(allrowcount,1).Value

            validcif = NLSApp.SQLSelectStatement(&amp;quot;Select cifnumber from cif where cifno = &amp;apos;&amp;quot; &amp;amp; CellcifVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
       
            If (allrowcount &amp;gt; 1) and (not  CellcifVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1        

                If validcif = &amp;quot;&amp;quot; Then
                    objExcel.Cells(allrowcount, 7).Value = &amp;quot;F1&amp;quot;                
                    Invalidcifs = Invalidcifs + 1
                    
                Else
                    validrecords = validrecords + 1
                    objExcel.Cells(allrowcount, 6).Value = validcif
                    objExcel.Cells(allrowcount, 7).Value = &amp;quot;OK&amp;quot;

                End if

                contactlist(datarows-1) =  validcif
                redim preserve contactlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        &amp;apos;msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(10) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid CIF Numbers (F1): &amp;quot; &amp;amp; Invalidcifs &amp;amp; chr(13)
        &amp;apos;msgline3 = &amp;quot;Invalid Investor Designations (F2): &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid CIF records submitted for update: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;

        &amp;apos;rename Columns 1-7
        objExcel.Cells(1,1).Value = &amp;quot;ContactID&amp;quot;
        objExcel.Cells(1,2).Value = &amp;quot;Skip Phone 1&amp;quot;
        objExcel.Cells(1,3).Value = &amp;quot;Skip Phone 2&amp;quot;
        objExcel.Cells(1,4).Value = &amp;quot;Skip Phone 3&amp;quot;
        objExcel.Cells(1,5).Value = &amp;quot;Skip Phone 4&amp;quot;
        objExcel.Cells(1,6).Value = &amp;quot;ContactNumber&amp;quot;
        objExcel.Cells(1,7).Value = &amp;quot;Success Code&amp;quot;
        &amp;apos;resize Columns 1-7
        objExcel.columns(1).columnwidth = 10
        objExcel.columns(2).columnwidth = 11
        objExcel.columns(3).columnwidth = 11
        objExcel.columns(4).columnwidth = 11
        objExcel.columns(5).columnwidth = 11
        objExcel.columns(6).columnwidth = 15
        objExcel.columns(7).columnwidth = 13
		
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1,9).Value = &amp;quot;PROCESSED &amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;, by  &amp;quot; &amp;amp; NLSApp.GetSignedOnID()
        objExcel.Cells(2,9).Value = msgheader
        &amp;apos;objExcel.Cells(3,7).Value = msgline1
        objExcel.Cells(3,9).Value = msgline2
        &amp;apos;objExcel.Cells(5,7).Value = msgline3
        objExcel.Cells(7,9).Value = msgline4
        
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing if &amp;quot;NO&amp;quot;
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder if there are no errors
        processresult = updateskipnos (allrowcount,Startrowno)
        If processresult = &amp;quot;1&amp;quot; Then
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        Else
            &amp;apos;If there are errors in processing all valid loans
            NLSApp.MessageBox(&amp;quot;There was a problem with Updating the loans below.&amp;quot; &amp;amp; chr(13) &amp;amp; processresult)
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        End if
        
    &amp;apos;Close Excel object and move processed file to completed folder
        objWorkbook.Save 
        objWorkbook.Close
        objExcel.quit

        objFs.GetFolder(targetfolder)
        &amp;apos;Set objShellFolderSavFile = objShell.BrowseForFolder(0, &amp;quot;Please select a folder to save the result file.&amp;quot;,&amp;amp;H0008+&amp;amp;H0020,completefolder)
        &amp;apos;savefilepath = CStr(objShellFolderSavFile.Self.path) &amp;amp; &amp;quot;\&amp;quot; &amp;amp; &amp;quot;ExperianImport&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
        savefilepath = completefolder &amp;amp; &amp;quot;ExperianImport&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;	
        objFs.MoveFile strExcelPath,savefilepath
        
        If objFs.FileExists(savefilepath) = True Then
            MsgBox(&amp;quot;Results file saved to:  &amp;quot; &amp;amp; savefilepath)
        Else
            MsgBox(&amp;quot;There was a problem saving Results file to:  &amp;quot; &amp;amp; savedfilepath)
        End If
        
        set objExcel = nothing
        set objShell = nothing

    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function updateskipnos (rowstoproc,rowno)
    For Counter = 1 to rowstoproc
    
        cif_no = objExcel.Cells(rowno, 1).Value
        skip1 = objExcel.Cells(rowno, 2).Value
        skip2 = objExcel.Cells(rowno, 3).Value
        skip3 = objExcel.Cells(rowno, 4).Value
        skip4 = objExcel.Cells(rowno, 5).Value
        loannumb = objExcel.Cells(rowno, 6).Value
        valid = objExcel.Cells(rowno, 7).Value

        If valid = &amp;quot;OK&amp;quot; Then
            If not skip1 = &amp;quot;&amp;quot; Then
                If skip2 = &amp;quot;&amp;quot; Then
                    skip2 = &amp;quot;###NULL###&amp;quot;
                End If
                If  skip3 = &amp;quot;&amp;quot; Then
                    skip3 = &amp;quot;###NULL###&amp;quot;
                End If
                If  skip4 = &amp;quot;&amp;quot; Then
                    skip4 = &amp;quot;###NULL###&amp;quot;
                End If
                
                firstskip = NLSApp.SQLSelectStatement(&amp;quot;select row_id from cif_phone_nums where phone_description like &amp;apos;Skip Phone%&amp;apos; and cifno in (&amp;quot; &amp;amp; cif_no &amp;amp; &amp;quot;)&amp;quot;)
                If NOT firstskip = &amp;quot;&amp;quot; Then
                    xmlOperation = &amp;quot;Operation=&amp;quot;&amp;quot;UPDATE&amp;quot;&amp;quot;&amp;quot;
                Else
                    xmlOperation = &amp;quot;&amp;quot;
                End If

                addskipphonesxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 1&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip1 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 2&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip2 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 3&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip3 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 4&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip4 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFDETAIL CIFDetail12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Date() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

                If Not ImportXML(addskipphonesxml) = &amp;quot;&amp;quot; Then

                    notupdated = notupdated &amp;amp;  loannumb &amp;amp; chr(10)
                    objExcel.Cells(rowno, 4).Value = &amp;quot;F2&amp;quot;
                    updatefail = updatefail + 1
                End If

            Else
                objExcel.Cells(rowno, 7).Value = &amp;quot;F3&amp;quot;
                noskipno = noskipno + 1
            End If
        End If
        rowno = rowno +1
    Next
	
    objExcel.Cells(4,9).Value = &amp;quot;Update Failures(F2): &amp;quot; &amp;amp; updatefail
    objExcel.Cells(5,9).Value = &amp;quot;No Skip Number (F3): &amp;quot; &amp;amp; noskipno	
	
    If notupdated = &amp;quot;&amp;quot; Then
        updateskipnos = &amp;quot;1&amp;quot;
    Else
        updateskipnos = notupdated
    End If

End Function

&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;103&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="68.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="68.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="103"/>
<USERDEFFIELDS field_id="53" field_type="6" field_attribute="0" label_text="Advanced Servicing" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Assign Collection Owners&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Advanced servicing field Assign Collection owners option
&amp;apos;on Button click option selection
&amp;apos;For Looks up users in the Collection Owners group and summarized the current loan allocation in a pop-up.

Collectionowners()

NLSApp.MessageBox(&amp;quot;Allocations Completed!&amp;quot;)

Sub Collectionowners()
    loanlimitcurr = NLSApp.Getfield(&amp;quot;CIF_DETAIL_UDF20&amp;quot;)
    batchlimitcurr = NLSApp.Getfield(&amp;quot;CIF_DETAIL_UDF21&amp;quot;)
    ownerresetsql = &amp;quot;&amp;quot;
    loanlimitrec = &amp;quot;&amp;quot;
    unassignedloans = &amp;quot;&amp;quot;
    nextloan = &amp;quot;&amp;quot;
    reachedlimit = &amp;quot;&amp;quot;
    rowcnt = 0
    newloans = 0
    collectorloans = 0
    Collector = &amp;quot;&amp;quot;
    maxlimitresetmsg = &amp;quot;&amp;quot;
    index1 = 0
    dpdrange = &amp;quot;0 and 600&amp;quot;
    Summaryheader = &amp;quot;Loan Allocation Summary for &amp;quot; &amp;amp; NOW() &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Name&amp;quot; &amp;amp; Chr(9) &amp;amp; Chr(9) &amp;amp; Chr(9) &amp;amp; &amp;quot;New&amp;quot; &amp;amp; Chr(9) &amp;amp; &amp;quot;Total&amp;quot; &amp;amp; chr(13)

    &amp;apos;SQL lookup Strings    
    &amp;apos;Lookup sql to identify &amp;quot;cured&amp;quot; loans update the collection owner to Admin
    ownerresetsql = &amp;quot;Select l.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #ownerresetloans&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, daily_trial_balance dtb&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where  l.acctrefno = dtb.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.days_past_due = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.collection_officer_no not in (0)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and dtb.trial_balance_date &amp;lt;= dateadd(dd, 7,getdate())&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;group by l.loan_number having sum(dtb.days_past_due) = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Update loanacct SET collection_officer_no = 0 where loan_number in (select loan_number from #ownerresetloans)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;drop table #ownerresetloans&amp;quot;
    
    &amp;apos;Lookup sql to identify loans in the call campaign not assigned to a valid collection owner
    Pastdueloanslistsql = &amp;quot;Select distinct  &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;l.loan_number, l.days_past_due,collection_officer_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #loanlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from campaign_list cl, campaign_list_detail cld, loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where cl.campaign_no = cld.campaign_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno = cld.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and cl.campaign_setup_no in (select campaign_setup_no from campaign_setup where campaign_name like &amp;apos;%UNASSIGNED OWNERS%&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and convert(char(8),cl.date_created,1) = convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and collection_officer_no not in (SELECT userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (select count(*) from #loanlist) , * from #loanlist order by collection_officer_no desc, days_past_due&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #loanlist&amp;quot;
        &amp;apos;The 1st column in the results is the total count of un-assigned loans in the active campaign
        &amp;apos;The 2nd column in the results is a loan_number
        &amp;apos;  SAMPLE OUTPUT
        &amp;apos;  unallocated_loans    loan_number    days_past_due
        &amp;apos;  3026    CP0223281    10
        &amp;apos;  3026    APP-01021004    30
        &amp;apos;  3026    APP-01083314    30
        &amp;apos;  3026    APP-01116168    30
        
    &amp;apos;Lookup sql to identify valid collection owners and their current loan allocation
    collectorssql = &amp;quot;SELECT convert(varchar(3),count(acctrefno)) as allocation,convert(varchar(3),count(acctrefno))  + &amp;apos;,0,&amp;apos; + &amp;quot; &amp;amp; _
        &amp;quot;convert(varchar(3),g.userno)+ &amp;apos;,&amp;apos; + username + space(30-len(username)) + &amp;apos;,&amp;apos; + substring(signonid,11,35) as list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #collectorlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from nlsusers u, nlsgroupmembers g&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on l.collection_officer_no = g.userno and status_code_no = 0 &amp;quot;  &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where g.userno = u.userno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and groupno IN ( &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;group by convert(varchar(3),g.userno),username,signonid&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (select count(*) from #collectorlist) as collectors ,(select sum(convert(Int,allocation))  from #collectorlist) as assigned, list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from #collectorlist order by list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #collectorlist &amp;quot;
        &amp;apos;The 1st column in the results is the total count of active collectors in the authorized security group
        &amp;apos;The 2nd column in the results is Total allocated loans         
        &amp;apos;The 3rd column in the results is a string = [count of assigned loans],[new assigned loans (default = 0)],[collector userno],[collector userno]  
        &amp;apos;  SAMPLE OUTPUT
        &amp;apos;  collectors    assigned    list
        &amp;apos;  16    848    41,0,258,Brittany Beaty                
        &amp;apos;  16    848    65,0,106,Eli Foxx                      
        &amp;apos;  16    848    65,0,127,Andrea Messinger              
    
    NLSApp.SQLSelectStatement (ownerresetsql) 
    
    &amp;apos;SET array to hold list of output from collectorssql
    collectors = NLSApp.SQLSelectStatement(collectorssql)
    assignedloans = NLSapp.SQLSelectStatementNextColumn()
       
    redim ownerdetails(collectors-1)
    
    For count = 1 to collectors
            ownerdetails(count-1) = NLSapp.SQLSelectStatementNextColumn()
            nextrow = NLSApp.SQLSelectStatementReadNext()
            nextcol = NLSApp.SQLSelectStatementNextColumn()
    next
    
    &amp;apos;SET array to hold list of output from Pastdueloanslistsql 
    unassignedincampaign = NLSApp.SQLSelectStatement(Pastdueloanslistsql)

    If not unassignedincampaign = &amp;quot;&amp;quot; Then
        If IsNumeric(batchlimitcurr) = True Then
            unassignedloans = batchlimitcurr
        Else
            unassignedloans =  unassignedincampaign
        End if
    
        redim loanlist(unassignedloans-1)
        
        For count = 1 to unassignedloans
                loanlist(count-1) = NLSapp.SQLSelectStatementNextColumn()
                nextrow = NLSApp.SQLSelectStatementReadNext()
    
        next
    Else
        &amp;apos;If SQL produces no output it is most likely due to missing campaign run for current day
        msgbox(&amp;quot;No valid Collection campaign for today.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Please create a new campaign before Processing.&amp;quot;)
        Exit Sub 
    End If
        
     msgbox(&amp;quot;Loan Allocation limit prescribed by maximum value of &amp;quot; &amp;amp; loanlimitcurr &amp;amp; &amp;quot;.&amp;quot;)
    
    If IsNumeric(loanlimitcurr) = False Then
        loanlimitcurr =  Round(unassignedloans/collectors,0)
    End if    


    &amp;apos;Assign collector to loans
    If Assigncollectors2 (collectors,unassignedloans,ownerdetails,loanlimitcurr,0,0,&amp;quot;&amp;quot;,loanlist,unassignedincampaign,Summaryheader) = &amp;quot;&amp;quot; Then	
 	    Personalcampaigns()
	End If 
    

End Sub

Function Assigncollectors2 (collectorcnt,loans,collectordetails,limit,collectorseqno,loanseqno,reachedlimit,loanarray,unassigned,Summarymsg)

    For Each owner In collectordetails
        Collector = Split(owner,&amp;quot;,&amp;quot;)
        collectorloans = Collector(0)
        If not finishall = 1 AND limit - collectorloans &amp;gt; 0 Then
            newloans = limit - collectorloans
        Else
            newloans = 0
        End If 
        collectorno = Collector(2)
        collectorname = Collector(3)
        collectorsignon = Collector(4)
        owner = collectorloans &amp;amp; &amp;quot;,&amp;quot; &amp;amp; newloans &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorno &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorname &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorsignon

        If newloans &amp;gt; 0 Then
            For assignment = 1 to newloans
                &amp;apos;XML IMPUT to update assigned collector
                Addcollxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanarray(loanseqno) &amp;amp; &amp;quot;&amp;quot;&amp;quot; CollectionOfficerNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; collectorno &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
                &amp;apos;SAMPLE XML string
                &amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;CP0123456&amp;quot; CollectionOfficerNumber=&amp;quot;123&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;
                
                ImportXML(Addcollxml)
                loanseqno = loanseqno + 1
                &amp;apos;If the maximum number of loans allowed by the batch limit is reached
                If loanseqno &amp;gt; UBound(loanarray,1) Then
                    finishall = 1
                    newloans = assignment 
                    owner = collectorloans &amp;amp; &amp;quot;,&amp;quot; &amp;amp; newloans &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorno &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorname &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorsignon
                    Exit For
                End if 
            Next
        
        End if       
        Summarymsg = Summarymsg &amp;amp; Collector(3) &amp;amp; Chr(9)  &amp;amp; newloans &amp;amp; Chr(9) &amp;amp; CDbl(newloans) + CDbl(collectorloans) &amp;amp; Chr(13)
        totnew = CDbl(totnew) + CDbl(newloans)
        totalloc = CDbl(totalloc) + CDbl(collectorloans)
        
    Next

    unassinedmsg = &amp;quot;Remaining un-assigned loans in current campaign:  &amp;quot; &amp;amp;  FormatNumber(unassigned - totnew,0,,,-1)
    NLSApp.MessageBox(Summarymsg &amp;amp; Chr(13) &amp;amp; &amp;quot;TOTALS&amp;quot; &amp;amp; space(24) &amp;amp; Chr(9) &amp;amp; totnew &amp;amp; Chr(9) &amp;amp; FormatNumber(totalloc + totnew,0,,,-1)  &amp;amp; Chr(13)  &amp;amp; Chr(13) &amp;amp; unassinedmsg )

    Assigncollectors2 = &amp;quot;&amp;quot;
End Function

Function Personalcampaigns()

    &amp;apos; Add new personal campaigns for group members without active open personal campaigns
    addnewpcampaignssql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;INSERT INTO campaign_list (campaign_setup_no,date_created,status_flag,created_by)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;SELECT 0,getdate(),0,userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; chr(13) &amp;amp; _
    &amp;quot; and userno NOT IN (SELECT userno from nlsgroupmembers g, campaign_list cl&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where cl.created_by = g.userno and cl.campaign_setup_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.status_flag = 0 and g.groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot;

    NLSApp.SQLSelectStatement(addnewpcampaignssql)

	
    &amp;apos;Move newly allocated loans in the Master campaign to the appropriate personal campaign 
    movetopcampaignssql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UPDATE campaign_list_detail SET campaign_no = pcamps.campaign_no, owner_uid = l.collection_officer_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from loanacct l, campaign_list_detail cld, campaign_list cl,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(select campaign_no,created_by from campaign_list &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where campaign_setup_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;--and convert(char(8),date_created,1) = convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and created_by in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;))pcamps&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where l.acctrefno = cld.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cld.campaign_no = cl.campaign_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no = pcamps.created_by&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cld.status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.status_flag not in (1)&amp;quot; &amp;amp;  chr(13) &amp;amp; _
    &amp;quot;and cl.campaign_setup_no in (select campaign_setup_no from campaign_setup where campaign_name like &amp;apos;%UNASSIGNED OWNERS%&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and convert(char(8),cl.date_created,1) = convert(char(8),getdate(),1)&amp;quot;

    NLSApp.SQLSelectStatement(movetopcampaignssql)

    Personalcampaigns = &amp;quot;&amp;quot;
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;View Current Owner Allocations&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Advanced servicing field View Collector Allocations option
&amp;apos;on Button click option selection
&amp;apos;For Looks up users in the Collection Owners group and summarized the current loan allocation in a pop-up.

ViewCollectionowners()


Sub ViewCollectionowners()
    Collector = &amp;quot;&amp;quot;
    &amp;apos;message header
    Summarymsg = &amp;quot;         As of &amp;quot; &amp;amp; NOW() &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Name&amp;quot; &amp;amp; Chr(9) &amp;amp; Chr(9) &amp;amp; Chr(9) &amp;amp; &amp;quot;   &amp;quot; &amp;amp; Chr(9) &amp;amp; &amp;quot;Total&amp;quot; &amp;amp; chr(13)
    
   
    collectorssql = &amp;quot;SELECT convert(varchar(3),count(acctrefno)) as allocation,convert(varchar(3),count(acctrefno))  + &amp;apos;,0,&amp;apos; +  convert(varchar(3),g.userno)+ &amp;apos;,&amp;apos; + username + space(30-len(username)) as list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;,username ,count(acctrefno) as counts&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #collectorlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from nlsusers u, nlsgroupmembers g&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on l.collection_officer_no = g.userno and status_code_no = 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where g.userno = u.userno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and groupno IN ( &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;group by convert(varchar(3),g.userno),username  order by [counts] asc,username&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (select count(*) from #collectorlist) as collectors ,(select sum(convert(Int,allocation))  from #collectorlist) as assigned, list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from #collectorlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #collectorlist &amp;quot;
        &amp;apos;The 1st column in the results is the total count of active collectors in the authorized security group
        &amp;apos;The 2nd column Total assigned loans
        &amp;apos;The 3rd column in the results is a string = [count of assigned loans],placeholdedr,[collector userno],[collector name] 
    
    
    &amp;apos;SET array to hold list of collector details ( usernos and the number of loans already assigned to each
    collectors = NLSApp.SQLSelectStatement(collectorssql)
    assignedloans = NLSapp.SQLSelectStatementNextColumn()
       
    &amp;apos;dim dynamic array to hold sql results
    redim ownerdetails(collectors-1)
    
    For count = 1 to collectors
            ownerdetails(count-1) = NLSapp.SQLSelectStatementNextColumn()
            nextrow = NLSApp.SQLSelectStatementReadNext()
            nextcol = NLSApp.SQLSelectStatementNextColumn()
    next
    
 
    For Each owner In ownerdetails
        Collector = Split(owner,&amp;quot;,&amp;quot;)
        Summarymsg = Summarymsg &amp;amp; Collector(3) &amp;amp; Chr(9) &amp;amp; &amp;quot;   &amp;quot; &amp;amp; Chr(9) &amp;amp;  space(4) &amp;amp; FormatNumber(Collector(0),0,,,-1) &amp;amp; Chr(13)
        totalloc = CDbl(totalloc) + CDbl(Collector(0))
    Next
    totalmsg = Summarymsg &amp;amp; Chr(13) &amp;amp; &amp;quot;TOTALS (&amp;quot; &amp;amp; collectors &amp;amp; &amp;quot;)&amp;quot; &amp;amp; space(24) &amp;amp; Chr(9) &amp;amp; totnew &amp;amp; Chr(9) &amp;amp;  space(2) &amp;amp;  FormatNumber( totalloc,0,,,-1)
    &amp;apos;NLSApp.MessageBox(totalmsg)
    MsgBox totalmsg,vbYesOK+vbInformation,&amp;quot;        Current Owner Allocations&amp;quot;
End Sub &quot;/&gt;
&lt;BUTTON Name=&quot;Total Un-allocated loans&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Advanced servicing field Total Un-allocated loans option
&amp;apos;on Button click option selection
&amp;apos;For Looks up loans win the designated campaigns with no Collection Owners group assigned  yet.

Viewunallocatedloans()

Sub Viewunallocatedloans()
    collectorloanslistsql = &amp;quot;Select distinct  &amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;l.loan_number, l.days_past_due&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;INTO #loanlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;from campaign_list cl, campaign_list_detail cld, loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;where cl.campaign_no = cld.campaign_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;and l.acctrefno = cld.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;and cl.campaign_setup_no = &amp;quot; &amp;amp; COLLECTION_OWNERS_CAMPAIGN_SETUPNO &amp;amp; chr(13) &amp;amp; _
            &amp;quot;and convert(char(8),cl.date_created,1) = convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;and cl.status_flag not in (1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;and collection_officer_no not in (SELECT userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;SELECT count(*)  from #loanlist &amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;Drop table #loanlist&amp;quot;

    unallocatedloans = NLSApp.SQLSelectStatement(collectorloanslistsql)

    If  Not unallocatedloans = 0 Then
        NLSApp.MessageBox(&amp;quot;There are currently &amp;quot; &amp;amp; FormatNumber(unallocatedloans,0,,,-1) &amp;amp; &amp;quot; un-allocated loans available.&amp;quot;) 
    Else
         NLSApp.MessageBox(&amp;quot;There are currently no un-allocated loans associated to an active allocation campaign.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Please verify that at least one(1) allocation campaign has run for today and try again.&amp;quot;)
    End if

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;***TESTING ONLY***&quot; Script=&quot;&quot;/&gt;
&lt;BUTTON Name=&quot;***Personal camp&quot; Script=&quot;Personalcampaigns()

Sub Personalcampaigns()
    &amp;apos;Close old campaigns. Leave open any campaigns created today
    &amp;apos; closeoldpcampaignssql = &amp;quot;SELECT 0; UPDATE campaign_list SET status_flag = 1&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;apos; &amp;quot;where campaign_setup_no = 0 and status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;apos; &amp;quot;and convert(char(8),date_created,1) &amp;lt; convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;apos; &amp;quot;and created_by in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _

    &amp;apos; NLSApp.SQLSelectStatement(closeoldpcampaignssql)

    &amp;apos; Add new personal campaigns for group members without active open personal campaigns
    addnewpcampaignssql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;INSERT INTO campaign_list (campaign_setup_no,date_created,status_flag,created_by)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;SELECT 0,getdate(),0,userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; chr(13) &amp;amp; _
    &amp;quot; and userno NOT IN (SELECT userno from nlsgroupmembers g, campaign_list cl&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where cl.created_by = g.userno and cl.campaign_setup_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.status_flag = 0 and g.groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot;



    NLSApp.SQLSelectStatement(addnewpcampaignssql)

    &amp;apos;Move newly allocated loans in the Master campaign to the appropriate personal campaign 
    movetopcampaignssql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UPDATE campaign_list_detail SET campaign_no = pcamps.campaign_no, owner_uid = l.collection_officer_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from loanacct l, campaign_list_detail cld, campaign_list cl,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(select campaign_no,created_by from campaign_list &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where campaign_setup_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;--and convert(char(8),date_created,1) = convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and created_by in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;))pcamps&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where l.acctrefno = cld.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cld.campaign_no = cl.campaign_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no = pcamps.created_by&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cld.status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.status_flag not in (1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.campaign_setup_no = 55&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and convert(char(8),cl.date_created,1) = convert(char(8),getdate(),1)&amp;quot;



    NLSApp.SQLSelectStatement(movetopcampaignssql)

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;***Reset All Allocations&quot; Script=&quot;

temp1 = &amp;quot;select 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct  SET collection_officer_no = 0 where collection_officer_no not in (0)&amp;quot;  &amp;amp; chr(13) &amp;amp; _
&amp;quot;DELETE from campaign_list_detail where owner_uid in (select userno from nlsgroupmembers where groupno = 23) and status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;Update campaign_list SET status_flag = 1 where campaign_setup_no = 0 and created_by in (select userno from nlsgroupmembers where groupno = 23) and status_flag = 0&amp;quot;

 NLSApp.SQLSelectStatement(temp1)

&quot;/&gt;
&lt;BUTTON Name=&quot;***Assign Collection Owners&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Advanced servicing field Assign Collection owners option
&amp;apos;on Button click option selection
&amp;apos;For Looks up users in the Collection Owners group and summarized the current loan allocation in a pop-up.

Collectionowners()
Personalcampaigns()
NLSApp.MessageBox(&amp;quot;Allocations Completed!&amp;quot;)

Sub Collectionowners()
    loanlimitcurr = NLSApp.Getfield(&amp;quot;CIF_DETAIL_UDF20&amp;quot;)
    batchlimitcurr = NLSApp.Getfield(&amp;quot;CIF_DETAIL_UDF21&amp;quot;)
    ownerresetsql = &amp;quot;&amp;quot;
    loanlimitrec = &amp;quot;&amp;quot;
    unassignedloans = &amp;quot;&amp;quot;
    nextloan = &amp;quot;&amp;quot;
    reachedlimit = &amp;quot;&amp;quot;
    rowcnt = 0
    newloans = 0
    collectorloans = 0
    Collector = &amp;quot;&amp;quot;
    maxlimitresetmsg = &amp;quot;&amp;quot;
    index1 = 0
    dpdrange = &amp;quot;0 and 600&amp;quot;
    Summarymsg = &amp;quot;Loan Allocation Summary for &amp;quot; &amp;amp; NOW() &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Name&amp;quot; &amp;amp; Chr(9) &amp;amp; Chr(9) &amp;amp; Chr(9) &amp;amp; &amp;quot;New&amp;quot; &amp;amp; Chr(9) &amp;amp; &amp;quot;Total&amp;quot; &amp;amp; chr(13)

    &amp;apos;SQL lookup Strings    
    &amp;apos;Lookup sql to identify &amp;quot;cured&amp;quot; loans update the collection owner to Admin
    ownerresetsql = &amp;quot;Select l.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #ownerresetloans&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, daily_trial_balance dtb&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where  l.acctrefno = dtb.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.days_past_due = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.collection_officer_no not in (0)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and dtb.trial_balance_date &amp;lt;= dateadd(dd, 7,getdate())&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;group by l.loan_number having sum(dtb.days_past_due) = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Update loanacct SET collection_officer_no = 0 where loan_number in (select loan_number from #ownerresetloans)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;drop table #ownerresetloans&amp;quot;
    
    &amp;apos;Lookup sql to identify loans in the call campaign not assigned to a valid collection owner
    Pastdueloanslistsql = &amp;quot;Select distinct  &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;l.loan_number, l.days_past_due,collection_officer_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #loanlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from campaign_list cl, campaign_list_detail cld, loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where cl.campaign_no = cld.campaign_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno = cld.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and cl.campaign_setup_no in (select campaign_setup_no from campaign_setup where campaign_name like &amp;apos;%*UN-ASSIGNED OWNERS&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and convert(char(8),cl.date_created,1) = convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and collection_officer_no not in (SELECT userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (select count(*) from #loanlist) , * from #loanlist order by collection_officer_no desc, days_past_due&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #loanlist&amp;quot;
        &amp;apos;The 1st column in the results is the total count of un-assigned loans in the active campaign
        &amp;apos;The 2nd column in the results is a loan_number
        &amp;apos;  SAMPLE OUTPUT
        &amp;apos;  unallocated_loans	loan_number	days_past_due
        &amp;apos;  3026	CP0223281	10
        &amp;apos;  3026	APP-01021004	30
        &amp;apos;  3026	APP-01083314	30
        &amp;apos;  3026	APP-01116168	30
		
    &amp;apos;Lookup sql to identify valid collection owners and their current loan allocation
    collectorssql = &amp;quot;SELECT convert(varchar(3),count(acctrefno)) as allocation,convert(varchar(3),count(acctrefno))  + &amp;apos;,0,&amp;apos; + &amp;quot; &amp;amp; _
        &amp;quot;convert(varchar(3),g.userno)+ &amp;apos;,&amp;apos; + username + space(30-len(username)) + &amp;apos;,&amp;apos; + substring(signonid,11,35) as list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #collectorlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from nlsusers u, nlsgroupmembers g&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on l.collection_officer_no = g.userno and status_code_no = 0 &amp;quot;  &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where g.userno = u.userno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and groupno IN ( &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;group by convert(varchar(3),g.userno),username,signonid&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (select count(*) from #collectorlist) as collectors ,(select sum(convert(Int,allocation))  from #collectorlist) as assigned, list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from #collectorlist order by list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #collectorlist &amp;quot;
        &amp;apos;The 1st column in the results is the total count of active collectors in the authorized security group
        &amp;apos;The 2nd column in the results is Total allocated loans 		
        &amp;apos;The 3rd column in the results is a string = [count of assigned loans],[new assigned loans (default = 0)],[collector userno],[collector userno]  
        &amp;apos;  SAMPLE OUTPUT
        &amp;apos;  collectors	assigned	list
        &amp;apos;  16	848	41,0,258,Brittany Beaty                
        &amp;apos;  16	848	65,0,106,Eli Foxx                      
        &amp;apos;  16	848	65,0,127,Andrea Messinger              
	
    NLSApp.SQLSelectStatement (ownerresetsql) 
    
    &amp;apos;SET array to hold list of output from collectorssql
    collectors = NLSApp.SQLSelectStatement(collectorssql)
    assignedloans = NLSapp.SQLSelectStatementNextColumn()
       
    redim ownerdetails(collectors-1)
    
    For count = 1 to collectors
            ownerdetails(count-1) = NLSapp.SQLSelectStatementNextColumn()
            nextrow = NLSApp.SQLSelectStatementReadNext()
            nextcol = NLSApp.SQLSelectStatementNextColumn()
    next
    
    &amp;apos;SET array to hold list of output from Pastdueloanslistsql 
    unassignedincampaign = NLSApp.SQLSelectStatement(Pastdueloanslistsql)

    If not unassignedincampaign = &amp;quot;&amp;quot; Then
        If IsNumeric(batchlimitcurr) = True Then
            unassignedloans = batchlimitcurr
        Else
            unassignedloans =  unassignedincampaign
        End if
    
        redim loanlist(unassignedloans-1)
        
        For count = 1 to unassignedloans
                loanlist(count-1) = NLSapp.SQLSelectStatementNextColumn()
                nextrow = NLSApp.SQLSelectStatementReadNext()
    
        next
    Else
        &amp;apos;If SQL produces no output it is most likely due to missing campaign run for current day
        msgbox(&amp;quot;No valid Collection campaign for today.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Please create a new campaign before Processing.&amp;quot;)
        Exit Sub 
    End If
        
     msgbox(&amp;quot;Loan Allocation limit prescribed by maximum value of &amp;quot; &amp;amp; loanlimitcurr &amp;amp; &amp;quot;.&amp;quot;)
	
    If IsNumeric(loanlimitcurr) = False Then
        loanlimitcurr = &amp;quot;999999&amp;quot;
    End if	


    &amp;apos;Assign collector to loans
    For loanseqno = 0 to unassignedloans-1
        &amp;apos;parse array for collector details    
        Collector = Split(ownerdetails(collectorseqno),&amp;quot;,&amp;quot;)
        collectorloans = Collector(0)
        newloans = Collector(1)
        collectorno = Collector(2)
        collectorname = Collector(3)
        collectorsignon = Collector(4)
        
        If CDbl(collectorloans) &amp;lt;= CDbl(loanlimitcurr) - 1 Then
            &amp;apos;If collector assigned loans is below loan limit, assign loan to collector via xml import
            nextloan = loanlist(loanseqno)
            &amp;apos;XML IMPUT to update assigned collector
            Addcollxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; nextloan &amp;amp; &amp;quot;&amp;quot;&amp;quot; CollectionOfficerNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; collectorno &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
            &amp;apos;SAMPLE XML string
            &amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;CP0123456&amp;quot; CollectionOfficerNumber=&amp;quot;123&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;
            
            If ImportXML(Addcollxml) = &amp;quot;&amp;quot; Then
                &amp;apos;If import successful update collector details to include newly assigned loan
                collectorloans = collectorloans + 1
                newloans = newloans + 1
                ownerdetails(collectorseqno) = collectorloans &amp;amp; &amp;quot;,&amp;quot; &amp;amp; newloans &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorno &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorname
            End If
        Else 
            &amp;apos;If collector has reached loan limit, go back 1 seqno to save current seqno for next collector 
            loanseqno = loanseqno - 1
            &amp;apos;And add collector signon to list that have reached the allocation limit
            If InStr(reachedlimit,collectorsignon) = 0 Then
                reachedlimit = reachedlimit &amp;amp; &amp;quot;,&amp;quot; &amp;amp; collectorsignon
&amp;apos;msgbox(&amp;quot;reached limit:&amp;quot; &amp;amp; reachedlimit &amp;amp; chr(13) &amp;amp; &amp;quot;Current user:&amp;quot; &amp;amp; collectorname &amp;amp; chr(13) &amp;amp; collectorloans &amp;amp; &amp;quot;/&amp;quot; &amp;amp; newloans)
            End If
        End if

        &amp;apos;If current collector is last in the collector list start over, else go to next collector
        If CDbl(collectorseqno + 1) = CDbl(collectors) Then
            collectorseqno = 0
        Else
            collectorseqno = collectorseqno + 1
        End If
	
        &amp;apos;If all collectors have reached the loan limit stop assigning loans
     msgbox(&amp;quot;reached limit cnt: &amp;quot; &amp;amp;  CDbl(Ubound(Split(reachedlimit,&amp;quot;,&amp;quot;)))+1 &amp;amp; &amp;quot; collectors: &amp;quot; &amp;amp; collectors &amp;amp; chr(13) &amp;amp; reachedlimit)
        If CDbl(Ubound(Split(reachedlimit,&amp;quot;,&amp;quot;))) = CDbl(collectors) Then
            Exit For
        End If
    Next
	
    &amp;apos;Build and display summary message
    For Each owner In ownerdetails
        Collector = Split(owner,&amp;quot;,&amp;quot;)
        Summarymsg = Summarymsg &amp;amp; Collector(3) &amp;amp; Chr(9)  &amp;amp; Collector(1) &amp;amp; Chr(9) &amp;amp; Collector(0) &amp;amp; Chr(13)
        totnew = CDbl(totnew) + CDbl(Collector(1))
        totalloc = CDbl(totalloc) + CDbl(Collector(0))
        unassinedmsg = &amp;quot;Remaining un-assigned loans in current campaign:  &amp;quot; &amp;amp;  FormatNumber(unassignedincampaign - totnew,0,,,-1)
    Next
    
    NLSApp.MessageBox(Summarymsg &amp;amp; Chr(13) &amp;amp; &amp;quot;TOTALS&amp;quot; &amp;amp; space(24) &amp;amp; Chr(9) &amp;amp; totnew &amp;amp; Chr(9) &amp;amp; FormatNumber(totalloc,0,,,-1)  &amp;amp; Chr(13)  &amp;amp; Chr(13) &amp;amp; unassinedmsg )
End Sub

Sub Personalcampaigns()
    &amp;apos;Close old campaigns. Leave open any campaigns created today
    &amp;apos; closeoldpcampaignssql = &amp;quot;SELECT 0; UPDATE campaign_list SET status_flag = 1&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;apos; &amp;quot;where campaign_setup_no = 0 and status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;apos; &amp;quot;and convert(char(8),date_created,1) &amp;lt; convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;apos; &amp;quot;and created_by in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _

    &amp;apos; NLSApp.SQLSelectStatement(closeoldpcampaignssql)

    &amp;apos; Add new personal campaigns for group members without active open personal campaigns
    addnewpcampaignssql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;INSERT INTO campaign_list (campaign_setup_no,date_created,status_flag,created_by)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;SELECT 0,getdate(),0,userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; chr(13) &amp;amp; _
    &amp;quot; and userno NOT IN (SELECT userno from nlsgroupmembers g, campaign_list cl&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where cl.created_by = g.userno and cl.campaign_setup_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.status_flag = 0 and g.groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot;



    NLSApp.SQLSelectStatement(addnewpcampaignssql)

    &amp;apos;Move newly allocated loans in the Master campaign to the appropriate personal campaign 
    movetopcampaignssql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UPDATE campaign_list_detail SET campaign_no = pcamps.campaign_no, owner_uid = l.collection_officer_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from loanacct l, campaign_list_detail cld, campaign_list cl,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(select campaign_no,created_by from campaign_list &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where campaign_setup_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;--and convert(char(8),date_created,1) = convert(char(8),getdate(),1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and created_by in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;))pcamps&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where l.acctrefno = cld.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cld.campaign_no = cl.campaign_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no = pcamps.created_by&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no in (select userno from nlsgroupmembers where groupno = &amp;quot; &amp;amp; SECURITY_GROUP_COLLECTION_OWNERS &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cld.status_flag = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and cl.status_flag not in (1)&amp;quot; &amp;amp;  chr(13) &amp;amp; _
    &amp;quot;and cl.campaign_setup_no = 55&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and convert(char(8),cl.date_created,1) = convert(char(8),getdate(),1)&amp;quot;



    NLSApp.SQLSelectStatement(movetopcampaignssql)

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;***Reset Cure and CnD&quot; Script=&quot;    ownerresetsql = &amp;quot;Select l.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;INTO #ownerresetloans&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, daily_trial_balance dtb&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where  l.acctrefno = dtb.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.days_past_due = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.collection_officer_no not in (0)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and dtb.trial_balance_date &amp;gt;= dateadd(dd, -3,getdate())&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;group by l.acctrefno having sum(dtb.eff_days_past_due) = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;UNION&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Select l.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, loanacct_statuses ls&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where  l.acctrefno = ls.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and ls.status_code_no = &amp;quot; &amp;amp; LOAN_STATUS_CEASE_AND_DESIST_ACTIVE &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Update loanacct SET collection_officer_no = 0 where acctrefno in (select acctrefno from #ownerresetloans)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Update campaign_list_detail SET status_flag = 1 where status_flag = 0 and acctrefno in (select acctrefno from #ownerresetloans)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;drop table #ownerresetloans&amp;quot;

    NLSApp.SQLSelectStatement (ownerresetsql)&quot;/&gt;
&lt;BUTTON Name=&quot;***Reset Cured loans&quot; Script=&quot;unassigncured()

Function unassigncured()
    &amp;apos;SQL to identify and build xml rows for cured or invalid status loans with assigned collectors
    ownerresetsql = &amp;quot;Select l.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;INTO #unassign                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from loanacct l                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where  l.days_past_due &amp;lt;= 10          &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.collection_officer_no not in (0)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.status_code_no = 0              &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Select  distinct  l.loan_number &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from loanacct l, loanacct_detail d1, loanacct_detail_2 d2&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;where l.acctrefno = d1.acctrefno    &amp;quot; &amp;amp; chr(13) &amp;amp; _  
    &amp;quot;and l.acctrefno = d2.acctrefno    &amp;quot; &amp;amp; chr(13) &amp;amp; _       
    &amp;quot;and l.collection_officer_no not in (0) &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and l.status_code_no = 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and (d1.userdef22 IN (&amp;apos;BK-CONFIRMED&amp;apos;, &amp;apos;FRAUD CONFIRMED&amp;apos;, &amp;apos;DECEASED BORROWER&amp;apos;, &amp;apos;DECEASED CO-BORROWER&amp;apos;,&amp;apos;FRAUD/DISPUTE REPORTED&amp;apos;, &amp;apos;FRAUD REPORTED&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;or d2.userdef18 = 1)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;SELECT (select count(*) from #unassign) ,&amp;apos;&amp;lt;LOAN UpdateFlag=&amp;apos;&amp;apos;1&amp;apos;&amp;apos; LoanNumber=&amp;apos;&amp;apos;&amp;apos;+loan_number+&amp;apos;&amp;apos;&amp;apos; CollectionOfficerNumber=&amp;apos;&amp;apos;0&amp;apos;&amp;apos;/&amp;gt;&amp;apos; From #unassign &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Drop table #unassign&amp;quot;

    &amp;apos;Build xml list of output from ownerresetsql
    resets = NLSApp.SQLSelectStatement(ownerresetsql)
    If resets &amp;gt; 0 Then
        resetxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(10) 
        For count = 1 to resets
            resetxml = resetxml &amp;amp; NLSapp.SQLSelectStatementNextColumn() &amp;amp; chr(10)
            nextrow = NLSApp.SQLSelectStatementReadNext()
        next
        resetxml = resetxml &amp;amp; &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
        NLSApp.MessageBox(resetxml)
        ImportXML(resetxml)
    End If
    unassigncured = &amp;quot;&amp;quot;
End Function

	
msgbox(&amp;quot;Done.&amp;quot;)&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;105&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="46.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="46.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="105"/>
<USERDEFFIELDS field_id="52" field_type="6" field_attribute="0" label_text="Loan Servicing" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Welcome Call Emails&quot; Script=&quot;If Weekday(NOW()) &amp;lt; 6 Then
     FPAutoemailWC()
Else 
    NLSApp.MessageBox(&amp;quot;Welcome Call Email Processing only allowed Mon - Thu.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Canceling.&amp;quot;)
End if

Sub FPAutoemailWC()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automate the Welcome Call request FFLS-86, 87, 88 https://billsdev.atlassian.net/browse/FFLS-86, https://billsdev.atlassian.net/browse/FFLS-87, https://billsdev.atlassian.net/browse/FFLS-88
    &amp;apos;Updated via FFLS-265 https://billsdev.atlassian.net/browse/FFLS-265
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    sqlpart2 = &amp;quot;FROM cif_detail cd, cif c Where c.cifno = cd.cifno and c.cifnumber = &amp;apos;SUB WC EMAIL AUTO()&amp;apos;&amp;quot;
    emailfromaddr = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef01 &amp;quot; &amp;amp; sqlpart2)
    serverName = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef02 &amp;quot; &amp;amp; sqlpart2)
    wcloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef18 &amp;quot; &amp;amp; sqlpart2)
    attempt1message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef03  &amp;quot; &amp;amp; sqlpart2)
    attempt2message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef04  &amp;quot; &amp;amp; sqlpart2)
    attempt3message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef05  &amp;quot; &amp;amp; sqlpart2)
    loanstoprocesssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef35  &amp;quot; &amp;amp; sqlpart2)
    loanstoprocess = NLSapp.SQLSelectStatement(loanstoprocesssql)
    loannumb = NLSapp.SQLSelectStatement(wcloanssql)

    processmsg1 = &amp;quot;There are &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans to process at this time.&amp;quot; 
    processmsg2 = &amp;quot;Do you want to process all &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans?&amp;quot;

    &amp;apos;-------Proccessing payload warning-------------------
    &amp;apos;If there are no loans to process, cancel
    &amp;apos;If user selectes to process all available loans, skip user input and got to processing
    &amp;apos;If user selects to process a specific # of loans, Loop input until user selects Cancel
    &amp;apos;    OR entry is a number between 0 and the # of loans available to process
    
    If CDbl(loanstoprocess) &amp;gt;= 1 Then
            If MsgBox(processmsg1 &amp;amp; chr(13) &amp;amp; processmsg2, 4, &amp;quot;WARNING!  Processing payload.&amp;quot;) = 7 Then
                validcnt = 0
                Do
                    processmax = InputBox(invalidText &amp;amp; &amp;quot;Please  Enter the number of loans to Process.&amp;quot;  &amp;amp; chr(13) &amp;amp; &amp;quot;Click Cancel to quit.&amp;quot; , &amp;quot;Set Processing size.&amp;quot;, loanstoprocess)
                    invalidText = &amp;quot;Invalid quantity/value entered.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Entry must be a number between 0 and &amp;quot; &amp;amp; loanstoprocess &amp;amp; chr(13) &amp;amp; chr(13)
	                If processmax &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
                        If isnumeric(processmax) = True Then
                            If CDbl(processmax) &amp;gt; 0 And CDbl(processmax) &amp;lt;= CDbl(loanstoprocess) Then
                                loanstoprocess = processmax
                                validcnt = 1
                            End If
                        End If
                    Else
                         NLSApp.MessageBox(&amp;quot;Canceling Welcome Call processing.&amp;quot;)
                         Exit sub
                    End if
                Loop Until validcnt = 1
            End If
            NLSApp.MessageBox(loanstoprocess &amp;amp; &amp;quot; loans will be processed.&amp;quot;)
    Else
       NLSApp.MessageBox(&amp;quot;There are no loans to process.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Canceling Welcome Call Email processing.&amp;quot;)
    End If
 

     &amp;apos;-------Begin welcome call Proccessing.
     Lcount = 0    
    
     &amp;apos;Repeat process for each loan based on quantity previously selected
     Do Until CDbl(Lcount) = CDbl(loanstoprocess)

         emailtoaddr = NLSApp.SQLSelectStatementNextColumn()
         borrowername = NLSApp.SQLSelectStatementNextColumn()
         Riskcode = NLSApp.SQLSelectStatementNextColumn()
         attemptno = NLSApp.SQLSelectStatementNextColumn()
         emailfromaddr = &amp;quot;customersupport@freedomplus.com&amp;quot;
         serverName = &amp;quot;Servicing FPlus&amp;quot; 
         
         If attemptno = &amp;quot;EMAIL - ATTEMPT 1&amp;quot; Then
             attemptmessage = attempt1message
         End If

         If attemptno = &amp;quot;EMAIL - ATTEMPT 2&amp;quot; Then
             attemptmessage = attempt2message
         End If

         If attemptno = &amp;quot;EMAIL - ATTEMPT 3&amp;quot; Then
             attemptmessage = attempt3message
         End If

         emailbody = &amp;quot;Dear &amp;quot; &amp;amp; borrowername &amp;amp; &amp;quot;,&amp;quot; &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; attemptmessage
         
        &amp;apos;----Send email    
             
        &amp;apos;?????? UnComment next 3rows for testing email sending. Add comments for go-live??????
        &amp;apos;emailtoaddr = &amp;quot;stanley.muhammad@gmail.com&amp;quot;
        &amp;apos;emailfromaddr = &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;
        &amp;apos;serverName = &amp;quot;Loan Servicing3&amp;quot;
        &amp;apos;************************************************************************************
        
        NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody
       &amp;apos; NLSApp.SendEmailMessage serverName, &amp;quot;stanley.muhammad@gmail.com&amp;quot;, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody       
         
        &amp;apos;----Xml import
        &amp;apos;Updates 2 fields in the Loan Detail tab and savesa a comment that represents the text of the email sent

        emailxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANCOMMENTS Date=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot; Category=&amp;quot;&amp;quot;SERVICING NOTES&amp;quot;&amp;quot; CommentDescription=&amp;quot;&amp;quot;WC Activity&amp;quot;&amp;quot; &amp;quot; &amp;amp; _
        &amp;quot;Comment=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; CHR(13) &amp;amp; &amp;quot;SENT TO: &amp;quot; &amp;amp; emailtoaddr &amp;amp; CHR(13) &amp;amp; emailbody &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot; 
        
        ImportXML(emailxml)
        
        &amp;apos;---XML example---- 
        &amp;apos;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
        &amp;apos;&amp;lt;NLS EnforceTagExistence=&amp;quot;1&amp;quot;&amp;gt;
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-001234567&amp;quot;&amp;gt;
        &amp;apos;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;EMAIL - ATTEMPT 3&amp;quot; UserDefined12=&amp;quot;06/21/2017&amp;quot;/&amp;gt;
        &amp;apos;   &amp;lt;LOANCOMMENTS Date=&amp;quot;06/21/2017&amp;quot; Category=&amp;quot;SERVICING NOTES&amp;quot; CommentDescription=&amp;quot;WC Activity&amp;quot;
        &amp;apos;Comment=&amp;quot;EMAIL - ATTEMPT 1
        &amp;apos;SENT TO: nlscontact@ffn.com
        &amp;apos;Dear Brian Smith##,
        &amp;apos;
        &amp;apos;Welcome to FreedomPlus and congratulations on your loan. We would like the opportunity to 
        &amp;apos;speak with you so that we can confirm the details of your newly funded loan and ensure you 
        &amp;apos;have the correct contact information for Customer Service. Please contact us via telephone 
        &amp;apos;at (800) 297-5879 Monday - Friday 7AM - 5PM MST to complete this call. Customer Service can 
        &amp;apos;also be reached via email at customersupport@freedomplus.com, should you have any questions 
        &amp;apos;along the way.
        &amp;apos;
        &amp;apos;Thank you for choosing FreedomPlus. We appreciate your business.
        &amp;apos;
        &amp;apos;Sincerely,
        &amp;apos;
        &amp;apos;FreedomPlus Customer Service&amp;quot;/&amp;gt;
        &amp;apos;  &amp;lt;/LOAN&amp;gt;
        &amp;apos;&amp;lt;/NLS&amp;gt;

         loannumb = NLSApp.SQLSelectStatementReadNext()

         Lcount = Lcount + 1

     Loop
     NLSApp.MessageBox(&amp;quot;Welcome Call Email Processing Completed.&amp;quot;)
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;Experian Skip Import&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Experian Import field 
&amp;apos;on Button click option selection
&amp;apos;For selected file in designated directory, processes list of loans for updates
    
Startrowno = 2
CellcifVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidcifs = 0
&amp;apos;Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
updatefail = 0
noskipno = 0
targetfolder = EXPERIAN_IMPORTS_PENDING_DIR
completefolder = EXPERIAN_SKIP_IMPORTS_COMPLETED_DIR
targetbackupsavfolder = &amp;quot;\\tsclient&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim contactlist(1)

&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile,objShellFolderSavFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;,&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
&amp;apos;Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;, &amp;amp;H0008+&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellcifVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellcifVal = objExcel.Cells(allrowcount,1).Value

            validcif = NLSApp.SQLSelectStatement(&amp;quot;Select cifnumber from cif where cifno = &amp;apos;&amp;quot; &amp;amp; CellcifVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
       
            If (allrowcount &amp;gt; 1) and (not  CellcifVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1        

                If validcif = &amp;quot;&amp;quot; Then
                    objExcel.Cells(allrowcount, 7).Value = &amp;quot;F1&amp;quot;                
                    Invalidcifs = Invalidcifs + 1
                    
                Else
                    validrecords = validrecords + 1
                    objExcel.Cells(allrowcount, 6).Value = validcif
                    objExcel.Cells(allrowcount, 7).Value = &amp;quot;OK&amp;quot;

                End if

                contactlist(datarows-1) =  validcif
                redim preserve contactlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        &amp;apos;msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(10) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid CIF Numbers (F1): &amp;quot; &amp;amp; Invalidcifs &amp;amp; chr(13)
        &amp;apos;msgline3 = &amp;quot;Invalid Investor Designations (F2): &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid CIF records submitted for update: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1,7).Value = &amp;quot;PROCESSING SUMARY &amp;quot; &amp;amp; NOW()
        objExcel.Cells(2,7).Value = msgheader
        &amp;apos;objExcel.Cells(3,7).Value = msgline1
        objExcel.Cells(4,7).Value = msgline2
        &amp;apos;objExcel.Cells(5,7).Value = msgline3
        objExcel.Cells(6,7).Value = msgline4
        
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing if &amp;quot;NO&amp;quot;
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder if there are no errors
        processresult = processupdates (allrowcount,Startrowno,6)
        If processresult = &amp;quot;1&amp;quot; Then
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        Else
            &amp;apos;If there are errors in processing all valid loans
            NLSApp.MessageBox(&amp;quot;There was a problem with Updating the loans below.&amp;quot; &amp;amp; chr(13) &amp;amp; processresult)
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        End if
        
    &amp;apos;Close Excel object and move processed file to completed folder
        objWorkbook.Save 
        objWorkbook.Close
        objExcel.quit

        objFs.GetFolder(targetfolder)
        Set objShellFolderSavFile = objShell.BrowseForFolder(0, &amp;quot;Please select a folder to save the result file.&amp;quot;,&amp;amp;H0008+&amp;amp;H0020,completefolder)
        savefilepath = CStr(objShellFolderSavFile.Self.path) &amp;amp; &amp;quot;\&amp;quot; &amp;amp; &amp;quot;ExperianImport&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
        objFs.MoveFile strExcelPath,savefilepath
        
        If objFs.FileExists(savefilepath) = True Then
            MsgBox(&amp;quot;Results file saved to:  &amp;quot; &amp;amp; savefilepath)
        Else
            MsgBox(&amp;quot;There was a problem saving Results file to:  &amp;quot; &amp;amp; savedfilepath)
        End If
        
        set objExcel = nothing
        set objShell = nothing

    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function processupdates (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
    
        loannumb = objExcel.Cells(rowno, colno).Value
        cif_no = objExcel.Cells(rowno, colno-5).Value
        skip1 = objExcel.Cells(rowno, colno-4).Value
        skip2 = objExcel.Cells(rowno, colno-3).Value
        skip3 = objExcel.Cells(rowno, colno-2).Value
        skip4 = objExcel.Cells(rowno, colno-1).Value
        valid = objExcel.Cells(rowno, colno+1).Value
        If valid = &amp;quot;OK&amp;quot; Then
            If not skip1 = &amp;quot;&amp;quot; Then
                If skip2 = &amp;quot;&amp;quot; Then
                    skip2 = &amp;quot;###NULL###&amp;quot;
                End If
                If  skip3 = &amp;quot;&amp;quot; Then
                    skip3 = &amp;quot;###NULL###&amp;quot;
                End If
                If  skip4 = &amp;quot;&amp;quot; Then
                    skip4 = &amp;quot;###NULL###&amp;quot;
                End If
                
                firstskip = NLSApp.SQLSelectStatement(&amp;quot;select row_id from cif_phone_nums where phone_description like &amp;apos;Skip Phone%&amp;apos; and cifno in (&amp;quot; &amp;amp; cif_no &amp;amp; &amp;quot;)&amp;quot;)
                If NOT firstskip = &amp;quot;&amp;quot; Then
                    xmlOperation = &amp;quot;Operation=&amp;quot;&amp;quot;UPDATE&amp;quot;&amp;quot;&amp;quot;
                Else
                    xmlOperation = &amp;quot;&amp;quot;
                End If

                addskipphonesxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 1&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip1 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 2&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip2 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 3&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip3 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 4&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip4 &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

                If Not ImportXML(addskipphonesxml) = &amp;quot;&amp;quot; Then

                    notupdated = notupdated &amp;amp;  loannumb &amp;amp; chr(10)
                    objExcel.Cells(rowno, 4).Value = &amp;quot;F2&amp;quot;
                    updatefail = updatefail + 1
                End If

            Else
                objExcel.Cells(rowno, 4).Value = &amp;quot;F3&amp;quot;
                noskipno = noskipno + 1
            End If
        End If
        rowno = rowno +1
    Next
    If notupdated = &amp;quot;&amp;quot; Then
        processupdates = &amp;quot;1&amp;quot;
    Else
        objExcel.Cells(5,7).Value = &amp;quot;Update Failures(F2): &amp;quot; &amp;amp; updatefail
        processupdates = notupdated
    End If 
End Function

&quot;/&gt;
&lt;BUTTON Name=&quot;Experian Score Import&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Experian Import field 
&amp;apos;on Button click option selection
&amp;apos;For selected file in designated directory, processes list of loans for updates
    
Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidloans = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = EXPERIAN_IMPORTS_PENDING_DIR
completefolder = EXPERIAN_SCORE_IMPORTS_COMPLETED_DIR
targetbackupsavfolder = &amp;quot;\\tsclient&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim loanlist(1)

&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile,objShellFolderSavFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;, &amp;amp;H0008+&amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    &amp;apos; set objFsFolder = objFs.GetFolder(targetfolder)
    &amp;apos; Foldersize = objFsFolder.size
    &amp;apos; If Foldersize &amp;gt; 0 Then 
        &amp;apos; &amp;apos;msgBox(objFsFolder.size)
        &amp;apos; &amp;apos;msgBox(objShellFolderFileItems.count)
    &amp;apos; End If
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellVal = objExcel.Cells(allrowcount,1).Value
            InvVal = objExcel.Cells(allrowcount,3).Value
            validloan = NLSApp.SQLSelectStatement(&amp;quot;Select count(*) from loanacct where loan_number = &amp;apos;&amp;quot; &amp;amp; CellVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
            validclass2 = 1        
            If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1        

                If validloan = 0 Then
                    Invalidloans = Invalidloans + 1
                End if
                &amp;apos;Set failure code - 
                SELECT Case validloan
                    case &amp;quot;1&amp;quot;
                    validrecords = validrecords + 1
                    objExcel.Cells(allrowcount, 4).Value = &amp;quot;OK&amp;quot;
                    
                    case &amp;quot;0&amp;quot;
                    objExcel.Cells(allrowcount, 4).Value = &amp;quot;F1&amp;quot;

                End select

                loanlist(datarows-1) = CellVal &amp;amp; validloan
                redim preserve loanlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        &amp;apos;msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(10) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid Loan Numbers (F1): &amp;quot; &amp;amp; Invalidloans &amp;amp; chr(13)
        &amp;apos;msgline3 = &amp;quot;Invalid Investor Designations (F2): &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid loan records submitted for update: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1,4).Value = &amp;quot;RESULT CODE&amp;quot;
        objExcel.Cells(1,7).Value = &amp;quot;PROCESSING SUMARY &amp;quot; &amp;amp; NOW()
        objExcel.Cells(2,7).Value = msgheader
        &amp;apos;objExcel.Cells(3,7).Value = msgline1
        objExcel.Cells(4,7).Value = msgline2
        &amp;apos;objExcel.Cells(5,7).Value = msgline3
        objExcel.Cells(6,7).Value = msgline4
        
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing if &amp;quot;NO&amp;quot;
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder if there are no errors
        processresult = processupdates (allrowcount,Startrowno,1)
        If processresult = &amp;quot;1&amp;quot; Then
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        Else
            &amp;apos;If there are errors in processing all valid loans
            NLSApp.MessageBox(&amp;quot;There was a problem with Updating the loans below.&amp;quot; &amp;amp; chr(13) &amp;amp; processresult)
            msgbox(&amp;quot;Updates Completed!&amp;quot;)
        End if
        
    &amp;apos;Close Excel object and move processed file to completed folder
        objWorkbook.Save 
        objWorkbook.Close
        objExcel.quit

        &amp;apos;set objExcel = nothing
        &amp;apos;set objShell = nothing
        objFs.GetFolder(targetfolder)
        &amp;apos;Set objShellFolderSavFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file From your local Mapped drives.&amp;quot;,&amp;amp;H0008+&amp;amp;H0020,targetsavfolder)

        &amp;apos;completefolder = CStr(objShellFolderSavFile.Self.path) &amp;amp; &amp;quot;\&amp;quot;
        savefilepath = completefolder &amp;amp; &amp;quot;ExperianImport&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
        objFs.MoveFile strExcelPath,savefilepath
		
        If objFs.FileExists(savefilepath) = True Then
            MsgBox(&amp;quot;Results file saved to:  &amp;quot; &amp;amp; savefilepath)
        Else
            MsgBox(&amp;quot;There was a problem saving Results file to:  &amp;quot; &amp;amp; savedfilepath)
        End If
        
        set objExcel = nothing
        set objShell = nothing

    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function processupdates (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
        LoanNumber = objExcel.Cells(rowno, colno).Value
        score1 = objExcel.Cells(rowno, colno+1).Value
        score2 = objExcel.Cells(rowno, colno+2).Value
        scode = objExcel.Cells(rowno, colno+3).Value
        LoanRefno = NLSapp.SQLSelectStatement(&amp;quot;SELECT convert(varchar,acctrefno)FROM loanacct WHERE loan_number = &amp;apos;&amp;quot; &amp;amp; LoanNumber &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
        If scode = &amp;quot;OK&amp;quot; Then
            If score1 = &amp;quot;&amp;quot; Then
                score1 = &amp;quot;NULL&amp;quot;
            End If	
            If score2 = &amp;quot;&amp;quot; Then
                score2 = &amp;quot;NULL&amp;quot;
            End If
            NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef15 = &amp;quot; &amp;amp; score1 &amp;amp; &amp;quot;, userdef20 = &amp;quot; &amp;amp; score2 &amp;amp; &amp;quot;, userdef24 = convert(char(10),getdate(),101)  where acctrefno = &amp;quot; &amp;amp; LoanRefno)
            &amp;apos; If (Counter Mod 33) = 0 Then
                &amp;apos; NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef24 = &amp;apos;09/01/2018&amp;apos;  where acctrefno = &amp;quot; &amp;amp; LoanRefno)
            &amp;apos; End if
            &amp;apos;Update validation (based on udf24(last update) field
            newdate = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef24 FROM loanacct_detail_2 WHERE acctrefno = &amp;quot; &amp;amp; LoanRefno)
            If Not CDate(newdate) = Date() Then
                notupdated = notupdated &amp;amp; LoanNumber &amp;amp; chr(10)
                objExcel.Cells(rowno, 4).Value = &amp;quot;F2&amp;quot;
                updatefail = updatefail + 1
            End If
            
        End If
        rowno = rowno +1
    Next
    If notupdated = &amp;quot;&amp;quot; Then
        processupdates = &amp;quot;1&amp;quot;
    Else
        objExcel.Cells(5,7).Value = &amp;quot;Update Failures(F2): &amp;quot; &amp;amp; updatefail
        processupdates = notupdated
    End If 
End Function



&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;107&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="24.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="24.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="107"/>
<USERDEFFIELDS field_id="51" field_type="6" field_attribute="0" label_text="Accounting/Finance" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;cursor&quot; Script=&quot;&amp;apos;Set cursor to hourglass
Cursor = Cursors.WaitCursor

&amp;apos;Set cursor to default
Cursor = Cursors.Default&quot;/&gt;
&lt;BUTTON Name=&quot;Investor Transfer&quot; Script=&quot;&amp;apos;###Contact view ADMINISTRATION PAGE Accounting/Finance field Investor transfer option
&amp;apos;on Button click option selection
&amp;apos;For selected file in designated directory, processes list of loans for updates to class2 (investor) field
    
Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidloans = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = INVESTOR_TRANFERS_PENDING_DIR
completefolder = INVESTOR_TRANFERS_COMPLETED_DIR
targetfolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\PendingTransfers\&amp;quot;
completefolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\CompletedTransfers\&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid class2 codes
redim class2list(1)
class2lookupsql = &amp;quot;SELECT distinct code from loan_class where class_specifier = 2&amp;quot;
    &amp;apos;Populate array with current class2 list in NLS
    Do until nextinvestor = &amp;quot;***END OF RESULT***&amp;quot;
        rowcnt = UBound(class2list,1)
        
        If rowcnt = 1 Then
            class2list(rowcnt) = NLSApp.SQLSelectStatement(class2lookupsql)
        else
            class2list(rowcnt) = nextinvestor
        end if
        
        nextinvestor = NLSApp.SQLSelectStatementReadNext()
    
        If not nextinvestor = &amp;quot;***END OF RESULT***&amp;quot; Then
           redim Preserve class2list(rowcnt + 1)
        End if
    
    Loop

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim loanlist(1)
    
&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file to process.&amp;quot;, &amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    set objFsFolder = objFs.GetFolder(targetfolder)
    Foldersize = objFsFolder.size
    If Foldersize &amp;gt; 0 Then 
        &amp;apos;msgBox(objFsFolder.size)
        &amp;apos;msgBox(objShellFolderFileItems.count)
    End If
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)
    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)
    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellVal = objExcel.Cells(allrowcount,1).Value
            InvVal = objExcel.Cells(allrowcount,3).Value
            validloan = NLSApp.SQLSelectStatement(&amp;quot;Select count(*) from loanacct where loan_number = &amp;apos;&amp;quot; &amp;amp; CellVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
            validclass2 = 1        
            If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1        
    
                If StrComp(&amp;quot;APP-&amp;quot;, left(CellVal,4),1 ) = 0 Then
                    fplusrows = fplusrows + 1
                   objExcel.Cells(allrowcount, 4).Value = &amp;quot;F&amp;quot;
                End if
                If StrComp(&amp;quot;CP&amp;quot;, left(CellVal,2),1 ) = 0 Then
                    cplusrows = cplusrows + 1
                   objExcel.Cells(allrowcount, 4).Value = &amp;quot;C&amp;quot;
                End if
                If UBound(Filter (class2list,InvVal),1)= -1 Then
                    validclass2 = 0
                    Invalidclass2 = Invalidclass2 + 1
                End if
                If validloan = 0 Then
                    Invalidloans = Invalidloans + 1
                End if
                &amp;apos;Set failure code - 
                SELECT Case validloan &amp;amp; validclass2
                    case &amp;quot;11&amp;quot;
                    validrecords = validrecords + 1
                    objExcel.Cells(allrowcount, 2).Value = &amp;quot;OK&amp;quot;
                    
                    case &amp;quot;01&amp;quot;
                    objExcel.Cells(allrowcount, 2).Value = &amp;quot;F1&amp;quot;
                    
                    case &amp;quot;10&amp;quot;
                    objExcel.Cells(allrowcount, 2).Value = &amp;quot;F2&amp;quot;
                    
                    case &amp;quot;00&amp;quot;
                    objExcel.Cells(allrowcount, 2).Value = &amp;quot;F1, F2&amp;quot;
                    
                End select

                If objExcel.Cells(allrowcount, 4).Value = &amp;quot;C&amp;quot; Then
                    objExcel.Cells(allrowcount, 5).Value = InvestorACHSync(objExcel.Cells(allrowcount, 3).Value,&amp;quot;CONSOL PLUS&amp;quot;)
                Else
                    objExcel.Cells(allrowcount, 5).Value = InvestorACHSync(objExcel.Cells(allrowcount, 3).Value,&amp;quot;PLUS PORTFOLIO&amp;quot;)
                End If
        
                loanlist(datarows-1) = CellVal &amp;amp; validloan &amp;amp; validclass2    
                redim preserve loanlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(13) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid Loan Numbers (F1): &amp;quot; &amp;amp; Invalidloans &amp;amp; chr(13)
        msgline3 = &amp;quot;Invalid Investor Designations (F2): &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid transferable loan records submitted: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1, 7).Value = &amp;quot;PROCESSING SUMARY &amp;quot; &amp;amp; NOW()
        objExcel.Cells(2, 7).Value = msgheader
        objExcel.Cells(3, 7).Value = msgline1
        objExcel.Cells(4, 7).Value = msgline2
        objExcel.Cells(5, 7).Value = msgline3
        objExcel.Cells(6, 7).Value = msgline4
        
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing if &amp;quot;NO&amp;quot;
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder if there are no errors
        If processtransfers (allrowcount,Startrowno,1) = 1 Then
            objWorkbook.Save 
            objWorkbook.Close
            objExcel.quit
            set objExcel = nothing
            set objShell = nothing
            objFs.GetFolder(targetfolder)
            objFs.MoveFile strExcelPath,completefolder &amp;amp; &amp;quot;InvestorTrans&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
            msgbox(&amp;quot;Transfers Completed!&amp;quot;)
        Else
            &amp;apos;If there are errors in processing all valid loans
            msgbox(&amp;quot;There was a problem with the Transfers and all were not Completed!&amp;quot;)
        End if
        
    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function processtransfers (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
        LoanNumber = objExcel.Cells(rowno, colno).Value
        refno = objExcel.Cells(rowno, colno+1).Value
        class2 = objExcel.Cells(rowno, colno+2).Value
        portfolio = objExcel.Cells(rowno, colno+3).Value
        transtype =  1
        target =  objExcel.Cells(rowno, colno+4).Value
        If UBound(Filter (loanlist,LoanNumber &amp;amp; &amp;quot;11&amp;quot;),1) = 0 Then
            SyncACHCompanyupdate LoanNumber, refno, class2, portfolio, target,transtype,DateFormat(NOW(),1)
        End if
        rowno = rowno +1
    Next
    processtransfers = 1
End Function

Sub SyncACHCompanyupdate(loannumber,refno,Investor,Portfolio,targetACH,bulktransfer,effectivedate)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &amp;apos;Triggered when individual loan account is changed or updated.
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    
    &amp;apos;Declare variables
    runtimestamp = Now()
    emailyn = &amp;quot;N&amp;quot;
    userno = NLSApp.GetCurrentUserNo()
    If Not loannumber = &amp;quot;&amp;quot; Then
        refno = NLSApp.SQLSelectStatement(&amp;quot;SELECT acctrefno FROM loanacct WHERE loan_number = &amp;apos;&amp;quot; &amp;amp; loannumber &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
    End if

     If Portfolio = &amp;quot;C&amp;quot; Then 
         Portfoliono = 1
     End if
     If Portfolio = &amp;quot;F&amp;quot; Then 
         Portfoliono = 0
     End if
    
    WebACH = targetACH

    &amp;apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &amp;quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &amp;quot; &amp;amp; refno &amp;amp; &amp;quot; and ach_company_id &amp;lt;&amp;gt; &amp;quot; &amp;amp; targetACH
    &amp;apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 
    class2code = NLSapp.SQLSelectStatement(&amp;quot;select convert(varchar(4),codenum) from loan_class where code = &amp;apos;&amp;quot; &amp;amp; Investor &amp;amp; &amp;quot;&amp;apos;&amp;quot;)


    &amp;apos;Other variables
    modhistupdatesql = &amp;quot;&amp;quot;  
    loanach = &amp;quot;&amp;quot;
    loandetail = &amp;quot;&amp;quot;
    achxml = &amp;quot;&amp;quot;
    Detail2pdatesql = &amp;quot;&amp;quot;
    ACHUpdatesql = &amp;quot;&amp;quot;
    
    &amp;apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &amp;quot;&amp;quot; Then
        Do Until nomatchACHrowID = &amp;quot;&amp;quot; &amp;apos;&amp;quot;***END OF RESULT***&amp;quot;
            ACHUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot; Where row_id = &amp;quot; &amp;amp; nomatchACHrowID
            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &amp;apos;MsgBox(&amp;quot;all match&amp;quot;)
    End If    
    
    &amp;apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &amp;apos;&amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
	
    &amp;apos;Is loan part of a bulf transafer?
    If Bulktransfer = 1 Then
        Select Case Portfoliono
        Case 0
            Investortransdatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail SET userdef19 = &amp;apos;&amp;quot; &amp;amp; DateFormat(effectivedate, 111) &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
            
        Case 1
            Investortransdatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail SET userdef29 = &amp;apos;&amp;quot; &amp;amp; DateFormat(effectivedate, 111) &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
            
        End Select
        
        NLSapp.SQLSelectStatement(Investortransdatesql)
    End If

    NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET loan_class2_no = &amp;quot; &amp;amp; class2code &amp;amp; &amp;quot; where acctrefno = &amp;quot; &amp;amp; refno)
      
End Sub
&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;258&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;317&quot; ScreenWidth=&quot;1142&quot; ZOrder=&quot;109&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="2.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="2.0000000000" FieldWidth="258.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="317.0000000000" ScreenWidth="1,142.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="109"/>
<KEYRECORD code_id="8" numbering_key="0"/>
<SCRIPTS code_id="8" script_type="0" script="**###Before Save###****###Before Save###****###Before Activate###****###Before Activate###****###Before Create###****###Before Create###****###On Delete###****###On Delete###****###After Save###****###After Save###****###After Create###****###After Create###****###On Add Button Clicked###****###On Add Button Clicked###****###Local Functions###**Function getprocessstatuses (getxml)
    strXMl = Replace(getxml, &quot;&amp;&quot;, &quot;&amp;amp;&quot;)
        Set xmlDoc = CreateObject(&quot;Msxml2.DOMDocument&quot;)                                                                                                                                             
        xmlDoc.setProperty &quot;SelectionLanguage&quot;, &quot;XPath&quot;                                                                                                                                             

        Err.Clear
        On Error Resume Next
        xmlDoc.loadxml(strXMl)
        If Err.Number &lt;&gt; 0 Then
            &apos;Exit Function                                                                                                                                                                          
            NLSapp.MessageBox(Err.Description)
        End If
        On Error GoTo 0
                                                                                                                                                                                                       
        Set nodesList = xmlDoc.documentelement.selectNodes(&quot;/DATA/ROW&quot;)                                                                                                                             
        counter = nodesList.length
        redim processstatus(counter)
        count = 1

        For x = 0 To counter-1
                                                                                                                                                                                                       
           Set currNode=nodesList.nextNode                                                                                                                                                             
           CurrNodeName = currNode.nodename
                                                                                                                                                                                                       
           Set cnode = currNode.childnodes                                                                                                                                                             
                                                                                                                                                                                                       
           For Each c In cnode
                name = c.getAttribute(&quot;Name&quot;)
                value = c.getAttribute(&quot;Value&quot;)

                If name = &quot;Daily Process&quot; Then
                    nprocess = value
                End If

                If name = &quot;On/Off&quot; Then
                    nstatus = value
                End If
            Next
            processstatus(x) = nprocess &amp; &quot;,&quot; &amp; nstatus
			
        Next
        getprocessstatuses = processstatus
End Function

Function ImportXML(xml)
	NLSApp.ClearErrorString()

	If Not NLSApp.ImportXMLRecord(xml) Then
		If True Then
		NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
		End If
	ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
	Else
              &apos; NLSApp.MessageBox(&quot;Payment Added&quot;)
		ImportXML = &quot;&quot;
	End If
End Function

Sub ACHCompanySyncatupdateB(loannumber,refno,Investor,Portfolio,targetACH,bulktransfer,effectivedate)
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &apos;Triggered when individual loan account is chnaged or updated.
    &apos;
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    
    &apos;Declare variables
    runtimestamp = Now()
    emailyn = &quot;N&quot;
    userno = NLSApp.GetCurrentUserNo()
    If Not loannumber = &quot;&quot; Then
    	refno = NLSApp.SQLSelectStatement(&quot;SELECT acctrefno FROM loanacct WHERE loan_number = &apos;&quot; &amp; loannumber &amp; &quot;&apos;&quot;)
    End if
    &apos;refno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
    &apos;Investor = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
    &apos;Portfolio = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    WebACH = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF45&quot;)
    If targetACH = &quot;&quot; Then 
    	targetACH =  InvestorACHSync(Investor, Portfolio)
    End If
    &apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &quot; &amp; refno &amp; &quot; and ach_company_id &lt;&gt; &quot; &amp; targetACH
    &apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 
    class2code = NLSapp.SQLSelectStatement(&quot;select convert(varchar(4),codenum) from loan_class where code = &apos;&quot; &amp; Investor &amp; &quot;&apos;&quot;)


    &apos;Other variables
    modhistupdatesql = &quot;&quot;  
    loanach = &quot;&quot;
    loandetail = &quot;&quot;
    achxml = &quot;&quot;
    Detail2pdatesql = &quot;&quot;
    ACHUpdatesql = &quot;&quot;
    
    &apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &quot;&quot; Then
        Do Until nomatchACHrowID = &quot;&quot; &apos;&quot;***END OF RESULT***&quot;
            ACHUpdatesql = &quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &quot; &amp; targetACH &amp; &quot; Where row_id = &quot; &amp; nomatchACHrowID
            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &apos;MsgBox(&quot;all match&quot;)
    End If    
    
    &apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &apos;&quot; &amp; targetACH &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
    &apos;Is loan part of a bulf transafer?
    If Bulktransfer = 1 Then
    	Select Case Portfolio 
    	Case 0
	        Investortransdatesql = &quot;SELECT 0; UPDATE loanacct_detail SET userdef19 = &apos;&quot; &amp; DateFormat(effectivedate, 111) &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
	        
        Case 1
	        Investortransdatesql = &quot;SELECT 0; UPDATE loanacct_detail SET userdef29 = &apos;&quot; &amp; DateFormat(effectivedate, 111) &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
	        
        End Select
        
        NLSapp.SQLSelectStatement(Investortransdatesql)
    End If

	NLSapp.SQLSelectStatement(&quot;SELECT 0; UPDATE loanacct SET loan_class2_no = &quot; &amp; class2code &amp; &quot; where acctrefno = &quot; &amp; refno)
      
End Sub

&apos;DATE FORMATTING--------------------------------------------------------------------

Function DateFormat(datestring,formatcode)

	If IsDate(datestring) = true Then
		If len(DAY(datestring)) = 1 Then
		   daytext = &quot;0&quot; &amp; DAY(datestring) 
		Else 
		   daytext = DAY(datestring) 
		End if 

		If len(MONTH(datestring)) = 1 Then
		   mnthtext = &quot;0&quot; &amp; MONTH(datestring) 
		Else 
		   mnthtext = MONTH(datestring) 
		End if 
		If len(HOUR(datestring)) = 1 Then
		   hrtext = &quot;0&quot; &amp; HOUR(datestring) 
		Else 
		   hrtext = HOUR(datestring) 
		End if 
		If len(MINUTE(datestring)) = 1 Then
		   mintext = &quot;0&quot; &amp; MINUTE(datestring) 
		Else 
		   mintext = MINUTE(datestring) 
		End if	
		If len(SECOND(datestring)) = 1 Then
		   sectext = &quot;0&quot; &amp; SECOND(datestring) 
		Else 
		   sectext = SECOND(datestring) 
		End if

		Select case formatcode
		&apos;U.S. = mm/dd/yyyy
		case 1	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp; Right(YEAR(datestring),2)

		case 101	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp;	YEAR(datestring) 

		&apos;JAPAN	= yyyy/mm/dd	
		case 11	
			DateFormat = Right(YEAR(datestring),2) &amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext
		case 111	
			DateFormat = YEAR(datestring)&amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext

		&apos;Default with Day and timestamp removed	= mon yyyy	
		case 10077	
			DateFormat =  MonthName(Month(datestring), False) &amp; &quot; &quot; &amp; YEAR(datestring)

		&apos;MMDDYYHHMMSS	
		case 1012	
			DateFormat =  mnthtext &amp; daytext &amp; Right(YEAR(datestring),2) &amp; 	hrtext &amp; mintext &amp;	sectext	


		Case Else

			DateFormat = -1

		End Select

	Else	

		DateFormat = -1

	End if

	

End Function

&apos;SUBS AND FUNCTIONS
&apos;----------------------------------------------------------------------------------------------

&apos;SUBS-------------------------------------------------------------
sub LoanDetail2udf46Maint()
&apos;Maintains the next ACH payment date field in LoanDeatail2 udf46 to stay in sync with the ach.billing_next_date field
&apos;This is to be used as a endpoint in a get command on the custom web portal.

	d2_userdef46sql = &quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef46 = u.next_date&quot; &amp; chr(13) &amp; _
		&quot;FROM loanacct_detail_2 ld2,&quot; &amp; chr(13) &amp; _
		&quot;(&quot; &amp; chr(13) &amp; _
		&quot;SELECT convert(int, l.acctrefno) as acctrefno, ld2.userdef46, convert(char(10),max(ach.billing_next_date),101) as next_date&quot; &amp; chr(13) &amp; _
		&quot;from loanacct_ach ach, loanacct l, loanacct_detail_2 ld2&quot; &amp; chr(13) &amp; _
		&quot;where l.acctrefno = ach.acctrefno&quot; &amp; chr(13) &amp; _
		&quot;and l.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
		&quot;and l.status_code_no = 0&quot; &amp; chr(13) &amp; _
		&quot;and ach.status = 0&quot; &amp; chr(13) &amp; _
		&quot;group by  l.acctrefno,ld2.userdef46&quot; &amp; chr(13) &amp; _
		&quot;having (case when ld2.userdef46 is null then&apos;&apos; else ld2.userdef46 end ) &lt;&gt; convert(char(10),max(ach.billing_next_date),101)&quot; &amp; chr(13) &amp; _
		&quot;) u&quot; &amp; chr(13) &amp; _
		&quot;Where ld2.acctrefno = u.acctrefno&quot;

NLSApp.SQLSelectStatement(d2_userdef46sql)
End sub

&apos;--------------------------------------------------------------------

&apos;ReverseDSpayments.vb
&apos;Looks for un-reversed debt settlement payment transactions (TC8200) and their corresponding loan payment transactions 
&apos;that have been reversed. it then uses XML import to reverse the TC8200 transaction

Sub reverseDSpayments()

	revtranslookupsql = &quot;select distinct  &quot; &amp; chr(13) &amp; _
	&quot;&apos;&lt;NLS&gt;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE &apos; + &quot; &amp; chr(13) &amp; _
	&quot;&apos;TransactionCode=&quot;&quot;8201&quot;&quot; EffectiveDate=&quot;&quot;&apos; + convert(char(8),getdate(),1) + &apos;&quot;&quot; LoanNumber=&quot;&quot;&apos; + l.loan_number + &apos;&quot;&quot; TransRefNo=&quot;&quot;&apos; + + convert(varchar,lth1.transrefno) + &quot; &amp; chr(13) &amp; _
	&quot;&apos;&quot;&quot; Amount=&quot;&quot;&apos; + convert(varchar,lth1.transaction_amount) + &apos;&quot;&quot; RowID=&quot;&quot;&apos; + lth1.userdef01  + &apos;&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&lt;/NLS&gt;&apos; &quot; &amp; chr(13) &amp; _
	&quot;from loanacct_trans_history lth1,  	/*lth1 represents the DS transaction*/&quot; &amp; chr(13) &amp; _
	&quot;loanacct_trans_history lth2, 			/*lth2 represents the loan payment transaction*/&quot; &amp; chr(13) &amp; _
	&quot;loanacct l &quot; &amp; chr(13) &amp; _								
	&quot;where lth1.userdef04 is not null &quot; &amp; chr(13) &amp; _		
	&quot;and lth1.acctrefno = l.acctrefno &quot; &amp; chr(13) &amp; _
	&quot;and cast(lth2.transaction_reference_no as varchar) = lth1.userdef04  		/*pairs DS transaction to it loan payment transaction*/&quot; &amp; chr(13) &amp; _
	&quot;and (lth1.reversal_transrefno = 0 and not lth2.reversal_transrefno = 0) 	/*DS transaction has not been reversed but the loan payment has been reversed*/&quot; &amp; chr(13) &amp; _
	&quot;and lth2.transaction_date &gt; &apos;02/01/18&apos; 									/*not valid for transactions prior to implementation date*/&quot;

		Do 	
			RevtransXML = NLSApp.SQLSelectStatement(revtranslookupsql)

			&apos;Sample output
			&apos;RevtransXML = &quot;&lt;NLS&gt;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE TransactionCode=&quot;&quot;8201&quot;&quot; EffectiveDate=&quot;&quot;03/21/18&quot;&quot; LoanNumber=&quot;&quot;APP-00553272&quot;&quot; TransRefNo=&quot;&quot;5256551&quot;&quot; Amount=&quot;&quot;500.00&quot;&quot; RowID=&quot;&quot;3089124&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&lt;/NLS&gt;&quot;

			If Not RevtransXML = &quot;&quot; Then
				ImportXML(RevtransXML)
			End If

		Loop Until RevtransXML = &quot;&quot;
	
End Sub

Sub AutoCloseaddCompleted2018()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Close Loans in COMPLETE PENDING status for prescribed waiting period or more and queue up ZERO Balance letter for printing or email
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Define Document template objects
    Set DT5 = NLSApp.GetDocumentTemplates(5)
    Set DT6 = NLSApp.GetDocumentTemplates(6)
  
    arrayUB = NLSapp.SQLSelectStatement(PENDING_COMPLETE_CLOSE_LOAN_SQL)   

    detailcnt = 0

    If arrayUB = &quot;&quot; then
        Exit Sub
     End if

    &apos;Dim array to hold sql lookup results of list of valid loan numbers
    Redim loanlist(arrayUB) 

    For count = 0 to arrayUB
        loandetail = NLSapp.SQLSelectStatementNextColumn()  
NLSApp.MessageBox( loandetail)
        loanlist(count) = loandetail
        skipcol = NLSapp. SQLSelectStatementReadNext()
    Next


    For Each detail in  loanlist

        rowdetails = Split (detail,&quot;,&quot;)
        loannumber = rowdetails(0)
        refno = rowdetails(1)
        Suspense = rowdetails(2)
        template = rowdetails(3)
        SendToQueue = rowdetails(4)
        emailtoaddr = rowdetails(5)
        name = rowdetails(6)
        fname = rowdetails(7)
        lname = rowdetails(8)
        datenow = date()
        detailcnt = detailcnt + 1
        If detailcnt = 1 Then 
            refnolist = refno
        Else 
            refnolist = refnolist &amp; &quot;,&quot; &amp; refno
        End If

        If Not CDbl(Suspense) = 0 Then
            ClosureImportXMLp1 = &quot;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE TransactionCode=&quot;&quot;462&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; datenow &amp; _
            &quot;&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; loannumber &amp; &quot;&quot;&quot; Amount=&quot;&quot;&quot; &amp; Suspense &amp; &quot;&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&quot;
        Else
            ClosureImportXMLp1 = &quot;&quot;
        End if
        
        ClosureImportXMLp2 = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; loannumber &amp; &quot;&quot;&quot; LoanStatusCode=&quot;&quot;CLOSED&quot;&quot; ClosedDate=&quot;&quot;&quot; &amp; datenow &amp; &quot;&quot;&quot; &gt;&quot; &amp; _
            &quot;&lt;LOANSTATUSES Operation=&quot;&quot;DELETE&quot;&quot; LoanStatusCode=&quot;&quot;PENDING COMPLETE&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; datenow &amp; &quot;&quot;&quot;/&gt; &quot; &amp; _              
            &quot;&lt;LOANSTATUSES Operation=&quot;&quot;ADD&quot;&quot; LoanStatusCode=&quot;&quot;COMPLETED&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; datenow &amp; &quot;&quot;&quot;/&gt;&lt;/LOAN&gt; &quot;
        &apos;XML string Format:
        &apos;&lt;NLS&gt;
        &apos;&lt;TRANSACTIONS&gt;                                                                                                
        &apos;    &lt;TRANSACTIONCODE TransactionCode=&quot;462&quot; EffectiveDate=&quot;07/21/17&quot; LoanNumber=&quot;APP-00999999&quot; Amount=&quot;537.43&quot; /&gt;
        &apos;  &lt;/TRANSACTIONS&gt;                                                                                               
        &apos;  &lt;LOAN UpdateFlag=&quot;1&quot; LoanNumber=&quot;APP-00999999&quot; LoanStatusCode=&quot;CLOSED&quot; ClosedDate=&quot;07/21/17&quot; &gt;                
        &apos;    &lt;LOANSTATUSES Operation=&quot;DELETE&quot; LoanStatusCode=&quot;PENDING COMPLETE&quot; EffectiveDate=&quot;07/21/17&quot;/&gt;               
        &apos;    &lt;LOANSTATUSES Operation=&quot;ADD&quot; LoanStatusCode=&quot;COMPLETED&quot; EffectiveDate=&quot;07/21/17&quot;/&gt;                         
        &apos;  &lt;/LOAN&gt;                                                                                                       
        &apos;&lt;/NLS&gt;             
       &apos;nlsApp.messageBox(&quot;&lt;NLS&gt;&quot; &amp; ClosureImportXMLp1 &amp; ClosureImportXMLp2 &amp; &quot;&lt;/NLS&gt;&quot;)
       If PendingCompleteClosureImportXML(&quot;&lt;NLS&gt;&quot; &amp; ClosureImportXMLp1 &amp; ClosureImportXMLp2 &amp; &quot;&lt;/NLS&gt;&quot;, refno) = &quot;&quot; Then

            If SendToQueue = &quot;TRUE&quot; Then

            &apos;Generate zero balance Document
                If template = &quot;5&quot; Then
                    DT5.GenerateDocument refno, &quot;TRUE&quot;, &quot;SERVICING NOTES&quot;, SendToQueue, &quot;T:\Temp\&quot;
                End if
                If template = &quot;6&quot; Then
                    DT6.GenerateDocument refno, &quot;TRUE&quot;, &quot;SERVICING NOTES&quot;, SendToQueue, &quot;T:\Temp\&quot;
                End if
                docqueueID = NLSapp.SQLSelectStatement(&quot;SELECT cast(MAX(documentqueueid) as varchar) from DocumentQueue where len(DocumentName) = 0 and parentrefno = &quot; &amp; refno)
                NLSapp.SQLSelectStatement(&quot;SELECT 0; UPDATE DocumentQueue SET DocumentName = &apos;ZERO BALANCE LETTER&apos;, DocumentPageCount = 1 where DocumentQueueID = &quot; &amp; docqueueID)
            End If

            Logmsg = &quot;Daily Auto-Closure process &amp;#13;Refno: &quot; &amp; refno 
            logXML = &quot;&lt;NLS&gt;&lt;NLSLOG LogTypeDescription=&quot;&quot;Scripting&quot;&quot; ErrorStatus=&quot;&quot;0&quot;&quot; Log=&quot;&quot;&quot; &amp; Logmsg &amp;&quot;&quot;&quot;/&gt;&lt;/NLS&gt;&quot;
            ImportXML(logXML)

        Else
            &apos;PLACEHOLDER
            NLSApp.MessageBox(&quot;There was a problem closing refno &quot; &amp;  refno &amp; &quot;.&quot;)
        End If
  Next  

    &apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    refnolist =  &quot;(&quot; &amp; refnolist &amp; &quot;)&quot;
    If SetAdminuser(refnolist) = -1 Then
       subject = &quot;Pending Complete Admin update FAILURE!&quot;
       toaddress = &quot;NLSErrors@freedomdebtrelief.com&quot; &apos;&quot;somebody@bills.com&quot; 
       body1 = NLSApp.GetDataBaseName() &amp; CHR(10) &amp; CHR(10) &amp;   &quot;Acctrefno: &quot; &amp; refno &amp; CHR(13) &amp; &quot;Update Error setting script user to Admin. Please investigate.&quot;
       NLSApp.SendEmailMessage &quot;Loan Servicing3&quot;, toaddress, &quot;svc.loanservicing@freedomdebtrelief.com&quot;, subject, body1
    End if
    
End Sub

Sub AutoWOaddCompletePending2018()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Automatic Write-off loan balances $10 or less set loan status to COMPLETE PENDING
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    userno = NLSApp.GetCurrentUserNo()
    authuser = NLSapp.SQLSelectStatement(&quot;select convert(varchar(12),groupno) from nlsgroupmembers where userno = &quot; &amp; userno &amp; &quot; and groupno IN (11)&quot;)
    &apos;Current Authrized User group(s) 11-Admin

    lookupallloanssql = NLSapp.SQLSelectStatement(&quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;)
    lookuponeloansql =  lookupallloanssql &amp; Chr(13) &amp; &quot;and l.acctrefno in (&quot; &amp; NLSApp.GetField(&quot;LOAN_REFNO&quot;) &amp; &quot;)&quot;  
    lookupsql = lookuponeloansql
    
    &apos;Members of authorized user groups can opt to process all eligible loans
    If authuser &lt;&gt; &quot;&quot; Then
        &apos;If NLSApp.YseNoMessageBox(&quot;Select Yes to process all available loans.&quot;) Then 
            lookupsql = lookupallloanssql
        &apos;End If           
    End If
 
    writeoffxml = NLSapp.SQLSelectStatement(lookupsql)

    If len(writeoffxml) = 0 Then
        writeoffxml = &quot;***END OF RESULT***&quot;
    End If

    Do Until writeoffxml = &quot;***END OF RESULT***&quot;
        refno = NLSapp.SQLSelectStatementNextColumn()
        refnolist = refnolist &amp; refno &amp; &quot;, &quot;

       AddWOandPendingComplete(writeoffxml &amp; refno)
        &apos;Expected XML string output Format:
        &apos;&lt;NLS&gt;                                                                                                         
        &apos;  &lt;TRANSACTIONS&gt;                                                                                              
        &apos;    &lt;TRANSACTIONCODE TransactionCode=&quot;540&quot; EffectiveDate=&quot;07/05/17&quot; LoanNumber=&quot;APP-00099999&quot; Amount=&quot;8.84&quot; /&gt;
        &apos;    &lt;TRANSACTIONCODE TransactionCode=&quot;544&quot; EffectiveDate=&quot;07/05/17&quot; LoanNumber=&quot;APP-00099999&quot; Amount=&quot;8.84&quot; /&gt;
        &apos;    &lt;TRANSACTIONCODE TransactionCode=&quot;448&quot; EffectiveDate=&quot;07/05/17&quot; LoanNumber=&quot;APP-00099999&quot; Amount=&quot;8.84&quot; /&gt;
        &apos;    &lt;TRANSACTIONCODE TransactionCode=&quot;452&quot; EffectiveDate=&quot;07/05/17&quot; LoanNumber=&quot;APP-00099999&quot; Amount=&quot;8.84&quot; /&gt;                        
        &apos;  &lt;/TRANSACTIONS&gt;                                                                                             
        &apos;  &lt;LOAN UpdateFlag=&quot;1&quot; LoanNumber=&quot;APP-00099999&quot;&gt;                                                             
        &apos;    &lt;LOANSTATUSES Operation=&quot;ADD&quot; LoanStatusCode=&quot;PENDING COMPLETE&quot; EffectiveDate=&quot;07/21/17&quot;/&gt;
        &apos;    &lt;LOANCOMMENTS Comment=&quot;Remaining loan balance written-off due to balance below $10. &quot; Category=&quot;SERVICING NOTES&quot; CommentDescription=&quot;Balance write-off&quot; CreatedBy=&quot;0&quot;/&gt;              
        &apos;  &lt;/LOAN&gt;                                                                                                     
        &apos;&lt;/NLS&gt;

        writeoffxml = NLSApp.SQLSelectStatementReadNext()

    Loop

    If not refnolist = &quot;&quot; Then
        refnolist = &quot;(&quot; &amp; Left(refnolist, Len(refnolist) - 2) &amp; &quot;)&quot;
    End if 

    &apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    If SetAdminuser(refnolist) = -1 Then
       subject = &quot;Pending Complete Admin update FAILURE!&quot;
       toaddress = &quot;NLSErrors@freedomdebtrelief.com&quot; &apos;&quot;somebody@bills.com&quot; 
       body1 = &quot;Acctrefno: &quot; &amp; refno &amp; CHR(13) &amp; &quot;Update Error setting script user to Admin. Please investigate.&quot;
       NLSApp.SendEmailMessage &quot;Loan Servicing3&quot;, toaddress, &quot;svc.loanservicing@freedomdebtrelief.com&quot;, subject, body1
    End If
    
End Sub

Sub SyncACHWebpay()
	acctrefno = 9999
	acctsyncsql = NLSapp.SQLSelectStatement(&quot;SELECT  userdef44 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;ACH MONITOR&apos;&quot;)
	
	
	Do Until acctrefno = &quot;&quot;
	    acctrefno =  NLSapp.SQLSelectStatement(acctsyncsql)
	
	    investorname = NLSApp.SQLSelectStatementNextColumn()
	    port_code = NLSApp.SQLSelectStatementNextColumn()
	    If port_code = &quot;0&quot; Then
	         port_code = &quot;PLUS PORTFOLIO&quot;
	     Else
	         port_code = &quot;CONSOL PLUS&quot;
	    End If
	    detail2udf45 = NLSApp.SQLSelectStatementNextColumn()
	
	    ACHCompanySyncatupdate2018 acctrefno,investorname,port_code,detail2udf45
	    loopcnt = loopcnt + 1
	Loop 
	&apos;Loop until loopcnt = 4

End Sub

Sub ACHCompanyUDF()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;ACH Company UDF Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    refnosql = &quot;SELECT nonachUDFs.acctrefno,nonachUDFs.UDFtarget&quot; &amp; chr(13) &amp; _
    &quot;FROM&quot; &amp; chr(13) &amp; _
    &quot;(SELECT distinct &quot; &amp; chr(13) &amp; _
    &quot;convert(varchar(10),la.acctrefno) as acctrefno,&quot; &amp; chr(13) &amp; _
    &quot;la.loan_class2_no,&quot; &amp; chr(13) &amp; _
    &quot;lach.ach_company_id,&quot; &amp; chr(13) &amp; _
    &quot;la.portfolio_code_id,ld2.userdef45,&quot; &amp; chr(13) &amp; _
    &quot;&apos;UDFtarget&apos;= CASE&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 0 THEN 1&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 1 THEN 4&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 4 THEN 3&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 7 THEN 7&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 8 THEN 8&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 9 THEN 9&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 10 THEN 10&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 11 THEN 11&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 0 THEN 12&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 1 THEN 15&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 13 THEN 13&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 15 THEN 16&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 16 THEN 17&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 17 THEN 18&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 18 THEN 19&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 19 THEN 20&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 20 THEN 21&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 21 THEN 22&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 22 THEN 23&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 23 THEN 24&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 24 THEN 25&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 25 THEN 26&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 26 THEN 27&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 27 THEN 32&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 28 THEN 28&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 29 THEN 30&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 30 THEN 31&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 31 THEN 29&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 32 THEN 34&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 33 AND la.portfolio_code_id = 0 THEN 35&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 33 AND la.portfolio_code_id = 1 THEN 38&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 34 AND la.portfolio_code_id = 0 THEN 36&quot; &amp; chr(13) &amp;_ 
    &quot;WHEN la.loan_class2_no = 34 AND la.portfolio_code_id = 1 THEN 37&quot; &amp; chr(13) &amp;_  
    &quot;WHEN la.loan_class2_no = 35 THEN 39&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 36 AND la.portfolio_code_id = 0 THEN 41&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 36 AND la.portfolio_code_id = 1 THEN 40&quot; &amp; chr(13) &amp;_
    &quot;WHEN la.loan_class2_no = 37 AND la.portfolio_code_id = 0 THEN 43&quot; &amp; chr(13) &amp;_ 
    &quot;WHEN la.loan_class2_no = 37 AND la.portfolio_code_id = 1 THEN 42&quot; &amp; chr(13) &amp;_ 
    &quot;ELSE 9999&quot; &amp; chr(13) &amp; _
    &quot;END&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct_ach lach, loanacct_detail_2 ld2, loanacct la, loan_class lc,ach_company ach&quot; &amp; chr(13) &amp; _
    &quot;WHERE lach.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lc.codenum = la.loan_class2_no&quot; &amp; chr(13) &amp; _
    &quot;AND lach.ach_company_id = ach.ach_company_id&quot; &amp; chr(13) &amp; _
    &quot;AND la.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0&quot; &amp; chr(13) &amp; _
    &quot;and lach.status = 0&quot; &amp; chr(13) &amp; _
    &quot;/*AND la.loan_class1_no 1*/) nonachUDFs&quot; &amp; chr(13) &amp; _
    &quot;WHERE nonachUDFs.UDFtarget &lt;&gt; nonachUDFs.userdef45 &quot; &amp; chr(13) &amp; _
    &quot;OR nonachUDFs.userdef45  IS NULL&quot;

    LoanRefNo = NLSapp.SQLSelectStatement(refnosql)
    &apos;NLSApp.MessageBox( LoanRefNo)

    If LoanRefNo = &quot;&quot; Then
        LoanRefNo = &quot;***END OF RESULT***&quot;
    End If

    Lcount = 0

    Do Until LoanRefNo = &quot;***END OF RESULT***&quot;
        Lcount = Lcount + 1
        achid = NLSApp.SQLSelectStatementNextColumn()

        achxml = &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
                    &quot;  &lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; LoanRefNo &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
                    &quot;    &lt;LOANDETAIL2 UserDefined45=&quot;&quot;&quot; &amp; achid &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
                    &quot;  &lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
                    &quot;&lt;/NLS&gt;&quot;


        ImportXML(achxml)


        LoanRefNo = NLSApp.SQLSelectStatementReadNext()

    Loop
    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;ACH Company UDF Proccessing&quot;, &quot;Loans Processed &quot; &amp; Lcount
        &apos;NLSApp.MessageBox(&quot;Loans Processed &quot; &amp; Lcount)
    End If

End Sub


Sub LoanCommPrefs()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Communication Preferences Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    Commsetuplookupsqltxt = &quot;SELECT distinct  la.loan_number, convert(varchar(15),la.acctrefno) as acctrefno,&quot; &amp; chr(13) &amp; _
    &quot;convert(char(1),lcp.StatementOptionFlags),lca.Address,&quot; &amp; chr(13) &amp; _
    &quot;&apos;MailOptIn&apos; = CASE When la.portfolio_code_id=0 THEN ld1.userdef18&quot; &amp; chr(13) &amp; _
    &quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END,&quot; &amp; chr(13) &amp; _
    &quot;cif.email, cif.cifnumber&quot; &amp; chr(13) &amp; _
    &quot;from cif cif, loanacct_detail ld1,loanacct la&quot; &amp; chr(13) &amp; _
    &quot;left outer join&quot; &amp; chr(13) &amp; _
    &quot;LoanCommunicationPreferences lcp&quot; &amp; chr(13) &amp; _
    &quot;on &quot; &amp; chr(13) &amp; _
    &quot;la.acctrefno = lcp.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;left outer join&quot; &amp; chr(13) &amp; _
    &quot;LoanCommunicationAddress lca&quot; &amp; chr(13) &amp; _
    &quot;on&quot; &amp; chr(13) &amp; _
    &quot;lca.LoanCommunicationPreferencesID = lcp.LoanCommunicationPreferencesID&quot; &amp; chr(13) &amp; _
    &quot;Where ld1.acctrefno = la.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND cif.cifno = la.cifno&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0&quot; &amp; chr(13) &amp; _
    &quot;AND ((lcp.StatementOptionFlags IS NULL AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&quot; &amp; chr(13) &amp; _
    &quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0)&quot; &amp; chr(13) &amp; _
    &quot;OR (lcp.StatementOptionFlags = 2 AND lca.Address IS NULL)&quot; &amp; chr(13) &amp; _
    &quot;OR (lcp.StatementOptionFlags = 1 AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&quot; &amp; chr(13) &amp; _
    &quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0) )&quot; &amp; chr(13) &amp; _
    &quot;AND la.loan_number  not like &apos;CP%A&apos; &quot; &amp; chr(13) &amp; _
    &quot;AND la.loan_number not like &apos;%dummy%&apos;&quot; &amp; chr(13) &amp; _
    &quot;order by acctrefno ,mailoptin desc&quot;

    LoanNumber = NLSapp.SQLSelectStatement(Commsetuplookupsqltxt)
    loopcnt = 0

    If LoanNumber = &quot;&quot; Then
        LoanNumber = &quot;***END OF RESULT***&quot;
    End If

    Lcount = 0

    Do Until LoanNumber = &quot;***END OF RESULT***&quot;

        Loanrefno = NLSapp.SQLSelectStatementNextColumn()
        Flag = NLSapp.SQLSelectStatementNextColumn()
        Commemail = NLSapp.SQLSelectStatementNextColumn()
        Optin = NLSapp.SQLSelectStatementNextColumn()
        Cntemail = NLSapp.SQLSelectStatementNextColumn()

        If Optin = 1 Then
            Optinflag = 1
        Else
            Optinflag = 2
        End If
        CIFNum = NLSapp.SQLSelectStatementNextColumn()

        If Cntemail = &quot;&quot; Then
            Optinflag = 1
            Cntemail = &quot;LScontact@ffn.com&quot;
            cifemailxml = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
            &quot;   &lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot;&quot;&quot; &amp; CIFNum &amp; &quot;&quot;&quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot; EmailAddress1=&quot;&quot;LScontact@ffn.com&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
            &quot;&lt;/NLS&gt;&quot;

            ImportXML(cifemailxml)

        End If


        commprefxml = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;UTF-8&quot;&quot; standalone=&quot;&quot;yes&quot;&quot;?&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;	&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; LoanNumber &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;		&lt;COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
        &quot;				&lt;EMAILADDRESS Operation=&quot;&quot;ADD&quot;&quot; Address=&quot;&quot;&quot; &amp; Cntemail &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;/EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;				&lt;ALERT AlertType=&quot;&quot;Statement&quot;&quot; OptionFlags=&quot;&quot;&quot; &amp; Optinflag &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;/ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;		&lt;/COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        &quot;	&lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

        &apos;NLSApp.MessageBox(loopcnt &amp; &quot; - &quot; &amp; LoanNumber)

        ImportXML(commprefxml)
        LoanNumber = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;Loan Comm Prefs Proccessing&quot;, &quot;Loans Processed &quot; &amp; Lcount 
        &apos; NLSApp.MessageBox( &quot;Loans Processed &quot; &amp; Lcount)
    End If
End Sub

Sub WebPayments()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Web payments Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;SET PENDING STATUSES-----------------------------------------------------------

    sqlstring1 = &quot;select convert(varchar(10),la.acctrefno) as acctrefno, pt.ach_trace_number,&apos;PENDING&apos; as Status,ld2.userdef41,null&quot; &amp; chr(13) &amp; _
    &quot;FROM pending_transactions pt, loanacct la, loanacct_detail_2 ld2&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = pt.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef35 = &apos;SUBMITTED&apos;&quot; &amp; chr(13) &amp; _
    &quot;AND convert(datetime,ld2.userdef41) = pt.effective_date&quot; &amp; chr(13) &amp; _
    &quot;UNION&quot; &amp; chr(13) &amp; _
    &quot;select convert(varchar(10),la.acctrefno) as acctrefno, lph.ach_trace_number,&apos;COMPLETED&apos;, ld2.userdef41,lph.date_paid&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct_payment_history lph, loanacct la, loanacct_detail_2 ld2&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = lph.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef35 = &apos;SUBMITTED&apos;&quot; &amp; chr(13) &amp; _
    &quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&quot; &amp; chr(13) &amp; _
    &quot;UNION&quot; &amp; chr(13) &amp; _
    &quot;select convert(varchar(10),ld2.acctrefno) ,null,&apos;COMPLETED&apos;,ld2.userdef41,lph.date_paid&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct_payment_history lph, loanacct_detail_2 ld2 &quot; &amp; chr(13) &amp; _
    &quot;WHERE ld2.acctrefno = lph.acctrefno &quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef35 = &apos;PENDING&apos; &quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef34 =lph.ach_trace_number&quot; &amp; chr(13) &amp; _
    &quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&quot;


    LoanRefNo = NLSapp.SQLSelectStatement(sqlstring1)

    If LoanRefNo = &quot;&quot; Then
        LoanRefNo = &quot;***END OF RESULT***&quot;
    End If
    Lcount = 0
    Do Until LoanRefNo = &quot;***END OF RESULT***&quot;

        achtrace = NLSapp.SQLSelectStatementNextColumn()
        status = NLSapp.SQLSelectStatementNextColumn()

        If status = &quot;PENDING&quot; Then

            xmlstrng1 = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&quot; &amp; _
                    &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; _
                    &quot;  &lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; LoanRefNo &amp; &quot;&quot;&quot;&gt;&quot; &amp; _
                    &quot;    &lt;LOANDETAIL2  UserDefined34=&quot;&quot;&quot; &amp; achtrace &amp; &quot;&quot;&quot; UserDefined35=&quot;&quot;&quot; &amp; status &amp; &quot;&quot;&quot; /&gt;&quot; &amp; _
                    &quot;  &lt;/LOAN&gt;&quot; &amp; _
                    &quot;&lt;/NLS&gt;&quot;
        End If

        If status = &quot;COMPLETED&quot; Then

            xmlstrng1 = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&quot; &amp; _
                    &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; _
                    &quot;  &lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; LoanRefNo &amp; &quot;&quot;&quot;&gt;&quot; &amp; _
                    &quot;    &lt;LOANDETAIL2  UserDefined35=&quot;&quot;&quot; &amp; status &amp; &quot;&quot;&quot; /&gt;&quot; &amp; _
                    &quot;  &lt;/LOAN&gt;&quot; &amp; _
                    &quot;&lt;/NLS&gt;&quot;
        End If

        &apos;NLSApp.MessageBox(xmlstrng1)

        &apos;XML Imports
        ImportXML(xmlstrng1)

        LoanRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;Web Payments&quot;, &quot;Loans Processed &quot; &amp; Lcount 
    End If
&apos;-------------------------------------------------------------------------------------------------------------------------------------------------
&apos;WebPay Clean up -- to catch any remaining loans that were not updated by previous process
&apos;-------------------------------------------------------------------------------------------------------------------------------------------------

 sysadmincifnum = &quot;WEB PAY MAINT&quot;
 userdefno = &quot;18&quot;
 Targetsql1 = &quot;SELECT cd.userdef&quot; &amp; userdefno &amp; &quot; from cif c, cif_detail cd where c.cifno = cd.cifno  AND c.cifnumber = &apos;&quot; &amp; sysadmincifnum &amp; &quot;&apos;&quot;
 
 acctrefno = NLSApp.SQLSelectStatement(NLSApp.SQLSelectStatement(Targetsql1))

    If acctrefno = &quot;&quot; Then
        acctrefno = &quot;***END OF RESULT***&quot;
    End If
    Lcount = 0

    Do Until acctrefno = &quot;***END OF RESULT***&quot;
    	      wpxml = &quot;&lt;NLS EnforceTagExistence=&apos;1&apos;&gt;&lt;LOAN UpdateFlag=&apos;1&apos; AcctRefno=&apos;&quot; &amp; acctrefno &amp; &quot;&apos;&gt;&quot; &amp; chr(13) &amp; _
                     &quot;&lt;LOANDETAIL2 UserDefined35=&apos;COMPLETED&apos;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
     
              ImportXML(wpxml)
              acctrefno = NLSApp.SQLSelectStatementReadNext()
    
    Loop

End Sub

Sub PDFP()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;PDFP Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    TranRefNosql = &quot;SELECT convert(varchar(12),lth.transrefno),lth.transaction_date,&quot; &amp; chr(13) &amp; _
    &quot;lth.effective_date,lth.date_due,la.current_suspense,la.loan_number&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct la,loanacct_trans_history lth,&quot; &amp; chr(13) &amp; _
    &quot;(SELECT DISTINCT la.loan_number,max(lth.transaction_date) as transaction_date&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct la,loanacct_trans_history lth WHERE la.acctrefno = lth.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lth.transaction_code = &apos;124&apos; AND la.current_suspense &gt; 0 AND la.current_suspense = la.total_past_due_balance&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0 AND lth.date_due &lt; getdate() group by  la.loan_number) lt&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = lth.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lt.loan_number = la.loan_number&quot; &amp; chr(13) &amp; _
    &quot;AND lt.transaction_date = lth.transaction_date&quot; &amp; chr(13) &amp; _
    &quot;AND lth.transaction_code = &apos;124&apos;  &quot; &amp; chr(13) &amp; _
    &quot;UNION &quot; &amp; chr(13) &amp; _
    &quot;SELECT distinct convert(varchar(12),lth.transrefno),lth.transaction_date,&quot; &amp; chr(13) &amp; _
    &quot;lth.effective_date,lth.date_due,la.total_past_due_balance,la.loan_number&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct la,loanacct_trans_history lth, loanacct_payments_due lpd&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = lth.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lpd.payment_reference_no = lth.transaction_reference_no&quot; &amp; chr(13) &amp; _
    &quot;AND lth.transaction_code = &apos;124&apos;&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0  &quot; &amp; chr(13) &amp; _
    &quot;AND la.total_past_due_balance between .000010 and .01&quot;

    TranRefNo = NLSapp.SQLSelectStatement(TranRefNosql)

    If  TranRefNo = &quot;&quot; Then
           TranRefNo =  &quot;***END OF RESULT***&quot;
    End If
    
    Lcount = 0

    Do Until TranRefNo =&quot;***END OF RESULT***&quot;
       
        transdate = NLSapp.SQLSelectStatementNextColumn()
        effdate = NLSapp.SQLSelectStatementNextColumn()
        duedate = NLSapp.SQLSelectStatementNextColumn()
        amount = NLSapp.SQLSelectStatementNextColumn()
        loannum = NLSapp.SQLSelectStatementNextColumn()

        revtransxml = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;?&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;TRANSACTIONS&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;TRANSACTIONCODE TransactionCode=&quot;&quot;125&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; effdate &amp; &quot;&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; loannum &amp; &quot;&quot;&quot;  Amount=&quot;&quot;&quot; &amp; amount &amp; &quot;&quot;&quot; DateDue=&quot;&quot;&quot; &amp; duedate &amp; &quot;&quot;&quot; TransactionDate=&quot;&quot;&quot; &amp; transdate &amp; &quot;&quot;&quot; TransRefNo=&quot;&quot;&quot; &amp; TranRefNo &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;/TRANSACTIONS&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

        ImportXML(revtransxml)

        TranRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;PDFP Proccessing&quot;, &quot;Loans Processed &quot; &amp; Lcount
    End if
End Sub

Sub NonACHDetail2udf45Maint()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;For Updating Detail2 UDF45 with the ACH Company ID to be utilized by web portal one-tine ACH payment function
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    importsxml = NLSApp.SQLSelectStatement(NLSApp.SQLSelectStatement(&quot;SELECT cd.userdef35 FROM cif c, cif_detail cd Where c.cifno = cd.cifno and cifnumber = &apos;WEB PAY MAINT&apos;&quot;))
    If len(importsxml) = 0 Then
        importsxml = &quot;***END OF RESULT***&quot;
    End If

    Do Until importsxml = &quot;***END OF RESULT***&quot;

        ImportXML(importsxml)
        &apos;Expected XML string output Format:
        &apos;&lt;NLS&gt;                                                                                                           
        &apos;  &lt;LOAN  UpdateFlag = &quot;1&quot; AcctRefno=&quot;155190&quot; &gt;
        &apos;   &lt;LOANDETAIL2 UserDefined45 = &quot;31&quot; /&gt;
        &apos;  &lt;/LOAN&gt;
        &apos;&lt;/NLS&gt;

        importsxml = NLSApp.SQLSelectStatementReadNext()
    Loop
End Sub

Sub FirstPayDefaultFlag()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;First Pay Default Flag UDF Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    timecheck = NLSapp.SQLSelectStatement(&quot;SELECT Case When substring(cd.userdef03,10,25) &gt; getdate() Then &apos;N&apos; Else &apos;Y&apos; End FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;FIRST PAY DEFAULTS&apos;&quot;)
    
    If timecheck = &quot;Y&quot; Then
        xmlsql = NLSapp.SQLSelectStatement(&quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;FIRST PAY DEFAULTS&apos;&quot;)
        
        detail2udf13xml = NLSapp.SQLSelectStatement(xmlsql)
        
        If detail2udf13xml = &quot;&quot; Then
            detail2udf13xml = &quot;***END OF RESULT***&quot;
        End If
        
        Do Until detail2udf13xml = &quot;***END OF RESULT***&quot;
        
           ImportXML(detail2udf13xml)
            &apos;Expected XML string output Format:
            &apos;&lt;NLS EnforceTagExistence=&quot;1&quot;&gt;
            &apos;  &lt;LOAN  UpdateFlag=&quot;1&quot; AcctRefno=&quot;999999&quot; &gt;
            &apos;    &lt;LOANDETAIL2 UserDefined13 = &quot;1&quot; /&gt;
            &apos;  &lt;/LOAN&gt;
            &apos;&lt;/NLS&gt;
        
            detail2udf13xml = NLSApp.SQLSelectStatementReadNext()
        
        Loop
        &apos;Update last/Next Run datetime and Last user record
        Runstamp = NOW()
        NextRun = Date() + 1 &amp; &quot; 8:00:00 AM&quot;
         NextRun = NOW()
        UID = NLSApp.GetCurrentUserNo()
        
        Cifupdate = &quot;&lt;NLS&gt;&lt;CIF UpdateFlag=&apos;1&apos;CIFNumber=&apos;FIRST PAY DEFAULTS&apos;&gt;&lt;CIFDETAIL CIFDetail3=&apos;Next Run: &quot; &amp; NextRun &amp; _
            &quot;&apos; CIFDetail4=&apos;Last Run: &quot; &amp; Runstamp &amp; &quot;&apos; CIFDetail5=&apos; UserID: &quot; &amp; UID &amp; &quot;&apos; /&gt;&lt;/CIF&gt;&lt;/NLS&gt;&quot;
        
        ImportXML(Cifupdate)
    End if

End Sub



Sub DSpaymntMaint()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Debt Settlement payment TC Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
	paymentlookupsql = &quot;Select                           &quot; &amp; chr(13) &amp; _
		&quot;&apos;&lt;NLS&gt;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE &apos; +                                                                                                                     &quot; &amp; chr(13) &amp; _
		&quot;&apos;TransactionCode=&quot;&quot;8200&quot;&quot; EffectiveDate=&quot;&quot;&apos; + convert(char(8),lth.date_paid,1) + &apos;&quot;&quot; LoanNumber=&quot;&quot;&apos; + l.loan_number +                                        &quot; &amp; chr(13) &amp; _
		&quot;&apos;&quot;&quot; Amount=&quot;&quot;&apos; + convert(varchar,lth.payment_amount) + &apos;&quot;&quot; UserDefined1=&quot;&quot;&apos; + convert(varchar,lth.row_id) + &apos;&quot;&quot; UserDefined4=&quot;&quot;&apos; + convert(varchar,lth.transaction_reference_no) + &apos;&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&lt;/NLS&gt;&apos;,                    &quot; &amp; chr(13) &amp; _
		&quot;&apos;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &apos;&apos;Debt Settlement Payment&apos;&apos;, userdef02  = &apos;&apos;YES&apos;&apos; where row_id = &apos; + convert(varchar,lth.row_id)&quot; &amp; chr(13) &amp; _
		&quot;from loanacct_payment_history lth,                                 &quot; &amp; chr(13) &amp; _
		&quot;loanacct l,                                                        &quot; &amp; chr(13) &amp; _
		&quot;loanacct_statuses ls,                                              &quot; &amp; chr(13) &amp; _
		&quot;(                                                                  &quot; &amp; chr(13) &amp; _
		&quot;	Select acctrefno, max(mod_datestamp) as activetime              &quot; &amp; chr(13) &amp; _
		&quot;	from (                                                          &quot; &amp; chr(13) &amp; _
		&quot;	SELECT row_id,acctrefno,mod_datestamp                           &quot; &amp; chr(13) &amp; _
		&quot;	from loanacct_mod_history                                       &quot; &amp; chr(13) &amp; _
		&quot;	where item_changed = &apos;Status&apos;                                   &quot; &amp; chr(13) &amp; _
		&quot;	and new_value like &apos;%ACTIVE SETTLEMENT%&apos;                        &quot; &amp; chr(13) &amp; _
		&quot;	and old_value not like &apos;%ACTIVE SETTLEMENT%&apos;) activationtimes   &quot; &amp; chr(13) &amp; _
		&quot;	group by acctrefno) times                                       &quot; &amp; chr(13) &amp; _
		&quot;where times.acctrefno = lth.acctrefno                              &quot; &amp; chr(13) &amp; _
		&quot;and l.acctrefno = lth.acctrefno                                    &quot; &amp; chr(13) &amp; _
		&quot;and ls.acctrefno = lth.acctrefno                                   &quot; &amp; chr(13) &amp; _
		&quot;and ls.status_code_no IN  (32, 34)                                   &quot; &amp; chr(13) &amp; _
		&quot;and userdef01 not like &apos;%Debt Settlement Payment%&apos;                 &quot; &amp; chr(13) &amp; _
		&quot;and payment_type = &apos;ZZ&apos;                                            &quot; &amp; chr(13) &amp; _
		&quot;and lth.nsf_flag = 0                                               &quot; &amp; chr(13) &amp; _
		&quot;and l.current_ol1_balance &gt; 0                                      &quot; &amp; chr(13) &amp; _
		&quot;and date_paid &gt;= times.activetime &quot;



		
	Do 	
		AddDStransXML = NLSApp.SQLSelectStatement(paymentlookupsql)
		payHistUpdatesql = NLSapp.SQLSelectStatementNextColumn()
		
		&apos;Sample output
		&apos;AddDStransXML = &quot;&lt;NLS&gt;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE TransactionCode=&quot;&quot;8200&quot;&quot; EffectiveDate=&quot;&quot;03/07/18&quot;&quot; LoanNumber=&quot;&quot;CP0162960&quot;&quot; Amount=&quot;&quot;463.00&quot;&quot; UserDefined1=&quot;&quot;5138899&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&lt;/NLS&gt;&quot;
		&apos;payHistUpdatesql = &quot;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &apos;Debt Settlement Payment&apos;, userdef02  = &apos;YES&apos; where row_id = 5138899&quot;

		If Not AddDStransXML = &quot;&quot; Then
			ImportXML(AddDStransXML)
			NLSApp.SQLSelectStatement(payHistUpdatesql)
		End If
		count = count + 1
	Loop Until AddDStransXML = &quot;&quot;
	
	&apos;USER ID update 
	NLSApp.SQLSelectStatement(&quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0 Where transaction_code IN (&apos;8460&apos;,&apos;8440&apos;,&apos;8100&apos;,&apos;8200&apos;) and  enteredby_uid in (39)&quot;)

	
End Sub

    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Debt Settlement Fee Maint
    &apos;
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;

Sub DebtsetFeeTransMaint()

    &apos;Set the list of transaction codes to include in the query i.e., &apos;150&apos;,&apos;180&apos;,&apos;504&apos;
    transcodestrg = &quot;&apos;&quot; &amp; LOAN_TRANS_CODE_LATE_FEE &amp; &quot;&apos;, &apos;&quot; &amp;  LOAN_TRANS_CODE_NSF_FEE &amp; &quot;&apos;, &apos;&quot; &amp;  LOAN_TRANS_CODE_CHECK_FEE &amp; &quot;&apos;&quot;
    &apos;Set the list of loan status codes to include in the query i.e., &apos;32&apos;,&apos;34&apos;
    statcodestrg = &quot;&apos;&quot; &amp; LOAN_STATUS_ACTIVE_SETTLEMENT &amp; &quot;&apos;, &apos;&quot; &amp;  LOAN_STATUS_BROKEN_SETTLEMENT &amp; &quot;&apos;&quot; 
    
    &apos;SQL command that will lookup the loans with required fields to create transaction records. Output is an importable XML string and a SQL command string
    &apos;***Sample SQL output***
    &apos;CP000123, &lt;NLS&gt;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE TransactionCode=&quot;&quot;8280&quot;&quot; EffectiveDate=&quot;&quot;02/26/18&quot;&quot; LoanNumber=&quot;&quot;APP-00463650&quot;&quot; Amount=&quot;&quot;15.00&quot;&quot; UserDefined1=&quot;&quot;7135687&quot;&quot; UserDefined4=&quot;&quot;5318695&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&lt;/NLS&gt;
    &apos;,SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &apos;Debt Settlement transaction&apos;, userdef02  = &apos;YES&apos; where transrefno = 7135687

    dsfeestblsql = &quot;Select convert(varchar(15),l.acctrefno) as acctrefno,   &apos;transimportxml&apos; =  &quot; &amp; chr(13) &amp; _                     
        &quot;&apos;&lt;NLS&gt;&lt;TRANSACTIONS&gt;&lt;TRANSACTIONCODE &apos; +    &quot; &amp; chr(13) &amp; _                                                                                                                  
        &quot;&apos;TransactionCode=&quot;&quot;8&apos; + convert(varchar,lth.transaction_code) + &quot; &amp; chr(13) &amp; _ 
        &quot;&apos;&quot;&quot; EffectiveDate=&quot;&quot;&apos; + convert(char(8),lth.transaction_date,1) + &apos;&quot;&quot; LoanNumber=&quot;&quot;&apos; + l.loan_number + &quot; &amp; chr(13) &amp; _                                        
        &quot;&apos;&quot;&quot; Amount=&quot;&quot;&apos; + convert(varchar,lth.transaction_amount) + &apos;&quot;&quot; UserDefined1=&quot;&quot;&apos; + convert(varchar,lth.transrefno) + &quot; &amp; chr(13) &amp; _ 
        &quot;&apos;&quot;&quot; UserDefined4=&quot;&quot;&apos; + convert(varchar,lth.transaction_reference_no) + &apos;&quot;&quot;/&gt;&lt;/TRANSACTIONS&gt;&lt;/NLS&gt;&apos;,   &quot; &amp; chr(13) &amp; _                  
        &quot;&apos;transupdatesql&apos; = &apos;SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &apos;&apos;DEBT SETTLEMENT TRANS&apos;&apos;, userdef02  = &apos;&apos;YES&apos;&apos; where transrefno = &apos; + convert(varchar,lth.transrefno)&quot; &amp; chr(13) &amp; _ 
        &quot;from loanacct_trans_history lth,  &quot; &amp; chr(13) &amp; _ 
        &quot;loanacct l, &quot; &amp; chr(13) &amp; _ 
        &quot;loanacct_statuses ls,&quot; &amp; chr(13) &amp; _ 
        &quot;(           &quot; &amp; chr(13) &amp; _ 
        &quot;    Select acctrefno, max(mod_datestamp) as activetime   &quot; &amp; chr(13) &amp; _ 
        &quot;    from (                &quot; &amp; chr(13) &amp; _ 
        &quot;    SELECT row_id,acctrefno,mod_datestamp  &quot; &amp; chr(13) &amp; _ 
        &quot;    from loanacct_mod_history     &quot; &amp; chr(13) &amp; _ 
        &quot;    where item_changed = &apos;Status&apos; &quot; &amp; chr(13) &amp; _ 
        &quot;    and new_value like &apos;%ACTIVE SETTLEMENT%&apos; &quot; &amp; chr(13) &amp; _ 
        &quot;    and old_value not like &apos;%ACTIVE SETTLEMENT%&apos;) activationtimes &quot; &amp; chr(13) &amp; _ 
        &quot;    group by acctrefno) times  &quot; &amp; chr(13) &amp; _ 
        &quot;where times.acctrefno = lth.acctrefno  &quot; &amp; chr(13) &amp; _ 
        &quot;and l.acctrefno = lth.acctrefno &quot; &amp; chr(13) &amp; _ 
        &quot;and l.status_code_no = 0 &quot; &amp; chr(13) &amp; _ 
        &quot;and ls.acctrefno = lth.acctrefno  &quot; &amp; chr(13) &amp; _ 
        &quot;and ls.status_code_no IN  (&quot; &amp; statcodestrg &amp; &quot;)  &quot; &amp; chr(13) &amp; _ 
        &quot;and (userdef01 not like &apos;DEBT SETTLEMENT TRANS&apos;   or userdef01 IS NULL)&quot; &amp; chr(13) &amp; _ 
        &quot;and lth.transaction_code IN (&quot; &amp; transcodestrg &amp; &quot;)  &quot; &amp; chr(13) &amp; _ 
        &quot;and lth.reversal_transrefno = 0     &quot; &amp; chr(13) &amp; _ 
        &quot;and l.current_ol1_balance &gt; 0  &quot; &amp; chr(13) &amp; _ 
        &quot;and lth.transaction_date &gt;= times.activetime &quot; &amp; chr(13) &amp; _ 
        &quot; order by l.acctrefno,[transimportxml]&quot;
        
    &apos;dim dynamic array to hold sql results
    redim DSfeeslist(2,1)

    &apos;populate array data with sql output
    Do until nextrefno = &quot;***END OF RESULT***&quot;
        rowcnt = UBound(DSfeeslist,2)
        
        If rowcnt = 1 Then
            DSfeeslist(0,rowcnt) = NLSApp.SQLSelectStatement(dsfeestblsql)
        else
            DSfeeslist(0,rowcnt) = nextrefno
        end if
        
        DSfeeslist(1,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        DSfeeslist(2,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
        nextrefno = NLSApp.SQLSelectStatementReadNext()

        If not nextrefno = &quot;***END OF RESULT***&quot; Then
           redim Preserve DSfeeslist(2,rowcnt + 1)
        End if

    Loop 

    &apos;Run XML Import process and SQL updates to Add and Update transaction records
    For counter = 1 to rowcnt
        
        ImportXML(DSfeeslist(1,counter))
        NLSApp.SQLSelectStatement(DSfeeslist(2,counter))
       
    Next
End Sub


Sub DSBilltransMaint()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Debt Billing Transaction (124) TC Maintainance
    &apos;
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
	translookupsql = &quot;Select distinct &apos;UPDATE loanacct_recurring_trans set event_transaction_due_date = &apos;&apos;&apos; + convert(char(10),event_startdate+16,101) + &apos;&apos;&apos; where row_id = &apos; + convert(varchar(10),row_id)&quot; &amp; chr(13) &amp; _
                     &quot;from loanacct_recurring_trans                             &quot; &amp; chr(13) &amp; _
                     &quot;where rec_trans_description = &apos;Debt Settlment Billing Transactions&apos;          &quot; &amp; chr(13) &amp; _
                     &quot;and event_startdate+16 &lt;&gt; event_transaction_due_date&quot;

	 
    transupdatesrow = NLSApp.SQLSelectStatement(translookupsql)
      
    If Not  transupdatesrow = &quot;&quot; Then  
                 	
		Do 	Until  transupdatesrow = &quot;***END OF RESULT***&quot;
		&apos;Do 	Until count = 2  
			transupdates =  transupdates &amp; chr(13) &amp;  transupdatesrow
                                                transupdatesrow = NLSApp.SQLSelectStatementReadNext()
        count = count + 1
		Loop 
    End If
    &apos;NLSapp.MessageBox(&quot;SELECT 0; &quot; &amp; transupdates)	
    NLSapp.SQLSelectStatement(&quot;SELECT 0;  &quot; &amp; transupdates)

End Sub

&apos;FUNCTIONS-------------------------------------------------------------

Function AddWOandPendingComplete(xml)
    NLSApp.ClearErrorString()
    endmark =  &quot;&lt;/NLS&gt;&quot;
    refno = Mid(xml, InStr(xml, endmark) + len(endmark), len(xml) - InStr(xml, endmark) + len(endmark))
    
    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            errormsg = NLSApp.GetErrorString()
            subject = &quot;Pending Complete Loan Closure process IMPORT FAILURE!&quot;
            toaddress = &quot;NLSErrors@freedomdebtrelief.com&quot; &apos;&quot;somebody@bills.com&quot; 
            body1 = &quot;Acctrefno: &quot; &amp; refno &amp; CHR(13) &amp; &quot;Import Error: &quot; &amp; chr(13) &amp; errormsg &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
            NLSApp.SendEmailMessage &quot;Loan Servicing3&quot;, toaddress, &quot;svc.loanservicing@freedomdebtrelief.com&quot;, subject, body1
        End If
        AddWOandPendingComplete = errormsg &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
    Else
        &apos; NLSApp.MessageBox(&quot;&quot;)
        AddWOandPendingComplete = &quot;&quot;
    End If
End Function

Function ACHCompanySyncatupdate2018(refno,Investor,Portfolio,WebACH)
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &apos;Triggered when individual loan account is changed or updated.
    &apos;
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    
    &apos;Declare variables
    runtimestamp = Now()
    emailyn = &quot;N&quot;
    userno = NLSApp.GetCurrentUserNo()
    &apos;refno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
    &apos;Investor = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
    &apos;Portfolio = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    &apos;WebACH = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF45&quot;)
    targetACH =  InvestorACHSync(Investor, Portfolio)
    &apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &quot; &amp; refno &amp; &quot; and ach_company_id &lt;&gt; &quot; &amp; targetACH
    &apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 

    &apos;Other variables
    modhistupdatesql = &quot;&quot;  
    loanach = &quot;&quot;
    loandetail = &quot;&quot;
    achxml = &quot;&quot;
    Detail2pdatesql = &quot;&quot;
    ACHUpdatesql = &quot;&quot;

    &apos;MsgBox(&quot;acctrefno = &quot; &amp; acctrefno &amp; chr(13) &amp; &quot;Port = &quot; &amp; Portfolio)
   &apos; MsgBox(&quot;target ach = &quot; &amp; targetACH)
    &apos;MsgBox(&quot;ach row id = &quot; &amp; nomatchACHrowID)
   &apos; MsgBox(&quot;udf 45 = &quot; &amp; WebACH)

    &apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &quot;&quot; Then
        Do Until nomatchACHrowID = &quot;&quot; &apos;&quot;***END OF RESULT***&quot;
            ACHUpdatesql = &quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &quot; &amp; targetACH &amp; &quot; Where row_id = &quot; &amp; nomatchACHrowID

            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &apos;MsgBox(&quot;all match&quot;)
    End If    

    &apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &apos;&quot; &amp; targetACH &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
    ACHCompanySyncatupdate2018 = &quot;&quot;  
End Function**###Local Functions###**"/>
</CONTACT_PORTFOLIO_CODE>
</SETUP>
