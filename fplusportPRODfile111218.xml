<SETUP>
<LOAN_PORTFOLIO_CODE code="PLUS PORTFOLIO" description="DEFAULT PORTFOLIO" numbering_mask="%d" option_flags="225" disabled_flag="0" allow_documents_flag="0" show_description_flag="0" comment_type="0" ecoa_code="" relationship_type="0" field_order="0" collateral_type="0" location_flag="0" taxes_flag="0" insurance_flag="0" object_def="&lt;NLSObjectDef&gt;
&lt;ScreenObject&gt;
&lt;UDF ObjectID=&quot;1&quot; ObjectType=&quot;2&quot; TabId=&quot;4&quot; TopPos=&quot;0&quot; LeftPos=&quot;7&quot; Height=&quot;64&quot; Width=&quot;1003&quot; Label=&quot;Actions&quot; ZOrder=&quot;1&quot;/&gt;
&lt;/ScreenObject&gt;
&lt;/NLSObjectDef&gt;
" class_1_label="Class 1" class_2_label="Investor">
<USERDEFFIELDS field_id="254" field_type="0" field_attribute="0" label_text="Charge off Exception Box" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;275&quot; StaticTopPos=&quot;135&quot; StaticWidth=&quot;164&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;275&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;60&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;1&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="275.0000000000" StaticTopPos="135.0000000000" StaticWidth="164.0000000000" StaticHeight="20.0000000000" FieldLeftPos="275.0000000000" FieldTopPos="156.0000000000" FieldWidth="251.0000000000" FieldHeight="60.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="1"/>
<USERDEFFIELDS field_id="245" field_type="0" field_attribute="3" label_text="Co-Borrower" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;379&quot; StaticTopPos=&quot;616&quot; StaticWidth=&quot;99&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;616&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;2&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="379.0000000000" StaticTopPos="616.0000000000" StaticWidth="99.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="616.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="2"/>
<USERDEFFIELDS field_id="5405" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;148&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;3&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="148.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="3"/>
<USERDEFFIELDS field_id="5305" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;150&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;63&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;4&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="973.0000000000" StaticWidth="150.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="63.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="4"/>
<USERDEFFIELDS field_id="5404" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;148&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;5&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="148.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="5"/>
<USERDEFFIELDS field_id="5304" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;150&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;63&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;6&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="973.0000000000" StaticWidth="150.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="63.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="6"/>
<USERDEFFIELDS field_id="5403" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;148&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;7&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="148.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="7"/>
<USERDEFFIELDS field_id="5303" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;150&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;63&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;8&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="973.0000000000" StaticWidth="150.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="63.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="8"/>
<USERDEFFIELDS field_id="5402" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;148&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;9&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="973.0000000000" StaticWidth="148.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="9"/>
<USERDEFFIELDS field_id="5302" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;150&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;63&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;10&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="973.0000000000" StaticWidth="150.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="63.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="10"/>
<USERDEFFIELDS field_id="5401" field_type="8" field_attribute="0" label_text="Current Balances Provided" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;168&quot; StaticHeight=&quot;14&quot; FieldLeftPos=&quot;56&quot; FieldTopPos=&quot;374&quot; FieldWidth=&quot;389&quot; FieldHeight=&quot;69&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;11&quot; ReadOnly=&quot;0&quot;&gt;
&lt;TABLE DoNotSave=&quot;False&quot; DoNotDirty=&quot;False&quot; StretchLastColumn=&quot;False&quot; GridType=&quot;Generic&quot;/&gt;
&lt;ROW NumberOfRows=&quot;Grow as needed&quot;/&gt;
&lt;COLUMN Name=&quot;Balance&quot; TableLink=&quot;None&quot; Type=&quot;Number&quot; DecimalPlaces=&quot;2&quot; ComboData=&quot;&quot; Alignment=&quot;Right&quot; Width=&quot;75&quot; ReadOnly=&quot;False&quot; UseComma=&quot;True&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Good Thru&quot; TableLink=&quot;None&quot; Type=&quot;Date&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;125&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Issued by&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Center&quot; Width=&quot;125&quot; ReadOnly=&quot;True&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Issue Date&quot; TableLink=&quot;None&quot; Type=&quot;Date&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;125&quot; ReadOnly=&quot;True&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;/UDF&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="354.0000000000" StaticWidth="168.0000000000" StaticHeight="14.0000000000" FieldLeftPos="56.0000000000" FieldTopPos="374.0000000000" FieldWidth="389.0000000000" FieldHeight="69.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="11"/>
<USERDEFFIELDS field_id="5301" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;150&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;63&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;12&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="973.0000000000" StaticWidth="150.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="63.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="12"/>
<USERDEFFIELDS field_id="300" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;13&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="332.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="332.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="13"/>
<USERDEFFIELDS field_id="250" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;747&quot; StaticTopPos=&quot;406&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;851&quot; FieldTopPos=&quot;343&quot; FieldWidth=&quot;250&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;14&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="747.0000000000" StaticTopPos="406.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="851.0000000000" FieldTopPos="343.0000000000" FieldWidth="250.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="14"/>
<USERDEFFIELDS field_id="299" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;15&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="310.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="310.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="15"/>
<USERDEFFIELDS field_id="249" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;373&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;16&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="373.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="310.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="16"/>
<USERDEFFIELDS field_id="298" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;17&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="288.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="288.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="17"/>
<USERDEFFIELDS field_id="248" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;351&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;18&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="351.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="288.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="18"/>
<USERDEFFIELDS field_id="297" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;19&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="266.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="266.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="19"/>
<USERDEFFIELDS field_id="247" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;329&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;20&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="329.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="266.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="20"/>
<USERDEFFIELDS field_id="296" field_type="0" field_attribute="3" label_text="Next Scheduled ACH" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;21&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="244.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="244.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="21"/>
<USERDEFFIELDS field_id="246" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;307&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;22&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="307.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="244.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="22"/>
<USERDEFFIELDS field_id="295" field_type="0" field_attribute="3" label_text="ACH Co ID" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;23&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="222.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="222.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="23"/>
<USERDEFFIELDS field_id="244" field_type="0" field_attribute="3" label_text="Borrower" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;379&quot; StaticTopPos=&quot;594&quot; StaticWidth=&quot;99&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;594&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;24&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="379.0000000000" StaticTopPos="594.0000000000" StaticWidth="99.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="594.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="24"/>
<USERDEFFIELDS field_id="294" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;25&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="200.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="200.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="25"/>
<USERDEFFIELDS field_id="243" field_type="0" field_attribute="0" label_text="Contribution Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;241&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;242&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;26&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="241.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="242.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="26"/>
<USERDEFFIELDS field_id="293" field_type="0" field_attribute="3" label_text="Message" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;27&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="178.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="178.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="27"/>
<USERDEFFIELDS field_id="242" field_type="0" field_attribute="0" label_text="Contributing Investor" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;219&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;220&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;28&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="219.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="220.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="28"/>
<USERDEFFIELDS field_id="292" field_type="0" field_attribute="3" label_text="Account Number Encrypt" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;29&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="156.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="156.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="29"/>
<USERDEFFIELDS field_id="241" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;197&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;30&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="197.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="134.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="30"/>
<USERDEFFIELDS field_id="291" field_type="0" field_attribute="3" label_text="Payment Date" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;31&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="134.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="134.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="31"/>
<USERDEFFIELDS field_id="240" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;175&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;32&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="175.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="112.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="32"/>
<USERDEFFIELDS field_id="290" field_type="0" field_attribute="3" label_text="Check Number" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;33&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="112.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="112.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="33"/>
<USERDEFFIELDS field_id="239" field_type="4" field_attribute="0" label_text="Loan Sale Buyer" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**NLSapp.LoadComboList 0, &quot;LOAN_DETAIL1_UDF39&quot;, &quot;SELECT cifnumber from cif where cifnumber like &apos;Debt BUYER%&apos; &quot;**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;884&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;94&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;885&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;112&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;34&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="884.0000000000" StaticTopPos="10.0000000000" StaticWidth="94.0000000000" StaticHeight="20.0000000000" FieldLeftPos="885.0000000000" FieldTopPos="29.0000000000" FieldWidth="112.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="34">
<USERDEFDATA row_id="2965" field_reference="239" field_data="CKS FINANCIAL" field_order="0" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="289" field_type="0" field_attribute="3" label_text="Account Number" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;35&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="90.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="90.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="35"/>
<USERDEFFIELDS field_id="238" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;131&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;36&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="131.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="68.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="36"/>
<USERDEFFIELDS field_id="288" field_type="0" field_attribute="3" label_text="ABA Number" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;37&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="68.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="68.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="37"/>
<USERDEFFIELDS field_id="237" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;746&quot; StaticTopPos=&quot;109&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;849&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;38&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="746.0000000000" StaticTopPos="109.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="849.0000000000" FieldTopPos="46.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="38"/>
<USERDEFFIELDS field_id="287" field_type="0" field_attribute="3" label_text="Name on Account" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;39&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="46.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="46.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="39"/>
<USERDEFFIELDS field_id="236" field_type="1" field_attribute="0" label_text="Loan Fees Paid by Investors to FFAM" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;427&quot; StaticTopPos=&quot;435&quot; StaticWidth=&quot;155&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;584&quot; FieldTopPos=&quot;431&quot; FieldWidth=&quot;144&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;40&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="427.0000000000" StaticTopPos="435.0000000000" StaticWidth="155.0000000000" StaticHeight="20.0000000000" FieldLeftPos="584.0000000000" FieldTopPos="431.0000000000" FieldWidth="144.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="40"/>
<USERDEFFIELDS field_id="286" field_type="0" field_attribute="3" label_text="Payment Amount" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;41&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="24.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="24.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="41"/>
<USERDEFFIELDS field_id="235" field_type="0" field_attribute="0" label_text="Funding Source" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;131&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;131&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;42&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="131.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="131.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="42"/>
<USERDEFFIELDS field_id="285" field_type="3" field_attribute="3" label_text="Status" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;NLSApp.SetField &quot;LOAN_DETAIL2_UDF36&quot;,&quot;67895&quot;**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;43&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="2.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="2.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="43">
<USERDEFDATA row_id="2966" field_reference="285" field_data="SUBMITTED" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2967" field_reference="285" field_data="PENDING" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2968" field_reference="285" field_data="COMPLETED" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2969" field_reference="285" field_data="CANCELLED" field_order="3" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="234" field_type="5" field_attribute="0" label_text="Limit Sharing" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;Script to update CIF UDF field 06 based on limiit sharing box (loan detail udf 34)  being checked or not checked.

NLSApp.SetFocus (&quot;LOAN_NUMBER&quot;)
LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
loanref= NLSapp.GetField(&quot;LOAN_REFNO&quot;)
CIFNo1 =NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)

strSQL1 =&quot;SELECT count(acctrefno) FROM cif_loan_relationship WHERE acctrefno = &apos;&quot; &amp; loanref &amp; &quot;&apos;&quot;

COCIFYN = NLSapp.SQLSelectStatement(strSQL1)

strSQL2 =&quot;SELECT cif.cifnumber &quot; &amp; _
		&quot;FROM cif_loan_relationship clr, cif cif &quot; &amp; _
		&quot;WHERE clr.cifno = cif.cifno  &quot; &amp; _
		&quot;AND relationship_code_id = &apos;1&apos; &quot; &amp; _
		&quot;AND clr.acctrefno = &apos;&quot; &amp; loanref &amp; &quot;&apos;&quot;

CIFNo2 = NLSapp.SQLSelectStatement(strSQL2)

If NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF34&quot;) = &quot;CHECK&quot; THEN
	LimistShareYN = &quot;1&quot;
	ELSE
	LimistShareYN = &quot;0&quot;
END IF

XMLA = &quot;&lt;NLS&gt;&quot; 
XMLB = &quot;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot; &amp; chr(34) &amp; CIFNo1 &amp; chr(34) &amp; &quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot;&gt;&lt;CIFDETAIL CIFDetail6=&quot; &amp; chr(34) &amp; LimistShareYN &amp; chr(34) &amp; &quot;/&gt;&quot; 
XMLC = &quot;&lt;/CIF&gt;&quot; &amp;CHR(13) &amp; &quot;&lt;/NLS&gt;&quot;


xmlstrng1 = XMLA &amp; CHR(13) &amp; XMLB &amp; CHR(13) &amp; XMLC

ImportXML(xmlstrng1)

If Not COCIFYN = 0 Then
	XMLD = &quot;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot; &amp; chr(34) &amp; CIFNo2 &amp; chr(34) &amp; &quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot;&gt;&lt;CIFDETAIL CIFDetail6=&quot; &amp; chr(34) &amp; LimistShareYN &amp; chr(34) &amp; &quot;/&gt;&quot; 
	xmlstrng2 = XMLA &amp; CHR(13) &amp; XMLD &amp; CHR(13) &amp; XMLC

	ImportXML(xmlstrng2)

End If





&apos;NLSApp.SetField &quot;LOAN_DETAIL1_UDF43&quot;,xmlstrng &amp; CHR(13) &amp; NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF34&quot;)



Function ImportXML(xml)
      NLSApp.ClearErrorString()
      
      If Not NLSApp.ImportXMLRecord(xml) Then
            If True Then
                  NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
            End If
            ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
      Else
&apos;            NLSApp.MessageBox(&quot;ECOA Status Updated.&quot;)
                    ImportXML = &quot;&quot;
      End If
End Function

NLSApp.SaveScreen()	**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;236&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;236&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;44&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="236.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="236.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="44"/>
<USERDEFFIELDS field_id="284" field_type="0" field_attribute="3" label_text="ACH Trace ID" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;245&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;45&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="354.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="354.0000000000" FieldWidth="245.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="45"/>
<USERDEFFIELDS field_id="233" field_type="6" field_attribute="0" label_text="Legal Actions" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Activate CnD&quot; Script=&quot;&amp;apos;FFLS-379 Add Cease and Desist Button
	&amp;apos; 1.  Remove loan statements from loan setup
	&amp;apos; 2.  Remove email address from Communication Preferences
	&amp;apos; 3.  Remove all alerts from Communication Preferences
	&amp;apos; 4.  Obfuscate borrower and co-borrower email to [borrower@ffn1.com]@cnd (for tracking)
&amp;apos;FFLS-656 Remove Scripting that Disables Statements for CND
    &amp;apos; 1.  Comment out SQL update lines that effect communication preferences

NLSApp.SaveScreen()
	
If NLSApp.YesNoMessageBox(&amp;quot;Are Sure you want to Activate a Cease and Desist for this loan?&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;This can only be undone manually.&amp;quot;) Then
&amp;apos;Set variables	
	loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
	cifnumber = NLSApp.GetField(&amp;quot;LOAN_CIFNUMBER&amp;quot;)
	cocifnumber = NLSApp.SQLSelectStatement(&amp;quot;SELECT c2.cifnumber , c2.email, c2.email2  from loanacct l, cif c2, cif_loan_relationship clr where c2.cifno = clr.cifno and l.acctrefno = clr.acctrefno and clr.acctrefno = &amp;quot; &amp;amp; loanrefno)
	email1 = NLSApp.SQLSelectStatementNextColumn()
	email2 = NLSApp.SQLSelectStatementNextColumn()
	
               &amp;apos;1-3 SQL to update loan setup and communication
                                cndsqlupdates = &amp;quot;SELECT 0; &amp;quot; &amp;amp; _
                                &amp;quot;UPDATE loanacct_setup SET statement1_code = 0, statement2_code = 0, late_fee_code = 0 WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
                                &amp;quot;DELETE from LoanCommunicationAddress WHERE LoanCommunicationPreferencesID IN (SELECT LoanCommunicationPreferencesID FROM LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
                                &amp;quot;UPDATE LoanCommunicationPreferences SET StatementOptionFlags = 0, LateNoticeOptionFlags = 0 from LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
                                &amp;quot;--UPDATE loanacct SET collection_officer_no = 0    WHERE acctrefno = &amp;quot; &amp;amp; loanrefno
 
               &amp;apos;Run UPDATES
                                NLSApp.SQLSelectStatement(cndsqlupdates)
                                ImportXML(&amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanrefno &amp;amp; &amp;quot;&amp;quot;&amp;quot; CollectionOfficerNumber=&amp;quot;&amp;quot;0&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;)


	&amp;apos;Add Loan Status change to &amp;quot;CEASE AND DESIST ACTIVE&amp;quot;
		 loanxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanrefno &amp;amp; _
		 &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;lt;LOANSTATUSES Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;CEASE AND DESIST ACTIVE&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
		 &amp;quot;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
	
	&amp;apos;4 Updates to obfuscate email addresses
		ImportXML(loanxmlstring) 
		If Not cocifnumber = &amp;quot;&amp;quot; Then
		 cocifxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cocifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp;  &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
		 ImportXML(cocifxmlstring)
		End if
		
	NLSApp.RefreshScreen()
Else
	NLSApp.MessageBox(&amp;quot;CnD Canceled.&amp;quot;)
End if&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;158&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;86&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;156&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;98&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;46&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="158.0000000000" StaticTopPos="10.0000000000" StaticWidth="86.0000000000" StaticHeight="20.0000000000" FieldLeftPos="156.0000000000" FieldTopPos="29.0000000000" FieldWidth="98.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="46"/>
<USERDEFFIELDS field_id="283" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;411&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;411&quot; FieldWidth=&quot;246&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;47&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="411.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="411.0000000000" FieldWidth="246.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="47"/>
<USERDEFFIELDS field_id="232" field_type="6" field_attribute="4" label_text="" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;TBD&quot; Script=&quot;&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;271&quot; StaticTopPos=&quot;120&quot; StaticWidth=&quot;93&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;531&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;108&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;48&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="271.0000000000" StaticTopPos="120.0000000000" StaticWidth="93.0000000000" StaticHeight="20.0000000000" FieldLeftPos="531.0000000000" FieldTopPos="29.0000000000" FieldWidth="108.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="48"/>
<USERDEFFIELDS field_id="282" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;389&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;389&quot; FieldWidth=&quot;246&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;49&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="389.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="389.0000000000" FieldWidth="246.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="49"/>
<USERDEFFIELDS field_id="231" field_type="6" field_attribute="0" label_text="" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Bankruptcy Notice&quot; Script=&quot;&amp;apos;###Loan Detail 1 UDF33
&amp;apos;on Button click option selection
&amp;apos;Creates a Bankruptcy TASK

loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)

&amp;apos;ACTIVE BK TASK lookup
activeBKtsksql = &amp;quot;select count(t.task_refno) from task t, task_template tt, task_status_codes tsc&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;where t.task_template_no = tt.task_template_no and t.status_code_id = tsc.status_code_id&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;and tt.task_template_name in (&amp;apos;BANKRUPTCY&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
&amp;quot;and status_code not in (&amp;apos;BK-DISMISSED&amp;apos;,&amp;apos;BK-COMPLETED&amp;apos;,&amp;apos;BK-INVALID&amp;apos;,&amp;apos;BK-DISSCHARGED&amp;apos;) and nls_refno = &amp;quot; &amp;amp; loanrefno

activeBKtsk = NLSapp.SQLSelectStatement(activeBKtsksql)

&amp;apos;If there are no active BK tasks(Statuses TBD) process request
If  activeBKtsk = 0 Then
    NLSApp.SaveScreen()
    addBKTask (loanrefno)
Else
    NLSApp.Messagebox(&amp;quot;Canceling request.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;This loan already has an active bankruptcy notice in the processing queue.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Please contact the Bankrupcy Administration group.&amp;quot;)
End if 

&amp;apos;-------------------------------------------------------------------------------------
&amp;apos;SUB
Sub addBKTask (loanrefno)
    &amp;apos;LOAN variables
    loanstatus1 = NLSApp.GetField(&amp;quot;LOAN_STATUS&amp;quot;)
    loanstatus2 = NLSApp.GetField(&amp;quot;LOAN_STATUS_SECONDARY&amp;quot;)
    loannumber = NLSApp.GetField(&amp;quot;LOAN_NUMBER&amp;quot;)
    Userno = NLSApp.GetCurrentUserNo( )


    &amp;apos;Task variables
    templateno = TEMPLATE_NUM_BANKRUPTCY
    defaulttskstatus = TEMPLATE_STATUS_BK_NOTICE
    workqueue = TEMPLATE_QUEUE_BANKRUPTCY

    &amp;apos;Who is supplying the notice?
    sourcepromt =    &amp;quot;Who is giving the Bankruptcy Notice?&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;A -  Attorney&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;B -  Borrower and or Co-Borrower&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;C -  Correspondence&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;D -  FirstSweep&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;E -  Other&amp;quot;
    sourcecode = noticesource(UCase(InputBox(sourcepromt, &amp;quot;BK-Notice Source&amp;quot;, &amp;quot;A&amp;quot;)))
    If sourcecode = -1 Then
        NLSApp.MessageBox(&amp;quot;Notice Canceled or Invalid Selection.&amp;quot;  &amp;amp; chr(13) &amp;amp; &amp;quot;Please Try Again.&amp;quot;)
        Exit sub
    End if
    &amp;apos;Atty name and Phone?
    attypromt1 = &amp;quot;Enter The Attorney&amp;apos;s name&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(Optional if you have the Court Case#.)&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_ 
	&amp;quot;Hit [OK] if you have the  Case# but no attorney Information.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;If you do not know either, hit [Cancel].&amp;quot;
    attypromt2 = &amp;quot;Enter The Attorney&amp;apos;s phone number.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(10 digits only.)&amp;quot;
	attypromt3 = &amp;quot;Please enter the court case#.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(Optional if you have entered the attorney&amp;apos;s name.)&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_
	&amp;quot;If you do not have it hit [OK] to proceed or [Cancel] to quit.&amp;quot;
	attypromt4 = &amp;quot;A valid phone# is required when an attorney name is supplied.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Entry MUST be 10 digits and all numeric.&amp;quot;

    attypromt1 = &amp;quot;Enter The Attorney&amp;apos;s name and Click [OK]&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;OR&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_ 
    &amp;quot;Click [OK] if you only know the  Case#.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;If you do not know either, Click [Cancel].&amp;quot;
    attypromt2 = &amp;quot;Enter The Attorney&amp;apos;s phone number.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(10 digits only.)&amp;quot;
    attypromt3 = &amp;quot;Enter the court Case# and Click [OK].&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_
    &amp;quot;If you do not have it, Click [Cancel].&amp;quot;
    attypromt4 = &amp;quot;A valid phone# is required when an attorney name is supplied.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Entry MUST be 10 digits and all numeric.&amp;quot;


    &amp;apos;Either Attorney name or case# is required or the process is aborted   
    attyname = InputBox(attypromt1, &amp;quot;Attorney&amp;quot;, &amp;quot;Enter Attorney&amp;quot;)

    If not attyname = &amp;quot;&amp;quot; and not attyname = &amp;quot;Enter Attorney&amp;quot; Then

        Do
            validphone = 0
            attyphone = InputBox(attypromt2, &amp;quot;Attorney Phone&amp;quot;, &amp;quot;#########&amp;quot;)
            if IsNumeric(attyphone) = True and len(attyphone) = 10 Then
                validphone = 1
            Else

                If MsgBox (attypromt4, 21,&amp;quot;Invalid Phone Number!&amp;quot;) = 2 Then
                    &amp;apos;If user selects [Cancel]
                    NLSApp.Messagebox(&amp;quot;Canceling.&amp;quot;)
                    Exit Sub
                End If
            End if
        Loop until validphone = 1


        caseno = InputBox(attypromt3, &amp;quot;Case #&amp;quot;, &amp;quot;&amp;quot;)
        
        &amp;apos;combine all attorney info into a formatted text string
        AttyInfo = attyname &amp;amp; chr(13) &amp;amp; &amp;quot; (&amp;quot; &amp;amp; left(attyphone,3) &amp;amp; &amp;quot;) &amp;quot; &amp;amp; Mid(attyphone,4,3) &amp;amp; _
        &amp;quot;-&amp;quot; &amp;amp; right(attyphone,4)
    Else
        If attyname = &amp;quot;&amp;quot; Then
            NLSApp.Messagebox(&amp;quot;Canceling.&amp;quot;)
            Exit Sub
        Else
            caseno = InputBox(attypromt3, &amp;quot;Case #&amp;quot;, &amp;quot;&amp;quot;)
        End if
    
    End if   

    If attyname = &amp;quot;Enter Attorney&amp;quot; and caseno = &amp;quot;&amp;quot;  Then
        NLSApp.Messagebox(&amp;quot;Attorney Name and Phone Number OR Case # are required to accept a bankruptcy notice and start the process.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp;&amp;quot;Canceling.&amp;quot;)
        Exit Sub
    End if

    &amp;apos;Get loan borrower and co-borrower detail functions
    borrowerinfo = getborrowercifdetails (loanrefno) &amp;amp;  getborrowerphndetails (loanrefno)
    coborrowerinfo = getcoborrowercifdetails (loanrefno) &amp;amp; getcoborrowerphndetails (loanrefno)
    If coborrowerinfo = &amp;quot;&amp;quot; Then
        coborrowerinfo = &amp;quot;N/A&amp;quot;
    End if 

    &amp;apos;Build the Task
    If not buildBKTask (loanrefno,templateno,defaulttskstatus,workqueue,Userno,sourcecode,borrowerinfo,coborrowerinfo,AttyInfo,caseno) = -1 Then 
        &amp;apos;Add loan status
        NLSApp.SetSecondaryLoanStatus loanrefno,NOW(),LOAN_STATUS_BK_NOTICE,&amp;quot;ADD&amp;quot;
        NLSApp.RefreshScreen()
    End if

End Sub


&amp;apos;-------------------------------------------------------------------------------------
&amp;apos;FUNCTIONS

Function getborrowercifdetails (refno)
&amp;apos;Looks up loan primary contact details (required)
    lookupdetailssql =  &amp;quot;select &amp;apos;Contact Number:  &amp;apos; + c.cifnumber  + char(13) + &amp;apos;Entry Date:  &amp;apos; + convert(char(11),c.setupdate) + char(13)  + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;Name:  &amp;apos; + c.firstname1 + &amp;apos; &amp;apos; +c.lastname1  + char(13)  + street_address1 + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when street_address2 is null Then &amp;apos;&amp;apos; Else  street_address2 +  char(13) end + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;city + &amp;apos;, &amp;apos; +  state + &amp;apos; &amp;apos; + zip +  char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL1 :&amp;apos; + case when c.email is null then &amp;apos;&amp;apos; else c.email end + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL2 :&amp;apos; + case when c.email2 is null then &amp;apos;&amp;apos; else c.email end + char(13) &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.cifno = c.cifno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno

    getborrowercifdetails = NLSapp.SQLSelectStatement(lookupdetailssql)
End function

Function getcoborrowercifdetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select &amp;apos;Contact Number:  &amp;apos; + c.cifnumber  + char(13) + &amp;apos;Entry Date:  &amp;apos; + convert(char(11),c.setupdate) + char(13)  + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;Name:  &amp;apos; + c.firstname1 + &amp;apos; &amp;apos; +c.lastname1  + char(13)  + street_address1 + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when street_address2 is null Then &amp;apos;&amp;apos; Else  street_address2 +  char(13) end + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;city + &amp;apos;, &amp;apos; +  state + &amp;apos; &amp;apos; + zip +  char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL1 :&amp;apos; + case when c.email is null then &amp;apos;&amp;apos; else c.email end + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL2 :&amp;apos; + case when c.email2 is null then &amp;apos;&amp;apos; else c.email end + char(13) &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c, cif_loan_relationship clr &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = clr.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and clr.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno

    getcoborrowercifdetails = NLSapp.SQLSelectStatement(lookupdetailssql)
End function




Function getborrowerphndetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select distinct phone_raw + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when primary_flag = 1 Then &amp;apos; Primary&amp;apos; Else &amp;apos; &amp;apos; + (case when comments is null then &amp;apos;&amp;apos; else comments end) end,primary_flag&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, cif c&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join cif_phone_nums cp&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on  c.cifno = cp.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and len(cp.phone_raw) in (10,12,11)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno &amp;amp; chr(13) &amp;amp; _
        &amp;quot;order by primary_flag desc&amp;quot;

    phoneheader  = chr(13) &amp;amp; &amp;quot;Phone Number(s)/Type&amp;quot;        
    currphn = NLSapp.SQLSelectStatement(lookupdetailssql) 

    If not IsNull(currphn) = True Then
        Do until currphn = &amp;quot;***END OF RESULT***&amp;quot;
        
        phonelist = phonelist &amp;amp; chr(13) &amp;amp; currphn
        currphn = NLSApp.SQLSelectStatementReadNext()
        
	    Loop
	Else
	    phonelist = &amp;quot;N/A&amp;quot;
	End if
    getborrowerphndetails =    phoneheader &amp;amp;  phonelist
   
    
    
End function

Function getcoborrowerphndetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select distinct phone_raw + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when primary_flag = 1 Then &amp;apos; Primary&amp;apos; Else &amp;apos; &amp;apos; + case when comments is null then &amp;apos;&amp;apos; else comments end end,primary_flag&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c, cif_loan_relationship clr &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join cif_phone_nums cp &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on  clr.cifno = cp.cifno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = clr.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and clr.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and len(phone_raw) in (10,12)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno &amp;amp; chr(13) &amp;amp; _
        &amp;quot;order by primary_flag desc&amp;quot;

    phoneheader  = chr(13) &amp;amp; &amp;quot;Phone Number(s)/Type&amp;quot;        
    currphn = NLSapp.SQLSelectStatement(lookupdetailssql) 

    If not IsNull(currphn) = True Then
        Do until currphn = &amp;quot;***END OF RESULT***&amp;quot;
        
        phonelist = phonelist &amp;amp; chr(13) &amp;amp; currphn
        currphn = NLSApp.SQLSelectStatementReadNext()
        
	    Loop
	Else
	    phonelist = &amp;quot;N/A&amp;quot;
	End if
 
    getcoborrowerphndetails = phoneheader &amp;amp;  phonelist
End function

Function buildBKTask (refno,tasktemplateno,status,queue,uidno,source,BoInfo,CoInfo,AttyInfo,filecasealphanum)
    &amp;apos;TASK OBJECT CREATION
        Set Task = NLSApp.Tasks.New(tasktemplateno)
        NLSApp.Tasks.BeginTransaction
        Task.StatusCodeID = status
        Task.NLSRefno = refno
        Task.WorkQueueCodeID = queue
        Task.CreatorUID = uidno
        Task.UDF1 = source
        Task.UDF4 = BoInfo
        Task.UDF5 = CoInfo
        Task.UDF22 = filecasealphanum
        Task.UDF23 = AttyInfo
 
        If (Task.Save = -1) Then
            NLSApp.Tasks.RollbackTransaction
            NLSApp.MessageBox(&amp;quot;Task not created.&amp;quot;)
            buildBKTask = -1
        Else
            NLSApp.Tasks.CommitTransaction
            NLSApp.MessageBox(&amp;quot;Bankruptcy TASK created and added to BK Queue for processing.&amp;quot;)
            buildBKTask = &amp;quot;&amp;quot;
        End If

end Function

Function noticesource(sourcecode)
    Select Case sourcecode
        Case &amp;quot;A&amp;quot;
            source = &amp;quot;Attorney&amp;quot;
        Case &amp;quot;B&amp;quot;
            source = &amp;quot;Customer&amp;quot;        
        Case &amp;quot;C&amp;quot;
            source = &amp;quot;Correspondence&amp;quot;
        Case &amp;quot;D&amp;quot;
            source = &amp;quot;First Sweep&amp;quot;
        Case &amp;quot;E&amp;quot;
            source = &amp;quot;Other&amp;quot;
        Case Else
            source = -1
    End Select
    noticesource = source
End Function&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;246&quot; StaticTopPos=&quot;98&quot; StaticWidth=&quot;85&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;259&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;98&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;50&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="246.0000000000" StaticTopPos="98.0000000000" StaticWidth="85.0000000000" StaticHeight="20.0000000000" FieldLeftPos="259.0000000000" FieldTopPos="29.0000000000" FieldWidth="98.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="50"/>
<USERDEFFIELDS field_id="281" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;367&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;367&quot; FieldWidth=&quot;246&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;51&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="367.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="367.0000000000" FieldWidth="246.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="51"/>
<USERDEFFIELDS field_id="230" field_type="6" field_attribute="4" label_text="Payments" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Change Bank Info&quot; Script=&quot;&quot;/&gt;
&lt;BUTTON Name=&quot;Add/Edit Recurring ACH&quot; Script=&quot;&quot;/&gt;
&lt;BUTTON Name=&quot;Change Investor&quot; Script=&quot;&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;396&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;105&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;395&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;122&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;52&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="396.0000000000" StaticTopPos="10.0000000000" StaticWidth="105.0000000000" StaticHeight="20.0000000000" FieldLeftPos="395.0000000000" FieldTopPos="29.0000000000" FieldWidth="122.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="52"/>
<USERDEFFIELDS field_id="280" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;345&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;345&quot; FieldWidth=&quot;246&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;53&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="345.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="345.0000000000" FieldWidth="246.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="53"/>
<USERDEFFIELDS field_id="229" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;283&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;307&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;54&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="283.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="307.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="54"/>
<USERDEFFIELDS field_id="279" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;485&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;246&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;55&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="244.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="485.0000000000" FieldTopPos="244.0000000000" FieldWidth="246.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="55"/>
<USERDEFFIELDS field_id="228" field_type="2" field_attribute="0" label_text="Modification Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;406&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;406&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;56&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="406.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="406.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="56"/>
<USERDEFFIELDS field_id="278" field_type="1" field_attribute="0" label_text="Decile" min_value="0.0000000000" max_value="10.0000000000" field_precision="0" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;558&quot; StaticTopPos=&quot;163&quot; StaticWidth=&quot;47&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;680&quot; FieldTopPos=&quot;163&quot; FieldWidth=&quot;42&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;57&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="558.0000000000" StaticTopPos="163.0000000000" StaticWidth="47.0000000000" StaticHeight="20.0000000000" FieldLeftPos="680.0000000000" FieldTopPos="163.0000000000" FieldWidth="42.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="57"/>
<USERDEFFIELDS field_id="227" field_type="0" field_attribute="0" label_text="Modification Notes" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;263&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;263&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;140&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;58&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="263.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="263.0000000000" FieldWidth="249.0000000000" FieldHeight="140.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="58"/>
<USERDEFFIELDS field_id="277" field_type="1" field_attribute="0" label_text="Weighted Dollar" min_value="0.0000000000" max_value="9,999,999,999.9800000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;558&quot; StaticTopPos=&quot;141&quot; StaticWidth=&quot;88&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;659&quot; FieldTopPos=&quot;141&quot; FieldWidth=&quot;63&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;59&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="558.0000000000" StaticTopPos="141.0000000000" StaticWidth="88.0000000000" StaticHeight="20.0000000000" FieldLeftPos="659.0000000000" FieldTopPos="141.0000000000" FieldWidth="63.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="59"/>
<USERDEFFIELDS field_id="226" field_type="0" field_attribute="4" label_text="Original Term" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;241&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;241&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;60&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="241.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="241.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="60"/>
<USERDEFFIELDS field_id="276" field_type="1" field_attribute="0" label_text="Propensity To Pay" min_value="0.0000000000" max_value="0.9999900000" field_precision="5" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;558&quot; StaticTopPos=&quot;119&quot; StaticWidth=&quot;96&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;652&quot; FieldTopPos=&quot;119&quot; FieldWidth=&quot;70&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;61&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="558.0000000000" StaticTopPos="119.0000000000" StaticWidth="96.0000000000" StaticHeight="20.0000000000" FieldLeftPos="652.0000000000" FieldTopPos="119.0000000000" FieldWidth="70.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="61"/>
<USERDEFFIELDS field_id="225" field_type="0" field_attribute="4" label_text="Original Payment Amount" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;219&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;219&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;62&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="219.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="219.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="62"/>
<USERDEFFIELDS field_id="275" field_type="6" field_attribute="3" label_text="Cease and Desist" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Activate CnD&quot; Script=&quot;If NLSApp.YesNoMessageBox(&amp;quot;Are you sure you want to Activate a Cease and Desist for this loan?&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;This can only be undone manually.&amp;quot;) Then
	loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
	cifnumber = NLSApp.GetField(&amp;quot;LOAN_CIFNUMBER&amp;quot;)
	cocifnumber = NLSApp.SQLSelectStatement(&amp;quot;SELECT c2.cifnumber , c2.email, c2.email2  from loanacct l, cif c2, cif_loan_relationship clr where c2.cifno = clr.cifno and l.acctrefno = clr.acctrefno and clr.acctrefno = &amp;quot; &amp;amp; loanrefno)
	email1 = NLSApp.SQLSelectStatementNextColumn()
	email2 = NLSApp.SQLSelectStatementNextColumn()
	
	cndsqlupdates = &amp;quot;SELECT 0; &amp;quot; &amp;amp; _
	&amp;quot;UPDATE loanacct_setup SET statement1_code = 0, statement2_code = 0, late_fee_code = 0 WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
	&amp;quot;DELETE from LoanCommunicationAddress WHERE LoanCommunicationPreferencesID IN (SELECT LoanCommunicationPreferencesID FROM LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;UPDATE LoanCommunicationPreferences SET StatementOptionFlags = 0, LateNoticeOptionFlags = 0 from LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
	&amp;quot;UPDATE loanacct SET collection_officer_no = 40	WHERE acctrefno = &amp;quot; &amp;amp; loanrefno
	
	NLSApp.SQLSelectStatement(cndsqlupdates)

	&amp;apos;Add Loan Status change to CEASE AND DESIST ACTIVE
	 loanxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanrefno &amp;amp; _
	 &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;lt;LOANSTATUSES Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;CEASE AND DESIST ACTIVE&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

	ImportXML(loanxmlstring) 
	If Not cocifnumber = &amp;quot;&amp;quot; Then
	 cocifxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cocifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp;  &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
	 ImportXML(cocifxmlstring)
	End if
	NLSApp.MessageBox(&amp;quot;Cease and Desist has been Activated for &amp;quot; &amp;amp; NLSApp.GetField(&amp;quot;LOAN_NUMBER&amp;quot;) &amp;amp; &amp;quot;.&amp;quot;)
	NLSApp.RefreshScreen()
Else
	NLSApp.MessageBox(&amp;quot;CnD Canceled.&amp;quot;)
End if&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;291&quot; StaticTopPos=&quot;19&quot; StaticWidth=&quot;73&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;288&quot; FieldTopPos=&quot;47&quot; FieldWidth=&quot;78&quot; FieldHeight=&quot;26&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;63&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="291.0000000000" StaticTopPos="19.0000000000" StaticWidth="73.0000000000" StaticHeight="20.0000000000" FieldLeftPos="288.0000000000" FieldTopPos="47.0000000000" FieldWidth="78.0000000000" FieldHeight="26.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="63"/>
<USERDEFFIELDS field_id="224" field_type="0" field_attribute="3" label_text="Original Loan Amount" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;197&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;197&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;64&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="197.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="197.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="64"/>
<USERDEFFIELDS field_id="273" field_type="3" field_attribute="0" label_text="Hardship Reason" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;54&quot; StaticTopPos=&quot;471&quot; StaticWidth=&quot;75&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;471&quot; FieldWidth=&quot;208&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;65&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="54.0000000000" StaticTopPos="471.0000000000" StaticWidth="75.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="471.0000000000" FieldWidth="208.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="65">
<USERDEFDATA row_id="2970" field_reference="273" field_data="Increase in unavoidable expenses" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2971" field_reference="273" field_data="Loss of Income" field_order="1" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="223" field_type="0" field_attribute="4" label_text="Original Interest Rate" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;175&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;175&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;66&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="175.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="175.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="66"/>
<USERDEFFIELDS field_id="272" field_type="3" field_attribute="0" label_text="Representative" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**If NLSApp.GetField ( &quot;LOAN_DETAIL2_UDF22&quot;) &lt;&gt; &quot;&quot; Then
 startnewDSoffer()
End If**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;54&quot; StaticTopPos=&quot;514&quot; StaticWidth=&quot;67&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;514&quot; FieldWidth=&quot;147&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;67&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="54.0000000000" StaticTopPos="514.0000000000" StaticWidth="67.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="514.0000000000" FieldWidth="147.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="67"/>
<USERDEFFIELDS field_id="222" field_type="4" field_attribute="0" label_text="Categories" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Categories update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF22 (C+ and F+ Portfolio) Field label name Categories
&apos;                    
&apos; Purpose:
&apos; Designed to maintain correct communications loan pref when borrowerer and coborrower is reported deseased or BK reported or BK confirmed.
&apos;	
&apos; Created: 04/18/2016 by Stanley Muhammad 
&apos; Modification History  06/30/2017 by Stanley Muhammad             
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
LoanDetailudfF22Update()

Sub LoanDetailudfF22Update()
    loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
    loancif = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)
    loanport = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    udf22 = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF22&quot;)
    status = &quot; &quot;

    lateflag = NLSApp.SQLSelectStatement(&quot;select LateNoticeOptionFlags from LoanCommunicationPreferences  where acctrefno =  &quot; &amp; loanref)
    optin =   NLSApp.SQLSelectStatement(&quot;select CASE WHEN l.portfolio_code_id = 0 THEN  ld.userdef18 else ld.userdef17 END from loanacct_detail ld, loanacct l where l.acctrefno = ld.acctrefno and l.acctrefno = &quot; &amp; loanref)
    
    If optin = 1  Then
        alert = &quot;	&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
            &quot;     &lt;ALERT AlertType=&apos;LateNotice&apos; OptionFlags=&apos;1&apos;/&gt; &quot; &amp; chr(13) &amp; _
            &quot;	 &lt;/ALERTS&gt;&quot;
     Else
        alert = &quot;	&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
            &quot;     &lt;ALERT AlertType=&apos;LateNotice&apos; OptionFlags=&apos;3&apos;/&gt; &quot; &amp; chr(13) &amp; _
            &quot;	 &lt;/ALERTS&gt;&quot;
    end if


    If udf22 = &quot;DECEASED CO-BORROWER&quot; Then
    &apos;Delete co-borrower Email address from loan communication preferences
         loancocif = NLSApp.SQLSelectStatement(&quot;select cifno from cif_loan_relationship where acctrefno = &quot; &amp; loanref)
        If loancocif &lt;&gt; &quot;&quot; Then
            coborroweremail = NLSApp.SQLSelectStatement(&quot;SELECT email from cif where cifno = &quot; &amp; loancocif)
            email = &quot;            &lt;EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
            &quot;                &lt;EMAILADDRESS Operation=&apos;DELETE&apos; Address=&apos;&quot; &amp; coborroweremail &amp; &quot;&apos;/&gt;&quot; &amp; chr(13) &amp; _
            &quot;            &lt;/EMAILADDRESSES&gt;&quot;
        End If
    End If

    If udf22 = &quot;DECEASED BORROWER&quot; Then
    &apos;Delete borrower Email address from loan communication preferences
        borroweremail = NLSApp.SQLSelectStatement(&quot;SELECT email from cif where cifnumber = &apos;&quot; &amp; loancif &amp; &quot;&apos;&quot;)
        email = &quot;            &lt;EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
        &quot;                &lt;EMAILADDRESS Operation=&apos;DELETE&apos; Address=&apos;&quot; &amp; borroweremail &amp; &quot;&apos;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;            &lt;/EMAILADDRESSES&gt;&quot;
    End If


    If udf22 = &quot;BK-AWAITING CONFIRMATION&quot; Or udf22 = &quot;BK-CONFIRMED&quot; Then
    &apos;Disable printing, email and SMS options from loan communication preferences
        &apos;status = &quot;   &lt;LOANSTATUSES Operation=&quot;&quot;ADD&quot;&quot; LoanStatusCode=&quot;&quot;DISABLESTMTS&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; now() &amp; &quot;&quot;&quot;/&gt;&quot; ***Future potential enhancement**
        alert = &quot;	&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;     &lt;ALERT AlertType=&apos;LateNotice&apos; OptionFlags=&apos;0&apos;/&gt; &quot; &amp; chr(13) &amp; _
        &quot;	 &lt;/ALERTS&gt;&quot;

    End If

    xmlstrng = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;LOAN UpdateFlag = &apos;1&apos; AcctRefno =&apos;&quot; &amp; loanref &amp; &quot;&apos;&gt;&quot; &amp; chr(13) &amp; _
        status &amp; chr(13) &amp; _
        &quot;   &lt;COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        email &amp; chr(13) &amp; _
        alert &amp; chr(13) &amp; _
        &quot;	&lt;/COMMUNICATION&gt; &quot; &amp; chr(13) &amp; _
        &quot;  &lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

    NLSApp.SaveScreen()

    ImportXML(xmlstrng)

End Sub
&apos;When Field Changes
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click/Box check-uncheck
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions
**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;153&quot; StaticWidth=&quot;101&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;153&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;68&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="153.0000000000" StaticWidth="101.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="153.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="68">
<USERDEFDATA row_id="2918" field_reference="222" field_data="NO RESPONSE" field_order="11" field_data_attribute="0"/>
<USERDEFDATA row_id="2919" field_reference="222" field_data="INTENT TO PAY" field_order="9" field_data_attribute="0"/>
<USERDEFDATA row_id="2920" field_reference="222" field_data="REFUSAL TO PAY" field_order="14" field_data_attribute="0"/>
<USERDEFDATA row_id="2921" field_reference="222" field_data="NONE" field_order="12" field_data_attribute="0"/>
<USERDEFDATA row_id="2922" field_reference="222" field_data="BK-AWAITING CONFIRMATION" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2923" field_reference="222" field_data="BK-CONFIRMED" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2924" field_reference="222" field_data="RAISING FUNDS" field_order="13" field_data_attribute="0"/>
<USERDEFDATA row_id="2925" field_reference="222" field_data="DECEASED BORROWER" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2926" field_reference="222" field_data="DECEASED CO-BORROWER" field_order="4" field_data_attribute="0"/>
<USERDEFDATA row_id="2927" field_reference="222" field_data="REPAYMENT" field_order="15" field_data_attribute="0"/>
<USERDEFDATA row_id="2928" field_reference="222" field_data="DEFAULTED SETTLEMENT/AGREEMENT" field_order="6" field_data_attribute="0"/>
<USERDEFDATA row_id="2929" field_reference="222" field_data="FRAUD/DISPUTE REPORTED" field_order="8" field_data_attribute="0"/>
<USERDEFDATA row_id="2930" field_reference="222" field_data="FRAUD CONFIRMED" field_order="7" field_data_attribute="0"/>
<USERDEFDATA row_id="2931" field_reference="222" field_data="CEASE AND DESIST" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2932" field_reference="222" field_data="DEFAULT 120-HOLD" field_order="5" field_data_attribute="0"/>
<USERDEFDATA row_id="2933" field_reference="222" field_data="KEEPER" field_order="10" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="271" field_type="3" field_attribute="0" label_text="Company" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###** replookup()

Sub replookup()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Adds list of debt settlemtn company representatives associated with selected company for LOAN_DETAIL2_UDF21 to drop down options
    &apos;in LOAN_DETAIL2_UDF22.
    &apos;Triggered when LOAN_DETAIL2_UDF21 field changes.
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;

    currco = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF21&quot;)
    repcountsql = &quot;select count(row_id) from cif c, cif_cif_relationship ccr where c.cifno = ccr.cifno1 and c.company = &apos;&quot; &amp; currco &amp; &quot;&apos;&quot;
    repcount = NLSapp.SQLSelectStatement(repcountsql)
    repnamesql = &quot;select c2.shortname from cif c, cif_cif_relationship ccr, cif c2 &quot; &amp; _
              &quot;where  c.cifno = ccr.cifno1 and c2.cifno = ccr.cifno2 and c.company = &apos;&quot; &amp; currco &amp; &quot;&apos;&quot;
    indexcount = 0
    repname = NLSapp.SQLSelectStatement(repnamesql)     
    indexx =  NLSapp.SQLSelectStatementNextColumn()    

          
    If len(repname) = 0 Then
        NLSApp.MessageBox(&quot;The company, &quot; &amp; currco &amp; &quot;, currently has no representatives assigned to it.&quot; &amp; chr(13) &amp; &quot;Please select another company or go to CONTACTS to add a representative.&quot;)
        Exit Sub
    End If

    Do 
       NLSapp.AddComboString &quot;LOAN_DETAIL2_UDF22&quot;, indexcount, repname

       repname = NLSapp.SQLSelectStatementReadNext()          
       indexx =  NLSapp.SQLSelectStatementNextColumn() 
       indexcount = indexcount + 1
    Loop While CDbl(indexcount) &lt; CDbl(repcount)

End Sub**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**NLSapp.LoadComboList 0, &quot;LOAN_DETAIL2_UDF21&quot;, &quot;select company from cif where cifnumber like &apos;%DSC%&apos;&quot;**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;52&quot; StaticTopPos=&quot;493&quot; StaticWidth=&quot;74&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;492&quot; FieldWidth=&quot;184&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;69&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="52.0000000000" StaticTopPos="493.0000000000" StaticWidth="74.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="492.0000000000" FieldWidth="184.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="69"/>
<USERDEFFIELDS field_id="221" field_type="4" field_attribute="0" label_text="Loan Modification Request" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;###UDF21
&apos;When Field Changes (Start a Loan Modification Request)
&apos;Creates a loan mod TASK

&apos;LOAN variables
loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
loannumber = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
getmodtype = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF21&quot;)
loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)

&apos;Task variables
templateno = TEMPLATE_NUM_LOAN_MODIFICATIONS_II
defaultstatusno = TEMPLATE_STATUS_STARTED
queue = TEMPLATE_QUEUE_MODIFICATIONS

&apos;Change Start a Loan Modification Request field (UDF21) back to default &quot;Choose an Option&quot;
NLSApp.SetField &quot;LOAN_DETAIL1_UDF21&quot;, &quot;Choose an Option&quot;
NLSApp.RefreshScreen()

If Not getmodtype = &quot;Choose an Option&quot; Then
    If addloanMod(getmodtype, loanrefno, loanstatus) = &quot;&quot; Then
    End If
End If
NLSApp.SaveScreen()



Function addloanMod(modtype, loanrefno, status)

    &apos;TASK variables
    currate = NLSApp.SQLSelectStatement(&quot;SELECT convert(varchar(6),convert( numeric(7,2),current_interest_rate))+&apos;%&apos; from loanacct where acctrefno = &quot; &amp; loanrefno)
    currpmt = NLSApp.SQLSelectStatement(&quot;SELECT  &apos;$&apos; + convert(varchar(6),convert( numeric(9,2), next_payment_total_amount)) from loanacct_payment where acctrefno = &quot; &amp; loanrefno)
    currdate = NLSApp.SQLSelectStatement(&quot;select  convert(char(10),getdate(),111)&quot;)
    currdatetime = NOW()
    hardship = &quot;Choose an Option&quot;

    &apos;User input for modification requestor Optins a. borrower, b. co-borrower, c. 3rd party
    requestpromt = &quot;Who is requesting the &quot; &amp; getmodtype &amp; &quot;?&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;A -  Borrower&quot; &amp; chr(13) &amp; &quot;B -  Co-Borrower&quot; &amp; chr(13) &amp; &quot;C -  Third party&quot;
    requestorcode = InputBox(requestpromt, &quot;Requestor&quot;, &quot;A&quot;)

    &apos;Borrower/Co-borrower detail sql lookups
    borrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, loanacct l where l.cifno = c.cifno and l.acctrefno = &quot; &amp; loanrefno
    coborrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, cif_loan_relationship clr where clr.cifno = c.cifno and clr.acctrefno = &quot; &amp; loanrefno

    &apos;Previous approved deferral lookup
    prevdeflookupsql = &quot;SELECT count(t.task_refno) from task t, task_detail td where t.task_refno = td.task_refno AND t.status_code_id = 8 AND t.task_template_no = 7 AND td.userdef01 = &apos;Deferral&apos; AND t.NLS_refno = &quot; &amp; loanrefno
   
   
    Select Case requestorcode
        Case &quot;A&quot;, &quot;a&quot;
            requestor = &quot;Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(borrowerlookupsql)
        Case &quot;B&quot;, &quot;b&quot;
            requestor = &quot;Co-Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(coborrowerlookupsql)
            If requestordetail = &quot;&quot; Then
                NLSApp.MessageBox(&quot;Co-Borrower information cannot be located.&quot; &amp; chr(13) &amp; &quot;Please validate that Co-borrower exists and Retry.&quot;)
                NLSApp.MessageBox(&quot;Operation Canceled.&quot;)
                Exit Function
            End If
        Case &quot;C&quot;, &quot;c&quot;
            requestor = &quot;Third_Party (See Notes)&quot;
            requestordetail = &quot;ENTER 3rd Party details here.&quot;
        Case &quot;&quot;
            NLSApp.MessageBox(&quot;Modification Canceled.&quot;)
            Exit Function
        Case Else
            NLSApp.MessageBox(&quot;Invalid Selection.&quot; &amp; chr(13) &amp; &quot;Please Try Again.&quot;)
            Exit Function
    End Select

    SELECT CASE getmodtype
        CASE &quot;Deferral&quot;
        &apos;Look up the # of previously approved deferrals
            prevdefs = NLSapp.SQLSelectStatement(prevdeflookupsql)
       CASE &quot;SCRA&quot;
       &apos;auto-pop udf2 with SCRA
            hardship = &quot;SCRA&quot;
        END SELECT


    &apos;TASK OBJECT CREATION
    If status = &quot;ACTIVE&quot; Then
        Set Task = NLSApp.Tasks.New(templateno)
        NLSApp.Tasks.BeginTransaction
        Task.StatusCodeID = defaultstatusno
        Task.WorkQueueCodeID = queue
        Task.NLSRefno = loanrefno
        Task.UDF1 = modtype
        Task.UDF2 = hardship
        Task.UDF9 = prevdefs
        Task.UDF10 = currpmt
        Task.UDF12 = currdate
        Task.UDF14 = currate
        Task.UDF18 = requestor
        Task.UDF23 = currdate
        Task.UDF25 = requestordetail

        If (Task.Save = -1) Then
            NLSApp.Tasks.RollbackTransaction
            NLSApp.MessageBox(&quot;Task not created.&quot;)
            addloanMod = -1
        Else
            NLSApp.Tasks.CommitTransaction
            NLSApp.MessageBox(&quot;Loan Modification TASK created.&quot; &amp; Chr(13) &amp; &quot;Please go the the Task Tab to complete the modification record.&quot;)
            addloanMod = &quot;&quot;
        End If
    Else
        NLSApp.MessageBox(&quot;The Loan must be in ACTIVE status to add a Modification task&quot;)
    End If

End Function**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;126&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;20&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;115&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;70&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="10.0000000000" StaticWidth="126.0000000000" StaticHeight="20.0000000000" FieldLeftPos="20.0000000000" FieldTopPos="29.0000000000" FieldWidth="115.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="70">
<USERDEFDATA row_id="2934" field_reference="221" field_data="Deferral" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2935" field_reference="221" field_data="Interest Rate reduction" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2936" field_reference="221" field_data="Lower payment/Term Extention" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2937" field_reference="221" field_data="SCRA" field_order="4" field_data_attribute="0"/>
<USERDEFDATA row_id="2938" field_reference="221" field_data="Choose an Option" field_order="0" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="270" field_type="0" field_attribute="4" label_text="Dollar Score" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;550&quot; StaticTopPos=&quot;53&quot; StaticWidth=&quot;70&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;663&quot; FieldTopPos=&quot;51&quot; FieldWidth=&quot;61&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;71&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="550.0000000000" StaticTopPos="53.0000000000" StaticWidth="70.0000000000" StaticHeight="20.0000000000" FieldLeftPos="663.0000000000" FieldTopPos="51.0000000000" FieldWidth="61.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="71"/>
<USERDEFFIELDS field_id="220" field_type="6" field_attribute="3" label_text="" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Run WC Emails&quot; Script=&quot;If Weekday(NOW()) &amp;lt; 6 Then
     NLSapp.ScriptOn(false)
     FPAutoemailWC()
     NLSapp.ScriptOn(true)
Else 
    NLSApp.MessageBox(&amp;quot;Welcome Call Email Processing only allowed Mon - Thu.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Canceling.&amp;quot;)
End if

Sub FPAutoemailWC()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automate the Welcome Call request FFLS-86, 87, 88 https://billsdev.atlassian.net/browse/FFLS-86, https://billsdev.atlassian.net/browse/FFLS-87, https://billsdev.atlassian.net/browse/FFLS-88
    &amp;apos;Updated via FFLS-265 https://billsdev.atlassian.net/browse/FFLS-265
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    sqlpart2 = &amp;quot;FROM cif_detail cd, cif c Where c.cifno = cd.cifno and c.cifnumber = &amp;apos;SUB WC EMAIL AUTO()&amp;apos;&amp;quot;
    emailfromaddr = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef01 &amp;quot; &amp;amp; sqlpart2)
    serverName = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef02 &amp;quot; &amp;amp; sqlpart2)
    wcloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef18 &amp;quot; &amp;amp; sqlpart2)
    attempt1message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef03  &amp;quot; &amp;amp; sqlpart2)
    attempt2message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef04  &amp;quot; &amp;amp; sqlpart2)
    attempt3message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef05  &amp;quot; &amp;amp; sqlpart2)
    loanstoprocesssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef35  &amp;quot; &amp;amp; sqlpart2)
    loanstoprocess = NLSapp.SQLSelectStatement(loanstoprocesssql)
    loannumb = NLSapp.SQLSelectStatement(wcloanssql)

    processmsg1 = &amp;quot;There are &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans to process at this time.&amp;quot; 
    processmsg2 = &amp;quot;Do you want to process all &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans?&amp;quot;

    &amp;apos;-------Proccessing payload warning-------------------
    &amp;apos;If there are no loans to process, cancel
    &amp;apos;If user selectes to process all available loans, skip user input and got to processing
    &amp;apos;If user selects to process a specific # of loans, Loop input until user selects Cancel
    &amp;apos;    OR entry is a number between 0 and the # of loans available to process
    
    If CDbl(loanstoprocess) &amp;gt;= 1 Then
            If MsgBox(processmsg1 &amp;amp; chr(13) &amp;amp; processmsg2, 4, &amp;quot;WARNING!  Processing payload.&amp;quot;) = 7 Then
                validcnt = 0
                Do
                    processmax = InputBox(invalidText &amp;amp; &amp;quot;Please  Enter the number of loans to Process.&amp;quot;  &amp;amp; chr(13) &amp;amp; &amp;quot;Click Cancel to quit.&amp;quot; , &amp;quot;Set Processing size.&amp;quot;, loanstoprocess)
                    invalidText = &amp;quot;Invalid quantity/value entered.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Entry must be a number between 0 and &amp;quot; &amp;amp; loanstoprocess &amp;amp; chr(13) &amp;amp; chr(13)
	                If processmax &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
                        If isnumeric(processmax) = True Then
                            If CDbl(processmax) &amp;gt; 0 And CDbl(processmax) &amp;lt;= CDbl(loanstoprocess) Then
                                loanstoprocess = processmax
                                validcnt = 1
                            End If
                        End If
                    Else
                         NLSApp.MessageBox(&amp;quot;Canceling Welcome Call processing.&amp;quot;)
                         Exit sub
                    End if
                Loop Until validcnt = 1
            End If
            NLSApp.MessageBox(loanstoprocess &amp;amp; &amp;quot; loans will be processed.&amp;quot;)
    Else
       NLSApp.MessageBox(&amp;quot;There are no loans to process.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Canceling Welcome Call Email processing.&amp;quot;)
    End If
 

     &amp;apos;-------Begin welcome call Proccessing.
     Lcount = 0    
    
     &amp;apos;Repeat process for each loan based on quantity previously selected
     Do Until CDbl(Lcount) = CDbl(loanstoprocess)

         emailtoaddr = NLSApp.SQLSelectStatementNextColumn()
         borrowername = NLSApp.SQLSelectStatementNextColumn()
         Riskcode = NLSApp.SQLSelectStatementNextColumn()
         attemptno = NLSApp.SQLSelectStatementNextColumn()
         emailfromaddr = &amp;quot;customersupport@freedomplus.com&amp;quot;
         serverName = &amp;quot;Servicing FPlus&amp;quot; 
         
         If attemptno = &amp;quot;EMAIL - ATTEMPT 1&amp;quot; Then
             attemptmessage = attempt1message
         End If

         If attemptno = &amp;quot;EMAIL - ATTEMPT 2&amp;quot; Then
             attemptmessage = attempt2message
         End If

         If attemptno = &amp;quot;EMAIL - ATTEMPT 3&amp;quot; Then
             attemptmessage = attempt3message
         End If

         emailbody = &amp;quot;Dear &amp;quot; &amp;amp; borrowername &amp;amp; &amp;quot;,&amp;quot; &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; attemptmessage
         
        &amp;apos;----Send email    
             
        &amp;apos;?????? UnComment next 3rows for testing email sending. Add comments for go-live??????
        &amp;apos;emailtoaddr = &amp;quot;stanley.muhammad@gmail.com&amp;quot;
        &amp;apos;emailfromaddr = &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;
        &amp;apos;serverName = &amp;quot;Loan Servicing3&amp;quot;
        &amp;apos;************************************************************************************
        
        NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody
       &amp;apos; NLSApp.SendEmailMessage serverName, &amp;quot;stanley.muhammad@gmail.com&amp;quot;, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody       
         
        &amp;apos;----Xml import
        &amp;apos;Updates 2 fields in the Loan Detail tab and savesa a comment that represents the text of the email sent

        emailxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANCOMMENTS Date=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot; Category=&amp;quot;&amp;quot;SERVICING NOTES&amp;quot;&amp;quot; CommentDescription=&amp;quot;&amp;quot;WC Activity&amp;quot;&amp;quot; &amp;quot; &amp;amp; _
        &amp;quot;Comment=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; CHR(13) &amp;amp; &amp;quot;SENT TO: &amp;quot; &amp;amp; emailtoaddr &amp;amp; CHR(13) &amp;amp; emailbody &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot; 
        
        ImportXML(emailxml)
        
        &amp;apos;---XML example---- 
        &amp;apos;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
        &amp;apos;&amp;lt;NLS EnforceTagExistence=&amp;quot;1&amp;quot;&amp;gt;
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-001234567&amp;quot;&amp;gt;
        &amp;apos;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;EMAIL - ATTEMPT 3&amp;quot; UserDefined12=&amp;quot;06/21/2017&amp;quot;/&amp;gt;
        &amp;apos;   &amp;lt;LOANCOMMENTS Date=&amp;quot;06/21/2017&amp;quot; Category=&amp;quot;SERVICING NOTES&amp;quot; CommentDescription=&amp;quot;WC Activity&amp;quot;
        &amp;apos;Comment=&amp;quot;EMAIL - ATTEMPT 1
        &amp;apos;SENT TO: nlscontact@ffn.com
        &amp;apos;Dear Brian Smith##,
        &amp;apos;
        &amp;apos;Welcome to FreedomPlus and congratulations on your loan. We would like the opportunity to 
        &amp;apos;speak with you so that we can confirm the details of your newly funded loan and ensure you 
        &amp;apos;have the correct contact information for Customer Service. Please contact us via telephone 
        &amp;apos;at (800) 297-5879 Monday - Friday 7AM - 5PM MST to complete this call. Customer Service can 
        &amp;apos;also be reached via email at customersupport@freedomplus.com, should you have any questions 
        &amp;apos;along the way.
        &amp;apos;
        &amp;apos;Thank you for choosing FreedomPlus. We appreciate your business.
        &amp;apos;
        &amp;apos;Sincerely,
        &amp;apos;
        &amp;apos;FreedomPlus Customer Service&amp;quot;/&amp;gt;
        &amp;apos;  &amp;lt;/LOAN&amp;gt;
        &amp;apos;&amp;lt;/NLS&amp;gt;

         loannumb = NLSApp.SQLSelectStatementReadNext()

         Lcount = Lcount + 1

     Loop
     NLSApp.MessageBox(&amp;quot;Welcome Call Email Processing Completed.&amp;quot;)
End Sub&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;515&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;126&quot; FieldTopPos=&quot;515&quot; FieldWidth=&quot;152&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;72&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="515.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="126.0000000000" FieldTopPos="515.0000000000" FieldWidth="152.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="72"/>
<USERDEFFIELDS field_id="269" field_type="6" field_attribute="3" label_text="" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Set CurrInt to Zero&quot; Script=&quot;loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
&amp;apos;currint = NLSApp.GetField(&amp;quot;LOAN_CURRINTAMT&amp;quot;)
currint = NLSApp.SQLSelectStatement(&amp;quot;SELECT current_interest_balance from loanacct where acctrefno = &amp;quot; &amp;amp; loanrefno )
currpayoff = NLSApp.SQLSelectStatement(&amp;quot;SELECT current_payoff_balance from loanacct where acctrefno = &amp;quot; &amp;amp; loanrefno )

If loanrefno = &amp;quot;&amp;quot; Then
	loanrefno = NLSApp.GetField(&amp;quot;TASK_NLS_REFNO&amp;quot;)
End If

If Not  currint =&amp;lt; .01 Then
    NLSApp.MessageBox(&amp;quot;Current interest on this loan is $&amp;quot; &amp;amp; Round( currint,2) &amp;amp; &amp;quot; and is above the allowable threshhold for this opperation.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;The opperation has been cancelled.&amp;quot;)
Else
    If NLSApp.YesNoMessageBox(&amp;quot;Current Interest on this loan is $&amp;quot; &amp;amp; currint &amp;amp; &amp;quot;.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Are you sure you want to Set interest balance on this loan to ZERO?&amp;quot;) Then
        ZeroCurrentInt(loanrefno)
        NLSApp.MessageBox(&amp;quot;Interest set to zero.&amp;quot;)
    Else
        NLSApp.MessageBox(&amp;quot;Interest unchanged.&amp;quot;)
    end If
End if

If Not  currpayoff =&amp;lt; .02 Then
    NLSApp.MessageBox(&amp;quot;Current Pay Off on this loan is $&amp;quot; &amp;amp; Round(currpayoff,2) &amp;amp; &amp;quot; and is above the allowable threshhold for this opperation.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;The opperation has been cancelled.&amp;quot;)
Else
    If NLSApp.YesNoMessageBox(&amp;quot;Current Pay Off on this loan is $&amp;quot; &amp;amp; currpayoff &amp;amp; &amp;quot;.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Are you sure you want to Set total balance on this loan to ZERO?&amp;quot;) Then
         ZeroCurrentpayOff(loanrefno)
        NLSApp.MessageBox(&amp;quot;Pay Off set to zero.&amp;quot;)
    Else
        NLSApp.MessageBox(&amp;quot;Pay Off unchanged.&amp;quot;)
    end If
End if

Function ZeroCurrentInt(refno)

    NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET current_interest_balance = 0 where acctrefno = &amp;quot; &amp;amp; refno)

End Function

Function ZeroCurrentpayOff(refno)

    NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET current_payoff_balance = 0 where acctrefno = &amp;quot; &amp;amp; refno)

End Function&quot;/&gt;
&lt;BUTTON Name=&quot;importemailtest&quot; Script=&quot;importtest()

Sub importtest()
    acctrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
    importxmltxt = &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                             &amp;quot;   &amp;lt;LOAN  UpdateFlag=&amp;apos;1&amp;apos; AcctRefno=&amp;apos;&amp;quot; &amp;amp; acctrefno &amp;amp; &amp;quot;&amp;apos; &amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp;  _
                             &amp;quot;      &amp;lt;LOANDETAIL2 UserDefined278=&amp;apos;34&amp;apos;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                             &amp;quot;    &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                             &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

    If PendingCompleteClosureImportXML( importxmltxt, acctrefno) = &amp;quot;&amp;quot; Then
emailbody = &amp;quot;Dear &amp;quot; &amp;amp; name &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Your loan now has a $0 balance And the automatic ACH payments have been discontinued.&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;We would Like to thank you for choosing Freedom Plus.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Warmest regards,&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;FreedomPlus Servicing&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Phone: 800-297-5897&amp;quot;

        NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;,&amp;quot;smuhammad@bills.com&amp;quot;, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, &amp;quot;Your loan now has a $0 balance&amp;quot;,emailbody
        NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;,&amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot;, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, &amp;quot;Your loan now has a $0 balance&amp;quot;,emailbody
    End If

    NLSApp.RefreshScreen()

End Sub



Function PendingCompleteClosureImportXML(xml, refno)
    NLSApp.ClearErrorString()

    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            errormsg = NLSApp.GetErrorString()
            subject = &amp;quot;Pending Complete Loan Closure IMPORT FAILURE!&amp;quot;
            toaddress1 = &amp;quot;smuhammad@bills.com&amp;quot;
            toaddress2 =&amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot;
            body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; &amp;quot;Import Error: &amp;quot; &amp;amp; chr(13) &amp;amp; errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp;  &amp;quot;Import text: &amp;quot; &amp;amp; CHR(13) &amp;amp; xml
            NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress1, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
            &amp;apos;NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress2, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
        End If
        PendingCompleteClosureImportXML = errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
    Else
        PendingCompleteClosureImportXML = &amp;quot;&amp;quot;
    End If
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;script user updates&quot; Script=&quot;modupdatesql = &amp;quot;Select 0; Update loanacct_mod_history set mod_uid = 0 where mod_uid = 39 and mod_datestamp &amp;gt; &amp;apos;09/14/17&amp;apos;&amp;quot;  &amp;amp; _
                   &amp;quot;and acctrefno in (163191,163192,163194,163196,163197,163198,163199,163200,163201,163202)&amp;quot;
NLSApp.SQLSelectStatement(modupdatesql )&quot;/&gt;
&lt;BUTTON Name=&quot;emailtest2&quot; Script=&quot;msgbox(NLSapp.SQLSelectStatement(&amp;quot;SELECT email FROM NLSusers where signonid = &amp;apos;&amp;quot; &amp;amp; NLSApp.GetSignedOnID() &amp;amp; &amp;quot;&amp;apos;&amp;quot;))&quot;/&gt;
&lt;BUTTON Name=&quot;transdelcleanup&quot; Script=&quot;transdelsql =&amp;quot;select 0; DELETE From loanacct_trans_history&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;  &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;Where&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;transrefno in ( &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               SELECT &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               top 10&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               transrefno&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               from &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               loanacct_trans_history&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               Where&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               transaction_code in (&amp;apos;541&amp;apos;,&amp;apos;540&amp;apos;,&amp;apos;448&amp;apos;,&amp;apos;452&amp;apos;)&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and transaction_date &amp;gt; = &amp;apos;10/03/17&amp;apos;&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and enteredby_uid &amp;lt;&amp;gt; 0&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and reversal_transrefno &amp;gt; 0&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and acctrefno = 43813 &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               ) &amp;quot; 

&amp;apos;msgbox(transdelsql)
NLSApp.SQLSelectStatement(transdelsql)&quot;/&gt;
&lt;BUTTON Name=&quot;modhistcleanup&quot; Script=&quot;modhistdelsql =&amp;quot;select 0; DELETE From loanacct_mod_history&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;  &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;Where&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;row_id in ( &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               SELECT &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               --top 2&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               row_id&amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               from   &amp;quot; &amp;amp; chr(13)&amp;amp; _                                                            
&amp;quot;               loanacct_mod_history&amp;quot; &amp;amp; chr(13)&amp;amp; _                                                  
&amp;quot;               Where&amp;quot; &amp;amp; chr(13)&amp;amp; _                                                              
&amp;quot;               item_changed like &amp;apos;%status%&amp;apos;&amp;quot; &amp;amp; chr(13)&amp;amp; _                         
&amp;quot;               and (new_value like &amp;apos;%PENDING COMPLETE%&amp;apos; or old_value like &amp;apos;%PENDING COMPLETE%&amp;apos; ) &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and mod_datestamp between &amp;apos;10/04/2017 08:00:00&amp;apos; and &amp;apos;10/04/2017 13:30:00&amp;apos; &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and mod_uid not in (39, 0) &amp;quot; &amp;amp; chr(13)&amp;amp; _
&amp;quot;               and acctrefno = 43813                                                ) &amp;quot; 

msgbox(modhistdelsql)
NLSApp.SQLSelectStatement(modhistdelsql)&quot;/&gt;
&lt;BUTTON Name=&quot;AutoCloseaddCompleted&quot; Script=&quot;AutoCloseaddCompletedX()
NLSApp.MessageBox(&amp;quot;Completed&amp;quot;)

Sub AutoCloseaddCompletedX()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Close Loans in COMPLETE PENDING status for prescribed waiting period or more and queue up ZERO Balance letter for printing or email
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    xmlsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef27 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)

    closurexml = NLSapp.SQLSelectStatement(xmlsql)

    If len(closurexml) = 0 Then
        closurexml = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until closurexml = &amp;quot;***END OF RESULT***&amp;quot;
        refno = NLSapp.SQLSelectStatementNextColumn()
        template = NLSapp.SQLSelectStatementNextColumn()
        SendToQueue = NLSapp.SQLSelectStatementNextColumn()
        emailtoaddr = NLSapp.SQLSelectStatementNextColumn()
        name = NLSapp.SQLSelectStatementNextColumn()

        If PendingCompleteClosureImportXML(closurexml, refno) = &amp;quot;&amp;quot; Then

        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                           
        &amp;apos;  &amp;lt;TRANSACTIONS&amp;gt;                                                                                                
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;462&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot; LoanNumber=&amp;quot;APP-00999999&amp;quot; Amount=&amp;quot;537.43&amp;quot; /&amp;gt;
        &amp;apos;  &amp;lt;/TRANSACTIONS&amp;gt;                                                                                               
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-00999999&amp;quot; LoanStatusCode=&amp;quot;CLOSED&amp;quot; ClosedDate=&amp;quot;07/21/17&amp;quot; &amp;gt;                
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;DELETE&amp;quot; LoanStatusCode=&amp;quot;PENDING COMPLETE&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;               
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;ADD&amp;quot; LoanStatusCode=&amp;quot;COMPLETED&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;                         
        &amp;apos;  &amp;lt;/LOAN&amp;gt;                                                                                                       
        &amp;apos;&amp;lt;/NLS&amp;gt;


            Set DT = NLSApp.GetDocumentTemplates(template)
            DT.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;

           &amp;apos; commentupdatesql = &amp;quot;Select 0; update loanacct_comments set created_by = 0,userdef01 = &amp;apos;Outbound&amp;apos;,userdef02 = &amp;apos;Zero Balance Letter&amp;apos;,userdef03 = &amp;apos;Email&amp;apos; &amp;quot; &amp;amp; _
           &amp;apos; &amp;quot;where comment_description in (&amp;apos;CPLUS ZERO BALANCE LETTER&amp;apos;,&amp;apos;FPLUS ZERO BALANCE LETTER&amp;apos;) &amp;quot; &amp;amp; _
           &amp;apos; &amp;quot;and created_by &amp;lt;&amp;gt; 0 and created &amp;gt; left(getdate(),11) and acctrefno = &amp;quot; &amp;amp; refno
            
           &amp;apos; nlsapp.sqlselectstatement(commentupdatesql)

            If SendToQueue = &amp;quot;FALSE&amp;quot; Then
                If template = 5 Then
                    emailbody = &amp;quot;Dear &amp;quot; &amp;amp; name &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Your loan now has a $0 balance And the automatic ACH payments have been discontinued.&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;We would Like to thank you for choosing Freedom Plus.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Warmest regards,&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;FreedomPlus Servicing&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Phone: 800-297-5897&amp;quot;

                    NLSApp.SendEmailMessage &amp;quot;Servicing FPlus&amp;quot;, emailtoaddr, &amp;quot;customersupport@freedomplus.com&amp;quot;, &amp;quot;Your loan now has a $0 balance&amp;quot;, emailbody 
                 End If
                If template = 6 Then
                    emailbody = &amp;quot;Dear &amp;quot; &amp;amp; name &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Your loan now has a $0 balance And the automatic ACH payments have been discontinued.&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;We would Like to thank you for choosing Concolidation Plus.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Warmest regards,&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Consolidation Plus Servicing&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Phone: 1-888-950-4829&amp;quot;

                    NLSApp.SendEmailMessage &amp;quot;Servicing CPlus&amp;quot;, emailtoaddr, &amp;quot;consolplus-servicing@consolplus.com&amp;quot;, &amp;quot;Your loan now has a $0 balance&amp;quot;, emailbody 
                 End If

            End If
        Else
            &amp;apos;PLACEHOLDER
            &amp;apos;NLSApp.MessageBox(&amp;quot;There was a problem with refno &amp;quot; &amp;amp;  refno &amp;amp; &amp;quot;.&amp;quot;)
        End If
        closurexml = NLSApp.SQLSelectStatementReadNext()
        If NLSApp.GetCurrentUserNo() = 39 Then
            &amp;apos;NLSApp.MessageBox(closurexml)
        End If
    Loop

            commentupdatesql = &amp;quot;Select 0; update loanacct_comments set created_by = 0,userdef01 = &amp;apos;Outbound&amp;apos;,userdef02 = &amp;apos;Zero Balance Letter&amp;apos;,userdef03 = &amp;apos;Email&amp;apos; &amp;quot; &amp;amp; _
            &amp;quot;where comment_description in (&amp;apos;CPLUS ZERO BALANCE LETTER&amp;apos;,&amp;apos;FPLUS ZERO BALANCE LETTER&amp;apos;) &amp;quot; &amp;amp; _
            &amp;quot;and created_by &amp;lt;&amp;gt; 0 and created &amp;gt;= left(getdate(),11)&amp;quot;
            
            nlsapp.sqlselectstatement(commentupdatesql)

    &amp;apos;Update last/Next Run datetime and Last user record
    Runstamp = NOW()
    NextRun = Date() + 1 &amp;amp; &amp;quot; 8:00:00 AM&amp;quot;
    NextRun =NOW()
    UID = NLSApp.GetCurrentUserNo()

    Cifupdate = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;apos;1&amp;apos;CIFNumber=&amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;gt;&amp;lt;CIFDETAIL CIFDetail6=&amp;apos;Next Run: &amp;quot; &amp;amp; NextRun &amp;amp; &amp;quot;&amp;apos; CIFDetail7=&amp;apos;Last Run: &amp;quot; &amp;amp; Runstamp &amp;amp; &amp;quot;&amp;apos; CIFDetail8=&amp;apos; UserID: &amp;quot; &amp;amp; UID &amp;amp; &amp;quot;&amp;apos; /&amp;gt;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

    ImportXML(Cifupdate)

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;addupdates&quot; Script=&quot;NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_mod_history SET mod_uid = 0, modification_description = &amp;apos;//VBScript// &amp;apos;+ char(13) + modification_description where row_id = 2686903&amp;quot;)
&quot;/&gt;
&lt;BUTTON Name=&quot;newWOaddPendComm&quot; Script=&quot;AutoWOaddCompletePendingx()

Sub AutoWOaddCompletePendingx()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automatic Write-off loan balances $10 or less set loan status to COMPLETE PENDING
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    userno = NLSApp.GetCurrentUserNo()
    authuser = NLSapp.SQLSelectStatement(&amp;quot;select convert(varchar(12),groupno) from nlsgroupmembers where userno = &amp;quot; &amp;amp; userno &amp;amp; &amp;quot; and groupno IN (11)&amp;quot;)
    &amp;apos;Current Authrized User group(s) 11-Admin

    lookupallloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)
    lookuponeloansql =  lookupallloanssql &amp;amp; Chr(13) &amp;amp; &amp;quot;and l.acctrefno in (&amp;quot; &amp;amp; NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;  
    lookupsql = lookuponeloansql
    
    &amp;apos;Members of authorized user groups can opt to process all eligible loans
    If authuser &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
        &amp;apos;If NLSApp.YseNoMessageBox(&amp;quot;Select Yes to process all available loans.&amp;quot;) Then 
            lookupsql = lookupallloanssql
        &amp;apos;End If           
    End If
 
    writeoffxml = NLSapp.SQLSelectStatement(lookupsql)

    If len(writeoffxml) = 0 Then
        writeoffxml = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until writeoffxml = &amp;quot;***END OF RESULT***&amp;quot;
        refno = NLSapp.SQLSelectStatementNextColumn()
        refnolist = refnolist &amp;amp; refno &amp;amp; &amp;quot;, &amp;quot;

       AddWOandPendingComplete(writeoffxml &amp;amp; refno)
        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                         
        &amp;apos;  &amp;lt;TRANSACTIONS&amp;gt;                                                                                              
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;540&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;544&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;448&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;452&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;                        
        &amp;apos;  &amp;lt;/TRANSACTIONS&amp;gt;                                                                                             
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot;&amp;gt;                                                             
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;ADD&amp;quot; LoanStatusCode=&amp;quot;PENDING COMPLETE&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;
        &amp;apos;    &amp;lt;LOANCOMMENTS Comment=&amp;quot;Remaining loan balance written-off due to balance below $10. &amp;quot; Category=&amp;quot;SERVICING NOTES&amp;quot; CommentDescription=&amp;quot;Balance write-off&amp;quot; CreatedBy=&amp;quot;0&amp;quot;/&amp;gt;              
        &amp;apos;  &amp;lt;/LOAN&amp;gt;                                                                                                     
        &amp;apos;&amp;lt;/NLS&amp;gt;

        writeoffxml = NLSApp.SQLSelectStatementReadNext()

    Loop

        refnolist = &amp;quot;(&amp;quot; &amp;amp; Left(refnolist, Len(refnolist) - 2) &amp;amp; &amp;quot;)&amp;quot;

    &amp;apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    If SetAdminuser(refnolist) = -1 Then
       subject = &amp;quot;Pending Complete Admin update FAILURE!&amp;quot;
       toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
       body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Update Error setting script user to Admin. Please investigate.&amp;quot;
       NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
    End If
    
End Sub

Function AddWOandPendingComplete(xml)
    NLSApp.ClearErrorString()
    endmark =  &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
    refno = Mid(xml, InStr(xml, endmark) + len(endmark), len(xml) - InStr(xml, endmark) + len(endmark))
    
    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            errormsg = NLSApp.GetErrorString()
            subject = &amp;quot;Pending Complete Loan Closure process IMPORT FAILURE!&amp;quot;
            toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
            body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Import Error: &amp;quot; &amp;amp; chr(13) &amp;amp; errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
            NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
        End If
        AddWOandPendingComplete = errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
    Else
        &amp;apos; NLSApp.MessageBox(&amp;quot;&amp;quot;)
        AddWOandPendingComplete = &amp;quot;&amp;quot;
    End If
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;deletes task data&quot; Script=&quot;NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 3116 DELETE from task_detail where task_refno = 3116 DELETE from task_comments where task_refno = 3116&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8567 DELETE from task_detail where task_refno = 8567 DELETE from task_comments where task_refno = 8567&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4558 DELETE from task_detail where task_refno = 4558 DELETE from task_comments where task_refno = 4558&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4608 DELETE from task_detail where task_refno = 4608 DELETE from task_comments where task_refno = 4608&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 6393 DELETE from task_detail where task_refno = 6393 DELETE from task_comments where task_refno = 6393&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4768 DELETE from task_detail where task_refno = 4768 DELETE from task_comments where task_refno = 4768&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8367 DELETE from task_detail where task_refno = 8367 DELETE from task_comments where task_refno = 8367&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8365 DELETE from task_detail where task_refno = 8365 DELETE from task_comments where task_refno = 8365&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8366 DELETE from task_detail where task_refno = 8366 DELETE from task_comments where task_refno = 8366&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7822 DELETE from task_detail where task_refno = 7822 DELETE from task_comments where task_refno = 7822&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8156 DELETE from task_detail where task_refno = 8156 DELETE from task_comments where task_refno = 8156&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8332 DELETE from task_detail where task_refno = 8332 DELETE from task_comments where task_refno = 8332&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7967 DELETE from task_detail where task_refno = 7967 DELETE from task_comments where task_refno = 7967&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7968 DELETE from task_detail where task_refno = 7968 DELETE from task_comments where task_refno = 7968&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5720 DELETE from task_detail where task_refno = 5720 DELETE from task_comments where task_refno = 5720&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7885 DELETE from task_detail where task_refno = 7885 DELETE from task_comments where task_refno = 7885&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5257 DELETE from task_detail where task_refno = 5257 DELETE from task_comments where task_refno = 5257&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5258 DELETE from task_detail where task_refno = 5258 DELETE from task_comments where task_refno = 5258&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5259 DELETE from task_detail where task_refno = 5259 DELETE from task_comments where task_refno = 5259&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5265 DELETE from task_detail where task_refno = 5265 DELETE from task_comments where task_refno = 5265&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8717 DELETE from task_detail where task_refno = 8717 DELETE from task_comments where task_refno = 8717&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7796 DELETE from task_detail where task_refno = 7796 DELETE from task_comments where task_refno = 7796&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7933 DELETE from task_detail where task_refno = 7933 DELETE from task_comments where task_refno = 7933&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8109 DELETE from task_detail where task_refno = 8109 DELETE from task_comments where task_refno = 8109&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8053 DELETE from task_detail where task_refno = 8053 DELETE from task_comments where task_refno = 8053&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7691 DELETE from task_detail where task_refno = 7691 DELETE from task_comments where task_refno = 7691&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7692 DELETE from task_detail where task_refno = 7692 DELETE from task_comments where task_refno = 7692&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7693 DELETE from task_detail where task_refno = 7693 DELETE from task_comments where task_refno = 7693&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7837 DELETE from task_detail where task_refno = 7837 DELETE from task_comments where task_refno = 7837&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8058 DELETE from task_detail where task_refno = 8058 DELETE from task_comments where task_refno = 8058&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7851 DELETE from task_detail where task_refno = 7851 DELETE from task_comments where task_refno = 7851&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7939 DELETE from task_detail where task_refno = 7939 DELETE from task_comments where task_refno = 7939&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8483 DELETE from task_detail where task_refno = 8483 DELETE from task_comments where task_refno = 8483&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7941 DELETE from task_detail where task_refno = 7941 DELETE from task_comments where task_refno = 7941&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7942 DELETE from task_detail where task_refno = 7942 DELETE from task_comments where task_refno = 7942&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7943 DELETE from task_detail where task_refno = 7943 DELETE from task_comments where task_refno = 7943&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7994 DELETE from task_detail where task_refno = 7994 DELETE from task_comments where task_refno = 7994&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7831 DELETE from task_detail where task_refno = 7831 DELETE from task_comments where task_refno = 7831&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8252 DELETE from task_detail where task_refno = 8252 DELETE from task_comments where task_refno = 8252&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7834 DELETE from task_detail where task_refno = 7834 DELETE from task_comments where task_refno = 7834&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4826 DELETE from task_detail where task_refno = 4826 DELETE from task_comments where task_refno = 4826&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8008 DELETE from task_detail where task_refno = 8008 DELETE from task_comments where task_refno = 8008&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8379 DELETE from task_detail where task_refno = 8379 DELETE from task_comments where task_refno = 8379&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8380 DELETE from task_detail where task_refno = 8380 DELETE from task_comments where task_refno = 8380&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8502 DELETE from task_detail where task_refno = 8502 DELETE from task_comments where task_refno = 8502&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5874 DELETE from task_detail where task_refno = 5874 DELETE from task_comments where task_refno = 5874&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5996 DELETE from task_detail where task_refno = 5996 DELETE from task_comments where task_refno = 5996&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5997 DELETE from task_detail where task_refno = 5997 DELETE from task_comments where task_refno = 5997&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8264 DELETE from task_detail where task_refno = 8264 DELETE from task_comments where task_refno = 8264&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7629 DELETE from task_detail where task_refno = 7629 DELETE from task_comments where task_refno = 7629&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7704 DELETE from task_detail where task_refno = 7704 DELETE from task_comments where task_refno = 7704&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7249 DELETE from task_detail where task_refno = 7249 DELETE from task_comments where task_refno = 7249&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5482 DELETE from task_detail where task_refno = 5482 DELETE from task_comments where task_refno = 5482&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5892 DELETE from task_detail where task_refno = 5892 DELETE from task_comments where task_refno = 5892&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5157 DELETE from task_detail where task_refno = 5157 DELETE from task_comments where task_refno = 5157&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5158 DELETE from task_detail where task_refno = 5158 DELETE from task_comments where task_refno = 5158&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8803 DELETE from task_detail where task_refno = 8803 DELETE from task_comments where task_refno = 8803&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8804 DELETE from task_detail where task_refno = 8804 DELETE from task_comments where task_refno = 8804&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7739 DELETE from task_detail where task_refno = 7739 DELETE from task_comments where task_refno = 7739&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7756 DELETE from task_detail where task_refno = 7756 DELETE from task_comments where task_refno = 7756&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8738 DELETE from task_detail where task_refno = 8738 DELETE from task_comments where task_refno = 8738&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8043 DELETE from task_detail where task_refno = 8043 DELETE from task_comments where task_refno = 8043&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7561 DELETE from task_detail where task_refno = 7561 DELETE from task_comments where task_refno = 7561&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7562 DELETE from task_detail where task_refno = 7562 DELETE from task_comments where task_refno = 7562&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7714 DELETE from task_detail where task_refno = 7714 DELETE from task_comments where task_refno = 7714&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4612 DELETE from task_detail where task_refno = 4612 DELETE from task_comments where task_refno = 4612&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8698 DELETE from task_detail where task_refno = 8698 DELETE from task_comments where task_refno = 8698&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7548 DELETE from task_detail where task_refno = 7548 DELETE from task_comments where task_refno = 7548&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4690 DELETE from task_detail where task_refno = 4690 DELETE from task_comments where task_refno = 4690&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4614 DELETE from task_detail where task_refno = 4614 DELETE from task_comments where task_refno = 4614&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4595 DELETE from task_detail where task_refno = 4595 DELETE from task_comments where task_refno = 4595&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8508 DELETE from task_detail where task_refno = 8508 DELETE from task_comments where task_refno = 8508&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4693 DELETE from task_detail where task_refno = 4693 DELETE from task_comments where task_refno = 4693&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8753 DELETE from task_detail where task_refno = 8753 DELETE from task_comments where task_refno = 8753&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5355 DELETE from task_detail where task_refno = 5355 DELETE from task_comments where task_refno = 5355&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4792 DELETE from task_detail where task_refno = 4792 DELETE from task_comments where task_refno = 4792&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8495 DELETE from task_detail where task_refno = 8495 DELETE from task_comments where task_refno = 8495&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8209 DELETE from task_detail where task_refno = 8209 DELETE from task_comments where task_refno = 8209&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8606 DELETE from task_detail where task_refno = 8606 DELETE from task_comments where task_refno = 8606&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8001 DELETE from task_detail where task_refno = 8001 DELETE from task_comments where task_refno = 8001&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 6759 DELETE from task_detail where task_refno = 6759 DELETE from task_comments where task_refno = 6759&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8033 DELETE from task_detail where task_refno = 8033 DELETE from task_comments where task_refno = 8033&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5474 DELETE from task_detail where task_refno = 5474 DELETE from task_comments where task_refno = 5474&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5092 DELETE from task_detail where task_refno = 5092 DELETE from task_comments where task_refno = 5092&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5093 DELETE from task_detail where task_refno = 5093 DELETE from task_comments where task_refno = 5093&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5094 DELETE from task_detail where task_refno = 5094 DELETE from task_comments where task_refno = 5094&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5826 DELETE from task_detail where task_refno = 5826 DELETE from task_comments where task_refno = 5826&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8798 DELETE from task_detail where task_refno = 8798 DELETE from task_comments where task_refno = 8798&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8808 DELETE from task_detail where task_refno = 8808 DELETE from task_comments where task_refno = 8808&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 6946 DELETE from task_detail where task_refno = 6946 DELETE from task_comments where task_refno = 6946&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7900 DELETE from task_detail where task_refno = 7900 DELETE from task_comments where task_refno = 7900&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7768 DELETE from task_detail where task_refno = 7768 DELETE from task_comments where task_refno = 7768&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4778 DELETE from task_detail where task_refno = 4778 DELETE from task_comments where task_refno = 4778&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8642 DELETE from task_detail where task_refno = 8642 DELETE from task_comments where task_refno = 8642&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5065 DELETE from task_detail where task_refno = 5065 DELETE from task_comments where task_refno = 5065&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5104 DELETE from task_detail where task_refno = 5104 DELETE from task_comments where task_refno = 5104&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5310 DELETE from task_detail where task_refno = 5310 DELETE from task_comments where task_refno = 5310&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7762 DELETE from task_detail where task_refno = 7762 DELETE from task_comments where task_refno = 7762&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8518 DELETE from task_detail where task_refno = 8518 DELETE from task_comments where task_refno = 8518&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8106 DELETE from task_detail where task_refno = 8106 DELETE from task_comments where task_refno = 8106&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 6556 DELETE from task_detail where task_refno = 6556 DELETE from task_comments where task_refno = 6556&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8479 DELETE from task_detail where task_refno = 8479 DELETE from task_comments where task_refno = 8479&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7414 DELETE from task_detail where task_refno = 7414 DELETE from task_comments where task_refno = 7414&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7672 DELETE from task_detail where task_refno = 7672 DELETE from task_comments where task_refno = 7672&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 6905 DELETE from task_detail where task_refno = 6905 DELETE from task_comments where task_refno = 6905&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8321 DELETE from task_detail where task_refno = 8321 DELETE from task_comments where task_refno = 8321&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4625 DELETE from task_detail where task_refno = 4625 DELETE from task_comments where task_refno = 4625&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8547 DELETE from task_detail where task_refno = 8547 DELETE from task_comments where task_refno = 8547&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8693 DELETE from task_detail where task_refno = 8693 DELETE from task_comments where task_refno = 8693&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7425 DELETE from task_detail where task_refno = 7425 DELETE from task_comments where task_refno = 7425&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8468 DELETE from task_detail where task_refno = 8468 DELETE from task_comments where task_refno = 8468&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8201 DELETE from task_detail where task_refno = 8201 DELETE from task_comments where task_refno = 8201&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7131 DELETE from task_detail where task_refno = 7131 DELETE from task_comments where task_refno = 7131&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8141 DELETE from task_detail where task_refno = 8141 DELETE from task_comments where task_refno = 8141&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 4845 DELETE from task_detail where task_refno = 4845 DELETE from task_comments where task_refno = 4845&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8452 DELETE from task_detail where task_refno = 8452 DELETE from task_comments where task_refno = 8452&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8020 DELETE from task_detail where task_refno = 8020 DELETE from task_comments where task_refno = 8020&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8213 DELETE from task_detail where task_refno = 8213 DELETE from task_comments where task_refno = 8213&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8199 DELETE from task_detail where task_refno = 8199 DELETE from task_comments where task_refno = 8199&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8443 DELETE from task_detail where task_refno = 8443 DELETE from task_comments where task_refno = 8443&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7753 DELETE from task_detail where task_refno = 7753 DELETE from task_comments where task_refno = 7753&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7754 DELETE from task_detail where task_refno = 7754 DELETE from task_comments where task_refno = 7754&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8329 DELETE from task_detail where task_refno = 8329 DELETE from task_comments where task_refno = 8329&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7679 DELETE from task_detail where task_refno = 7679 DELETE from task_comments where task_refno = 7679&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8269 DELETE from task_detail where task_refno = 8269 DELETE from task_comments where task_refno = 8269&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8270 DELETE from task_detail where task_refno = 8270 DELETE from task_comments where task_refno = 8270&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8273 DELETE from task_detail where task_refno = 8273 DELETE from task_comments where task_refno = 8273&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8280 DELETE from task_detail where task_refno = 8280 DELETE from task_comments where task_refno = 8280&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 7568 DELETE from task_detail where task_refno = 7568 DELETE from task_comments where task_refno = 7568&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5627 DELETE from task_detail where task_refno = 5627 DELETE from task_comments where task_refno = 5627&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8679 DELETE from task_detail where task_refno = 8679 DELETE from task_comments where task_refno = 8679&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8051 DELETE from task_detail where task_refno = 8051 DELETE from task_comments where task_refno = 8051&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8437 DELETE from task_detail where task_refno = 8437 DELETE from task_comments where task_refno = 8437&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8231 DELETE from task_detail where task_refno = 8231 DELETE from task_comments where task_refno = 8231&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8396 DELETE from task_detail where task_refno = 8396 DELETE from task_comments where task_refno = 8396&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8026 DELETE from task_detail where task_refno = 8026 DELETE from task_comments where task_refno = 8026&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8005 DELETE from task_detail where task_refno = 8005 DELETE from task_comments where task_refno = 8005&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8203 DELETE from task_detail where task_refno = 8203 DELETE from task_comments where task_refno = 8203&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8344 DELETE from task_detail where task_refno = 8344 DELETE from task_comments where task_refno = 8344&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 8633 DELETE from task_detail where task_refno = 8633 DELETE from task_comments where task_refno = 8633&amp;quot;)
NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE task Set nls_refno = NULL where task_refno = 5171 DELETE from task_detail where task_refno = 5171 DELETE from task_comments where task_refno = 5171&amp;quot;)

&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;589&quot; FieldTopPos=&quot;460&quot; FieldWidth=&quot;97&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;73&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="24.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="589.0000000000" FieldTopPos="460.0000000000" FieldWidth="97.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="73"/>
<USERDEFFIELDS field_id="219" field_type="2" field_attribute="0" label_text="Investor Transfer Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Detail 2 UDF45 update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF16(C+)  and Loan Detail 1 UDF29(F+) Field label name Investor sale date
&apos;                    
&apos; Purpose:
&apos; Designed to maintain detail2 udef45 in sync with loan ach_co set up for the purpose of assuring the webpaay portal can see the current code for each new online reqiest.
&apos;	
&apos; Created: 07/18/2017 by Stanley Muhammad 
&apos; Modification History  NA

	class_2 = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
	port =  NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
	&apos;ACH_no = ACHCoIDUDF45(class_2,port)
	Curr_ACH_Co_UDF45 = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF45&quot;)
	If  ACH_no &lt;&gt; Curr_ACH_Co_UDF45  Then
		NLSApp.SetField &quot;LOAN_DETAIL2_UDF45&quot;, ACH_no
	End If

&apos;When Field Changes
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click/Box check-uncheck
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions**###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;461&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;127&quot; FieldTopPos=&quot;461&quot; FieldWidth=&quot;249&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;74&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="461.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="127.0000000000" FieldTopPos="461.0000000000" FieldWidth="249.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="74"/>
<USERDEFFIELDS field_id="268" field_type="5" field_attribute="4" label_text="Settlement POA Received" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;448&quot; StaticWidth=&quot;103&quot; StaticHeight=&quot;23&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;449&quot; FieldWidth=&quot;85&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;75&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="448.0000000000" StaticWidth="103.0000000000" StaticHeight="23.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="449.0000000000" FieldWidth="85.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="75"/>
<USERDEFFIELDS field_id="218" field_type="5" field_attribute="0" label_text="Mail Paper Statements" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Mail Paper Statement checkbox update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF18 (Plus Portfolio)
&apos;                    
&apos; Purpose:
&apos; Designed to keep the CIF MailPaperstatement check box always in sync with the loan Mail Paper Statement checkbox.
&apos;
&apos; Created: 04/18/20126 by Stanley Muhammad 
&apos; Modification History    05/26/16      By    SM       
&apos; Modification History    06/26/16      By    SM  
&apos; Modification History    09/25/18      By    SM    
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
ELCommUpdate()

Sub ELCommUpdate()
    loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
    loancif = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)
    loanport = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    loancifno = NLSApp.SQLSelectStatement(&quot;SELECT cast(cifno as varchar) from cif where cifnumber = &apos;&quot; &amp; loancif &amp; &quot;&apos;&quot;)
    email1 = NLSApp.SQLSelectStatement(&quot;SELECT email,email2 from cif where cifnumber = &apos;&quot; &amp; loancif &amp; &quot;&apos;&quot;)
    email2 = NLSapp.SQLSelectStatementNextColumn()
    &apos;msgbox(loanport)
    If loanport = &quot;PLUS PORTFOLIO&quot; Then
        statement2 = &quot;NONE&quot;
        boxchecked = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF18&quot;)
        cifboxchecked = &quot;CIFDetail7&quot;
    Else
        statement2 = &quot;NONE&quot;
        boxchecked = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF17&quot;)
        cifboxchecked = &quot;CIFDetail3&quot;
    End If

    If boxchecked = &quot;CHECK&quot; Then
            boxvalue = &quot;1&quot;
            OptionFlagS = &quot;1&quot;
            OptionFlagL = &quot;1&quot;
    Else
        If not email1 = &quot;&quot; Then
            boxvalue = &quot;0&quot;
            OptionFlagS = &quot;2&quot;
            OptionFlagL = &quot;2&quot;
            statement2 = &quot;NONE&quot;
        Else
            If NLSApp.YesNoMessageBox(&quot;NO EMAIL ADDRESS ON RECORD.&quot; &amp; chr(10) &amp; &quot;You cannot end MAIL ONLY without adding an email address First.&quot; &amp;  chr(10)&amp; chr(10) &amp; &quot;Do you want to add one now?&quot;) then
                newemail = addnewemail(loancif,1)
                If newemail = &quot;&quot; Then
                    canceladdemail loanport, loanref
                Else
                    OptionFlagS = &quot;2&quot;
                    NLSapp.AddModificationHistory 1, loanref, curremail1,newemail, &quot;Primary Email&quot;
                    NLSapp.AddModificationHistory 0, loancifno, curremail1,newemail, &quot;Primary Email (from loan detail1)&quot;
                End If
            Else 
                canceladdemail loanport, loanref
                Exit sub
            End if
        End if
    End If

    xmlstrng1 = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;CIF UpdateFlag =&quot;&quot;1&quot;&quot; CIFNumber = &quot;&quot;&quot; &amp; loancif &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;CIFDETAIL &quot; &amp; cifboxchecked &amp; &quot; = &quot;&quot;&quot; &amp; boxvalue &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;/CIF&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;
   xmlstrng2 = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;LOAN UpdateFlag = &quot;&quot;1&quot;&quot; AcctRefno =&quot;&quot;&quot; &amp; loanref &amp; &quot;&quot;&quot; &gt;&quot; &amp; chr(13) &amp; _
        &quot;   &lt;COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;     &lt;ALERT AlertType=&quot;&quot;Statement&quot;&quot; OptionFlags=&quot;&quot;&quot; &amp; OptionFlagS &amp; &quot;&quot;&quot;/&gt; &quot; &amp; chr(13) &amp; _
        &quot;     &lt;/ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;/COMMUNICATION&gt; &quot; &amp; chr(13) &amp; _
        &quot;  &lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

    &apos; &quot;    &apos;&lt;ALERT AlertType=&quot;&quot;LateNotice&quot;&quot; OptionFlags=&quot;&quot;&quot; &amp; OptionFlagL &amp; &quot;&quot;&quot;/&gt; &quot; &amp; chr(13) &amp; _
    &apos;msgbox(xmlstrng2)

    NLSApp.SaveScreen()

    ImportXML(xmlstrng1)
    ImportXML(xmlstrng2)
End Sub
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions

**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;480&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;127&quot; FieldTopPos=&quot;480&quot; FieldWidth=&quot;251&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;76&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="480.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="127.0000000000" FieldTopPos="480.0000000000" FieldWidth="251.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="76"/>
<USERDEFFIELDS field_id="267" field_type="3" field_attribute="0" label_text="Company" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**NLSapp.LoadComboList 0, &quot;LOAN_DETAIL2_UDF17&quot;, &quot;select company from cif where cifnumber like &apos;%DSC%&apos;&quot;**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;148&quot; StaticTopPos=&quot;302&quot; StaticWidth=&quot;43&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;194&quot; FieldTopPos=&quot;303&quot; FieldWidth=&quot;145&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;77&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="148.0000000000" StaticTopPos="302.0000000000" StaticWidth="43.0000000000" StaticHeight="20.0000000000" FieldLeftPos="194.0000000000" FieldTopPos="303.0000000000" FieldWidth="145.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="77"/>
<USERDEFFIELDS field_id="217" field_type="2" field_attribute="0" label_text="Investor Purchase Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Detail 2 UDF45 update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF16(C+)  and Loan Detail 1 UDF29(F+) Field label name Investor sale date
&apos;                    
&apos; Purpose:
&apos; Designed to maintain detail2 udef45 in sync with loan ach_co set up for the purpose of assuring the webpaay portal can see the current code for each new online reqiest.
&apos;	
&apos; Created: 07/18/2017 by Stanley Muhammad 
&apos; Modification History  NA

	class_2 = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
	port =  NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
	ACH_no = ACHCoIDUDF45(class_2,port)
	Curr_ACH_Co_UDF45 = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF45&quot;)
	If  ACH_no &lt;&gt; Curr_ACH_Co_UDF45  Then
		NLSApp.SetField &quot;LOAN_DETAIL2_UDF45&quot;, ACH_no
	End If

&apos;When Field Changes
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click/Box check-uncheck
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions**###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;439&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;439&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;78&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="439.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="439.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="78"/>
<USERDEFFIELDS field_id="266" field_type="2" field_attribute="0" label_text="Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;302&quot; StaticWidth=&quot;22&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;43&quot; FieldTopPos=&quot;303&quot; FieldWidth=&quot;100&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;79&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="302.0000000000" StaticWidth="22.0000000000" StaticHeight="20.0000000000" FieldLeftPos="43.0000000000" FieldTopPos="303.0000000000" FieldWidth="100.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="79"/>
<USERDEFFIELDS field_id="216" field_type="0" field_attribute="0" label_text="Payoff Reason" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;417&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;417&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;80&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="417.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="417.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="80"/>
<USERDEFFIELDS field_id="265" field_type="0" field_attribute="4" label_text="Priority Score" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;550&quot; StaticTopPos=&quot;26&quot; StaticWidth=&quot;79&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;674&quot; FieldTopPos=&quot;25&quot; FieldWidth=&quot;50&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;81&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="550.0000000000" StaticTopPos="26.0000000000" StaticWidth="79.0000000000" StaticHeight="20.0000000000" FieldLeftPos="674.0000000000" FieldTopPos="25.0000000000" FieldWidth="50.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="81"/>
<USERDEFFIELDS field_id="215" field_type="2" field_attribute="0" label_text="Payoff Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;395&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;395&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;82&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="395.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="395.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="82"/>
<USERDEFFIELDS field_id="264" field_type="6" field_attribute="3" label_text="Admin only" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;1&quot;&gt;
&lt;BUTTON Name=&quot;View Web pay fields&quot; Script=&quot;Userno = NLSApp.GetCurrentUserNo( )
userauthsql = &amp;quot;select convert(varchar(3),groupno) from nlsgroupmembers where groupno in (&amp;apos;11&amp;apos;) and userno = &amp;quot; &amp;amp; Userno

groupno = NLSApp.SQLSelectStatement(userauthsql)
&amp;apos;NLSApp.MessageBox(groupno)

If len(groupno) &amp;gt; 0 Then
	If groupno = 11 or groupno = 2 or groupno = 20 Then
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF34&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF35&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF36&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF37&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF38&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF39&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF40&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF41&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF42&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF43&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF44&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF45&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF46&amp;quot;, false

	End If
End If&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;548&quot; StaticTopPos=&quot;390&quot; StaticWidth=&quot;150&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;585&quot; FieldTopPos=&quot;419&quot; FieldWidth=&quot;109&quot; FieldHeight=&quot;31&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;83&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="548.0000000000" StaticTopPos="390.0000000000" StaticWidth="150.0000000000" StaticHeight="20.0000000000" FieldLeftPos="585.0000000000" FieldTopPos="419.0000000000" FieldWidth="109.0000000000" FieldHeight="31.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="83"/>
<USERDEFFIELDS field_id="214" field_type="1" field_attribute="0" label_text="Payoff Amount" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;373&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;373&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;84&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="373.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="373.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="84"/>
<USERDEFFIELDS field_id="263" field_type="5" field_attribute="4" label_text="First Pay Default" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;240&quot; StaticWidth=&quot;103&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;240&quot; FieldWidth=&quot;29&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;85&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="240.0000000000" StaticWidth="103.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="240.0000000000" FieldWidth="29.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="85"/>
<USERDEFFIELDS field_id="213" field_type="2" field_attribute="0" label_text="Last DD Change" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;351&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;351&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;86&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="351.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="351.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="86"/>
<USERDEFFIELDS field_id="262" field_type="5" field_attribute="0" label_text="Incarcerated" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;217&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;219&quot; FieldWidth=&quot;29&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;87&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="217.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="219.0000000000" FieldWidth="29.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="87"/>
<USERDEFFIELDS field_id="212" field_type="0" field_attribute="4" label_text="WC Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;302&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;302&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;88&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="302.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="302.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="88"/>
<USERDEFFIELDS field_id="261" field_type="5" field_attribute="0" label_text="Active Military" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;196&quot; StaticWidth=&quot;93&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;197&quot; FieldWidth=&quot;48&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;89&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="196.0000000000" StaticWidth="93.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="197.0000000000" FieldWidth="48.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="89"/>
<USERDEFFIELDS field_id="211" field_type="3" field_attribute="0" label_text="WC Agent" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;---------------------------------------------------------------------------------------------------------------
&apos; Automatic data chnages - When Field Changes - Field Level/C+ UDF37/F+ UDF11
&apos;
&apos; Purpose:
&apos; Update last update UDF fiels and save record of chnage in loan comments
&apos;  
&apos; Created: 06/09/20126 by Stanley Muhammad 
&apos; Modification History    NA      By             
&apos;       
&apos;---------------------------------------------------------------------------------------------------------------
CurrentDate = Now()
LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)

&apos;C+ Options
&apos;NLSApp.SetField &quot;LOAN_DETAIL1_UDF38&quot;, CurrentDate
&apos;WCAgent = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF37&quot;)
&apos;WCdate = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF38&quot;)
&apos;WCStatus = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF44&quot;)
&apos;F+ Options

NLSApp.SetField &quot;LOAN_DETAIL1_UDF12&quot;, CurrentDate
WCAgent = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF11&quot;)
WCdate = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF12&quot;)
WCStatus = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF7&quot;)

NLSApp.SaveScreen()

If not right(WCAgent,9) =  &quot;COMPLETED&quot; THEN

	notes = &quot;Additional Notes:&quot;  &amp; chr(13) &amp;addnotes
	commenthd = &quot;Welcome Call Attempt &quot;  &amp; right(WCAgent ,2)
	
	XMLA = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot;
	XMLB = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; LoanNo &amp; &quot;&quot;&quot;&gt;&quot;
	XMLC = &quot;&lt;LOANCOMMENTS Comment=&quot;&quot;&quot; &amp; commenthd &amp;  &quot;&quot;&quot; Category=&quot;&quot;SERVICING NOTES&quot;&quot; CommentDescription=&quot;&quot;WC Activity&quot;&quot;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
	
	
	xmlstrng = XMLA &amp; XMLB &amp; XMLC
	
	&apos;NLSApp.MessageBox(xmlstrng)
	
	NLSApp.SaveScreen()
	
	ImportXML(xmlstrng)
End if	
	
**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**&apos;---------------------------------------------------------------------------------------------------------------
&apos; WC Agent options - On Initialize - Field Level/C+ UDF37/F+ UDF11
&apos;
&apos; Purpose:
&apos; Load drop down list values.
&apos;  
&apos; Created: 06/09/20126 by Stanley Muhammad 
&apos; Modification History    NA      By             
&apos;       
&apos;---------------------------------------------------------------------------------------------------------------
UserID = NLSApp.GetCurrentUserNo( )

SQLtxt = &quot;SELECT username+&apos; - &apos;+shortname FROM nlsusers, CIF WHERE CIFno IN (&apos;51973&apos;,&apos;51974&apos;,&apos;51975&apos;,&apos;51976&apos;) AND userno = &quot; &amp; UserID 

NLSapp.LoadComboList 0, &quot;LOAN_DETAIL1_UDF11&quot;, SQLtxt**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;280&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;280&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;90&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="280.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="280.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="90"/>
<USERDEFFIELDS field_id="260" field_type="3" field_attribute="0" label_text="Intent To Pay" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;129&quot; StaticWidth=&quot;73&quot; StaticHeight=&quot;19&quot; FieldLeftPos=&quot;18&quot; FieldTopPos=&quot;149&quot; FieldWidth=&quot;39&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;91&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="129.0000000000" StaticWidth="73.0000000000" StaticHeight="19.0000000000" FieldLeftPos="18.0000000000" FieldTopPos="149.0000000000" FieldWidth="39.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="91">
<USERDEFDATA row_id="2972" field_reference="260" field_data="YES" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2973" field_reference="260" field_data="NO" field_order="1" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="210" field_type="1" field_attribute="0" label_text="Origination Fee Pd" min_value="0.0000000000" max_value="10,000.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;256&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;256&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;92&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="256.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="256.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="92"/>
<USERDEFFIELDS field_id="259" field_type="4" field_attribute="0" label_text="Category" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate

&apos;Script to update credit bureau loan account reporting based on loan status changes.

LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
StatusCat = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF9&quot;)
lastupdate = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF6&quot;)
loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
statuscode = NLSApp.GetField(&quot;STATUS_CODE&quot;)

NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, Now()

XMLA = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot;
    XMLB = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot; &amp; chr(34) &amp; LoanNo &amp; chr(34) &amp; &quot;&gt;&quot;

    Select Case StatusCat
        Case &quot;Deceased Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  ECOACode=&quot;&quot;X&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case &quot;BK Chpt 7 Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;&quot;&quot; ConsumerInfoIndicator=&quot;&quot;A &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case &quot;BK Chpt 13 Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;&quot;&quot; ConsumerInfoIndicator=&quot;&quot;D &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case &quot;Fraud Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;DF&quot;&quot; ConsumerInfoIndicator=&quot;&quot;  &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case Else 
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;&quot;&quot; ConsumerInfoIndicator=&quot;&quot;  &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
    End Select

    xmlstrng = XMLA &amp; XMLB &amp; XMLC

NLSApp.SetField &quot;LOAN_DETAIL2_UDF7&quot;,xmlstrng

NLSApp.SaveScreen()

&apos;xmlstrng = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF7&quot;)
&apos;lastupdate = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF6&quot;)
&apos;loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
&apos;StatusCat = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF9&quot;)


&apos;IF Not lastupdate = Null Then
&apos;	If loanstatus = &quot;CLOSED&quot; Then
&apos;		IF DateValue(lastupdate) = DateValue(Now) Then
			If StatusCat = &quot;Deceased Confirmed&quot; Or StatusCat = &quot;BK Chpt 7 Confirmed&quot; Or StatusCat = &quot;BK Chpt 13 Confirmed&quot; Or StatusCat = &quot;Fraud Confirmed&quot; Then
			ImportXML(xmlstrng)
			End If
&apos;		End If
&apos;	End If
&apos;End If



Function ImportXML(xml)
    NLSApp.ClearErrorString()

    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
        End If
        ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
    Else
        &apos;            NLSApp.MessageBox(&quot;ECOA Status Updated.&quot;)
        ImportXML = &quot;&quot;
    End If
End Function**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;75&quot; StaticWidth=&quot;103&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;11&quot; FieldTopPos=&quot;97&quot; FieldWidth=&quot;145&quot; FieldHeight=&quot;22&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;93&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="75.0000000000" StaticWidth="103.0000000000" StaticHeight="20.0000000000" FieldLeftPos="11.0000000000" FieldTopPos="97.0000000000" FieldWidth="145.0000000000" FieldHeight="22.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="93">
<USERDEFDATA row_id="2976" field_reference="259" field_data="Deceased Confirmed" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2977" field_reference="259" field_data=" " field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2978" field_reference="259" field_data="Fraud Confirmed" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2979" field_reference="259" field_data="Defaulted 120" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2980" field_reference="259" field_data="Fraud Reported" field_order="4" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="209" field_type="5" field_attribute="0" label_text="Phone Consent" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="1" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;217&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;217&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;94&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="217.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="217.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="94"/>
<USERDEFFIELDS field_id="258" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;288&quot; FieldTopPos=&quot;167&quot; FieldWidth=&quot;250&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;95&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="156.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="288.0000000000" FieldTopPos="167.0000000000" FieldWidth="250.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="95"/>
<USERDEFFIELDS field_id="208" field_type="5" field_attribute="0" label_text="Email Consent" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="1" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;195&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;195&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;96&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="195.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="195.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="96"/>
<USERDEFFIELDS field_id="257" field_type="0" field_attribute="3" label_text="userdef07" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="2" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;/&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;110&quot; StaticTopPos=&quot;125&quot; StaticWidth=&quot;99&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;110&quot; FieldTopPos=&quot;147&quot; FieldWidth=&quot;105&quot; FieldHeight=&quot;26&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;97&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="110.0000000000" StaticTopPos="125.0000000000" StaticWidth="99.0000000000" StaticHeight="20.0000000000" FieldLeftPos="110.0000000000" FieldTopPos="147.0000000000" FieldWidth="105.0000000000" FieldHeight="26.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="97"/>
<USERDEFFIELDS field_id="207" field_type="4" field_attribute="3" label_text="Post-Call status" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;---------------------------------------------------------------------------------------------------------------
&apos; WC completed data changes - When Field Changes - Field Level/C+ UDF44/F+ UDF07
&apos;
&apos; Purpose:
&apos; Update last update UDF fields and save record of change in loan comments
&apos;  
&apos; Created: 06/09/20126 by Stanley Muhammad 
&apos; Modification History    NA      By             
&apos;       
&apos;---------------------------------------------------------------------------------------------------------------
NLSapp.ClearErrorString() 
LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
WCAgent = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF11&quot;)
WCdate = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF12&quot;)
WCStatus = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF7&quot;)


addnotes = InputBox(&quot;Additional Info?&quot; &amp; chr(13)  &amp; &quot;Leave blank if nothing to add.&quot; , &quot;WC Status Notes&quot;, defaultdate,4550,4550)

if len(addnotes) = 0 Then
	addnotes = &quot;N/A&quot;
end if

notes = &quot;Additional Notes:&quot;  &amp; chr(13) &amp;addnotes
commenthd = &quot;Welcome Call completed.&quot; &amp; chr(13)

XMLA = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot;
XMLB = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; LoanNo &amp; &quot;&quot;&quot;&gt;&quot;
XMLC = &quot;&lt;LOANCOMMENTS Comment=&quot;&quot;&quot; &amp; commenthd &amp;  WCStatus &amp; chr(13) &amp; notes &amp; &quot;&quot;&quot; Category=&quot;&quot;SERVICING NOTES&quot;&quot; CommentDescription=&quot;&quot;WC Activity&quot;&quot;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;


xmlstrng = XMLA &amp; XMLB &amp; XMLC

&apos;NLSApp.MessageBox(xmlstrng)

NLSApp.SaveScreen()

ImportXML(xmlstrng)**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;324&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;128&quot; FieldTopPos=&quot;324&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;98&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="324.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="128.0000000000" FieldTopPos="324.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="98">
<USERDEFDATA row_id="2939" field_reference="207" field_data="Client Satisfied - no known issues" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2940" field_reference="207" field_data="F+ loan interest rate confusion/concern" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2941" field_reference="207" field_data="F+ loan balance confusion/concern" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2942" field_reference="207" field_data="F+ loan duration confusion/concern" field_order="3" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="256" field_type="0" field_attribute="4" label_text="Last Update" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;25&quot; StaticTopPos=&quot;590&quot; StaticWidth=&quot;80&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;106&quot; FieldTopPos=&quot;590&quot; FieldWidth=&quot;102&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;99&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="25.0000000000" StaticTopPos="590.0000000000" StaticWidth="80.0000000000" StaticHeight="20.0000000000" FieldLeftPos="106.0000000000" FieldTopPos="590.0000000000" FieldWidth="102.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="99"/>
<USERDEFFIELDS field_id="206" field_type="0" field_attribute="0" label_text="Loan Reason Explanation" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="2" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;175&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;175&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;100&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="175.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="175.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="100"/>
<USERDEFFIELDS field_id="255" field_type="4" field_attribute="0" label_text="Start a Loan Modification" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;LOAN variables
loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
loannumber = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
getmodtype = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF5&quot;)
loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)

&apos;Task variables
templateno = 7  &apos;LOAN MODIFICATION II
defaultstatusno = 7  &apos;STARTED

&apos;Change Start a Loan Modification Request field (UDF5) back to default &quot;Choose an Option&quot;
NLSApp.SetField &quot;LOAN_DETAIL2_UDF5&quot;, &quot;Choose an Option&quot;
NLSApp.RefreshScreen()

If Not getmodtype = &quot;Choose an Option&quot; Then
    If addloanMod(getmodtype, loanrefno, loanstatus) = &quot;&quot; Then
    End If
End If
NLSApp.SaveScreen()



Function addloanMod(modtype, loanrefno, status)

    &apos;TASK variables
    currate = NLSApp.SQLSelectStatement(&quot;SELECT convert(varchar(6),convert( numeric(7,2),current_interest_rate))+&apos;%&apos; from loanacct where acctrefno = &quot; &amp; loanrefno)
    currpmt = NLSApp.SQLSelectStatement(&quot;SELECT  &apos;$&apos; + convert(varchar(6),convert( numeric(9,2), next_payment_total_amount)) from loanacct_payment where acctrefno = &quot; &amp; loanrefno)
    currdate = NLSApp.SQLSelectStatement(&quot;select  convert(char(10),getdate(),111)&quot;)
    currdatetime = NOW()

    &apos;User input for modification requestor Options a. borrower, b. co-borrower, c. 3rd party
    requestpromt = &quot;Who is requesting the &quot; &amp; getmodtype &amp; &quot;?&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;A -  Borrower&quot; &amp; chr(13) &amp; &quot;B -  Co-Borrower&quot; &amp; chr(13) &amp; &quot;C -  Third party&quot;
    requestorcode = InputBox(requestpromt, &quot;Requestor&quot;, &quot;A&quot;)

    &apos;Borrower/Co-borrower detail sql lookups
    borrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, loanacct l where l.cifno = c.cifno and l.acctrefno = &quot; &amp; loanrefno
    coborrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, cif_loan_relationship clr where clr.cifno = c.cifno and clr.acctrefno = &quot; &amp; loanrefno

    &apos;Previous approved deferral lookup
    prevdeflookupsql = &quot;SELECT count(t.task_refno) from task t, task_detail td where t.task_refno = td.task_refno AND t.status_code_id = 8 AND t.task_template_no = 7 AND td.userdef01 = &apos;Deferral&apos; AND t.NLS_refno = &quot; &amp; loanrefno

    Select Case requestorcode
        Case &quot;A&quot;, &quot;a&quot;
            requestor = &quot;Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(borrowerlookupsql)
        Case &quot;B&quot;, &quot;b&quot;
            requestor = &quot;Co-Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(coborrowerlookupsql)
            If requestordetail = &quot;&quot; Then
                NLSApp.MessageBox(&quot;Co-Borrower information cannot be located.&quot; &amp; chr(13) &amp; &quot;Please validate that Co-borrower exists and Retry.&quot;)
                NLSApp.MessageBox(&quot;Operation Canceled.&quot;)
                Exit Function
            End If
        Case &quot;C&quot;, &quot;c&quot;
            requestor = &quot;Third_Party (See Notes)&quot;
            requestordetail = &quot;ENTER 3rd Party details here.&quot;
        Case &quot;&quot;
            NLSApp.MessageBox(&quot;Modification Canceled.&quot;)
            Exit Function
        Case Else
            NLSApp.MessageBox(&quot;Invalid Selection.&quot; &amp; chr(13) &amp; &quot;Please Try Again.&quot;)
            Exit Function
    End Select

    &apos;If Mod Type is  a deferral look up the # of previously approved deferrals
    If getmodtype = &quot;Deferral&quot; Then
        prevdefs = NLSapp.SQLSelectStatement(prevdeflookupsql)
    Else
        prevdefs = &quot;&quot;
    End If


    &apos;TASK OBJECT CREATION
    If status = &quot;ACTIVE&quot; Then
        Set Task = NLSApp.Tasks.New(templateno)
        NLSApp.Tasks.BeginTransaction
        Task.StatusCodeID = defaultstatusno
        Task.NLSRefno = loanrefno
        Task.UDF1 = modtype
        Task.UDF9 = prevdefs
        Task.UDF10 = currpmt
        Task.UDF12 = currdate
        Task.UDF14 = currate
        Task.UDF18 = requestor
        Task.UDF23 = currdate
        Task.UDF25 = requestordetail

        If (Task.Save = -1) Then
            NLSApp.Tasks.RollbackTransaction
            NLSApp.MessageBox(&quot;Task not created.&quot;)
            addloanMod = -1
        Else
            NLSApp.Tasks.CommitTransaction
            NLSApp.MessageBox(&quot;Loan Modification TASK created.&quot; &amp; Chr(13) &amp; &quot;Please go the the Task Tab to complete the modification record.&quot;)
            addloanMod = &quot;&quot;
        End If
    Else
        NLSApp.MessageBox(&quot;The Loan must be in ACTIVE status to add a Modification task&quot;)
    End If

End Function**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;288&quot; StaticTopPos=&quot;92&quot; StaticWidth=&quot;174&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;288&quot; FieldTopPos=&quot;114&quot; FieldWidth=&quot;188&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;101&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="288.0000000000" StaticTopPos="92.0000000000" StaticWidth="174.0000000000" StaticHeight="20.0000000000" FieldLeftPos="288.0000000000" FieldTopPos="114.0000000000" FieldWidth="188.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="101">
<USERDEFDATA row_id="2981" field_reference="255" field_data="Choose an Option" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2982" field_reference="255" field_data="Deferral" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2983" field_reference="255" field_data="Interest Rate Reduction" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2984" field_reference="255" field_data="Lower Payment/Term Extension" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2985" field_reference="255" field_data="SCRA" field_order="4" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="205" field_type="3" field_attribute="0" label_text="Loan Reason" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;153&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;153&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;102&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="153.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="153.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="102">
<USERDEFDATA row_id="2943" field_reference="205" field_data="PAY FOR UNPLANNED EXPENSES" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2944" field_reference="205" field_data="FINANCE A MAJOR PURCHASE" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2945" field_reference="205" field_data="HELP PAY DOWN DEBT MORE QUICKLY" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2946" field_reference="205" field_data="LOWER MONTHLY DEBT PAYMENTS" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2947" field_reference="205" field_data="LIFE EVENT" field_order="4" field_data_attribute="0"/>
<USERDEFDATA row_id="2948" field_reference="205" field_data="ALLEVIATE FINANCIAL PRESSURES/PAY BILLS" field_order="5" field_data_attribute="0"/>
<USERDEFDATA row_id="2949" field_reference="205" field_data="LOCK IN LOW INTEREST RATE" field_order="6" field_data_attribute="0"/>
<USERDEFDATA row_id="2950" field_reference="205" field_data="OTHER" field_order="7" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="253" field_type="6" field_attribute="0" label_text="Refresh" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;&quot; Script=&quot;PastDue = NLSApp.GetField(&amp;quot;LOAN_DAYSPASTDUE&amp;quot;)
ITP = NLSApp.GetField(&amp;quot;LOAN_DETAIL2_UDF10&amp;quot;)
CurrentDate = Now()

If PastDue = 0 Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;CURRENT&amp;quot; End If
If (PastDue &amp;gt; 0) AND (PastDue &amp;lt;= 10) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;0-10&amp;quot; End If
If (PastDue &amp;gt; 10) AND (PastDue &amp;lt;= 30) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;11+&amp;quot; End If
If (PastDue &amp;gt; 30) AND (PastDue &amp;lt;= 60) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;30+&amp;quot; End If
If (PastDue &amp;gt; 60) AND (PastDue &amp;lt;= 90) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;60+&amp;quot; End If
If (PastDue &amp;gt; 90) AND (PastDue &amp;lt;= 120) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;90+&amp;quot; End If
If (PastDue &amp;gt; 120) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;120+&amp;quot; End If

If (PastDue &amp;gt; 0) AND (PastDue &amp;lt;= 10) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;N/A&amp;quot; End If
If (PastDue &amp;gt; 11) AND (PastDue &amp;lt;= 120) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;Collections&amp;quot; End If
If (PastDue &amp;gt; 120) AND (ITP = &amp;quot;NO&amp;quot;) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;Defaulted&amp;quot; End If
If (PastDue &amp;gt; 120) AND (ITP &amp;lt;&amp;gt; &amp;quot;NO&amp;quot;) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;Collections&amp;quot; End If&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;493&quot; StaticTopPos=&quot;30&quot; StaticWidth=&quot;33&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;487&quot; FieldTopPos=&quot;27&quot; FieldWidth=&quot;42&quot; FieldHeight=&quot;27&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;103&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="493.0000000000" StaticTopPos="30.0000000000" StaticWidth="33.0000000000" StaticHeight="20.0000000000" FieldLeftPos="487.0000000000" FieldTopPos="27.0000000000" FieldWidth="42.0000000000" FieldHeight="27.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="103"/>
<USERDEFFIELDS field_id="204" field_type="4" field_attribute="0" label_text="Loan Use" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;131&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;131&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;104&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="131.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="131.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="104">
<USERDEFDATA row_id="2951" field_reference="204" field_data="CREDIT CARD REFINANCING" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2952" field_reference="204" field_data="DEBT CONSOLIDATION" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2953" field_reference="204" field_data="HOME IMPROVEMENT" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2954" field_reference="204" field_data="TRAVEL/VACATION" field_order="5" field_data_attribute="0"/>
<USERDEFDATA row_id="2955" field_reference="204" field_data="WEDDING" field_order="4" field_data_attribute="0"/>
<USERDEFDATA row_id="2956" field_reference="204" field_data="OTHER" field_order="12" field_data_attribute="0"/>
<USERDEFDATA row_id="2957" field_reference="204" field_data="MAJOR PURCHASE" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2958" field_reference="204" field_data="BUSINESS EXPENSES" field_order="6" field_data_attribute="0"/>
<USERDEFDATA row_id="2959" field_reference="204" field_data="AUTO PURCHASE" field_order="7" field_data_attribute="0"/>
<USERDEFDATA row_id="2960" field_reference="204" field_data="MEDICAL EXPENSES" field_order="8" field_data_attribute="0"/>
<USERDEFDATA row_id="2961" field_reference="204" field_data="MOVING EXPENSES" field_order="9" field_data_attribute="0"/>
<USERDEFDATA row_id="2962" field_reference="204" field_data="REFI FP LOAN" field_order="10" field_data_attribute="0"/>
<USERDEFDATA row_id="2963" field_reference="204" field_data="REFI CPLUS LOAN" field_order="11" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="252" field_type="0" field_attribute="4" label_text="Status" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;145&quot; StaticTopPos=&quot;31&quot; StaticWidth=&quot;45&quot; StaticHeight=&quot;18&quot; FieldLeftPos=&quot;145&quot; FieldTopPos=&quot;50&quot; FieldWidth=&quot;135&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;105&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="145.0000000000" StaticTopPos="31.0000000000" StaticWidth="45.0000000000" StaticHeight="18.0000000000" FieldLeftPos="145.0000000000" FieldTopPos="50.0000000000" FieldWidth="135.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="105"/>
<USERDEFFIELDS field_id="203" field_type="0" field_attribute="0" label_text="Loan Officer" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;109&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;109&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;106&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="109.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="109.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="106"/>
<USERDEFFIELDS field_id="251" field_type="0" field_attribute="4" label_text="Level" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;27&quot; StaticWidth=&quot;35&quot; StaticHeight=&quot;21&quot; FieldLeftPos=&quot;18&quot; FieldTopPos=&quot;50&quot; FieldWidth=&quot;89&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;107&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="27.0000000000" StaticWidth="35.0000000000" StaticHeight="21.0000000000" FieldLeftPos="18.0000000000" FieldTopPos="50.0000000000" FieldWidth="89.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="107"/>
<USERDEFFIELDS field_id="202" field_type="0" field_attribute="0" label_text="SF Application ID" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;86&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;87&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;108&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="86.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="87.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="108"/>
<USERDEFFIELDS field_id="274" field_type="0" field_attribute="4" label_text="Last Updated" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;550&quot; StaticTopPos=&quot;79&quot; StaticWidth=&quot;72&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;624&quot; FieldTopPos=&quot;75&quot; FieldWidth=&quot;100&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;109&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="550.0000000000" StaticTopPos="79.0000000000" StaticWidth="72.0000000000" StaticHeight="20.0000000000" FieldLeftPos="624.0000000000" FieldTopPos="75.0000000000" FieldWidth="100.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="109"/>
<USERDEFFIELDS field_id="201" field_type="0" field_attribute="0" label_text="LOS Application ID" min_value="0.0000000000" max_value="0.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;20&quot; StaticTopPos=&quot;65&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;129&quot; FieldTopPos=&quot;65&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;484&quot; ScreenWidth=&quot;1101&quot; ZOrder=&quot;110&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="20.0000000000" StaticTopPos="65.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="129.0000000000" FieldTopPos="65.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="484.0000000000" ScreenWidth="1,101.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="110"/>
<KEYRECORD code_id="0" numbering_key="0"/>
<SCRIPTS code_id="0" script_type="0" script="**###Before Save###****###Before Save###****###Before Activate###**&apos;Variables********
pastdue = NLSApp.GetField(&quot;LOAN_DAYSPASTDUE&quot;)
If pastdue = &quot;&quot; then 
 pastdue = 0
end if
udf18 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF18&quot;)
acctrefno = NLSApp.GetField (&quot;LOAN_REFNO&quot;)
POAststatussql = &quot;Select distinct l.acctrefno from loanacct l, loanacct_statuses ls where l.acctrefno = ls.acctrefno and ls.status_code_no = 39 and l.acctrefno = &quot; &amp; acctrefno
POAstatus = NLSApp.SQLSelectStatement(POAststatussql)
POABox = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF18&quot;)
ValidPOAYN = POADocExists(acctrefno)
NLSapp.SetToolTip &quot;LOAN_DETAIL2_UDF51&quot;, &quot;Right Click to add a new row.&quot;
loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
udf18 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF18&quot;)
Userno = NLSApp.GetCurrentUserNo( )
userauthsql = &quot;select convert(varchar(3),groupno) from nlsgroupmembers where groupno in (&apos;11&apos;) and userno = &quot; &amp; Userno
groupno = NLSApp.SQLSelectStatement(userauthsql)
UserID = NLSApp.GetCurrentUserNo()
userAuthverifysql = &quot;Select userno from nlsgroupmembers where groupno in (2, 11, 20)  and  userno = &quot; &amp; UserID
userAuthverify = NLSApp.SQLSelectStatement(userAuthverifysql)


&apos;DETAIL 1 ********

&apos;---------------------------------------------------------------------------------------------------------------
&apos;WC activities
&apos;---------------------------------------------------------------------------------------------------------------

If right(NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF11&quot;),9) =  &quot;COMPLETED&quot; THEN
	NLSapp.HideFields &quot;LOAN_DETAIL1_UDF7&quot;, False
Else
	NLSapp.HideFields &quot;LOAN_DETAIL1_UDF7&quot;, True
End If


&apos;DETAIL 2********

&apos;---------------------------------------------------------------------------------------------------------------
&apos;&apos;Hide 120+ exception notes
&apos;---------------------------------------------------------------------------------------------------------------

If pastdue &gt;= 120 Then
	NLSapp.HideFields &quot;LOAN_DETAIL2_UDF4&quot;, false
Else
	NLSapp.HideFields &quot;LOAN_DETAIL2_UDF4&quot;, true
End If

&apos;---------------------------------------------------------------------------------------------------------------
&apos;Hidden fields for Sys Admin only
&apos;---------------------------------------------------------------------------------------------------------------

If Not userAuthverify = &quot;&quot; Then
    NLSapp.HideFields &quot;LOAN_DETAIL1_UDF20&quot;, false
 End if


If len(groupno) &gt; 0 Then

	If groupno = 11 or Userno = 39   Then
		NLSapp.HideFields &quot;LOAN_DETAIL2_UDF14&quot;, false
		NLSapp.HideFields &quot;LOAN_DETAIL2_UDF19&quot;, false
		NLSapp.EnableFields &quot;LOAN_DETAIL2_UDF19&quot;, true
	End If

End if
&apos;---------------------------------------------------------------------------------------------------------------


&apos;---------------------------------------------------------------------------------------------------------------
&apos;Settlement and POA Maintenance
&apos;---------------------------------------------------------------------------------------------------------------
&apos;MAINTAIN POA Check box
	brokenyn = NLSApp.SQLSelectStatement(&quot;SELECT distinct convert(varchar(12),acctrefno) from loanacct_statuses where status_code_no IN (34, 38) and acctrefno = &quot; &amp; acctrefno ) 
	&apos;Check POA box if POA exist and box is not checked
	If ValidPOAYN = &quot;Y&quot; and Not POABox = &quot;CHECK&quot; Then
		If not brokenyn = acctrefno Then
			NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;, &quot;CHECK&quot;
		End if
	End if

	&apos;UnCheck POA box if no POA exist and box is checked
	If (not ValidPOAYN = &quot;Y&quot; or brokenyn = acctrefno) and POABox = &quot;CHECK&quot;  Then
		NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;,&quot;UNCHECK&quot;
	End if

&apos;Validate POA and loan Status
If not POAstatus = &quot;&quot;  Then
	If ValidPOAYN = &quot;Y&quot; Then
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF21&quot;, True
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF22&quot;, True
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF23&quot;, True
		&apos;NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF51&quot;, True

	Else
		POAmissingNote =  &quot;Loan has &apos;POA RECEIVED&apos; status, however the required documentation is missing in comments!&quot; &amp; chr(13) &amp; chr(13) &amp; _  
		&quot;Please go to the Comments Tab and upload a copy of the documentation.&quot; &amp; chr(13) &amp; chr(13) &amp; _
		&quot;It MUST be saved in the DOCUMENTS category and Settlement POA must be selected from the Reason Code drop-down list.&quot;   &amp; chr(13) &amp; chr(13) &amp; &quot;Thank you.&quot;
		NLSApp.MessageBox(POAmissingNote)
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF21&quot;, false
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF22&quot;, false
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF23&quot;, false
		&apos;NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF51&quot;, false

	End if

Else 
&apos;	DSinputisnull = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF21&quot;) &amp; NLSApp.GetField (&quot;LOAN_DETAIL2_UDF22&quot;) &amp; NLSApp.GetField (&quot;LOAN_DETAIL2_UDF23&quot;)
&apos; 	If Not DSinputisnull = &quot;&quot; Then
&apos; 		NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
&apos; 		NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
&apos; 		NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
&apos; 	End If

	NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF21&quot;, false
	NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF22&quot;, false
	NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF23&quot;, false
	&apos;NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF51&quot;, false

End if


NLSapp.SetToolTip &quot;LOAN_DETAIL2_UDF51&quot;, &quot;Right Click to add a new row.&quot;

&apos;---------------------------------------------------------------------------------------------------------------**###Before Activate###****###Before Create###****###Before Create###****###On Delete###****###On Delete###****###After Save###**&apos;Variables********
   
udf18 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF18&quot;)
userid = REPLACE( NLSApp.GetSignedOnID(),&quot;NLS.LOCAL\&quot;,&quot;&quot;)
acctrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
newbalchecksql = NLSApp.SQLSelectStatement(&quot;select left(cd.userdef27,95)  from cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &apos;DEBT SETTLEMENT TASK&apos;&quot;)
newDSbalcheck = NLSApp.SQLSelectStatement(newbalchecksql &amp;  acctrefno)

&apos;DETAIL 1********
&apos;DETAIL 2******** 
&apos;---------------------------------------------------------------------------------------------------------------
&apos;Debt settlement
 &apos;---------------------------------------------------------------------------------------------------------------

If udf18 = &quot;CHECK&quot;  Then
   NLSApp.HideFields &quot;LOAN_DETAIL2_UDF20&quot;, False 

End if

If newDSbalcheck &lt;&gt; &quot;&quot; then
   newbaleditsqlpart1 = NLSApp.SQLSelectStatement(&quot;select cd.userdef04  from cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &apos;DEBT SETTLEMENT TASK&apos;&quot;)
   newbaleditsqlpart2 = NLSApp.SQLSelectStatement(&quot;select cd.userdef03 from cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &apos;DEBT SETTLEMENT TASK&apos;&quot;)
   newDSbaledit = NLSApp.SQLSelectStatement(newbaleditsqlpart1 &amp; userid &amp; newbaleditsqlpart2 &amp; acctrefno)
   newDSbaledit = Replace(newDSbaledit,&quot;&quot;&quot;&quot;,&quot;&apos;&quot;)
   
   XMLstring = &quot;&lt;NLS&gt;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; acctrefno &amp; &quot;&quot;&quot;&gt;&lt;LOANDETAIL2 UserDefined51=&quot;&quot;&quot; &amp; newDSbaledit &amp;  &quot;&quot;&quot;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;

   ImportXML(XMLstring)
   NLSApp.RefreshScreen()
End if
**###After Save###****###After Create###****###After Create###****###On Transaction Entry###****###On Transaction Entry###****###After Transaction Entry###**loanpayoff = NLSapp.GetField(&quot;LOAN_CURRPAYOFF&quot;)

&apos;NextRun = NLSapp.SQLSelectStatement(&quot;SELECT substring(cd.userdef03,11,25) FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;)
&apos;
&apos;    If CDate(NextRun) &lt; CDate(Now()) Then
&apos;       NextRuntime = NOW() + 1     
&apos;       SetNextRun = &quot;SELECT 0; UPDATE cif_detail SET userdef03 = &apos;Next Run: &quot; &amp; NextRuntime &amp; &quot;&apos; FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;
&apos;       NLSapp.SQLSelectStatement(SetNextRun)
&apos;       
&apos;       AutoWOaddCompletePending()
&apos;       AutoCloseaddCompleted()
&apos;
&apos;       NextRuntime = NOW()     
&apos;       SetNextRun = &quot;SELECT 0; UPDATE cif_detail SET userdef03 = &apos;Next Run: &quot; &amp; NextRuntime &amp; &quot;&apos; FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;
&apos;       NLSapp.SQLSelectStatement(SetNextRun)
&apos;       
&apos;    End If


    NLSapp.RefreshScreen()**###After Transaction Entry###****###On Add Button Clicked###****###On Add Button Clicked###****###Local Functions###**&apos;---------------------------------------------------------------------------------------------------------------
&apos;Port form Subs
&apos;---------------------------------------------------------------------------------------------------------------

Function canceladdemail(portfolio,refno)
     NLSApp.SaveScreen()
    If portfolio = &quot;PLUS PORTFOLIO&quot; Then
        NLSApp.SQLSelectStatement &quot;SELECT 0; UPDATE loanacct_detail SET userdef18 = &apos;1&apos; where acctrefno = &quot; &amp; refno
    Else
        NLSApp.SQLSelectStatement &quot;SELECT 0; UPDATE loanacct_detail SET userdef17 = &apos;1&apos; where acctrefno = &quot; &amp; refno
    End If            
    NLSApp.MessageBox(&quot;Process Canceled.&quot;)
     NLSApp.RefreshScreen()
End Function

Function addnewemail(contactnum,emailno)
    retry = True
    
    commprefidsql = &quot;select Distinct convert(varchar,lcp.LoanCommunicationPreferencesID)&quot; &amp; chr(13) &amp; _  
                    &quot;from cif c,loanacct l, LoanCommunicationPreferences lcp&quot; &amp; chr(13) &amp; _  
                    &quot;where l.cifno = c.cifno and l.acctrefno = lcp.acctrefno and c.cifnumber = &apos;&quot; &amp; contactnum &amp; &quot;&apos;&quot;
 &apos;NLSApp.MessageBox(commprefidsql)
    commprefid = NLSApp.SQLSelectStatement(commprefidsql)          
 &apos;NLSApp.MessageBox(commprefidsql)
    Do  
     eaddress = InputBox(&quot;Please enter a valid email address.&quot;,&quot;New Email&quot; &amp; emailno, &quot;some.thing@somewhere.com&quot;)
     &apos; email format check
     exchnage = InStrRev(eaddress, &quot;@&quot;)
     domain = InStrRev(eaddress, &quot;.&quot;)

     If (Not exchnage = 0 and Not domain = 0) And (exchnage &lt; domain) Then
        
        If emailno = 1 Then
            addressedits1 = &quot;SELECT 0; UPDATE cif SET email = &apos;&quot; &amp; eaddress &amp; &quot;&apos;  where cifnumber = &apos;&quot; &amp; contactnum &amp; &quot;&apos;&quot; &amp; chr(13)&amp; _
                        &quot;DELETE FROM LoanCommunicationAddress where  LoanCommunicationPreferencesID = &quot; &amp; commprefid   &amp; chr(13) &amp; _         
                        &quot;INSERT INTO LoanCommunicationAddress Values (&quot; &amp; commprefid &amp; &quot;, &apos;&quot; &amp; eaddress &amp; &quot;&apos;, 0)&quot;
        Else
            addressedits1 = &quot;SELECT 0; UPDATE cif SET email2 = &apos;&quot; &amp; eaddress &amp; &quot;&apos;  where cifnumber = &apos;&quot; &amp; contactnum &amp; &quot;&apos;&quot; &amp; chr(13)
        End If        
        &apos;NLSApp.MessageBox(addressedits1)
        NLSApp.SQLSelectStatement addressedits1
        retry = False
     Else
        retry = NLSApp.YesNoMessageBox(&quot;Invalid Email format&quot; &amp; chr(10) &amp; chr(10) &amp;&quot;Retry? (Y/N)&quot;)

         If retry = false Then
            addnewemail = &quot;&quot;
            Exit Do
         End if
     End if
     addnewemail = eaddress
     Loop while retry = True
End Function

Sub startnewDSoffer()
  &apos;NLSApp.SaveScreen()
   acctrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
   currco = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF21&quot;)
   loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
   poa =  POADocExists(acctrefno)
   proceednext = 1

    If loanstatus = &quot;ACTIVE&quot; Then
        If poa = &quot;Y&quot; Then
            If currco &lt;&gt; &quot;&quot; Then
                addDSofferLOANv2()
            Else
                NLSApp.MessageBox(&quot;A valid Debt Settlement Company must be selected to Proceed.&quot;)
                proceednext = 0
            End If

        Else
            NLSApp.MessageBox(&quot;Power of Attorney Documentation has not been recorded.&quot; &amp; chr(13) &amp; &quot;Please complete to Proceed.&quot;)
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
            proceednext = 0
        End If
    Else
        NLSApp.MessageBox(&quot;Invalid account. Loan must be open for Settlement.&quot;)
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;,&quot;UNCHECK&quot;
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
        proceednext = 0
    End If
         
End Sub

Sub addDSofferLOANv2()
    monthtseqtxt = &quot;starting&quot;
    nextmonthyr = Year(NOW())
    nextmonth = Monthtext(month(now())) &amp; &quot; &quot; &amp; nextmonthyr
    rowno = 0
    cifnumb = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)

    &apos;**XML set up ***To avoid loan record locks, The contact record udf grid fields associated with the active loan will be used as a temporary holding place to build the settlement schedule.
    xxmlheader = &quot;&lt;NLS&gt;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot;&quot;&quot; &amp; cifnumb &amp; &quot;&quot;&quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot; &gt;&lt;CIFDETAIL CIFDetail51=&quot;&quot;&lt;DATA&gt;&quot;
    xxmlfooter = &quot;&lt;/DATA&gt;&quot;&quot; /&gt;&lt;/CIF&gt;&lt;/NLS&gt;&quot;

    firstpass = True
    
    Do Until firstmonth = &quot;END&quot;
        &apos;**INPUTS
       Do
            If firstpass = True Then
                firstmonth = InputBox(&quot;If the first payment will be in &quot; &amp; nextmonth &amp; &quot; Select [OK].&quot; &amp; chr(13) &amp; &quot;If payments will start another month, Type below.&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;Select CANCEL To quit.&quot;, &quot;Settlement Offer Set Up&quot;, nextmonth)
            Else
                firstmonth = InputBox(&quot;Select [OK] to enter payments starting &quot; &amp; nextmonth &amp; &quot;.&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;Select [CANCEL] To quit.&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;Type &apos;END&apos; to Finish.&quot;, &quot;Settlement Offer Set Up&quot;, nextmonth)
            End If
            
            If  Not len(firstmonth) = 0 and  Not (firstmonth = &quot;END&quot; Or firstmonth = &quot;end&quot; Or firstmonth = &quot;End&quot;) Then
                If DateFormat(firstmonth,10077) = -1 Then
                    NLSApp.MessageBox(&quot;Invalid Entry or Date Format.&quot; &amp; chr(13) &amp; &quot;Please re-enter&quot;)
                End if
            End If 

        Loop Until  len(firstmonth) = 0 OR  IsDate(firstmonth) = True OR (firstmonth = &quot;END&quot; Or firstmonth = &quot;end&quot; Or firstmonth = &quot;End&quot;)

        firstpass = False

        If IsDate(firstmonth) = True  Then
            firstmonth = DateFormat(firstmonth,10077)
        End if

        &apos;Check for select CANCEL
        If len(firstmonth) = 0 Then
            NLSApp.MessageBox(&quot;Canceling.&quot;)
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
            Exit Sub
        End If
        
        &apos;Check for select END
        If firstmonth = &quot;END&quot; Or firstmonth = &quot;end&quot; Or firstmonth = &quot;End&quot; Then
            Endproc = 1
            curramount = CStr(totpayments)
           repeat = 1

        Else
            Endproc = 0
            curramount = InputBox(&quot;Enter payment amount starting &quot; &amp; firstmonth &amp; &quot;. &quot;, &quot;Settlement Offer Set Up&quot;, &quot;0.00&quot;)
           repeat = CDbl(InputBox(&quot;Repeat $&quot; &amp; curramount &amp; &quot; payment how many Times? &quot;, &quot;Settlement Offer Set Up&quot;, &quot;1&quot;))

           &apos;**VARIABLES
           monthtseqtxt = &quot;Next&quot;
           nextmonth = firstmonth
           nextmonthno = MonthNo(firstmonth)
           nextmonthyr = right(firstmonth, 4)
           monthstopno = CDbl(nextmonthno) + CDbl(repeat)

        End If
        

        &apos;**CREATE SECTION ROWS
        Do While repeatcnt &lt; repeat
            repeatcnt = repeatcnt + 1

            If Endproc = 1 Then
                nextgridrow = &quot;&lt;ROW RowNumber=&apos;&quot; &amp; rowno &amp; &quot;&apos;&gt;&lt;COLUMN Name=&apos;&apos; Value=&apos;&apos;/&gt;&lt;COLUMN Name=&apos;Month&apos; Value=&apos;TOTAL&apos;/&gt;&lt;COLUMN Name=&apos;Amount&apos; Value=&apos;&quot; &amp; totpayments &amp; &quot;&apos;/&gt;&lt;/ROW&gt;&quot;
            Else
                nextgridrow = &quot;&lt;ROW RowNumber=&apos;&quot; &amp; rowno &amp; &quot;&apos;&gt;&lt;COLUMN Name=&apos;&apos; Value=&apos;&apos;/&gt;&lt;COLUMN Name=&apos;Month&apos; Value=&apos;&quot; &amp; nextmonth &amp; &quot;&apos;/&gt;&lt;COLUMN Name=&apos;Amount&apos; Value=&apos;&quot; &amp; curramount &amp; &quot;&apos;/&gt;&lt;/ROW&gt;&quot;
            End If

            allgridrows = allgridrows &amp; nextgridrow

            rowno = rowno + 1

            &apos;Check if next month begins a new year
            If nextmonthno = &quot;12&quot; Then
                nextmonthno = &quot;1&quot;
                nextmonthyr = nextmonthyr + 1
                nextmonth = &quot;January&quot; &amp; &quot; &quot; &amp; nextmonthyr
            Else
                nextmonthno = MonthNo(nextmonth) + 1
                nextmonth = Monthtext(MonthNo(nextmonth) + 1) &amp; &quot; &quot; &amp; nextmonthyr
            End If
            rowcnt = rowcnt + 1
            
            If rowcnt = 1 Then   &apos;Set default 1st paymentdate
              
                firstpayment = DateForm111(firstmonth)
                If CDate(firstpayment) &lt; CDate(Now()) Then
                    firstpayment = DateForm111(CDate(firstmonth)+ Day(Now()))
                End If
             
            End If
            
            totpayments = CDbl(totpayments) + CDbl(curramount)

        Loop
        repeatcnt = 0

        xxml = xxmlheader &amp; allgridrows &amp; xxmlfooter

        ImportXML(xxml)

        If Endproc = 1 Then
            NLSApp.SaveScreen()
            Exit Do
        End If

    Loop

    &apos;**CREATE TASK
    If proceednext = &quot;&quot; Then
        &apos;TASK variables
        createuser = NLSApp.GetSignedOnID()
        loannumber = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
        loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
        cifnum = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)
        coname = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF21&quot;)
        repname = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF22&quot;)
        reason = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF23&quot;)
        cifudf51 = NLSApp.SQLSelectStatement(&quot;SELECT userdef51 from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;&quot; &amp; cifnum &amp; &quot;&apos;&quot;)
        currbal = NLSApp.GetField(&quot;LOAN_CURRPAYOFF&quot;)
        minbal = 0
        currtime = NOW()
        offer = GetMonthsFromtaskGrid101(cifudf51) &amp; &quot; payments for a total of $&quot; &amp; GetTotalFromtaskGrid101(cifudf51, &quot;Amount&quot;) &amp; &quot;.&quot;
        TotalOffer = GetTotalFromtaskGrid101(cifudf51, &quot;Amount&quot;)
        Expiredate = DateForm111(Month(firstpayment) &amp; &quot;/&quot; &amp; DaysInMonth(Month(firstpayment),Year(firstpayment)) &amp; &quot;/&quot; &amp; Year(firstpayment))


        Companylookupsql = &quot;select &apos;Contact ID:  &apos; + cifnumber  + &apos;     &apos; + &apos;Entry Date:  &apos; + convert(char(11),c.setupdate) + char(13)  + char(13) + &quot; &amp; _
        &quot;&apos;Name:  &apos; + company + char(13)  + char(13) + &apos;ADDRESS :&apos; + char(13) + mail_name1 + char(13) + street_address1 + char(13) + &quot; &amp; _
        &quot;city + &apos;, &apos; + state + &apos; &apos; + zip + char(13) + char(13) + &apos;Phone: (&apos; + phone_area_code + &apos;) &apos; + phone_number + char(13)  + char(13) + &apos;Standard Offer - &apos; + cast(convert(dec(4,2),cd.userdef01) as varchar) +&apos;%&apos; &quot; &amp; _
        &quot;from  cif_detail cd, cif c left outer join cif_phone_nums cp on  c.cifno = cp.cifno &quot; &amp; _
        &quot;where c.cifno = cd.cifno and cp.phone_description = &apos;Business&apos; and c.company = &apos;&quot; &amp; coname &amp; &quot;&apos;&quot;


        workerlookupsql = &quot;select &apos;Contact ID:  &apos; + cifnumber  + &apos;     &apos; + &apos;Entry Date:  &apos; + convert(char(11),c.setupdate) + char(13)  + char(13) + &quot; &amp; _
        &quot;&apos;Name:  &apos; + shortname + char(13)  + char(13) + &apos;EMAIL1 :&apos; + case when email is null then &apos;&apos; else email end + char(13) + &quot; &amp; _
        &quot;&apos;EMAIL2 :&apos; + case when email2 is null then &apos;&apos; else email end + char(13) + char(13)  + &apos;Phone: (&apos; + phone_area_code + &apos;) &apos; + phone_number &quot; &amp; _
        &quot;from  cif_detail cd, cif c left outer join cif_phone_nums cp on  c.cifno = cp.cifno where c.cifno = cd.cifno and cp.phone_description = &apos;Business&apos; and c.shortname = &apos;&quot; &amp; repname &amp; &quot;&apos;&quot;

        coinfo = NLSapp.SQLSelectStatement(Companylookupsql)
        repinfo = NLSapp.SQLSelectStatement(workerlookupsql)
        useremail = NLSapp.SQLSelectStatement(&quot;SELECT email FROM NLSusers where signonid = &apos;&quot; &amp; createuser &amp; &quot;&apos;&quot;)


        &apos;TASK OBJECT CREATION
        If CDbl(currbal) &gt; minbal Then
            Set Task = NLSApp.Tasks.New(6)
            NLSApp.Tasks.BeginTransaction
            Task.StatusCodeID = 6
            Task.NLSRefno = loanrefno
            Task.WorkQueueCodeID = 4
            Task.DueDate = Expiredate
            Task.UDF1 = coname
            Task.UDF2 = repname
            Task.UDF3 = reason
            Task.UDF4 = 1
            Task.UDF5 = currbal
            Task.UDF6 = offer
            Task.UDF7 = round(TotalOffer / currbal * 100, 2)
            Task.UDF8 = currtime
            Task.UDF9 = firstpayment           
            Task.UDF10 = coinfo
            Task.UDF12 = repinfo
            Task.UDF13 = currtime
            Task.UDF14 = &quot;NEW&quot;
            Task.UDF15 = useremail
            Task.UDF101 = cifudf51
            If (Task.Save = -1) Then
                NLSApp.Tasks.RollbackTransaction
                NLSApp.MessageBox(&quot;Task not created&quot;)
            Else
                NLSApp.Tasks.CommitTransaction
                subjectstring1 = &quot;Debt Settlement Task Needs Approval - Loan #&quot; &amp; loannumber
                emailbody1 = &quot;There is a debt settlement agreement that needs approval. Please review Loan #&quot; &amp; loannumber &amp; &quot; and approve or decline.&quot;
                &apos;serverName = &quot;Servicing CPlus&quot;
                &apos;emailtoaddr = &quot;somebody@gmail.com&quot;
                &apos;emailfromaddr = &quot;consolplus-servicing@consolplus.com&quot;
                serverName = &quot;Loan Servicing3&quot;
                emailtoaddr =  &quot;NLSApprovers@freedomfinancialnetwork.com&quot;
                emailfromaddr = &quot;svc.loanservicing@freedomdebtrelief.com&quot;
                NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, subjectstring1, emailbody1
                NLSApp.MessageBox(&quot;TASK created.&quot;)
            End If
        Else
            NLSApp.MessageBox(&quot;Minimum loan balance must be greater than $&quot; &amp; minbal &amp; &quot;.&quot; &amp; chr(13) &amp; &quot;Request not submitted.&quot;)
        End If
    End If
End Sub

&apos;---------------------------------------------------------------------------------------------------------------
&apos;Port form function #1
&apos;XML Import
&apos;---------------------------------------------------------------------------------------------------------------
Function ImportXML(xml)
	NLSApp.ClearErrorString()

	If Not NLSApp.ImportXMLRecord(xml) Then
		If True Then
		NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
		End If
	ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
	Else
              &apos; NLSApp.MessageBox(&quot;Payment Added&quot;)
		ImportXML = &quot;&quot;
	End If
End Function

Function DateForm111(sourcedate)

	If len(DAY(sourcedate)) = 1 Then
	   daytext = &quot;0&quot; &amp; DAY(sourcedate) 
	Else 
	   daytext = DAY(sourcedate) 
	End if 
	
	If len(MONTH(sourcedate)) = 1 Then
	   mnthtext = &quot;0&quot; &amp; MONTH(sourcedate) 
	Else 
	   mnthtext = MONTH(sourcedate) 
	End if 
	
	DateForm111 = YEAR(sourcedate)&amp;&quot;/&quot;&amp; mnthtext&amp;&quot;/&quot;&amp; daytext
	
End Function



Function setAdminuser(acctrefno)
    setAdminuser = -1
    &apos;COMMENT UPDATE
	    commentupdatetxt = &quot;Select 0; update loanacct_comments set created_by = 0,userdef01 = &apos;Outbound&apos;,userdef02 = &apos;Zero Balance Letter&apos;,userdef03 = &apos;Email&apos; &quot; &amp; _
	                 &quot;where comment_description in (&apos;CPLUS ZERO BALANCE LETTER&apos;,&apos;FPLUS ZERO BALANCE LETTER&apos;) &quot; &amp; _
	                 &quot;and created_by &lt;&gt; 0 and created &gt;= left(getdate(),11) and acctrefno IN &quot;
	    
	    Nlsapp.sqlselectstatement(commentupdatetxt &amp; acctrefno)                 
    
    &apos;Mod HISTORY UPDATE             
	    modhistupdatetxt = &quot;SELECT 0; UPDATE loanacct_mod_history SET mod_uid = 0, modification_description = &apos;//VBScript// &apos;+ char(13) + modification_description where row_id IN &quot;
	    modIDlist = &quot;&quot;
	    modsqllookup1 = &quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;UIDADMINUPDATES&apos; &quot;    
	    
	    modupdatesql = NLSapp.SQLSelectStatement(modsqllookup1)    
	    modID = NLSapp.SQLSelectStatement(modupdatesql &amp; acctrefno)
	    Do Until modID = &quot;stop&quot;
	
	        If modID = &quot;***END OF RESULT***&quot; Then
	            modIDlist = &quot;(&quot; &amp; Left(modIDlist, Len(modIDlist) - 2) &amp; &quot;)&quot;
	            modID = &quot;stop&quot;
	        Else
	            modIDlist = modIDlist &amp; modID &amp; &quot;, &quot;
	            modID = NLSApp.SQLSelectStatementReadNext()
	        End If
	
	    Loop 
  
	    NLSapp.SQLSelectStatement(modhistupdatetxt &amp; modIDlist)  
    
    &apos;TRANSACTION HISTORY UPDATE 
	    transhistupdatetxt = &quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0, user_reference = &apos;//VBScript//&apos; where transrefno IN &quot;
	    transrefnolist = &quot;&quot;
	    transqllookup2 = &quot;SELECT cd.userdef27 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;UIDADMINUPDATES&apos; &quot;
	    
	    transupdatesql = NLSapp.SQLSelectStatement(transqllookup2)
	    tranrefno = NLSapp.SQLSelectStatement(transupdatesql &amp; acctrefno)
	    Do Until tranrefno = &quot;stop&quot;
	
	        If tranrefno = &quot;***END OF RESULT***&quot; Then
	            transrefnolist = &quot;(&quot; &amp; Left(transrefnolist, Len(transrefnolist) - 2) &amp; &quot;)&quot;
	            tranrefno = &quot;stop&quot;
	        Else
	            transrefnolist = transrefnolist &amp; tranrefno &amp; &quot;, &quot;
	            tranrefno = NLSApp.SQLSelectStatementReadNext()
	        End If
	
	    Loop
	    NLSapp.SQLSelectStatement(transhistupdatetxt &amp; transrefnolist)

    setAdminuser = &quot;&quot;

End Function

&apos;DATE FORMATTING--------------------------------------------------------------------

Function DateFormat(datestring,formatcode)

	If IsDate(datestring) = true Then
		If len(DAY(datestring)) = 1 Then
		   daytext = &quot;0&quot; &amp; DAY(datestring) 
		Else 
		   daytext = DAY(datestring) 
		End if 

		If len(MONTH(datestring)) = 1 Then
		   mnthtext = &quot;0&quot; &amp; MONTH(datestring) 
		Else 
		   mnthtext = MONTH(datestring) 
		End if 

		Select case formatcode
		&apos;U.S. = mm/dd/yyyy
		case 1	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp; Right(YEAR(datestring),2)

		case 101	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp;	YEAR(datestring) 

		&apos;JAPAN	= yyyy/mm/dd	
		case 11	
			DateFormat = Right(YEAR(datestring),2) &amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext
		case 111	
			DateFormat = YEAR(datestring)&amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext

		&apos;Default with Day and timestamp removed	= mon yyyy	
		case 10077	
			DateFormat =  MonthName(Month(datestring), False) &amp; &quot; &quot; &amp; YEAR(datestring)
			

		Case Else

			DateFormat = -1

		End Select

	Else	

		DateFormat = -1

	End if

	

End Function

Function DaysInMonth(monthno,yearno)

     Select Case monthno
           Case 1, 3, 5, 7, 8, 10, 12
              DaysInMonth = 31

          Case 4, 6, 9, 11
              DaysInMonth = 30  

          Case 2
              &apos;Is Year a leap year?
              If  (yearno Mod 400 = 0) or (yearno Mod 4 = 0 and not yearno Mod 100 = 0) Then  
                 DaysInMonth = 29
              Else
                 DaysInMonth = 28
              End If
     End Select

End Function

Function MonthNo(monthtxt)
    mthno = &quot;&quot;
    Select Case left(monthtxt, 3)
        Case &quot;Jan&quot;
            mthno = &quot;1&quot;
        Case &quot;Feb&quot;
            mthno = &quot;2&quot;
        Case &quot;Mar&quot;
            mthno = &quot;3&quot;
        Case &quot;Apr&quot;
            mthno = &quot;4&quot;
        Case &quot;May&quot;
            mthno = &quot;5&quot;
        Case &quot;Jun&quot;
            mthno = &quot;6&quot;
        Case &quot;Jul&quot;
            mthno = &quot;7&quot;
        Case &quot;Aug&quot;
            mthno = &quot;8&quot;
        Case &quot;Sep&quot;
            mthno = &quot;9&quot;
        Case &quot;Oct&quot;
            mthno = &quot;10&quot;
        Case &quot;Nov&quot;
            mthno = &quot;11&quot;
        Case &quot;Dec&quot;
            mthno = &quot;12&quot;
        Case Else
            mthno = &quot;Invalid Month&quot;
    End Select
    MonthNo = mthno
End Function**###Local Functions###**"/>
</LOAN_PORTFOLIO_CODE>
</SETUP>
