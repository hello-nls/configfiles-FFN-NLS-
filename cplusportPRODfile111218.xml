<SETUP>
<LOAN_PORTFOLIO_CODE code="CONSOL PLUS" description="Loans for the Consolidation Plus business" numbering_mask="%d" option_flags="37" disabled_flag="0" allow_documents_flag="0" show_description_flag="0" comment_type="0" ecoa_code="" relationship_type="0" field_order="0" collateral_type="0" location_flag="0" taxes_flag="0" insurance_flag="0" object_def="&lt;NLSObjectDef&gt;
&lt;ScreenObject&gt;
&lt;UDF ObjectID=&quot;1&quot; ObjectType=&quot;2&quot; TabId=&quot;4&quot; TopPos=&quot;0&quot; LeftPos=&quot;5&quot; Height=&quot;68&quot; Width=&quot;1057&quot; Label=&quot;Actions&quot; ZOrder=&quot;1&quot;/&gt;
&lt;/ScreenObject&gt;
&lt;/NLSObjectDef&gt;
" class_1_label="Class 1" class_2_label="Investor">
<USERDEFFIELDS field_id="254" field_type="0" field_attribute="0" label_text="Charge off Exception Box" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;277&quot; StaticTopPos=&quot;129&quot; StaticWidth=&quot;169&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;277&quot; FieldTopPos=&quot;150&quot; FieldWidth=&quot;285&quot; FieldHeight=&quot;60&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;1&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="277.0000000000" StaticTopPos="129.0000000000" StaticWidth="169.0000000000" StaticHeight="20.0000000000" FieldLeftPos="277.0000000000" FieldTopPos="150.0000000000" FieldWidth="285.0000000000" FieldHeight="60.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="1"/>
<USERDEFFIELDS field_id="227" field_type="0" field_attribute="0" label_text="Modification Notes" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;269&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;269&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;140&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;2&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="269.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="269.0000000000" FieldWidth="261.0000000000" FieldHeight="140.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="2"/>
<USERDEFFIELDS field_id="5401" field_type="8" field_attribute="0" label_text="Current Balances Provided" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;352&quot; StaticWidth=&quot;108&quot; StaticHeight=&quot;14&quot; FieldLeftPos=&quot;37&quot; FieldTopPos=&quot;372&quot; FieldWidth=&quot;365&quot; FieldHeight=&quot;69&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;3&quot; ReadOnly=&quot;0&quot;&gt;
&lt;TABLE DoNotSave=&quot;False&quot; DoNotDirty=&quot;False&quot; StretchLastColumn=&quot;False&quot; GridType=&quot;Loan&quot;/&gt;
&lt;ROW NumberOfRows=&quot;Grow as needed&quot;/&gt;
&lt;COLUMN Name=&quot;Balance&quot; TableLink=&quot;None&quot; Type=&quot;Number&quot; DecimalPlaces=&quot;2&quot; ComboData=&quot;&quot; Alignment=&quot;Right&quot; Width=&quot;75&quot; ReadOnly=&quot;False&quot; UseComma=&quot;True&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Good Thru&quot; TableLink=&quot;None&quot; Type=&quot;Date&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Center&quot; Width=&quot;125&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Issued by&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Center&quot; Width=&quot;125&quot; ReadOnly=&quot;True&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Issue Date&quot; TableLink=&quot;None&quot; Type=&quot;Date&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Center&quot; Width=&quot;125&quot; ReadOnly=&quot;True&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;/UDF&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="352.0000000000" StaticWidth="108.0000000000" StaticHeight="14.0000000000" FieldLeftPos="37.0000000000" FieldTopPos="372.0000000000" FieldWidth="365.0000000000" FieldHeight="69.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="3"/>
<USERDEFFIELDS field_id="5305" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;156&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;21&quot; FieldTopPos=&quot;69&quot; FieldWidth=&quot;85&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;4&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="156.0000000000" StaticHeight="25.0000000000" FieldLeftPos="21.0000000000" FieldTopPos="69.0000000000" FieldWidth="85.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="4"/>
<USERDEFFIELDS field_id="258" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;18&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;99&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;125&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;245&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;5&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="18.0000000000" StaticTopPos="156.0000000000" StaticWidth="99.0000000000" StaticHeight="20.0000000000" FieldLeftPos="125.0000000000" FieldTopPos="156.0000000000" FieldWidth="245.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="5"/>
<USERDEFFIELDS field_id="5304" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;156&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;21&quot; FieldTopPos=&quot;69&quot; FieldWidth=&quot;85&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;6&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="156.0000000000" StaticHeight="25.0000000000" FieldLeftPos="21.0000000000" FieldTopPos="69.0000000000" FieldWidth="85.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="6"/>
<USERDEFFIELDS field_id="257" field_type="0" field_attribute="3" label_text="user def 07" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;/&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;106&quot; StaticTopPos=&quot;126&quot; StaticWidth=&quot;72&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;103&quot; FieldTopPos=&quot;154&quot; FieldWidth=&quot;76&quot; FieldHeight=&quot;26&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;7&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="106.0000000000" StaticTopPos="126.0000000000" StaticWidth="72.0000000000" StaticHeight="20.0000000000" FieldLeftPos="103.0000000000" FieldTopPos="154.0000000000" FieldWidth="76.0000000000" FieldHeight="26.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="7"/>
<USERDEFFIELDS field_id="5303" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;156&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;21&quot; FieldTopPos=&quot;69&quot; FieldWidth=&quot;85&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;8&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="156.0000000000" StaticHeight="25.0000000000" FieldLeftPos="21.0000000000" FieldTopPos="69.0000000000" FieldWidth="85.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="8"/>
<USERDEFFIELDS field_id="5405" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;151&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;9&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="151.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="9"/>
<USERDEFFIELDS field_id="5302" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;156&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;21&quot; FieldTopPos=&quot;69&quot; FieldWidth=&quot;85&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;10&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="156.0000000000" StaticHeight="25.0000000000" FieldLeftPos="21.0000000000" FieldTopPos="69.0000000000" FieldWidth="85.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="10"/>
<USERDEFFIELDS field_id="5404" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;151&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;11&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="151.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="11"/>
<USERDEFFIELDS field_id="5301" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;156&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;69&quot; FieldWidth=&quot;86&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;12&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="156.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="69.0000000000" FieldWidth="86.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="12"/>
<USERDEFFIELDS field_id="5403" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;151&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;13&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="151.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="13"/>
<USERDEFFIELDS field_id="250" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;401&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;446&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;14&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="401.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="446.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="14"/>
<USERDEFFIELDS field_id="5402" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;151&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;83&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;15&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="973.0000000000" StaticWidth="151.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="83.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="15"/>
<USERDEFFIELDS field_id="249" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;379&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;424&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;16&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="379.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="424.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="16"/>
<USERDEFFIELDS field_id="300" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;17&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="332.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="332.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="17"/>
<USERDEFFIELDS field_id="248" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;357&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;402&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;18&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="357.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="402.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="18"/>
<USERDEFFIELDS field_id="299" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;19&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="310.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="310.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="19"/>
<USERDEFFIELDS field_id="247" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;335&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;380&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;20&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="335.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="380.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="20"/>
<USERDEFFIELDS field_id="298" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;21&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="288.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="288.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="21"/>
<USERDEFFIELDS field_id="246" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;313&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;358&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;22&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="313.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="358.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="22"/>
<USERDEFFIELDS field_id="297" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;23&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="266.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="266.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="23"/>
<USERDEFFIELDS field_id="245" field_type="6" field_attribute="3" label_text="Prepare Transition Letter" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;&amp;gt;&quot; Script=&quot;loanref = NLSapp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
&amp;apos;NLSapp.MessageBox(loanref)

strSQL2 = &amp;quot;select loan_number from loanacct where acctrefno = &amp;apos;&amp;quot; &amp;amp; loanref &amp;amp; &amp;quot;&amp;apos;&amp;quot;
loannumber = NLSapp.SQLSelectStatement(strSQL2)

strSQL3 = &amp;quot;select open_maturity_date from loanacct where acctrefno = &amp;apos;&amp;quot; &amp;amp; loanref &amp;amp; &amp;quot;&amp;apos;&amp;quot;
maturity = NLSapp.SQLSelectStatement(strSQL3)

strSQL4 = &amp;quot;select first_principal_payment_date from loanacct_payment where acctrefno = &amp;apos;&amp;quot; &amp;amp; loanref &amp;amp; &amp;quot;&amp;apos;&amp;quot;
FirstPayment = NLSapp.SQLSelectStatement(strSQL4)


TotalPayments = NLSapp.AmortizeLoanInMemory(maturity, loanref)

NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF47&amp;quot;,TotalPayments  
NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF48&amp;quot;,FirstPayment
NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF49&amp;quot;,maturity 
NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF50&amp;quot;,loannumber

NLSApp.SaveScreen()&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;23&quot; StaticTopPos=&quot;539&quot; StaticWidth=&quot;103&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;23&quot; FieldTopPos=&quot;558&quot; FieldWidth=&quot;81&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;24&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="23.0000000000" StaticTopPos="539.0000000000" StaticWidth="103.0000000000" StaticHeight="20.0000000000" FieldLeftPos="23.0000000000" FieldTopPos="558.0000000000" FieldWidth="81.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="24"/>
<USERDEFFIELDS field_id="296" field_type="0" field_attribute="3" label_text="Next Scheduled ACH" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;25&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="244.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="244.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="25"/>
<USERDEFFIELDS field_id="244" field_type="4" field_attribute="3" label_text="Post-Call status" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**NLSapp.ClearErrorString() 
LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
WCAgent = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF37&quot;)
WCdate = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF38&quot;)
WCStatus = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF44&quot;)


addnotes = InputBox(&quot;Additional Info?&quot; &amp; chr(13)  &amp; &quot;Leave blank if nothing to add.&quot; , &quot;WC Status Notes&quot;, defaultdate,4550,4550)

if len(addnotes) = 0 Then
	addnotes = &quot;N/A&quot;
end if

notes = &quot;Additional Notes:&quot;  &amp; chr(13) &amp;addnotes
commenthd = &quot;Welcome Call completed.&quot; &amp; chr(13)

XMLA = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot;
XMLB = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; LoanNo &amp; &quot;&quot;&quot;&gt;&quot;
XMLC = &quot;&lt;LOANCOMMENTS Comment=&quot;&quot;&quot; &amp; commenthd &amp;  WCStatus &amp; chr(13) &amp; notes &amp; &quot;&quot;&quot; Category=&quot;&quot;SERVICING NOTES&quot;&quot; CommentDescription=&quot;&quot;WC Activity&quot;&quot;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;


xmlstrng = XMLA &amp; XMLB &amp; XMLC

&apos;NLSApp.MessageBox(xmlstrng)

NLSApp.SaveScreen()

ImportXML(xmlstrng)**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;&amp;gt;&quot; Script=&quot;strSQL1 = &amp;quot;select max(acctrefno) from loanacct&amp;quot;
loanref = NLSapp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
&amp;apos;NLSapp.MessageBox(loanref)

strSQL2 = &amp;quot;select loan_number from loanacct where acctrefno = &amp;apos;&amp;quot; &amp;amp; loanref &amp;amp; &amp;quot;&amp;apos;&amp;quot;
loannumber = NLSapp.SQLSelectStatement(strSQL2)

strSQL3 = &amp;quot;select open_maturity_date from loanacct where acctrefno = &amp;apos;&amp;quot; &amp;amp; loanref &amp;amp; &amp;quot;&amp;apos;&amp;quot;
maturity = NLSapp.SQLSelectStatement(strSQL3)

strSQL4 = &amp;quot;select first_principal_payment_date from loanacct_payment where acctrefno = &amp;apos;&amp;quot; &amp;amp; loanref &amp;amp; &amp;quot;&amp;apos;&amp;quot;
FirstPayment = NLSapp.SQLSelectStatement(strSQL4)


TotalPayments = NLSapp.AmortizeLoanInMemory(maturity, loanref)

NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF47&amp;quot;,TotalPayments  
NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF48&amp;quot;,FirstPayment
NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF49&amp;quot;,maturity 
NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF50&amp;quot;,loannumber

NLSapp.SetFieldAttribute &amp;quot;LOAN_DETAIL1_UDF44&amp;quot;, RGB(0,0,0), RGB(155,155,155), false

NLSapp.SaveScreen()&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;565&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;130&quot; FieldTopPos=&quot;565&quot; FieldWidth=&quot;262&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;26&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="565.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="130.0000000000" FieldTopPos="565.0000000000" FieldWidth="262.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="26">
<USERDEFDATA row_id="2797" field_reference="5449" field_data="Client satisfied - no known issues" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2798" field_reference="5449" field_data="C+ loan interest rate confusion/concern" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2799" field_reference="5449" field_data="C+ loan balance confusion/concern" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2800" field_reference="5449" field_data="C+ loan duration confusion/concern" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2801" field_reference="5449" field_data="FDR negotiations % or process confusion/concern" field_order="4" field_data_attribute="0"/>
<USERDEFDATA row_id="2802" field_reference="5449" field_data="FDR fees confusion/concern" field_order="5" field_data_attribute="0"/>
<USERDEFDATA row_id="2803" field_reference="5449" field_data="FDR customer service concern" field_order="6" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="295" field_type="0" field_attribute="3" label_text="ACH Company ID" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;27&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="222.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="222.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="27"/>
<USERDEFFIELDS field_id="243" field_type="0" field_attribute="0" label_text="Contribution Date" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;247&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;250&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;28&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="247.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="250.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="28"/>
<USERDEFFIELDS field_id="294" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;29&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="200.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="200.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="29"/>
<USERDEFFIELDS field_id="242" field_type="0" field_attribute="0" label_text="Contributing Investor" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;781&quot; StaticTopPos=&quot;225&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;890&quot; FieldTopPos=&quot;228&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;30&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="781.0000000000" StaticTopPos="225.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="890.0000000000" FieldTopPos="228.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="30"/>
<USERDEFFIELDS field_id="293" field_type="0" field_attribute="3" label_text="Message" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;31&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="178.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="178.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="31"/>
<USERDEFFIELDS field_id="241" field_type="4" field_attribute="0" label_text="Loan Modification Request" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;###UDF41(CPlus)
&apos;When Field Changes (Start a Loan Modification Request)
&apos;Creates a loan mod TASK

&apos;LOAN variables
loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
loannumber = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
getmodtype = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF41&quot;)
loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)

&apos;Task variables
templateno = TEMPLATE_NUM_LOAN_MODIFICATIONS_II
defaultstatusno = TEMPLATE_STATUS_STARTED
queue = TEMPLATE_QUEUE_MODIFICATIONS


&apos;Change Start a Loan Modification Request field (UDF41) back to default &quot;Choose an Option&quot;
NLSApp.SetField &quot;LOAN_DETAIL1_UDF41&quot;, &quot;Choose an Option&quot;
NLSApp.RefreshScreen()

If Not getmodtype = &quot;Choose an Option&quot; Then
    If addloanMod(getmodtype, loanrefno, loanstatus) = &quot;&quot; Then
    End If
End If
NLSApp.SaveScreen()



Function addloanMod(modtype, loanrefno, status)

    &apos;TASK variables
    currate = NLSApp.SQLSelectStatement(&quot;SELECT convert(varchar(6),convert( numeric(7,2),current_interest_rate))+&apos;%&apos; from loanacct where acctrefno = &quot; &amp; loanrefno)
    currpmt = NLSApp.SQLSelectStatement(&quot;SELECT  &apos;$&apos; + convert(varchar(6),convert( numeric(9,2), next_payment_total_amount)) from loanacct_payment where acctrefno = &quot; &amp; loanrefno)
    currdate = NLSApp.SQLSelectStatement(&quot;select  convert(char(10),getdate(),111)&quot;)
    currdatetime = NOW()
    hardship = &quot;Choose an Option&quot;

    &apos;User input for modification requestor Optins a. borrower, b. co-borrower, c. 3rd party
    requestpromt = &quot;Who is requesting the &quot; &amp; getmodtype &amp; &quot;?&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;A -  Borrower&quot; &amp; chr(13) &amp; &quot;B -  Co-Borrower&quot; &amp; chr(13) &amp; &quot;C -  Third party&quot;
    requestorcode = InputBox(requestpromt, &quot;Requestor&quot;, &quot;A&quot;)

    &apos;Borrower/Co-borrower detail sql lookups
    borrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, loanacct l where l.cifno = c.cifno and l.acctrefno = &quot; &amp; loanrefno
    coborrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, cif_loan_relationship clr where clr.cifno = c.cifno and clr.acctrefno = &quot; &amp; loanrefno

    &apos;Previous approved deferral lookup
    prevdeflookupsql = &quot;SELECT count(t.task_refno) from task t, task_detail td where t.task_refno = td.task_refno AND t.status_code_id = 8 AND t.task_template_no = 7 AND td.userdef01 = &apos;Deferral&apos; AND t.NLS_refno = &quot; &amp; loanrefno
   
   
    Select Case requestorcode
        Case &quot;A&quot;, &quot;a&quot;
            requestor = &quot;Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(borrowerlookupsql)
        Case &quot;B&quot;, &quot;b&quot;
            requestor = &quot;Co-Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(coborrowerlookupsql)
            If requestordetail = &quot;&quot; Then
                NLSApp.MessageBox(&quot;Co-Borrower information cannot be located.&quot; &amp; chr(13) &amp; &quot;Please validate that Co-borrower exists and Retry.&quot;)
                NLSApp.MessageBox(&quot;Operation Canceled.&quot;)
                Exit Function
            End If
        Case &quot;C&quot;, &quot;c&quot;
            requestor = &quot;Third_Party (See Notes)&quot;
            requestordetail = &quot;ENTER 3rd Party details here.&quot;
        Case &quot;&quot;
            NLSApp.MessageBox(&quot;Modification Canceled.&quot;)
            Exit Function
        Case Else
            NLSApp.MessageBox(&quot;Invalid Selection.&quot; &amp; chr(13) &amp; &quot;Please Try Again.&quot;)
            Exit Function
    End Select

    SELECT CASE getmodtype
        CASE &quot;Deferral&quot;
        &apos;Look up the # of previously approved deferrals
            prevdefs = NLSapp.SQLSelectStatement(prevdeflookupsql)
       CASE &quot;SCRA&quot;
       &apos;auto-pop udf2 with SCRA
            hardship = &quot;SCRA&quot;
        END SELECT


    &apos;TASK OBJECT CREATION
    If status = &quot;ACTIVE&quot; Then
        Set Task = NLSApp.Tasks.New(templateno)
        NLSApp.Tasks.BeginTransaction
        Task.StatusCodeID = defaultstatusno
        Task.WorkQueueCodeID = queue
        Task.NLSRefno = loanrefno
        Task.UDF1 = modtype
        Task.UDF2 = hardship
        Task.UDF9 = prevdefs
        Task.UDF10 = currpmt
        Task.UDF12 = currdate
        Task.UDF14 = currate
        Task.UDF18 = requestor
        Task.UDF23 = currdate
        Task.UDF25 = requestordetail

        If (Task.Save = -1) Then
            NLSApp.Tasks.RollbackTransaction
            NLSApp.MessageBox(&quot;Task not created.&quot;)
            addloanMod = -1
        Else
            NLSApp.Tasks.CommitTransaction
            NLSApp.MessageBox(&quot;Loan Modification TASK created.&quot; &amp; Chr(13) &amp; &quot;Please go the the Task Tab to complete the modification record.&quot;)
            addloanMod = &quot;&quot;
        End If
    Else
        NLSApp.MessageBox(&quot;The Loan must be in ACTIVE status to add a Modification task&quot;)
    End If

End Function**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;132&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;21&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;120&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;32&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="10.0000000000" StaticWidth="132.0000000000" StaticHeight="20.0000000000" FieldLeftPos="21.0000000000" FieldTopPos="29.0000000000" FieldWidth="120.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="32">
<USERDEFDATA row_id="2804" field_reference="5446" field_data="Choose an Option" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2805" field_reference="5446" field_data="Deferral" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2806" field_reference="5446" field_data="Interest Rate Reduction" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2807" field_reference="5446" field_data="Lower Payment/Term Extension" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2808" field_reference="5446" field_data="SCRA" field_order="4" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="292" field_type="0" field_attribute="3" label_text="Account Number Encrypt" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;33&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="156.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="156.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="33"/>
<USERDEFFIELDS field_id="240" field_type="6" field_attribute="0" label_text="Legal Action" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Activate CnD&quot; Script=&quot;&amp;apos;FFLS-379 Add Cease and Desist Button
	&amp;apos; 1.  Remove loan statements from loan setup
	&amp;apos; 2.  Remove email address from Communication Preferences
	&amp;apos; 3.  Remove all alerts from Communication Preferences
	&amp;apos; 4.  Obfuscate borrower and co-borrower email to [borrower@ffn1.com]@cnd (for tracking)
&amp;apos;FFLS-656 Remove Scripting that Disables Statements for CND
    &amp;apos; 1.  Comment out SQL update lines that effect communication preferences
	
If NLSApp.YesNoMessageBox(&amp;quot;Are Sure you want to Activate a Cease and Desist for this loan?&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;This can only be undone manually.&amp;quot;) Then
&amp;apos;Set variables	
	loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
	cifnumber = NLSApp.GetField(&amp;quot;LOAN_CIFNUMBER&amp;quot;)
	cocifnumber = NLSApp.SQLSelectStatement(&amp;quot;SELECT c2.cifnumber , c2.email, c2.email2  from loanacct l, cif c2, cif_loan_relationship clr where c2.cifno = clr.cifno and l.acctrefno = clr.acctrefno and clr.acctrefno = &amp;quot; &amp;amp; loanrefno)
	email1 = NLSApp.SQLSelectStatementNextColumn()
	email2 = NLSApp.SQLSelectStatementNextColumn()
	
               &amp;apos;1-3 SQL to update loan setup and communication
                                cndsqlupdates = &amp;quot;SELECT 0; &amp;quot; &amp;amp; _
                                &amp;quot;UPDATE loanacct_setup SET statement1_code = 0, statement2_code = 0, late_fee_code = 0 WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
                                &amp;quot;DELETE from LoanCommunicationAddress WHERE LoanCommunicationPreferencesID IN (SELECT LoanCommunicationPreferencesID FROM LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
                                &amp;quot;UPDATE LoanCommunicationPreferences SET StatementOptionFlags = 0, LateNoticeOptionFlags = 0 from LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
                                &amp;quot;--UPDATE loanacct SET collection_officer_no = 0    WHERE acctrefno = &amp;quot; &amp;amp; loanrefno
 
               &amp;apos;Run UPDATES
                                NLSApp.SQLSelectStatement(cndsqlupdates)
                                ImportXML(&amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanrefno &amp;amp; &amp;quot;&amp;quot;&amp;quot; CollectionOfficerNumber=&amp;quot;&amp;quot;0&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;)

	&amp;apos;Add Loan Status change to &amp;quot;CEASE AND DESIST ACTIVE&amp;quot;
		 loanxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanrefno &amp;amp; _
		 &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;lt;LOANSTATUSES Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;CEASE AND DESIST ACTIVE&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
		 &amp;quot;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
	
	&amp;apos;4 Updates to obfuscate email addresses
		ImportXML(loanxmlstring) 
		If Not cocifnumber = &amp;quot;&amp;quot; Then
		 cocifxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cocifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp;  &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
		 ImportXML(cocifxmlstring)
		End if
		
	NLSApp.RefreshScreen()
Else
	NLSApp.MessageBox(&amp;quot;CnD Canceled.&amp;quot;)
End if&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;162&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;99&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;160&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;113&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;34&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="162.0000000000" StaticTopPos="10.0000000000" StaticWidth="99.0000000000" StaticHeight="20.0000000000" FieldLeftPos="160.0000000000" FieldTopPos="29.0000000000" FieldWidth="113.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="34"/>
<USERDEFFIELDS field_id="291" field_type="0" field_attribute="3" label_text="Payment Date" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;35&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="134.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="134.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="35"/>
<USERDEFFIELDS field_id="239" field_type="4" field_attribute="0" label_text="Loan Sale Buyer" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**NLSapp.LoadComboList 0, &quot;LOAN_DETAIL1_UDF39&quot;, &quot;SELECT cifnumber from cif where cifnumber like &apos;Debt BUYER%&apos; &quot;**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;924&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;925&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;117&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;36&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="924.0000000000" StaticTopPos="10.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="925.0000000000" FieldTopPos="29.0000000000" FieldWidth="117.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="36">
<USERDEFDATA row_id="2964" field_reference="5444" field_data="CKS FINANCIAL" field_order="0" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="290" field_type="0" field_attribute="3" label_text="Check Number" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;37&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="112.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="112.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="37"/>
<USERDEFFIELDS field_id="238" field_type="0" field_attribute="4" label_text="WC Date" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;NLSApp.SaveScreen()**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;543&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;543&quot; FieldWidth=&quot;260&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;38&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="543.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="543.0000000000" FieldWidth="260.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="38"/>
<USERDEFFIELDS field_id="289" field_type="0" field_attribute="3" label_text="Accoun Number" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;39&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="90.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="90.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="39"/>
<USERDEFFIELDS field_id="237" field_type="3" field_attribute="0" label_text="WC Agent" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL1_UDF38&quot;, CurrentDate

NLSApp.SaveScreen()

LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
WCAgent = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF37&quot;)
WCdate = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF38&quot;)
WCStatus = NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF44&quot;)

If not right(WCAgent,9) =  &quot;COMPLETED&quot; THEN

	notes = &quot;Additional Notes:&quot;  &amp; chr(13) &amp;addnotes
	commenthd = &quot;Welcome Call Attempt &quot;  &amp; right(WCAgent ,2)
	
	XMLA = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot;
	XMLB = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; LoanNo &amp; &quot;&quot;&quot;&gt;&quot;
	XMLC = &quot;&lt;LOANCOMMENTS Comment=&quot;&quot;&quot; &amp; commenthd &amp;  &quot;&quot;&quot; Category=&quot;&quot;SERVICING NOTES&quot;&quot; CommentDescription=&quot;&quot;WC Activity&quot;&quot;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
	
	
	xmlstrng = XMLA &amp; XMLB &amp; XMLC
	
	&apos;NLSApp.MessageBox(xmlstrng)
	
	NLSApp.SaveScreen()
	
	ImportXML(xmlstrng)
End if**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**UserID = NLSApp.GetCurrentUserNo( )

SQLtxt = &quot;SELECT username+&apos; - &apos;+shortname FROM nlsusers, CIF WHERE CIFno IN (&apos;51973&apos;,&apos;51974&apos;,&apos;51975&apos;,&apos;51976&apos;) AND userno = &quot; &amp; UserID 


NLSapp.LoadComboList 1, &quot;LOAN_DETAIL1_UDF37&quot;, SQLtxt**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;521&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;521&quot; FieldWidth=&quot;260&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;40&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="521.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="521.0000000000" FieldWidth="260.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="40"/>
<USERDEFFIELDS field_id="288" field_type="0" field_attribute="3" label_text="ABA Number" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;41&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="68.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="68.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="41"/>
<USERDEFFIELDS field_id="236" field_type="1" field_attribute="0" label_text="Loan Fees Paid by Investors to FFAM" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;783&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;157&quot; StaticHeight=&quot;30&quot; FieldLeftPos=&quot;941&quot; FieldTopPos=&quot;96&quot; FieldWidth=&quot;168&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;42&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="783.0000000000" StaticTopPos="90.0000000000" StaticWidth="157.0000000000" StaticHeight="30.0000000000" FieldLeftPos="941.0000000000" FieldTopPos="96.0000000000" FieldWidth="168.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="42"/>
<USERDEFFIELDS field_id="287" field_type="0" field_attribute="3" label_text="Name on Account" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;43&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="46.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="46.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="43"/>
<USERDEFFIELDS field_id="235" field_type="5" field_attribute="0" label_text="Limit Sharing" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;Script to update CIF based on limiit sharing box being checked or not checked.

NLSApp.SetFocus (&quot;LOAN_NUMBER&quot;)
LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
loanref= NLSapp.GetField(&quot;LOAN_REFNO&quot;)
CIFNo1 =NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)

strSQL1 =&quot;SELECT count(acctrefno) FROM cif_loan_relationship WHERE acctrefno = &apos;&quot; &amp; loanref &amp; &quot;&apos;&quot;

COCIFYN = NLSapp.SQLSelectStatement(strSQL1)

strSQL2 =&quot;SELECT cif.cifnumber &quot; &amp; _
		&quot;FROM cif_loan_relationship clr, cif cif &quot; &amp; _
		&quot;WHERE clr.cifno = cif.cifno  &quot; &amp; _
		&quot;AND relationship_code_id = &apos;1&apos; &quot; &amp; _
		&quot;AND clr.acctrefno = &apos;&quot; &amp; loanref &amp; &quot;&apos;&quot;

CIFNo2 = NLSapp.SQLSelectStatement(strSQL2)

If NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF35&quot;) = &quot;CHECK&quot; THEN
	LimistShareYN = &quot;1&quot;
	ELSE
	LimistShareYN = &quot;0&quot;
END IF

XMLA = &quot;&lt;NLS&gt;&quot; 
XMLB = &quot;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot; &amp; chr(34) &amp; CIFNo1 &amp; chr(34) &amp; &quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot;&gt;&lt;CIFDETAIL CIFDetail2=&quot; &amp; chr(34) &amp; LimistShareYN &amp; chr(34) &amp; &quot;/&gt;&quot; 
XMLC = &quot;&lt;/CIF&gt;&quot; &amp;CHR(13) &amp; &quot;&lt;/NLS&gt;&quot;


xmlstrng1 = XMLA &amp; CHR(13) &amp; XMLB &amp; CHR(13) &amp; XMLC

ImportXML(xmlstrng1)

If Not COCIFYN = 0 Then
	XMLD = &quot;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot; &amp; chr(34) &amp; CIFNo2 &amp; chr(34) &amp; &quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot;&gt;&lt;CIFDETAIL CIFDetail2=&quot; &amp; chr(34) &amp; LimistShareYN &amp; chr(34) &amp; &quot;/&gt;&quot; 
	xmlstrng2 = XMLA &amp; CHR(13) &amp; XMLD &amp; CHR(13) &amp; XMLC

	ImportXML(xmlstrng2)

End If





&apos;NLSApp.SetField &quot;LOAN_DETAIL1_UDF43&quot;,xmlstrng &amp; CHR(13) &amp;CIFNo1 


Function ImportXML(xml)
      NLSApp.ClearErrorString()
      
      If Not NLSApp.ImportXMLRecord(xml) Then
            If True Then
                  NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
            End If
            ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
      Else
&apos;            NLSApp.MessageBox(&quot;ECOA Status Updated.&quot;)
                    ImportXML = &quot;&quot;
      End If
End Function

NLSApp.SaveScreen()**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;496&quot; StaticWidth=&quot;76&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;496&quot; FieldWidth=&quot;260&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;44&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="496.0000000000" StaticWidth="76.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="496.0000000000" FieldWidth="260.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="44"/>
<USERDEFFIELDS field_id="286" field_type="0" field_attribute="3" label_text="Paymnet Amount" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;45&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="24.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="24.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="45"/>
<USERDEFFIELDS field_id="234" field_type="5" field_attribute="0" label_text="Phone Consent" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="1" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;478&quot; StaticWidth=&quot;76&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;478&quot; FieldWidth=&quot;260&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;46&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="478.0000000000" StaticWidth="76.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="478.0000000000" FieldWidth="260.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="46"/>
<USERDEFFIELDS field_id="285" field_type="3" field_attribute="3" label_text="Status" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;742&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;100&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;47&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="742.0000000000" StaticTopPos="2.0000000000" StaticWidth="100.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="2.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="47">
<USERDEFDATA row_id="3006" field_reference="5490" field_data="SUBMITTED" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="3007" field_reference="5490" field_data="PENDING" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="3008" field_reference="5490" field_data="COMPLETED" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="3009" field_reference="5490" field_data="CANCELLED" field_order="3" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="233" field_type="5" field_attribute="0" label_text="Email Consent" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;459&quot; StaticWidth=&quot;83&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;459&quot; FieldWidth=&quot;260&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;48&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="459.0000000000" StaticWidth="83.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="459.0000000000" FieldWidth="260.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="48"/>
<USERDEFFIELDS field_id="284" field_type="0" field_attribute="3" label_text="ACH Trace ID" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;743&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;848&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;49&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="743.0000000000" StaticTopPos="354.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="848.0000000000" FieldTopPos="354.0000000000" FieldWidth="247.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="49"/>
<USERDEFFIELDS field_id="232" field_type="6" field_attribute="4" label_text="" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;TBD&quot; Script=&quot;&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;754&quot; StaticTopPos=&quot;120&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;555&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;113&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;50&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="754.0000000000" StaticTopPos="120.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="555.0000000000" FieldTopPos="29.0000000000" FieldWidth="113.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="50"/>
<USERDEFFIELDS field_id="283" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;409&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;486&quot; FieldTopPos=&quot;409&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;51&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="409.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="486.0000000000" FieldTopPos="409.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="51"/>
<USERDEFFIELDS field_id="231" field_type="6" field_attribute="0" label_text="" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;BK-Notice&quot; Script=&quot;&amp;apos;###Loan Detail 1 UDF33
&amp;apos;on Button click option selection
&amp;apos;Creates a Bankruptcy TASK

loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)

&amp;apos;ACTIVE BK TASK lookup
activeBKtsksql = &amp;quot;select count(t.task_refno) from task t, task_template tt, task_status_codes tsc&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;where t.task_template_no = tt.task_template_no and t.status_code_id = tsc.status_code_id&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;and tt.task_template_name in (&amp;apos;BANKRUPTCY&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
&amp;quot;and status_code not in (&amp;apos;BK-DISMISSED&amp;apos;,&amp;apos;BK-COMPLETED&amp;apos;,&amp;apos;BK-INVALID&amp;apos;,&amp;apos;BK-DISSCHARGED&amp;apos;) and nls_refno = &amp;quot; &amp;amp; loanrefno

activeBKtsk = NLSapp.SQLSelectStatement(activeBKtsksql)

&amp;apos;If there are no active BK tasks(Statuses TBD) process request
If  activeBKtsk = 0 Then
    NLSApp.SaveScreen()
    addBKTask (loanrefno)
Else
    NLSApp.Messagebox(&amp;quot;Canceling request.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;This loan already has an active bankruptcy notice in the processing queue.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Please contact the Bankrupcy Administration group.&amp;quot;)
End if 

&amp;apos;-------------------------------------------------------------------------------------
&amp;apos;SUB
Sub addBKTask (loanrefno)
    &amp;apos;LOAN variables
    loanstatus1 = NLSApp.GetField(&amp;quot;LOAN_STATUS&amp;quot;)
    loanstatus2 = NLSApp.GetField(&amp;quot;LOAN_STATUS_SECONDARY&amp;quot;)
    loannumber = NLSApp.GetField(&amp;quot;LOAN_NUMBER&amp;quot;)
    Userno = NLSApp.GetCurrentUserNo( )


    &amp;apos;Task variables
    templateno = TEMPLATE_NUM_BANKRUPTCY
    defaulttskstatus = TEMPLATE_STATUS_BK_NOTICE
    workqueue = TEMPLATE_QUEUE_BANKRUPTCY

    &amp;apos;Who is supplying the notice?
    sourcepromt =    &amp;quot;Who is giving the Bankruptcy Notice?&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;A -  Attorney&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;B -  Borrower and or Co-Borrower&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;C -  Correspondence&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;D -  FirstSweep&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;E -  Other&amp;quot;
    sourcecode = noticesource(UCase(InputBox(sourcepromt, &amp;quot;BK-Notice Source&amp;quot;, &amp;quot;A&amp;quot;)))
    If sourcecode = -1 Then
        NLSApp.MessageBox(&amp;quot;Notice Canceled or Invalid Selection.&amp;quot;  &amp;amp; chr(13) &amp;amp; &amp;quot;Please Try Again.&amp;quot;)
        Exit sub
    End if
    &amp;apos;Atty name and Phone?
    attypromt1 = &amp;quot;Enter The Attorney&amp;apos;s name&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(Optional if you have the Court Case#.)&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_ 
	&amp;quot;Hit [OK] if you have the  Case# but no attorney Information.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;If you do not know either, hit [Cancel].&amp;quot;
    attypromt2 = &amp;quot;Enter The Attorney&amp;apos;s phone number.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(10 digits only.)&amp;quot;
	attypromt3 = &amp;quot;Please enter the court case#.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(Optional if you have entered the attorney&amp;apos;s name.)&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_
	&amp;quot;If you do not have it hit [OK] to proceed or [Cancel] to quit.&amp;quot;
	attypromt4 = &amp;quot;A valid phone# is required when an attorney name is supplied.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Entry MUST be 10 digits and all numeric.&amp;quot;

    attypromt1 = &amp;quot;Enter The Attorney&amp;apos;s name and Click [OK]&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;OR&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_ 
    &amp;quot;Click [OK] if you only know the  Case#.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;If you do not know either, Click [Cancel].&amp;quot;
    attypromt2 = &amp;quot;Enter The Attorney&amp;apos;s phone number.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;(10 digits only.)&amp;quot;
    attypromt3 = &amp;quot;Enter the court Case# and Click [OK].&amp;quot; &amp;amp; chr(13)&amp;amp; chr(13) &amp;amp;_
    &amp;quot;If you do not have it, Click [Cancel].&amp;quot;
    attypromt4 = &amp;quot;A valid phone# is required when an attorney name is supplied.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Entry MUST be 10 digits and all numeric.&amp;quot;


    &amp;apos;Either Attorney name or case# is required or the process is aborted   
    attyname = InputBox(attypromt1, &amp;quot;Attorney&amp;quot;, &amp;quot;Enter Attorney&amp;quot;)

    If not attyname = &amp;quot;&amp;quot; and not attyname = &amp;quot;Enter Attorney&amp;quot; Then

        Do
            validphone = 0
            attyphone = InputBox(attypromt2, &amp;quot;Attorney Phone&amp;quot;, &amp;quot;#########&amp;quot;)
            if IsNumeric(attyphone) = True and len(attyphone) = 10 Then
                validphone = 1
            Else

                If MsgBox (attypromt4, 21,&amp;quot;Invalid Phone Number!&amp;quot;) = 2 Then
                    &amp;apos;If user selects [Cancel]
                    NLSApp.Messagebox(&amp;quot;Canceling.&amp;quot;)
                    Exit Sub
                End If
            End if
        Loop until validphone = 1


        caseno = InputBox(attypromt3, &amp;quot;Case #&amp;quot;, &amp;quot;&amp;quot;)
        
        &amp;apos;combine all attorney info into a formatted text string
        AttyInfo = attyname &amp;amp; chr(13) &amp;amp; &amp;quot; (&amp;quot; &amp;amp; left(attyphone,3) &amp;amp; &amp;quot;) &amp;quot; &amp;amp; Mid(attyphone,4,3) &amp;amp; _
        &amp;quot;-&amp;quot; &amp;amp; right(attyphone,4)
    Else
        If attyname = &amp;quot;&amp;quot; Then
            NLSApp.Messagebox(&amp;quot;Canceling.&amp;quot;)
            Exit Sub
        Else
            caseno = InputBox(attypromt3, &amp;quot;Case #&amp;quot;, &amp;quot;&amp;quot;)
        End if
    
    End if   

    If attyname = &amp;quot;Enter Attorney&amp;quot; and caseno = &amp;quot;&amp;quot;  Then
        NLSApp.Messagebox(&amp;quot;Attorney Name and Phone Number OR Case # are required to accept a bankruptcy notice and start the process.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp;&amp;quot;Canceling.&amp;quot;)
        Exit Sub
    End if

    &amp;apos;Get loan borrower and co-borrower detail functions
    borrowerinfo = getborrowercifdetails (loanrefno) &amp;amp;  getborrowerphndetails (loanrefno)
    coborrowerinfo = getcoborrowercifdetails (loanrefno) &amp;amp; getcoborrowerphndetails (loanrefno)
    If coborrowerinfo = &amp;quot;&amp;quot; Then
        coborrowerinfo = &amp;quot;N/A&amp;quot;
    End if 

    &amp;apos;Build the Task
    If not buildBKTask (loanrefno,templateno,defaulttskstatus,workqueue,Userno,sourcecode,borrowerinfo,coborrowerinfo,AttyInfo,caseno) = -1 Then 
        &amp;apos;Add loan status
        NLSApp.SetSecondaryLoanStatus loanrefno,NOW(),LOAN_STATUS_BK_NOTICE,&amp;quot;ADD&amp;quot;
        NLSApp.RefreshScreen()
    End if

End Sub


&amp;apos;-------------------------------------------------------------------------------------
&amp;apos;FUNCTIONS

Function getborrowercifdetails (refno)
&amp;apos;Looks up loan primary contact details (required)
    lookupdetailssql =  &amp;quot;select &amp;apos;Contact Number:  &amp;apos; + c.cifnumber  + char(13) + &amp;apos;Entry Date:  &amp;apos; + convert(char(11),c.setupdate) + char(13)  + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;Name:  &amp;apos; + c.firstname1 + &amp;apos; &amp;apos; +c.lastname1  + char(13)  + street_address1 + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when street_address2 is null Then &amp;apos;&amp;apos; Else  street_address2 +  char(13) end + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;city + &amp;apos;, &amp;apos; +  state + &amp;apos; &amp;apos; + zip +  char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL1 :&amp;apos; + case when c.email is null then &amp;apos;&amp;apos; else c.email end + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL2 :&amp;apos; + case when c.email2 is null then &amp;apos;&amp;apos; else c.email end + char(13) &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.cifno = c.cifno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno

    getborrowercifdetails = NLSapp.SQLSelectStatement(lookupdetailssql)
End function

Function getcoborrowercifdetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select &amp;apos;Contact Number:  &amp;apos; + c.cifnumber  + char(13) + &amp;apos;Entry Date:  &amp;apos; + convert(char(11),c.setupdate) + char(13)  + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;Name:  &amp;apos; + c.firstname1 + &amp;apos; &amp;apos; +c.lastname1  + char(13)  + street_address1 + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when street_address2 is null Then &amp;apos;&amp;apos; Else  street_address2 +  char(13) end + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;city + &amp;apos;, &amp;apos; +  state + &amp;apos; &amp;apos; + zip +  char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL1 :&amp;apos; + case when c.email is null then &amp;apos;&amp;apos; else c.email end + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL2 :&amp;apos; + case when c.email2 is null then &amp;apos;&amp;apos; else c.email end + char(13) &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c, cif_loan_relationship clr &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = clr.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and clr.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno

    getcoborrowercifdetails = NLSapp.SQLSelectStatement(lookupdetailssql)
End function




Function getborrowerphndetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select distinct phone_raw + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when primary_flag = 1 Then &amp;apos; Primary&amp;apos; Else &amp;apos; &amp;apos; + (case when comments is null then &amp;apos;&amp;apos; else comments end) end,primary_flag&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, cif c&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join cif_phone_nums cp&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on  c.cifno = cp.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and len(cp.phone_raw) in (10,12,11)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno &amp;amp; chr(13) &amp;amp; _
        &amp;quot;order by primary_flag desc&amp;quot;

    phoneheader  = chr(13) &amp;amp; &amp;quot;Phone Number(s)/Type&amp;quot;        
    currphn = NLSapp.SQLSelectStatement(lookupdetailssql) 

    If not IsNull(currphn) = True Then
        Do until currphn = &amp;quot;***END OF RESULT***&amp;quot;
        
        phonelist = phonelist &amp;amp; chr(13) &amp;amp; currphn
        currphn = NLSApp.SQLSelectStatementReadNext()
        
	    Loop
	Else
	    phonelist = &amp;quot;N/A&amp;quot;
	End if
    getborrowerphndetails =    phoneheader &amp;amp;  phonelist
   
    
    
End function

Function getcoborrowerphndetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select distinct phone_raw + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when primary_flag = 1 Then &amp;apos; Primary&amp;apos; Else &amp;apos; &amp;apos; + case when comments is null then &amp;apos;&amp;apos; else comments end end,primary_flag&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c, cif_loan_relationship clr &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join cif_phone_nums cp &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on  clr.cifno = cp.cifno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = clr.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and clr.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and len(phone_raw) in (10,12)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno &amp;amp; chr(13) &amp;amp; _
        &amp;quot;order by primary_flag desc&amp;quot;

    phoneheader  = chr(13) &amp;amp; &amp;quot;Phone Number(s)/Type&amp;quot;        
    currphn = NLSapp.SQLSelectStatement(lookupdetailssql) 

    If not IsNull(currphn) = True Then
        Do until currphn = &amp;quot;***END OF RESULT***&amp;quot;
        
        phonelist = phonelist &amp;amp; chr(13) &amp;amp; currphn
        currphn = NLSApp.SQLSelectStatementReadNext()
        
	    Loop
	Else
	    phonelist = &amp;quot;N/A&amp;quot;
	End if
 
    getcoborrowerphndetails = phoneheader &amp;amp;  phonelist
End function

Function buildBKTask (refno,tasktemplateno,status,queue,uidno,source,BoInfo,CoInfo,AttyInfo,filecasealphanum)
    &amp;apos;TASK OBJECT CREATION
        Set Task = NLSApp.Tasks.New(tasktemplateno)
        NLSApp.Tasks.BeginTransaction
        Task.StatusCodeID = status
        Task.NLSRefno = refno
        Task.WorkQueueCodeID = queue
        Task.CreatorUID = uidno
        Task.UDF1 = source
        Task.UDF4 = BoInfo
        Task.UDF5 = CoInfo
        Task.UDF22 = filecasealphanum
        Task.UDF23 = AttyInfo
 
        If (Task.Save = -1) Then
            NLSApp.Tasks.RollbackTransaction
            NLSApp.MessageBox(&amp;quot;Task not created.&amp;quot;)
            buildBKTask = -1
        Else
            NLSApp.Tasks.CommitTransaction
            NLSApp.MessageBox(&amp;quot;Bankruptcy TASK created and added to BK Queue for processing.&amp;quot;)
            buildBKTask = &amp;quot;&amp;quot;
        End If

end Function

Function noticesource(sourcecode)
    Select Case sourcecode
        Case &amp;quot;A&amp;quot;
            source = &amp;quot;Attorney&amp;quot;
        Case &amp;quot;B&amp;quot;
            source = &amp;quot;Customer&amp;quot;        
        Case &amp;quot;C&amp;quot;
            source = &amp;quot;Correspondence&amp;quot;
        Case &amp;quot;D&amp;quot;
            source = &amp;quot;First Sweep&amp;quot;
        Case &amp;quot;E&amp;quot;
            source = &amp;quot;Other&amp;quot;
        Case Else
            source = -1
    End Select
    noticesource = source
End Function&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;283&quot; StaticTopPos=&quot;98&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;279&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;113&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;52&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="283.0000000000" StaticTopPos="98.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="279.0000000000" FieldTopPos="29.0000000000" FieldWidth="113.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="52"/>
<USERDEFFIELDS field_id="282" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;387&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;486&quot; FieldTopPos=&quot;387&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;53&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="387.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="486.0000000000" FieldTopPos="387.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="53"/>
<USERDEFFIELDS field_id="230" field_type="6" field_attribute="4" label_text="Payments" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Change Bank Info&quot; Script=&quot;&quot;/&gt;
&lt;BUTTON Name=&quot;Add/Edit Recurring ACH&quot; Script=&quot;&quot;/&gt;
&lt;BUTTON Name=&quot;Change Investor&quot; Script=&quot;&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;437&quot; StaticTopPos=&quot;10&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;436&quot; FieldTopPos=&quot;29&quot; FieldWidth=&quot;113&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;54&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="437.0000000000" StaticTopPos="10.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="436.0000000000" FieldTopPos="29.0000000000" FieldWidth="113.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="54"/>
<USERDEFFIELDS field_id="281" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;365&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;486&quot; FieldTopPos=&quot;365&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;55&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="365.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="486.0000000000" FieldTopPos="365.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="55"/>
<USERDEFFIELDS field_id="229" field_type="2" field_attribute="0" label_text="Investor Transfer Date" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Detail 2 UDF45 update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF16(C+)  and Loan Detail 1 UDF29(F+) Field label name Investor sale date
&apos;                    
&apos; Purpose:
&apos; Designed to maintain detail2 udef45 in sync with loan ach_co set up for the purpose of assuring the webpaay portal can see the current code for each new online reqiest.
&apos;	
&apos; Created: 07/18/2017 by Stanley Muhammad 
&apos; Modification History  NA

	class_2 = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
	port =  NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
	ACH_no = ACHCoIDUDF45(class_2,port)
	Curr_ACH_Co_UDF45 = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF45&quot;)
	If  ACH_no &lt;&gt; Curr_ACH_Co_UDF45  Then
		NLSApp.SetField &quot;LOAN_DETAIL2_UDF45&quot;, ACH_no
	End If

&apos;When Field Changes
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click/Box check-uncheck
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions**###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;422&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;422&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;56&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="422.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="422.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="56"/>
<USERDEFFIELDS field_id="280" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;343&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;486&quot; FieldTopPos=&quot;343&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;57&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="343.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="486.0000000000" FieldTopPos="343.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="57"/>
<USERDEFFIELDS field_id="228" field_type="2" field_attribute="0" label_text="Modification Date" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;414&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;414&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;58&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="414.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="414.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="58"/>
<USERDEFFIELDS field_id="279" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;486&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;248&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;59&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="244.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="486.0000000000" FieldTopPos="244.0000000000" FieldWidth="248.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="59"/>
<USERDEFFIELDS field_id="226" field_type="0" field_attribute="0" label_text="Original Term" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;247&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;247&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;60&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="247.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="247.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="60"/>
<USERDEFFIELDS field_id="278" field_type="1" field_attribute="0" label_text="Decile" min_value="0.0000000000" max_value="10.0000000000" field_precision="0" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;612&quot; StaticTopPos=&quot;158&quot; StaticWidth=&quot;32&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;746&quot; FieldTopPos=&quot;158&quot; FieldWidth=&quot;34&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;61&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="612.0000000000" StaticTopPos="158.0000000000" StaticWidth="32.0000000000" StaticHeight="20.0000000000" FieldLeftPos="746.0000000000" FieldTopPos="158.0000000000" FieldWidth="34.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="61"/>
<USERDEFFIELDS field_id="225" field_type="0" field_attribute="0" label_text="Original Payment Amount" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;225&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;225&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;62&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="225.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="225.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="62"/>
<USERDEFFIELDS field_id="277" field_type="1" field_attribute="0" label_text="Weighted Dollar" min_value="0.0000000000" max_value="9,999,999,999.9800000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;612&quot; StaticTopPos=&quot;137&quot; StaticWidth=&quot;88&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;716&quot; FieldTopPos=&quot;136&quot; FieldWidth=&quot;64&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;63&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="612.0000000000" StaticTopPos="137.0000000000" StaticWidth="88.0000000000" StaticHeight="20.0000000000" FieldLeftPos="716.0000000000" FieldTopPos="136.0000000000" FieldWidth="64.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="63"/>
<USERDEFFIELDS field_id="224" field_type="0" field_attribute="3" label_text="Original Loan Amount" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;203&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;203&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;64&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="203.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="203.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="64"/>
<USERDEFFIELDS field_id="276" field_type="1" field_attribute="0" label_text="Propensity To Pay" min_value="0.0000000000" max_value="0.9999900000" field_precision="5" default_value="0000000000000.00000" script_type="0" option_flags="8" script="" object_def="&lt;UDF StaticLeftPos=&quot;612&quot; StaticTopPos=&quot;114&quot; StaticWidth=&quot;96&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;727&quot; FieldTopPos=&quot;117&quot; FieldWidth=&quot;53&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;65&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="612.0000000000" StaticTopPos="114.0000000000" StaticWidth="96.0000000000" StaticHeight="20.0000000000" FieldLeftPos="727.0000000000" FieldTopPos="117.0000000000" FieldWidth="53.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="65"/>
<USERDEFFIELDS field_id="223" field_type="0" field_attribute="4" label_text="Original Interest Rate" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;181&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;181&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;66&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="181.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="181.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="66"/>
<USERDEFFIELDS field_id="275" field_type="6" field_attribute="3" label_text="Cease and Desist" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Activate CnD&quot; Script=&quot;If NLSApp.YesNoMessageBox(&amp;quot;Are you sure you want to Activate a Cease and Desist for this loan?&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;This can only be undone manually.&amp;quot;) Then
	loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
	cifnumber = NLSApp.GetField(&amp;quot;LOAN_CIFNUMBER&amp;quot;)
	cocifnumber = NLSApp.SQLSelectStatement(&amp;quot;SELECT c2.cifnumber , c2.email, c2.email2  from loanacct l, cif c2, cif_loan_relationship clr where c2.cifno = clr.cifno and l.acctrefno = clr.acctrefno and clr.acctrefno = &amp;quot; &amp;amp; loanrefno)
	email1 = NLSApp.SQLSelectStatementNextColumn()
	email2 = NLSApp.SQLSelectStatementNextColumn()
	
	cndsqlupdates = &amp;quot;SELECT 0; &amp;quot; &amp;amp; _
	&amp;quot;UPDATE loanacct_setup SET statement1_code = 0, statement2_code = 0, late_fee_code = 0 WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
	&amp;quot;DELETE from LoanCommunicationAddress WHERE LoanCommunicationPreferencesID IN (SELECT LoanCommunicationPreferencesID FROM LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;UPDATE LoanCommunicationPreferences SET StatementOptionFlags = 0, LateNoticeOptionFlags = 0 from LoanCommunicationPreferences WHERE acctrefno = &amp;quot; &amp;amp; loanrefno &amp;amp; chr(13) &amp;amp; _
	&amp;quot;UPDATE loanacct SET collection_officer_no = 40	WHERE acctrefno = &amp;quot; &amp;amp; loanrefno
	
	NLSApp.SQLSelectStatement(cndsqlupdates)

	&amp;apos;Add Loan Status change to CEASE AND DESIST ACTIVE
	 loanxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loanrefno &amp;amp; _
	 &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;lt;LOANSTATUSES Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; LoanStatusCode=&amp;quot;&amp;quot;CEASE AND DESIST ACTIVE&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

	ImportXML(loanxmlstring) 
	If Not cocifnumber = &amp;quot;&amp;quot; Then
	 cocifxmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cocifnumber &amp;amp; &amp;quot;&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email1 &amp;amp;  &amp;quot;@cnd&amp;quot;&amp;quot; EmailAddress2=&amp;quot;&amp;quot;&amp;quot; &amp;amp; email2 &amp;amp; &amp;quot;@cnd&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
	 ImportXML(cocifxmlstring)
	End if
	NLSApp.MessageBox(&amp;quot;Cease and Desist has been Activated for &amp;quot; &amp;amp; NLSApp.GetField(&amp;quot;LOAN_NUMBER&amp;quot;) &amp;amp; &amp;quot;.&amp;quot;)
	NLSApp.RefreshScreen()
Else
	NLSApp.MessageBox(&amp;quot;CnD Canceled.&amp;quot;)
End if&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;290&quot; StaticTopPos=&quot;19&quot; StaticWidth=&quot;74&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;289&quot; FieldTopPos=&quot;47&quot; FieldWidth=&quot;77&quot; FieldHeight=&quot;26&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;67&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="290.0000000000" StaticTopPos="19.0000000000" StaticWidth="74.0000000000" StaticHeight="20.0000000000" FieldLeftPos="289.0000000000" FieldTopPos="47.0000000000" FieldWidth="77.0000000000" FieldHeight="26.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="67"/>
<USERDEFFIELDS field_id="222" field_type="4" field_attribute="0" label_text="Categories" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Categories update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF22 (C+ and F+ Portfolio) Field label name Categories
&apos;                    
&apos; Purpose:
&apos; Designed to maintain correct communications loan pref when borrowerer and coborrower is reported deseased or BK reported or BK confirmed.
&apos;	
&apos; Created: 04/18/2016 by Stanley Muhammad 
&apos; Modification History  06/30/2017 by Stanley Muhammad             
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
LoanDetailudfF22Update()

Sub LoanDetailudfF22Update()
    loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
    loancif = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)
    loanport = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    udf22 = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF22&quot;)
    status = &quot; &quot;

    lateflag = NLSApp.SQLSelectStatement(&quot;select LateNoticeOptionFlags from LoanCommunicationPreferences  where acctrefno =  &quot; &amp; loanref)
    optin =   NLSApp.SQLSelectStatement(&quot;select CASE WHEN l.portfolio_code_id = 0 THEN  ld.userdef18 else ld.userdef17 END from loanacct_detail ld, loanacct l where l.acctrefno = ld.acctrefno and l.acctrefno = &quot; &amp; loanref)
    
    If optin = 1  Then
        alert = &quot;	&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
            &quot;     &lt;ALERT AlertType=&apos;LateNotice&apos; OptionFlags=&apos;1&apos;/&gt; &quot; &amp; chr(13) &amp; _
            &quot;	 &lt;/ALERTS&gt;&quot;
     Else
        alert = &quot;	&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
            &quot;     &lt;ALERT AlertType=&apos;LateNotice&apos; OptionFlags=&apos;3&apos;/&gt; &quot; &amp; chr(13) &amp; _
            &quot;	 &lt;/ALERTS&gt;&quot;
    end if


    If udf22 = &quot;DECEASED CO-BORROWER&quot; Then
    &apos;Delete co-borrower Email address from loan communication preferences
         loancocif = NLSApp.SQLSelectStatement(&quot;select cifno from cif_loan_relationship where acctrefno = &quot; &amp; loanref)
        If loancocif &lt;&gt; &quot;&quot; Then
            coborroweremail = NLSApp.SQLSelectStatement(&quot;SELECT email from cif where cifno = &quot; &amp; loancocif)
            email = &quot;            &lt;EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
            &quot;                &lt;EMAILADDRESS Operation=&apos;DELETE&apos; Address=&apos;&quot; &amp; coborroweremail &amp; &quot;&apos;/&gt;&quot; &amp; chr(13) &amp; _
            &quot;            &lt;/EMAILADDRESSES&gt;&quot;
        End If
    End If

    If udf22 = &quot;DECEASED BORROWER&quot; Then
    &apos;Delete borrower Email address from loan communication preferences
        borroweremail = NLSApp.SQLSelectStatement(&quot;SELECT email from cif where cifnumber = &apos;&quot; &amp; loancif &amp; &quot;&apos;&quot;)
        email = &quot;            &lt;EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
        &quot;                &lt;EMAILADDRESS Operation=&apos;DELETE&apos; Address=&apos;&quot; &amp; borroweremail &amp; &quot;&apos;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;            &lt;/EMAILADDRESSES&gt;&quot;
    End If


    If udf22 = &quot;BK-AWAITING CONFIRMATION&quot; Or udf22 = &quot;BK-CONFIRMED&quot; Then
    &apos;Disable printing, email and SMS options from loan communication preferences
        &apos;status = &quot;   &lt;LOANSTATUSES Operation=&quot;&quot;ADD&quot;&quot; LoanStatusCode=&quot;&quot;DISABLESTMTS&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; now() &amp; &quot;&quot;&quot;/&gt;&quot; ***Future potential enhancement**
        alert = &quot;	&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;     &lt;ALERT AlertType=&apos;LateNotice&apos; OptionFlags=&apos;0&apos;/&gt; &quot; &amp; chr(13) &amp; _
        &quot;	 &lt;/ALERTS&gt;&quot;

    End If

    xmlstrng = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;LOAN UpdateFlag = &apos;1&apos; AcctRefno =&apos;&quot; &amp; loanref &amp; &quot;&apos;&gt;&quot; &amp; chr(13) &amp; _
        status &amp; chr(13) &amp; _
        &quot;   &lt;COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        email &amp; chr(13) &amp; _
        alert &amp; chr(13) &amp; _
        &quot;	&lt;/COMMUNICATION&gt; &quot; &amp; chr(13) &amp; _
        &quot;  &lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

    NLSApp.SaveScreen()

    ImportXML(xmlstrng)

End Sub
&apos;When Field Changes
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click/Box check-uncheck
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions
**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;159&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;159&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;68&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="159.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="159.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="68">
<USERDEFDATA row_id="2809" field_reference="5427" field_data="NO RESPONSE" field_order="12" field_data_attribute="0"/>
<USERDEFDATA row_id="2810" field_reference="5427" field_data="INTENT TO PAY" field_order="10" field_data_attribute="0"/>
<USERDEFDATA row_id="2811" field_reference="5427" field_data="REFUSAL TO PAY" field_order="15" field_data_attribute="0"/>
<USERDEFDATA row_id="2812" field_reference="5427" field_data="DEFERRED" field_order="7" field_data_attribute="0"/>
<USERDEFDATA row_id="2813" field_reference="5427" field_data="NONE" field_order="13" field_data_attribute="0"/>
<USERDEFDATA row_id="2814" field_reference="5427" field_data="BK-AWAITING CONFIRMATION" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="2815" field_reference="5427" field_data="BK-CONFIRMED" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="2816" field_reference="5427" field_data="RAISING FUNDS" field_order="14" field_data_attribute="0"/>
<USERDEFDATA row_id="2817" field_reference="5427" field_data="DECEASED BORROWER" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="2818" field_reference="5427" field_data="DECEASED CO-BORROWER" field_order="4" field_data_attribute="0"/>
<USERDEFDATA row_id="2819" field_reference="5427" field_data="REPAYMENT" field_order="16" field_data_attribute="0"/>
<USERDEFDATA row_id="2820" field_reference="5427" field_data="DEFAULTED SETTLEMENT/AGREEMENT" field_order="6" field_data_attribute="0"/>
<USERDEFDATA row_id="2821" field_reference="5427" field_data="FRAUD/DISPUTE REPORTED" field_order="9" field_data_attribute="0"/>
<USERDEFDATA row_id="2822" field_reference="5427" field_data="FRAUD CONFIRMED" field_order="8" field_data_attribute="0"/>
<USERDEFDATA row_id="2823" field_reference="5427" field_data="CEASE AND DESIST" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="2824" field_reference="5427" field_data="DEFAULT 120-HOLD" field_order="5" field_data_attribute="0"/>
<USERDEFDATA row_id="2825" field_reference="5427" field_data="KEEPER" field_order="11" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="274" field_type="0" field_attribute="4" label_text="Last Updated" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;612&quot; StaticTopPos=&quot;80&quot; StaticWidth=&quot;67&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;686&quot; FieldTopPos=&quot;76&quot; FieldWidth=&quot;95&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;69&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="612.0000000000" StaticTopPos="80.0000000000" StaticWidth="67.0000000000" StaticHeight="20.0000000000" FieldLeftPos="686.0000000000" FieldTopPos="76.0000000000" FieldWidth="95.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="69"/>
<USERDEFFIELDS field_id="221" field_type="1" field_attribute="0" label_text="DA Balance" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;137&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;137&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;70&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="137.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="137.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="70"/>
<USERDEFFIELDS field_id="273" field_type="3" field_attribute="0" label_text="Hardship Reason" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;37&quot; StaticTopPos=&quot;469&quot; StaticWidth=&quot;96&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;469&quot; FieldWidth=&quot;246&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;71&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="37.0000000000" StaticTopPos="469.0000000000" StaticWidth="96.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="469.0000000000" FieldWidth="246.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="71">
<USERDEFDATA row_id="3010" field_reference="5478" field_data="Increase in unavoidable expenses" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="3011" field_reference="5478" field_data="Loss of Income" field_order="1" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="220" field_type="0" field_attribute="0" label_text="Migrated w/ Lead Phase" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;115&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;115&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;72&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="115.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="115.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="72"/>
<USERDEFFIELDS field_id="272" field_type="3" field_attribute="0" label_text="Representative" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**If NLSApp.GetField ( &quot;LOAN_DETAIL2_UDF22&quot;) &lt;&gt; &quot;&quot; Then
  startnewDSoffer()
End If**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;37&quot; StaticTopPos=&quot;512&quot; StaticWidth=&quot;58&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;512&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;73&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="37.0000000000" StaticTopPos="512.0000000000" StaticWidth="58.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="512.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="73"/>
<USERDEFFIELDS field_id="219" field_type="0" field_attribute="0" label_text="FDR Client ID" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;93&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;93&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;74&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="93.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="93.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="74"/>
<USERDEFFIELDS field_id="271" field_type="3" field_attribute="0" label_text="Company" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###** replookup()

Sub replookup()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Adds list of debt settlemtn company representatives associated with selected company for LOAN_DETAIL2_UDF21 to drop down options
    &apos;in LOAN_DETAIL2_UDF22.
    &apos;Triggered when LOAN_DETAIL2_UDF21 field changes.
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;

    currco = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF21&quot;)
    repcountsql = &quot;select count(row_id) from cif c, cif_cif_relationship ccr where c.cifno = ccr.cifno1 and c.company = &apos;&quot; &amp; currco &amp; &quot;&apos;&quot;
    repcount = NLSapp.SQLSelectStatement(repcountsql)
    repnamesql = &quot;select c2.shortname from cif c, cif_cif_relationship ccr, cif c2 &quot; &amp; _
              &quot;where  c.cifno = ccr.cifno1 and c2.cifno = ccr.cifno2 and c.company = &apos;&quot; &amp; currco &amp; &quot;&apos;&quot;
    indexcount = 0
    repname = NLSapp.SQLSelectStatement(repnamesql)     
    indexx =  NLSapp.SQLSelectStatementNextColumn()    

          
        If len(currco) &gt; 0 Then
            If len(repname) = 0 Then
                NLSApp.MessageBox(&quot;The company, &apos; &quot; &amp; currco &amp; &quot;&apos;, currently has no representatives assigned to it.&quot; &amp; chr(13)  &amp; chr(13) &amp; &quot;Please select another company or go to CONTACTS to add a representative.&quot;)
                Exit Sub
            End If
        End If

    Do 
       NLSapp.AddComboString &quot;LOAN_DETAIL2_UDF22&quot;, indexcount, repname

       repname = NLSapp.SQLSelectStatementReadNext()          
       indexx =  NLSapp.SQLSelectStatementNextColumn() 
       indexcount = indexcount + 1
    Loop While CDbl(indexcount) &lt; CDbl(repcount)

End Sub**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**NLSapp.LoadComboList 1, &quot;LOAN_DETAIL2_UDF21&quot;, &quot;select company from cif where cifnumber like &apos;%DSC%&apos;&quot;**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;34&quot; StaticTopPos=&quot;491&quot; StaticWidth=&quot;87&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;490&quot; FieldWidth=&quot;218&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;75&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="34.0000000000" StaticTopPos="491.0000000000" StaticWidth="87.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="490.0000000000" FieldWidth="218.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="75"/>
<USERDEFFIELDS field_id="218" field_type="0" field_attribute="0" label_text="Loan Officer" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;401&quot; StaticTopPos=&quot;71&quot; StaticWidth=&quot;104&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;510&quot; FieldTopPos=&quot;71&quot; FieldWidth=&quot;261&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;76&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="401.0000000000" StaticTopPos="71.0000000000" StaticWidth="104.0000000000" StaticHeight="20.0000000000" FieldLeftPos="510.0000000000" FieldTopPos="71.0000000000" FieldWidth="261.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="76"/>
<USERDEFFIELDS field_id="270" field_type="0" field_attribute="4" label_text="Dollar Score" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;612&quot; StaticTopPos=&quot;54&quot; StaticWidth=&quot;63&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;723&quot; FieldTopPos=&quot;52&quot; FieldWidth=&quot;58&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;77&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="612.0000000000" StaticTopPos="54.0000000000" StaticWidth="63.0000000000" StaticHeight="20.0000000000" FieldLeftPos="723.0000000000" FieldTopPos="52.0000000000" FieldWidth="58.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="77"/>
<USERDEFFIELDS field_id="217" field_type="5" field_attribute="0" label_text="Mail Paper Statements" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="1" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Mail Paper Statement checkbox update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF18 (Plus Portfolio)
&apos;                    
&apos; Purpose:
&apos; Designed to keep the CIF MailPaperstatement check box always in sync with the loan Mail Paper Statement checkbox.
&apos;
&apos; Created: 04/18/20126 by Stanley Muhammad 
&apos; Modification History    05/26/16      By    SM       
&apos; Modification History    06/26/16      By    SM  
&apos; Modification History    09/25/18      By    SM    
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
ELCommUpdate()

Sub ELCommUpdate()
    loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)
    loancif = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)
    loanport = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    loancifno = NLSApp.SQLSelectStatement(&quot;SELECT cast(cifno as varchar) from cif where cifnumber = &apos;&quot; &amp; loancif &amp; &quot;&apos;&quot;)
    email1 = NLSApp.SQLSelectStatement(&quot;SELECT email,email2 from cif where cifnumber = &apos;&quot; &amp; loancif &amp; &quot;&apos;&quot;)
    email2 = NLSapp.SQLSelectStatementNextColumn()
    &apos;msgbox(loanport)
    If loanport = &quot;PLUS PORTFOLIO&quot; Then
        statement2 = &quot;NONE&quot;
        boxchecked = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF18&quot;)
        cifboxchecked = &quot;CIFDetail7&quot;
    Else
        statement2 = &quot;NONE&quot;
        boxchecked = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF17&quot;)
        cifboxchecked = &quot;CIFDetail3&quot;
    End If

    If boxchecked = &quot;CHECK&quot; Then
            boxvalue = &quot;1&quot;
            OptionFlagS = &quot;1&quot;
            OptionFlagL = &quot;1&quot;
    Else
        If not email1 = &quot;&quot; Then
            boxvalue = &quot;0&quot;
            OptionFlagS = &quot;2&quot;
            OptionFlagL = &quot;2&quot;
            statement2 = &quot;NONE&quot;
        Else
            If NLSApp.YesNoMessageBox(&quot;NO EMAIL ADDRESS ON RECORD.&quot; &amp; chr(10) &amp; &quot;You cannot end MAIL ONLY without adding an email address First.&quot; &amp;  chr(10)&amp; chr(10) &amp; &quot;Do you want to add one now?&quot;) then
                newemail = addnewemail(loancif,1)
                If newemail = &quot;&quot; Then
                    canceladdemail loanport, loanref
                Else
                    OptionFlagS = &quot;2&quot;
                    NLSapp.AddModificationHistory 1, loanref, curremail1,newemail, &quot;Primary Email&quot;
                    NLSapp.AddModificationHistory 0, loancifno, curremail1,newemail, &quot;Primary Email (from loan detail1)&quot;
                End If
            Else 
                canceladdemail loanport, loanref
                Exit sub
            End if
        End if
    End If

    xmlstrng1 = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;CIF UpdateFlag =&quot;&quot;1&quot;&quot; CIFNumber = &quot;&quot;&quot; &amp; loancif &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;CIFDETAIL &quot; &amp; cifboxchecked &amp; &quot; = &quot;&quot;&quot; &amp; boxvalue &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;/CIF&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;
   xmlstrng2 = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;LOAN UpdateFlag = &quot;&quot;1&quot;&quot; AcctRefno =&quot;&quot;&quot; &amp; loanref &amp; &quot;&quot;&quot; &gt;&quot; &amp; chr(13) &amp; _
        &quot;   &lt;COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;     &lt;ALERT AlertType=&quot;&quot;Statement&quot;&quot; OptionFlags=&quot;&quot;&quot; &amp; OptionFlagS &amp; &quot;&quot;&quot;/&gt; &quot; &amp; chr(13) &amp; _
        &quot;     &lt;/ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;/COMMUNICATION&gt; &quot; &amp; chr(13) &amp; _
        &quot;  &lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

    &apos; &quot;    &apos;&lt;ALERT AlertType=&quot;&quot;LateNotice&quot;&quot; OptionFlags=&quot;&quot;&quot; &amp; OptionFlagL &amp; &quot;&quot;&quot;/&gt; &quot; &amp; chr(13) &amp; _

    NLSApp.SaveScreen()

    ImportXML(xmlstrng1)
    ImportXML(xmlstrng2)
End Sub
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions


**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;441&quot; StaticWidth=&quot;116&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;441&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;78&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="441.0000000000" StaticWidth="116.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="441.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="78"/>
<USERDEFFIELDS field_id="269" field_type="6" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;AmortXML&quot; Script=&quot;amortxml = NLSApp.AmortizationScheduleAsXML(NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;))

NLSApp.MessageBox(amortxml)&quot;/&gt;
&lt;BUTTON Name=&quot;FFLS 287 onetine&quot; Script=&quot;commenttext = &amp;quot;Emailed Attacthed disclosure document sent via Sendgrid 10/31/2017.&amp;quot;
newtwxt = &amp;quot;Emailed Attached disclosure document sent via Sendgrid 10/31/2017&amp;quot;
commentupdatesql = &amp;quot;Select 0; update loanacct_comments set  comments = &amp;apos;&amp;quot; &amp;amp; newtwxt &amp;amp; &amp;quot;&amp;apos; where comments like &amp;apos;%Emailed Attacthed disclosure document sent via Sendgrid 10/31/2017%&amp;apos; &amp;quot; 

&amp;apos;NLSapp.MessageBox(commentupdatesql)
&amp;apos;NLSapp.sqlselectstatement(commentupdatesql)
msgbox(&amp;quot;Completed.&amp;quot;)&quot;/&gt;
&lt;BUTTON Name=&quot;Set CurrInt to Zero&quot; Script=&quot;loanrefno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
&amp;apos;currint = NLSApp.GetField(&amp;quot;LOAN_CURRINTAMT&amp;quot;)
currint = NLSApp.SQLSelectStatement(&amp;quot;SELECT current_interest_balance from loanacct where acctrefno = &amp;quot; &amp;amp; loanrefno )
currpayoff = NLSApp.SQLSelectStatement(&amp;quot;SELECT current_payoff_balance from loanacct where acctrefno = &amp;quot; &amp;amp; loanrefno )

If loanrefno = &amp;quot;&amp;quot; Then
	loanrefno = NLSApp.GetField(&amp;quot;TASK_NLS_REFNO&amp;quot;)
End If

If Not  currint &amp;lt; .02 Then
    NLSApp.MessageBox(&amp;quot;Current interest on this loan is $&amp;quot; &amp;amp; Round( currint,2) &amp;amp; &amp;quot; and is above the allowable threshhold for this opperation.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;The opperation has been cancelled.&amp;quot;)
Else
    If NLSApp.YesNoMessageBox(&amp;quot;Current Interest on this loan is $&amp;quot; &amp;amp; currint &amp;amp; &amp;quot;.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Are you sure you want to Set interest balance on this loan to ZERO?&amp;quot;) Then
        ZeroCurrentInt(loanrefno)
        NLSApp.MessageBox(&amp;quot;Interest set to zero.&amp;quot;)
    Else
        NLSApp.MessageBox(&amp;quot;Interest unchanged.&amp;quot;)
    end If
End if

If Not  currpayoff &amp;lt; .02 Then
    NLSApp.MessageBox(&amp;quot;Current Pay Off on this loan is $&amp;quot; &amp;amp; Round(currpayoff,2) &amp;amp; &amp;quot; and is above the allowable threshhold for this opperation.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;The opperation has been cancelled.&amp;quot;)
Else
    If NLSApp.YesNoMessageBox(&amp;quot;Current Pay Off on this loan is $&amp;quot; &amp;amp; currpayoff &amp;amp; &amp;quot;.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Are you sure you want to Set total balance on this loan to ZERO?&amp;quot;) Then
         ZeroCurrentpayOff(loanrefno)
        NLSApp.MessageBox(&amp;quot;Pay Off set to zero.&amp;quot;)
    Else
        NLSApp.MessageBox(&amp;quot;Pay Off unchanged.&amp;quot;)
    end If
End if

Function ZeroCurrentInt(refno)

    NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET current_interest_balance = 0 where acctrefno = &amp;quot; &amp;amp; refno)

End Function

Function ZeroCurrentpayOff(refno)

    NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET current_payoff_balance = 0 where acctrefno = &amp;quot; &amp;amp; refno)

End Function&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;382&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;98&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;622&quot; FieldTopPos=&quot;457&quot; FieldWidth=&quot;93&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;79&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="382.0000000000" StaticTopPos="24.0000000000" StaticWidth="98.0000000000" StaticHeight="20.0000000000" FieldLeftPos="622.0000000000" FieldTopPos="457.0000000000" FieldWidth="93.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="79"/>
<USERDEFFIELDS field_id="216" field_type="2" field_attribute="0" label_text="Investor Sale Date" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###**&apos;Field Level Script-----------------------------------------------------------------------
&apos;Before Input
&apos;After Input
&apos;When Field Changes
&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
&apos; Detail 2 UDF45 update - This is triggered by the  When Field Changes event
&apos;
&apos; Location of script: Loan Detail 1 UDF16(C+)  and Loan Detail 1 UDF29(F+) Field label name Investor sale date
&apos;                    
&apos; Purpose:
&apos; Designed to maintain detail2 udef45 in sync with loan ach_co set up for the purpose of assuring the webpaay portal can see the current code for each new online reqiest.
&apos;	
&apos; Created: 07/18/2017 by Stanley Muhammad 
&apos; Modification History  NA

	class_2 = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
	port =  NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
	ACH_no = ACHCoIDUDF45(class_2,port)
	Curr_ACH_Co_UDF45 = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF45&quot;)
	If  ACH_no &lt;&gt; Curr_ACH_Co_UDF45  Then
		NLSApp.SetField &quot;LOAN_DETAIL2_UDF45&quot;, ACH_no
	End If

&apos;When Field Changes
&apos;On Field Refresh
&apos;On Initialize
&apos;On Button click/Box check-uncheck
&apos;Form Level Script-------------------------------------------------------------------------
&apos;Before save
&apos;Before Activate
&apos;Before Create
&apos;On Delete
&apos;After Save
&apos;After Create
&apos;On Add Button Clicked
&apos;Local Functions**###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;401&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;401&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;80&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="401.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="401.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="80"/>
<USERDEFFIELDS field_id="268" field_type="5" field_attribute="4" label_text="Settlement POA Received" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;acctrefno = NLSApp.GetField (&quot;LOAN_REFNO&quot;)
&apos;udf18 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF18&quot;)


&apos;If udf18 = &quot;CHECK&quot;  Then
&apos;   If POADocExists(acctrefno) = &quot;Y&quot; Then
&apos;      NLSApp.HideFields &quot;LOAN_DETAIL2_UDF21&quot;, False
&apos;      NLSApp.HideFields &quot;LOAN_DETAIL2_UDF22&quot;, False
&apos;      NLSApp.HideFields &quot;LOAN_DETAIL2_UDF23&quot;, False
&apos;      NLSApp.HideFields &quot;LOAN_DETAIL2_UDF51&quot;, False
&apos;   Else
&apos;      POAmissingNote =  &quot;Power of Attorney Documentation is missing!&quot; &amp; chr(13) &amp; chr(13) &amp; _  
&apos;      &quot;Please go to the Comments Tab and upload a copy of the documentation.&quot; &amp; chr(13) &amp; chr(13) &amp; _
&apos;      &quot;It MUST be saved in the DOCUMENTS category and POA must be selected from the Reason Code dropdown list.&quot;   &amp; chr(13) &amp; chr(13) &amp; &quot;Thank you.&quot;
&apos;      NLSApp.MessageBox(POAmissingNote)
&apos;      NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;,&quot;UNCHECK&quot;
&apos;   End if
&apos;Else 
&apos;   NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
&apos;   NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
&apos;   NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;


&apos;   NLSApp.HideFields &quot;LOAN_DETAIL2_UDF21&quot;, True
&apos;   NLSApp.HideFields &quot;LOAN_DETAIL2_UDF22&quot;, True
&apos;   NLSApp.HideFields &quot;LOAN_DETAIL2_UDF23&quot;, True
&apos;   NLSApp.HideFields &quot;LOAN_DETAIL2_UDF51&quot;, True

&apos;End if

&apos;NLSApp.SaveScreen()**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;14&quot; StaticTopPos=&quot;446&quot; StaticWidth=&quot;119&quot; StaticHeight=&quot;23&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;447&quot; FieldWidth=&quot;59&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;81&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="14.0000000000" StaticTopPos="446.0000000000" StaticWidth="119.0000000000" StaticHeight="23.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="447.0000000000" FieldWidth="59.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="81"/>
<USERDEFFIELDS field_id="215" field_type="0" field_attribute="0" label_text="C+ Client SF URL" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;379&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;379&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;82&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="379.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="379.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="82"/>
<USERDEFFIELDS field_id="267" field_type="3" field_attribute="0" label_text="Company" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###**NLSapp.LoadComboList 0, &quot;LOAN_DETAIL2_UDF17&quot;, &quot;select company from cif where cifnumber like &apos;%DSC%&apos;&quot;**###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;152&quot; StaticTopPos=&quot;302&quot; StaticWidth=&quot;44&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;201&quot; FieldTopPos=&quot;303&quot; FieldWidth=&quot;120&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;83&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="152.0000000000" StaticTopPos="302.0000000000" StaticWidth="44.0000000000" StaticHeight="20.0000000000" FieldLeftPos="201.0000000000" FieldTopPos="303.0000000000" FieldWidth="120.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="83"/>
<USERDEFFIELDS field_id="214" field_type="1" field_attribute="0" label_text="FDR Fee Model" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;357&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;357&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;84&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="357.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="357.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="84"/>
<USERDEFFIELDS field_id="266" field_type="2" field_attribute="0" label_text="Date" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;22&quot; StaticTopPos=&quot;302&quot; StaticWidth=&quot;27&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;52&quot; FieldTopPos=&quot;303&quot; FieldWidth=&quot;86&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;85&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="22.0000000000" StaticTopPos="302.0000000000" StaticWidth="27.0000000000" StaticHeight="20.0000000000" FieldLeftPos="52.0000000000" FieldTopPos="303.0000000000" FieldWidth="86.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="85"/>
<USERDEFFIELDS field_id="213" field_type="0" field_attribute="0" label_text="Migrated W/Schedule Type" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;335&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;335&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;86&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="335.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="335.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="86"/>
<USERDEFFIELDS field_id="265" field_type="0" field_attribute="4" label_text="Priority Score" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;612&quot; StaticTopPos=&quot;25&quot; StaticWidth=&quot;72&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;735&quot; FieldTopPos=&quot;26&quot; FieldWidth=&quot;46&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;87&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="612.0000000000" StaticTopPos="25.0000000000" StaticWidth="72.0000000000" StaticHeight="20.0000000000" FieldLeftPos="735.0000000000" FieldTopPos="26.0000000000" FieldWidth="46.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="87"/>
<USERDEFFIELDS field_id="212" field_type="0" field_attribute="0" label_text="Funding Source" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;313&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;313&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;88&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="313.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="313.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="88"/>
<USERDEFFIELDS field_id="264" field_type="6" field_attribute="3" label_text="Admin only" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;View WebPay Fields&quot; Script=&quot;Userno = NLSApp.GetCurrentUserNo( )
userauthsql = &amp;quot;select convert(varchar(3),groupno) from nlsgroupmembers where groupno in (&amp;apos;11&amp;apos;) and userno = &amp;quot; &amp;amp; Userno

groupno = NLSApp.SQLSelectStatement(userauthsql)
&amp;apos;NLSApp.MessageBox(groupno)

If len(groupno) &amp;gt; 0 Then
	&amp;apos;If groupno = 11 or groupno = 2 or groupno = 20 Then
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF34&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF35&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF36&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF37&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF38&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF39&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF40&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF41&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF42&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF43&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF44&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF45&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF46&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF47&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF48&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF49&amp;quot;, false
		NLSapp.HideFields &amp;quot;LOAN_DETAIL2_UDF50&amp;quot;, false
	&amp;apos;End If
End If&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;625&quot; StaticTopPos=&quot;375&quot; StaticWidth=&quot;97&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;621&quot; FieldTopPos=&quot;403&quot; FieldWidth=&quot;126&quot; FieldHeight=&quot;28&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;89&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="625.0000000000" StaticTopPos="375.0000000000" StaticWidth="97.0000000000" StaticHeight="20.0000000000" FieldLeftPos="621.0000000000" FieldTopPos="403.0000000000" FieldWidth="126.0000000000" FieldHeight="28.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="89"/>
<USERDEFFIELDS field_id="211" field_type="5" field_attribute="0" label_text="Pre-SFDC" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="1" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;291&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;291&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;90&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="291.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="291.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="90"/>
<USERDEFFIELDS field_id="263" field_type="5" field_attribute="4" label_text="First Pay Default" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;13&quot; StaticTopPos=&quot;240&quot; StaticWidth=&quot;88&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;142&quot; FieldTopPos=&quot;240&quot; FieldWidth=&quot;32&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;91&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="13.0000000000" StaticTopPos="240.0000000000" StaticWidth="88.0000000000" StaticHeight="20.0000000000" FieldLeftPos="142.0000000000" FieldTopPos="240.0000000000" FieldWidth="32.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="91"/>
<USERDEFFIELDS field_id="210" field_type="5" field_attribute="0" label_text="Pre-2013 Changes" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="1" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;269&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;269&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;92&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="269.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="269.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="92"/>
<USERDEFFIELDS field_id="262" field_type="5" field_attribute="0" label_text="Incarcerated" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;13&quot; StaticTopPos=&quot;217&quot; StaticWidth=&quot;56&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;142&quot; FieldTopPos=&quot;219&quot; FieldWidth=&quot;28&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;93&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="13.0000000000" StaticTopPos="217.0000000000" StaticWidth="56.0000000000" StaticHeight="20.0000000000" FieldLeftPos="142.0000000000" FieldTopPos="219.0000000000" FieldWidth="28.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="93"/>
<USERDEFFIELDS field_id="209" field_type="5" field_attribute="0" label_text="Migrated from SFDC" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="1" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;247&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;247&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;94&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="247.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="247.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="94"/>
<USERDEFFIELDS field_id="261" field_type="5" field_attribute="0" label_text="Active Military" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="0" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;13&quot; StaticTopPos=&quot;196&quot; StaticWidth=&quot;74&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;142&quot; FieldTopPos=&quot;197&quot; FieldWidth=&quot;49&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;95&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="13.0000000000" StaticTopPos="196.0000000000" StaticWidth="74.0000000000" StaticHeight="20.0000000000" FieldLeftPos="142.0000000000" FieldTopPos="197.0000000000" FieldWidth="49.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="95"/>
<USERDEFFIELDS field_id="208" field_type="0" field_attribute="0" label_text="FDR Client SF URL" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;225&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;225&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;96&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="225.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="225.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="96"/>
<USERDEFFIELDS field_id="260" field_type="4" field_attribute="0" label_text="Intent To Pay" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;129&quot; StaticWidth=&quot;81&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;16&quot; FieldTopPos=&quot;149&quot; FieldWidth=&quot;44&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;97&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="129.0000000000" StaticWidth="81.0000000000" StaticHeight="20.0000000000" FieldLeftPos="16.0000000000" FieldTopPos="149.0000000000" FieldWidth="44.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="97">
<USERDEFDATA row_id="3012" field_reference="5465" field_data="YES" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="3013" field_reference="5465" field_data="NO" field_order="1" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="207" field_type="0" field_attribute="0" label_text="Client Type" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="2.0" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;203&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;203&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;98&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="203.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="203.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="98"/>
<USERDEFFIELDS field_id="259" field_type="4" field_attribute="0" label_text="Category" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate

&apos;Script to update credit bureau loan account reporting based on loan status changes.

LoanNo = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
StatusCat = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF9&quot;)
lastupdate = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF6&quot;)
loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
statuscode = NLSApp.GetField(&quot;STATUS_CODE&quot;)

NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, Now()

XMLA = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot;
    XMLB = &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot; &amp; chr(34) &amp; LoanNo &amp; chr(34) &amp; &quot;&gt;&quot;

    Select Case StatusCat
        Case &quot;Deceased Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  ECOACode=&quot;&quot;X&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case &quot;BK Chpt 7 Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;&quot;&quot; ConsumerInfoIndicator=&quot;&quot;A &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case &quot;BK Chpt 13 Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;&quot;&quot; ConsumerInfoIndicator=&quot;&quot;D &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case &quot;Fraud Confirmed&quot;
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;DF&quot;&quot; ConsumerInfoIndicator=&quot;&quot;  &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
        Case Else 
            XMLC = &quot;&lt;CREDITBUREAU  AccountStatus=&quot;&quot;&quot;&quot; ConsumerInfoIndicator=&quot;&quot;  &quot;&quot; ECOACode=&quot;&quot;&quot;&quot;&gt;&lt;/CREDITBUREAU&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;
    End Select

    xmlstrng = XMLA &amp; XMLB &amp; XMLC

NLSApp.SetField &quot;LOAN_DETAIL2_UDF7&quot;,xmlstrng

NLSApp.SaveScreen()

&apos;xmlstrng = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF7&quot;)
&apos;lastupdate = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF6&quot;)
&apos;loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
&apos;StatusCat = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF9&quot;)


&apos;IF Not lastupdate = Null Then
&apos;	If loanstatus = &quot;CLOSED&quot; Then
&apos;		IF DateValue(lastupdate) = DateValue(Now) Then
			If StatusCat = &quot;Deceased Confirmed&quot; Or StatusCat = &quot;BK Chpt 7 Confirmed&quot; Or StatusCat = &quot;BK Chpt 13 Confirmed&quot; Or StatusCat = &quot;Fraud Confirmed&quot; Then
			ImportXML(xmlstrng)
			End If
&apos;		End If
&apos;	End If
&apos;End If



Function ImportXML(xml)
    NLSApp.ClearErrorString()

    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
        End If
        ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
    Else
        &apos;            NLSApp.MessageBox(&quot;ECOA Status Updated.&quot;)
        ImportXML = &quot;&quot;
    End If
End Function**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;84&quot; StaticWidth=&quot;75&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;17&quot; FieldTopPos=&quot;106&quot; FieldWidth=&quot;116&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;99&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="84.0000000000" StaticWidth="75.0000000000" StaticHeight="20.0000000000" FieldLeftPos="17.0000000000" FieldTopPos="106.0000000000" FieldWidth="116.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="99">
<USERDEFDATA row_id="3016" field_reference="5464" field_data="Deceased Confirmed" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="3017" field_reference="5464" field_data=" " field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="3018" field_reference="5464" field_data="Fraud Confirmed" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="3019" field_reference="5464" field_data="Defaulted 120" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="3020" field_reference="5464" field_data="Fraud Reported" field_order="4" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="206" field_type="1" field_attribute="0" label_text="OID Amount" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;181&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;181&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;100&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="181.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="181.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="100"/>
<USERDEFFIELDS field_id="256" field_type="0" field_attribute="4" label_text="Last Updated" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;17&quot; StaticTopPos=&quot;588&quot; StaticWidth=&quot;52&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;72&quot; FieldTopPos=&quot;588&quot; FieldWidth=&quot;114&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;101&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="17.0000000000" StaticTopPos="588.0000000000" StaticWidth="52.0000000000" StaticHeight="20.0000000000" FieldLeftPos="72.0000000000" FieldTopPos="588.0000000000" FieldWidth="114.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="101"/>
<USERDEFFIELDS field_id="205" field_type="1" field_attribute="0" label_text="OID Rate (%)" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;159&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;159&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;102&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="159.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="159.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="102"/>
<USERDEFFIELDS field_id="255" field_type="4" field_attribute="0" label_text="Start a Loan Modification" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**&apos;LOAN variables
loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
loannumber = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
getmodtype = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF5&quot;)
loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)

&apos;Task variables
templateno = 7  &apos;LOAN MODIFICATION II
defaultstatusno = 7  &apos;STARTED

&apos;Change Start a Loan Modification Request field (UDF5) back to default &quot;Choose an Option&quot;
NLSApp.SetField &quot;LOAN_DETAIL2_UDF5&quot;, &quot;Choose an Option&quot;
NLSApp.RefreshScreen()

If Not getmodtype = &quot;Choose an Option&quot; Then
    If addloanMod(getmodtype, loanrefno, loanstatus) = &quot;&quot; Then
    End If
End If
NLSApp.SaveScreen()



Function addloanMod(modtype, loanrefno, status)

    &apos;TASK variables
    currate = NLSApp.SQLSelectStatement(&quot;SELECT convert(varchar(6),convert( numeric(7,2),current_interest_rate))+&apos;%&apos; from loanacct where acctrefno = &quot; &amp; loanrefno)
    currpmt = NLSApp.SQLSelectStatement(&quot;SELECT  &apos;$&apos; + convert(varchar(6),convert( numeric(9,2), next_payment_total_amount)) from loanacct_payment where acctrefno = &quot; &amp; loanrefno)
    currdate = NLSApp.SQLSelectStatement(&quot;select  convert(char(10),getdate(),111)&quot;)
    currdatetime = NOW()

    &apos;User input for modification requestor Options a. borrower, b. co-borrower, c. 3rd party
    requestpromt = &quot;Who is requesting the &quot; &amp; getmodtype &amp; &quot;?&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;A -  Borrower&quot; &amp; chr(13) &amp; &quot;B -  Co-Borrower&quot; &amp; chr(13) &amp; &quot;C -  Third party&quot;
    requestorcode = InputBox(requestpromt, &quot;Requestor&quot;, &quot;A&quot;)

    &apos;Borrower/Co-borrower detail sql lookups
    borrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, loanacct l where l.cifno = c.cifno and l.acctrefno = &quot; &amp; loanrefno
    coborrowerlookupsql = &quot;select mail_name1 + char(13) + street_address1 + char(13) + city + &apos; &apos; + state + &apos;, &apos; + zip from cif c, cif_loan_relationship clr where clr.cifno = c.cifno and clr.acctrefno = &quot; &amp; loanrefno

    &apos;Previous approved deferral lookup
    prevdeflookupsql = &quot;SELECT count(t.task_refno) from task t, task_detail td where t.task_refno = td.task_refno AND t.status_code_id = 8 AND t.task_template_no = 7 AND td.userdef01 = &apos;Deferral&apos; AND t.NLS_refno = &quot; &amp; loanrefno

    Select Case requestorcode
        Case &quot;A&quot;, &quot;a&quot;
            requestor = &quot;Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(borrowerlookupsql)
        Case &quot;B&quot;, &quot;b&quot;
            requestor = &quot;Co-Borrower&quot;
            requestordetail = NLSapp.SQLSelectStatement(coborrowerlookupsql)
            If requestordetail = &quot;&quot; Then
                NLSApp.MessageBox(&quot;Co-Borrower information cannot be located.&quot; &amp; chr(13) &amp; &quot;Please validate that Co-borrower exists and Retry.&quot;)
                NLSApp.MessageBox(&quot;Operation Canceled.&quot;)
                Exit Function
            End If
        Case &quot;C&quot;, &quot;c&quot;
            requestor = &quot;Third_Party (See Notes)&quot;
            requestordetail = &quot;ENTER 3rd Party details here.&quot;
        Case &quot;&quot;
            NLSApp.MessageBox(&quot;Modification Canceled.&quot;)
            Exit Function
        Case Else
            NLSApp.MessageBox(&quot;Invalid Selection.&quot; &amp; chr(13) &amp; &quot;Please Try Again.&quot;)
            Exit Function
    End Select

    &apos;If Mod Type is  a deferral look up the # of previously approved deferrals
    If getmodtype = &quot;Deferral&quot; Then
        prevdefs = NLSapp.SQLSelectStatement(prevdeflookupsql)
    Else
        prevdefs = &quot;&quot;
    End If


    &apos;TASK OBJECT CREATION
    If status = &quot;ACTIVE&quot; Then
        Set Task = NLSApp.Tasks.New(templateno)
        NLSApp.Tasks.BeginTransaction
        Task.StatusCodeID = defaultstatusno
        Task.NLSRefno = loanrefno
        Task.UDF1 = modtype
        Task.UDF9 = prevdefs
        Task.UDF10 = currpmt
        Task.UDF12 = currdate
        Task.UDF14 = currate
        Task.UDF18 = requestor
        Task.UDF23 = currdate
        Task.UDF25 = requestordetail

        If (Task.Save = -1) Then
            NLSApp.Tasks.RollbackTransaction
            NLSApp.MessageBox(&quot;Task not created.&quot;)
            addloanMod = -1
        Else
            NLSApp.Tasks.CommitTransaction
            NLSApp.MessageBox(&quot;Loan Modification TASK created.&quot; &amp; Chr(13) &amp; &quot;Please go the the Task Tab to complete the modification record.&quot;)
            addloanMod = &quot;&quot;
        End If
    Else
        NLSApp.MessageBox(&quot;The Loan must be in ACTIVE status to add a Modification task&quot;)
    End If

End Function**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;280&quot; StaticTopPos=&quot;74&quot; StaticWidth=&quot;173&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;280&quot; FieldTopPos=&quot;103&quot; FieldWidth=&quot;186&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;103&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="280.0000000000" StaticTopPos="74.0000000000" StaticWidth="173.0000000000" StaticHeight="20.0000000000" FieldLeftPos="280.0000000000" FieldTopPos="103.0000000000" FieldWidth="186.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="103">
<USERDEFDATA row_id="3021" field_reference="5460" field_data="Choose an Option" field_order="0" field_data_attribute="0"/>
<USERDEFDATA row_id="3022" field_reference="5460" field_data="Deferral" field_order="1" field_data_attribute="0"/>
<USERDEFDATA row_id="3023" field_reference="5460" field_data="Interest Rate Reduction" field_order="2" field_data_attribute="0"/>
<USERDEFDATA row_id="3024" field_reference="5460" field_data="Lower Payment/Term Extension" field_order="3" field_data_attribute="0"/>
<USERDEFDATA row_id="3025" field_reference="5460" field_data="SCRA" field_order="4" field_data_attribute="0"/>
</USERDEFFIELDS>
<USERDEFFIELDS field_id="204" field_type="1" field_attribute="0" label_text="Total SIA" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;137&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;137&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;104&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="137.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="137.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="104"/>
<USERDEFFIELDS field_id="253" field_type="6" field_attribute="0" label_text="Refresh" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;&quot; Script=&quot;PastDue = NLSApp.GetField(&amp;quot;LOAN_DAYSPASTDUE&amp;quot;)
ITP = NLSApp.GetField(&amp;quot;LOAN_DETAIL2_UDF10&amp;quot;)
CurrentDate = Now()

If PastDue = 0 Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;CURRENT&amp;quot; End If
If (PastDue &amp;gt; 0) AND (PastDue &amp;lt;= 10) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;0-10&amp;quot; End If
If (PastDue &amp;gt; 10) AND (PastDue &amp;lt;= 30) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;11+&amp;quot; End If
If (PastDue &amp;gt; 30) AND (PastDue &amp;lt;= 60) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;30+&amp;quot; End If
If (PastDue &amp;gt; 60) AND (PastDue &amp;lt;= 90) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;60+&amp;quot; End If
If (PastDue &amp;gt; 90) AND (PastDue &amp;lt;= 119) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;90+&amp;quot; End If
If (PastDue &amp;gt; 119) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF1&amp;quot;,&amp;quot;120+&amp;quot; End If

If (PastDue &amp;gt; 0) AND (PastDue &amp;lt;= 10) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;N/A&amp;quot; End If
If (PastDue &amp;gt; 11) AND (PastDue &amp;lt;= 120) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;Collections&amp;quot; End If
If (PastDue &amp;gt; 120) AND (ITP = &amp;quot;NO&amp;quot;) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;Defaulted&amp;quot; End If
If (PastDue &amp;gt; 120) AND (ITP &amp;lt;&amp;gt; &amp;quot;NO&amp;quot;) Then NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF2&amp;quot;,&amp;quot;Collections&amp;quot; End If&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;526&quot; StaticTopPos=&quot;30&quot; StaticWidth=&quot;32&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;520&quot; FieldTopPos=&quot;27&quot; FieldWidth=&quot;42&quot; FieldHeight=&quot;27&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;105&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="526.0000000000" StaticTopPos="30.0000000000" StaticWidth="32.0000000000" StaticHeight="20.0000000000" FieldLeftPos="520.0000000000" FieldTopPos="27.0000000000" FieldWidth="42.0000000000" FieldHeight="27.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="105"/>
<USERDEFFIELDS field_id="203" field_type="1" field_attribute="0" label_text="Other Advances" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;115&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;115&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;106&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="115.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="115.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="106"/>
<USERDEFFIELDS field_id="252" field_type="0" field_attribute="4" label_text="Status" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;144&quot; StaticTopPos=&quot;30&quot; StaticWidth=&quot;47&quot; StaticHeight=&quot;18&quot; FieldLeftPos=&quot;144&quot; FieldTopPos=&quot;50&quot; FieldWidth=&quot;135&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;107&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="144.0000000000" StaticTopPos="30.0000000000" StaticWidth="47.0000000000" StaticHeight="18.0000000000" FieldLeftPos="144.0000000000" FieldTopPos="50.0000000000" FieldWidth="135.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="107"/>
<USERDEFFIELDS field_id="202" field_type="1" field_attribute="0" label_text="Settlement Fees" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;93&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;93&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;108&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="93.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="93.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="108"/>
<USERDEFFIELDS field_id="251" field_type="0" field_attribute="4" label_text="Level" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###**CurrentDate = Now()
NLSApp.SetField &quot;LOAN_DETAIL2_UDF6&quot;, CurrentDate**###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###****###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;16&quot; StaticTopPos=&quot;27&quot; StaticWidth=&quot;36&quot; StaticHeight=&quot;21&quot; FieldLeftPos=&quot;16&quot; FieldTopPos=&quot;50&quot; FieldWidth=&quot;91&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;539&quot; ScreenWidth=&quot;1096&quot; ZOrder=&quot;109&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="16.0000000000" StaticTopPos="27.0000000000" StaticWidth="36.0000000000" StaticHeight="21.0000000000" FieldLeftPos="16.0000000000" FieldTopPos="50.0000000000" FieldWidth="91.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="539.0000000000" ScreenWidth="1,096.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="109"/>
<USERDEFFIELDS field_id="201" field_type="1" field_attribute="0" label_text="Creditor Payments" min_value="0.0000000000" max_value="9,999,999,999.0000000000" field_precision="2" default_value="0000000000000.00000" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;71&quot; StaticWidth=&quot;102&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;71&quot; FieldWidth=&quot;259&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;528&quot; ScreenWidth=&quot;1151&quot; ZOrder=&quot;110&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="71.0000000000" StaticWidth="102.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="71.0000000000" FieldWidth="259.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="528.0000000000" ScreenWidth="1,151.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="110"/>
<KEYRECORD code_id="1" numbering_key="0"/>
<SCRIPTS code_id="1" script_type="0" script="**###Before Save###**&apos;ACHCompanyUDF()
&apos;LoanCommPrefs()
&apos;WebPayments()
&apos;PrivacyStatements()
&apos;PDFP()

If NOW() &gt; &quot;12/22/16&quot; Then
&apos;     LateFees1()
End if

&apos;NLSApp.MessageBox(&quot;Completed!&quot;)

Sub PrivacyStatements()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Privacy Statement Maintainance - Looks up qualifying loans due an annual Privacy statement notice and send email notice
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;

    cifnosql = &quot;SELECT TOP 5 convert(varchar(10),privstmntsDue.cifno) as cifno,privstmntsDue.cifnumber,privstmntsDue.loan_number,&quot; &amp; chr(13) &amp; _
    &quot;privstmntsDue.Name,convert(char(1),privstmntsDue.portfolio_code_id) as portfolio_code_id,privstmntsDue.email,privstmntsDue.email2,&quot; &amp; chr(13) &amp; _
    &quot;convert(varchar(10),privstmntsDue.acctrefno)&quot; &amp; chr(13) &amp; _
    &quot;from &quot; &amp; chr(13) &amp; _
    &quot;(SELECT cif.cifnumber,cif.cifno,la.loan_number,la.acctrefno,&quot; &amp; chr(13) &amp; _
    &quot;&apos;OptOut&apos; = CASE &quot; &amp; chr(13) &amp; _
    &quot;WHEN la.portfolio_code_id = 0 THEN  CASE WHEN cd.userdef07 = 1 THEN cd.userdef07 ELSE 0 END&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.portfolio_code_id = 1 THEN  CASE WHEN cd.userdef03 = 1 THEN cd.userdef03 ELSE 0 END&quot; &amp; chr(13) &amp; _
    &quot;ELSE &apos;NA&apos; END,cif.firstname1+&apos; &apos;+cif.lastname1 as Name,&quot; &amp; chr(13) &amp; _
    &quot;&apos;lastSent&apos; = cd.userdef04, dateadd(yy,datediff(yy,la.open_date,getdate()), la.open_date) as aniversary,&quot; &amp; chr(13) &amp; _
    &quot;cif.email,cif.email2,&apos;Borrower&apos; as type, la.portfolio_code_id,cif.street_address1,cif.street_address2,cif.state,cif.zip&quot; &amp; chr(13) &amp; _
    &quot;FROM cif cif,cif_detail cd,loanacct la&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.cifno = cif.cifno&quot; &amp; chr(13) &amp; _
    &quot;AND cif.cifno = cd.cifno&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0&quot; &amp; chr(13) &amp; _
    &quot;AND la.current_payoff_balance &gt; 0&quot; &amp; chr(13) &amp; _
    &quot;AND (cif.email IS NOT NULL OR (cif.email IS NULL AND cif.email2 IS NOT NULL))&quot; &amp; chr(13) &amp; _
    &quot;UNION&quot; &amp; chr(13) &amp; _
    &quot;/*loan relationships (co-borrowers)*/&quot; &amp; chr(13) &amp; _
    &quot;SELECT cif.cifnumber,cif.cifno,la.loan_number,la.acctrefno,&quot; &amp; chr(13) &amp; _
    &quot;CASE &quot; &amp; chr(13) &amp; _
    &quot;WHEN la.portfolio_code_id = 0 THEN  CASE WHEN cd.userdef07 = 1 THEN cd.userdef07 ELSE 0 END &quot; &amp; chr(13) &amp; _
    &quot;WHEN la.portfolio_code_id = 1 THEN  CASE WHEN cd.userdef03 = 1 THEN cd.userdef03 ELSE 0 END &quot; &amp; chr(13) &amp; _
    &quot;ELSE &apos;NA&apos; END,cif.firstname1+&apos; &apos;+cif.lastname1 as Name,&quot; &amp; chr(13) &amp; _
    &quot;&apos;last Sent&apos; = cd.userdef04, dateadd(yy,datediff(yy,la.open_date,getdate()), la.open_date) ,&quot; &amp; chr(13) &amp; _
    &quot;cif.email,cif.email2,&apos;Co-Borrower&apos;,la.portfolio_code_id,cif.street_address1,cif.street_address2,cif.state,cif.zip&quot; &amp; chr(13) &amp; _
    &quot;FROM cif cif,cif_detail cd,loanacct la&quot; &amp; chr(13) &amp; _
    &quot;,cif_loan_relationship clr&quot; &amp; chr(13) &amp; _
    &quot;WHERE clr.cifno = cif.cifno&quot; &amp; chr(13) &amp; _
    &quot;AND cif.cifno = cd.cifno&quot; &amp; chr(13) &amp; _
    &quot;AND clr.acctrefno = la.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0&quot; &amp; chr(13) &amp; _
    &quot;AND la.current_payoff_balance &gt; 0&quot; &amp; chr(13) &amp; _
    &quot;AND (cif.email IS NOT NULL OR (cif.email IS NULL AND cif.email2 IS NOT NULL))&quot; &amp; chr(13) &amp; _
    &quot;) privstmntsDue&quot; &amp; chr(13) &amp; _
    &quot;WHERE &quot; &amp; chr(13) &amp; _
    &quot;(lastsent IS NULL AND aniversary &lt; convert(char(8),getdate(),1)) &quot; &amp; chr(13) &amp; _
    &quot;OR (aniversary &lt; convert(char(8),getdate(),1) AND lastsent &lt; dateadd(yy,-1,getdate()))&quot; &amp; chr(13) &amp; _
    &quot;AND OptOut = 0&quot; &amp; chr(13) &amp; _
    &quot;order by privstmntsDue.loan_number&quot;

    Cifno1 = NLSApp.SQLSelectStatement(cifnosql)

    If Cifno1 = &quot;&quot; Then
        Cifno1 = &quot;***END OF RESULT***&quot;
    End If
    Lcount = 0

    Do Until Cifno1 = &quot;***END OF RESULT***&quot;

        &apos;NLSApp.MessageBox(Cifno1)
        cifnum = NLSApp.SQLSelectStatementNextColumn()
        loannumb = NLSApp.SQLSelectStatementNextColumn()
        name = NLSApp.SQLSelectStatementNextColumn()
        portcode = NLSApp.SQLSelectStatementNextColumn()
        email1 = NLSApp.SQLSelectStatementNextColumn()
        email2 = NLSApp.SQLSelectStatementNextColumn()
        acctrefno = NLSApp.SQLSelectStatementNextColumn()

        If portcode = &quot;1&quot; Then
            portstring1 = &quot;Consolidation&quot;
            linkstring1 = &quot;https://www.consolplus.com/privacy-notice&quot;
            emailstring1 = &quot;myloan@consolplus.com&quot;
            phonestring1 = &quot;1-888-950-4829&quot;
            emailfromaddr = &quot;consolplus-servicing@consolplus.com&quot;
            serverName = &quot;Servicing CPlus&quot;

        Else
            portstring1 = &quot;Freedom&quot;
            linkstring1 = &quot;http://www.freedomplus.com/data/privacy_notice.pdf&quot;
            emailstring1 = &quot;customersupport@freedomplus.com&quot;
            phonestring1 = &quot;1-800-297-58799&quot;
            emailfromaddr = &quot;customersupport@freedomplus.com&quot;
            serverName = &quot;Servicing FPlus&quot;

        End If

        If len(email1) &gt; 0 Then
            emailtoaddr = email1
        Else
            emailtoaddr = email2
        End If
        &apos;**Uncomment next row for testing with real email address. Add comment for go-live
        &apos;emailtoaddr = &quot;stanley.muhammad@gmail.com&quot;

        subjectstring1 = &quot;Your &quot; &amp; portstring1 &amp; &quot; Plus Privacy statement is now available online&quot;
        emailbody1 = &quot;Your &quot; &amp; portstring1 &amp; &quot; Plus Privacy statement is now available online.&quot; &amp; chr(13) &amp; chr(13) &amp; _
                    chr(13) &amp; _
                    &quot;Dear &quot; &amp; name &amp; &quot;,&quot; &amp; chr(13) &amp; chr(13) &amp; _
                    &quot;Customer privacy and security have never been more important. We want you to know what we are doing to protect your privacy and to keep &quot; &amp; _
                    &quot;information about you secure. By following this link (&quot; &amp; linkstring1 &amp; &quot;) you will find our current Privacy Policy, which describes how we protect the privacy of your &quot; &amp; _
                    &quot;information, what information we may share with others, and your right to limit the sharing and use of information that we may have about you. We &quot; &amp; _
                    &quot;believe the responsible use of information is an important part of meeting your needs and providing consistent service. &quot; &amp; chr(13) &amp; chr(13) &amp; _
                    &quot;You are receiving this notice as part of our annual Privacy Notice requirement. Please read the privacy notice carefully. If you previously submitted &quot; &amp; _
                    &quot;your privacy choices, your preferences still apply and you don&apos;t have to take any other actions unless you&apos;d like to make changes. &quot; &amp; chr(13) &amp; chr(13) &amp; _
                    &quot;If you have any questions about our privacy notice, please contact us anytime via email &quot; &amp; emailstring1 &amp; &quot;, or by telephone at &quot; &amp; phonestring1 &amp; &quot;.&quot; &amp; chr(13) &amp; chr(13) &amp; _
                    chr(13) &amp; chr(13) &amp; _
                    &quot;Sincerely,&quot; &amp; chr(13) &amp; _
                    chr(13) &amp; &quot;Diane Sanders&quot; &amp; chr(13) &amp; _
                    chr(13) &amp; &quot;Operations Manager, Client Services&quot; &amp; chr(13) &amp; _
                    chr(13) &amp; &quot;Freedom Financial Asset Management, LLC&quot;
        emailbody2 = &quot;A PRIVACY STATEMENT IS NOW DUE FOR LOAN # &quot; &amp; loannumb &amp; CHR(13) &amp; CHR(13) &amp; _
                    &quot;HOWEVER, THIS LOAN HAS NOT OPTED FOR PAPER STATEMENTS AND THE CURRENT EMAIL ADDRESS ON FILE IS NOT VALID.&quot; &amp; chr(13) &amp; _
                    &quot;PLEASE PRINT AND MAIL A COPY OF THE PRIVACY STATEMENT AS SOON AS POSSIBLE.&quot; &amp; chr(13) &amp; &quot;OR&quot; &amp; chr(13) &amp; _
                    &quot;UPDATE THE BORROWER RECORD WITH A VALID EMAIL ADDRESS.&quot;
        emailbody3 = &quot;A PRIVACY STATEMENT IS NOW DUE FOR LOAN # &quot; &amp; loannumb &amp; CHR(13) &amp; CHR(13) &amp; _
                    &quot;THIS LOAN HAS OPTED FOR PAPER STATEMENTS ONLY.&quot; &amp; CHR(13) &amp; _
                    &quot;PLEASE PRINT AND MAIL A COPY OF THE PRIVACY STATEMENT AS SOON AS POSSIBLE.&quot;

        NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, subjectstring1, emailbody1

        cmmnttext = &quot;SENT TO: &quot; &amp; emailtoaddr &amp; chr(13) &amp; &quot;SENT FROM: &quot; &amp; emailfromaddr &amp; chr(13) &amp; &quot;NOTICE TEXT: &quot; &amp; chr(13) &amp; emailbody1

        cifXML = &quot;&lt;NLS&gt;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot; &amp; chr(34) &amp; cifnum &amp; chr(34) &amp; &quot;&gt;&lt;CIFDETAIL CIFDetail4=&quot; &amp; chr(34) &amp; NOW() &amp; chr(34) &amp; &quot;/&gt;&lt;/CIF&gt;&lt;/NLS&gt;&quot;
        cmmntxml = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&quot; &amp; chr(13) &amp; &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
                     &quot;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; acctrefno &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
                     &quot;&lt;LOANCOMMENTS Comment=&quot;&quot;&quot; &amp; cmmnttext &amp; &quot;&quot;&quot; Category=&quot;&quot;SERVICING NOTES&quot;&quot; CommentDescription=&quot;&quot;Privacy Notice Email&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
                      &quot;&lt;/LOAN&gt;&quot; &amp; chr(13) &amp; &quot;&lt;/NLS&gt;&quot;

        ImportXML(cifXML)
        ImportXML(cmmntxml)

        Cifno1 = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;Privacy Statement Processing&quot;, &quot;Statements Processed - &quot; &amp; Lcount
        &apos;NLSApp.MessageBox(&quot;Loans Processed &quot; &amp; Lcount)
    End If

End Sub


Sub ACHCompanyUDF()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;ACH Company UDF Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    refnosql = &quot;SELECT TOP 5 nonachUDFs.acctrefno,nonachUDFs.UDFtarget&quot; &amp; chr(13) &amp; _
    &quot;FROM&quot; &amp; chr(13) &amp; _
    &quot;(SELECT distinct &quot; &amp; chr(13) &amp; _
    &quot;convert(varchar(10),la.acctrefno) as acctrefno,&quot; &amp; chr(13) &amp; _
    &quot;la.loan_class2_no,&quot; &amp; chr(13) &amp; _
    &quot;lach.ach_company_id,&quot; &amp; chr(13) &amp; _
    &quot;la.portfolio_code_id,ld2.userdef45,&quot; &amp; chr(13) &amp; _
    &quot;&apos;UDFtarget&apos;= CASE&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 0 THEN 1&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 1 THEN 4&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 4 THEN 3&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 7 THEN 7&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 8 THEN 8&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 9 THEN 9&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 10 THEN 10&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 11 THEN 11&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 0 THEN 12&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 1 THEN 15&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 13 THEN 13&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 15 THEN 16&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 16 THEN 17&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 17 THEN 18&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 18 THEN 19&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 19 THEN 20&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 20 THEN 21&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 21 THEN 22&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 22 THEN 23&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 23 THEN 24&quot; &amp; chr(13) &amp; _
    &quot;WHEN la.loan_class2_no = 24 THEN 25&quot; &amp; chr(13) &amp; _
    &quot;ELSE 9999&quot; &amp; chr(13) &amp; _
    &quot;END&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct_ach lach, loanacct_detail_2 ld2, loanacct la, loan_class lc,ach_company ach&quot; &amp; chr(13) &amp; _
    &quot;WHERE lach.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lc.codenum = la.loan_class2_no&quot; &amp; chr(13) &amp; _
    &quot;AND lach.ach_company_id = ach.ach_company_id&quot; &amp; chr(13) &amp; _
    &quot;AND la.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0&quot; &amp; chr(13) &amp; _
    &quot;and lach.status = 0&quot; &amp; chr(13) &amp; _
    &quot;/*AND la.loan_class1_no 1*/) nonachUDFs&quot; &amp; chr(13) &amp; _
    &quot;WHERE nonachUDFs.UDFtarget &lt;&gt; nonachUDFs.userdef45 &quot; &amp; chr(13) &amp; _
    &quot;OR nonachUDFs.userdef45  IS NULL&quot;

    LoanRefNo = NLSapp.SQLSelectStatement(refnosql)
    &apos;NLSApp.MessageBox( LoanRefNo)

    If LoanRefNo = &quot;&quot; Then
        LoanRefNo = &quot;***END OF RESULT***&quot;
    End If

    Lcount = 0

    Do Until LoanRefNo = &quot;***END OF RESULT***&quot;
        Lcount = Lcount + 1
        achid = NLSApp.SQLSelectStatementNextColumn()

        achxml = &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
                    &quot;  &lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; LoanRefNo &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
                    &quot;    &lt;LOANDETAIL2 UserDefined45=&quot;&quot;&quot; &amp; achid &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
                    &quot;  &lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
                    &quot;&lt;/NLS&gt;&quot;


        ImportXML(achxml)


        LoanRefNo = NLSApp.SQLSelectStatementReadNext()

    Loop
    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;ACH Company UDF Proccessing&quot;, &quot;Loans Processed &quot; &amp; Lcount
        &apos;NLSApp.MessageBox(&quot;Loans Processed &quot; &amp; Lcount)
    End If

End Sub


Sub LoanCommPrefs()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Communication Preferences Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    Commsetuplookupsqltxt = &quot;SELECT distinct TOP 5 la.loan_number, convert(varchar(15),la.acctrefno) as acctrefno,&quot; &amp; chr(13) &amp; _
    &quot;convert(char(1),lcp.StatementOptionFlags),lca.Address,&quot; &amp; chr(13) &amp; _
    &quot;&apos;MailOptIn&apos; = CASE When la.portfolio_code_id=0 THEN ld1.userdef18&quot; &amp; chr(13) &amp; _
    &quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END,&quot; &amp; chr(13) &amp; _
    &quot;cif.email, cif.cifnumber&quot; &amp; chr(13) &amp; _
    &quot;from cif cif, loanacct_detail ld1,loanacct la&quot; &amp; chr(13) &amp; _
    &quot;left outer join&quot; &amp; chr(13) &amp; _
    &quot;LoanCommunicationPreferences lcp&quot; &amp; chr(13) &amp; _
    &quot;on &quot; &amp; chr(13) &amp; _
    &quot;la.acctrefno = lcp.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;left outer join&quot; &amp; chr(13) &amp; _
    &quot;LoanCommunicationAddress lca&quot; &amp; chr(13) &amp; _
    &quot;on&quot; &amp; chr(13) &amp; _
    &quot;lca.LoanCommunicationPreferencesID = lcp.LoanCommunicationPreferencesID&quot; &amp; chr(13) &amp; _
    &quot;Where ld1.acctrefno = la.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND cif.cifno = la.cifno&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0&quot; &amp; chr(13) &amp; _
    &quot;AND ((lcp.StatementOptionFlags IS NULL AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&quot; &amp; chr(13) &amp; _
    &quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0)&quot; &amp; chr(13) &amp; _
    &quot;OR (lcp.StatementOptionFlags = 2 AND lca.Address IS NULL)&quot; &amp; chr(13) &amp; _
    &quot;OR (lcp.StatementOptionFlags = 1 AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&quot; &amp; chr(13) &amp; _
    &quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0) )&quot; &amp; chr(13) &amp; _
    &quot;AND la.loan_number  not like &apos;CP%A&apos; &quot; &amp; chr(13) &amp; _
    &quot;AND la.loan_number not like &apos;%dummy%&apos;&quot; &amp; chr(13) &amp; _
    &quot;order by acctrefno ,mailoptin desc&quot;

    LoanNumber = NLSapp.SQLSelectStatement(Commsetuplookupsqltxt)
    loopcnt = 0

    If LoanNumber = &quot;&quot; Then
        LoanNumber = &quot;***END OF RESULT***&quot;
    End If

    Lcount = 0

    Do Until LoanNumber = &quot;***END OF RESULT***&quot;

        Loanrefno = NLSapp.SQLSelectStatementNextColumn()
        Flag = NLSapp.SQLSelectStatementNextColumn()
        Commemail = NLSapp.SQLSelectStatementNextColumn()
        Optin = NLSapp.SQLSelectStatementNextColumn()
        Cntemail = NLSapp.SQLSelectStatementNextColumn()

        If Optin = 1 Then
            Optinflag = 1
        Else
            Optinflag = 2
        End If
        CIFNum = NLSapp.SQLSelectStatementNextColumn()

        If Cntemail = &quot;&quot; Then
            Optinflag = 1
            Cntemail = &quot;LScontact@ffn.com&quot;
            cifemailxml = &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
            &quot;   &lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot;&quot;&quot; &amp; CIFNum &amp; &quot;&quot;&quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot; EmailAddress1=&quot;&quot;LScontact@ffn.com&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
            &quot;&lt;/NLS&gt;&quot;

            ImportXML(cifemailxml)

        End If


        commprefxml = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;UTF-8&quot;&quot; standalone=&quot;&quot;yes&quot;&quot;?&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;NLS&gt;&quot; &amp; chr(13) &amp; _
        &quot;	&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; LoanNumber &amp; &quot;&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;		&lt;COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
        &quot;				&lt;EMAILADDRESS Operation=&quot;&quot;ADD&quot;&quot; Address=&quot;&quot;&quot; &amp; Cntemail &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;/EMAILADDRESSES&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;				&lt;ALERT AlertType=&quot;&quot;Statement&quot;&quot; OptionFlags=&quot;&quot;&quot; &amp; Optinflag &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;			&lt;/ALERTS&gt;&quot; &amp; chr(13) &amp; _
        &quot;		&lt;/COMMUNICATION&gt;&quot; &amp; chr(13) &amp; _
        &quot;	&lt;/LOAN&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

        &apos;NLSApp.MessageBox(loopcnt &amp; &quot; - &quot; &amp; LoanNumber)

        ImportXML(commprefxml)
        LoanNumber = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;Loan Comm Prefs Proccessing&quot;, &quot;Loans Processed &quot; &amp; Lcount 
        &apos; NLSApp.MessageBox( &quot;Loans Processed &quot; &amp; Lcount)
    End If
End Sub

Sub WebPayments()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Web payments Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;SET PENDING STATUSES-----------------------------------------------------------

    sqlstring1 = &quot;select TOP 5 convert(varchar(10),la.acctrefno) as acctrefno, pt.ach_trace_number,&apos;PENDING&apos; as Status,ld2.userdef41,null&quot; &amp; chr(13) &amp; _
    &quot;FROM pending_transactions pt, loanacct la, loanacct_detail_2 ld2&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = pt.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef35 = &apos;SUBMITTED&apos;&quot; &amp; chr(13) &amp; _
    &quot;AND convert(datetime,ld2.userdef41) = pt.effective_date&quot; &amp; chr(13) &amp; _
    &quot;UNION&quot; &amp; chr(13) &amp; _
    &quot;select convert(varchar(10),la.acctrefno) as acctrefno, lph.ach_trace_number,&apos;COMPLETED&apos;, ld2.userdef41,lph.date_paid&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct_payment_history lph, loanacct la, loanacct_detail_2 ld2&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = lph.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND la.acctrefno = ld2.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef35 = &apos;SUBMITTED&apos;&quot; &amp; chr(13) &amp; _
    &quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&quot; &amp; chr(13) &amp; _
    &quot;UNION&quot; &amp; chr(13) &amp; _
    &quot;select convert(varchar(10),ld2.acctrefno) ,null,&apos;COMPLETED&apos;,ld2.userdef41,lph.date_paid&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct_payment_history lph, loanacct_detail_2 ld2 &quot; &amp; chr(13) &amp; _
    &quot;WHERE ld2.acctrefno = lph.acctrefno &quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef35 = &apos;PENDING&apos; &quot; &amp; chr(13) &amp; _
    &quot;AND ld2.userdef34 =lph.ach_trace_number&quot; &amp; chr(13) &amp; _
    &quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&quot;


    LoanRefNo = NLSapp.SQLSelectStatement(sqlstring1)

    If LoanRefNo = &quot;&quot; Then
        LoanRefNo = &quot;***END OF RESULT***&quot;
    End If
    Lcount = 0
    Do Until LoanRefNo = &quot;***END OF RESULT***&quot;

        achtrace = NLSapp.SQLSelectStatementNextColumn()
        status = NLSapp.SQLSelectStatementNextColumn()

        If status = &quot;PENDING&quot; Then

            xmlstrng1 = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&quot; &amp; _
                    &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; _
                    &quot;  &lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; LoanRefNo &amp; &quot;&quot;&quot;&gt;&quot; &amp; _
                    &quot;    &lt;LOANDETAIL2  UserDefined34=&quot;&quot;&quot; &amp; achtrace &amp; &quot;&quot;&quot; UserDefined35=&quot;&quot;&quot; &amp; status &amp; &quot;&quot;&quot; /&gt;&quot; &amp; _
                    &quot;  &lt;/LOAN&gt;&quot; &amp; _
                    &quot;&lt;/NLS&gt;&quot;
        End If

        If status = &quot;COMPLETED&quot; Then

            xmlstrng1 = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;  standalone=&quot;&quot;yes&quot;&quot; ?&gt;&quot; &amp; _
                    &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; _
                    &quot;  &lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; LoanRefNo &amp; &quot;&quot;&quot;&gt;&quot; &amp; _
                    &quot;    &lt;LOANDETAIL2  UserDefined35=&quot;&quot;&quot; &amp; status &amp; &quot;&quot;&quot; /&gt;&quot; &amp; _
                    &quot;  &lt;/LOAN&gt;&quot; &amp; _
                    &quot;&lt;/NLS&gt;&quot;
        End If

        &apos;NLSApp.MessageBox(xmlstrng1)

        &apos;XML Imports
        ImportXML(xmlstrng1)

        LoanRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;Web Payments&quot;, &quot;Loans Processed &quot; &amp; Lcount 
    End If
End Sub


Sub LateFees1()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;1st late fee Maintainance - Reverses any late fees charged prior to acct 11 days past due
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    Trandatasql = &quot;select distinct TOP 5 la.loan_number,lth.date_due,lth.transaction_date,lth.effective_date,&quot; &amp; chr(13) &amp; _
        &quot;datediff(dd,lth.date_due,getdate()) as days,la.days_past_due,&quot; &amp; chr(13) &amp; _
        &quot;convert(varchar(10),lth.transrefno) as transrefno,lth.transaction_amount&quot; &amp; chr(13) &amp; _
        &quot;from loanacct la, loanacct_trans_history lth &quot; &amp; chr(13) &amp; _
        &quot;where la.acctrefno = lth.acctrefno &quot; &amp; chr(13) &amp; _
        &quot;and lth.transaction_code = 150&quot; &amp; chr(13) &amp; _
        &quot;AND la.days_past_due between 1 and 12 &quot; &amp; chr(13) &amp; _
        &quot;AND datediff(dd,lth.date_due,getdate()) between 1 and 11&quot; &amp; chr(13) &amp; _
        &quot;AND lth.transaction_date &gt; &apos;12/22/16&apos;&quot; &amp; CHR(13) &amp; _
        &quot;AND lth.reversal_transrefno = 0&quot;
    
    loannumb = NLSapp.SQLSelectStatement(Trandatasql)
    
    If  loannumb = &quot;&quot; Then
           loannumb =  &quot;***END OF RESULT***&quot;
    End If
    
    Lcount = 0
    
    Do Until loannumb = &quot;***END OF RESULT***&quot;
        duedate = NLSApp.SQLSelectStatementNextColumn()
        transdate = NLSApp.SQLSelectStatementNextColumn()
        effdate = NLSApp.SQLSelectStatementNextColumn()
        pmtdpd = NLSApp.SQLSelectStatementNextColumn()
        lndpd = NLSApp.SQLSelectStatementNextColumn()
        transrefno = NLSApp.SQLSelectStatementNextColumn()
        amount = NLSApp.SQLSelectStatementNextColumn()
    
        revtransxml = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;?&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;TRANSACTIONS&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;TRANSACTIONCODE TransactionCode=&quot;&quot;151&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; effdate &amp; &quot;&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; loannumb &amp; &quot;&quot;&quot;  Amount=&quot;&quot;&quot; &amp; amount &amp; &quot;&quot;&quot; DateDue=&quot;&quot;&quot; &amp; duedate &amp; &quot;&quot;&quot; TransactionDate=&quot;&quot;&quot; &amp; transdate &amp; &quot;&quot;&quot; TransRefNo=&quot;&quot;&quot; &amp; transrefno &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;/TRANSACTIONS&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;
    
        ImportXML(revtransxml)
    
        loannumb = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &gt; 0 Then
    	NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;Late Fee Processing&quot;, &quot;Late Fees reversed - &quot; &amp; Lcount
    End If 

End Sub

Sub PDFP()
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;PDFP Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    TranRefNosql = &quot;SELECT TOP 5 convert(varchar(12),lth.transrefno),lth.transaction_date,&quot; &amp; chr(13) &amp; _
    &quot;lth.effective_date,lth.date_due,la.current_suspense,la.loan_number&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct la,loanacct_trans_history lth,&quot; &amp; chr(13) &amp; _
    &quot;(SELECT DISTINCT la.loan_number,max(lth.transaction_date) as transaction_date&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct la,loanacct_trans_history lth WHERE la.acctrefno = lth.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lth.transaction_code = &apos;124&apos; AND la.current_suspense &gt; 0 AND la.current_suspense = la.total_past_due_balance&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0 AND lth.date_due &lt; getdate() group by  la.loan_number) lt&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = lth.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lt.loan_number = la.loan_number&quot; &amp; chr(13) &amp; _
    &quot;AND lt.transaction_date = lth.transaction_date&quot; &amp; chr(13) &amp; _
    &quot;AND lth.transaction_code = &apos;124&apos;  &quot; &amp; chr(13) &amp; _
    &quot;UNION &quot; &amp; chr(13) &amp; _
    &quot;SELECT distinct convert(varchar(12),lth.transrefno),lth.transaction_date,&quot; &amp; chr(13) &amp; _
    &quot;lth.effective_date,lth.date_due,la.total_past_due_balance,la.loan_number&quot; &amp; chr(13) &amp; _
    &quot;FROM loanacct la,loanacct_trans_history lth, loanacct_payments_due lpd&quot; &amp; chr(13) &amp; _
    &quot;WHERE la.acctrefno = lth.acctrefno&quot; &amp; chr(13) &amp; _
    &quot;AND lpd.payment_reference_no = lth.transaction_reference_no&quot; &amp; chr(13) &amp; _
    &quot;AND lth.transaction_code = &apos;124&apos;&quot; &amp; chr(13) &amp; _
    &quot;AND la.status_code_no = 0  &quot; &amp; chr(13) &amp; _
    &quot;AND la.total_past_due_balance between .000010 and .01&quot;

    TranRefNo = NLSapp.SQLSelectStatement(TranRefNosql)

    If  TranRefNo = &quot;&quot; Then
           TranRefNo =  &quot;***END OF RESULT***&quot;
    End If
    
    Lcount = 0

    Do Until TranRefNo =&quot;***END OF RESULT***&quot;
       
        transdate = NLSapp.SQLSelectStatementNextColumn()
        effdate = NLSapp.SQLSelectStatementNextColumn()
        duedate = NLSapp.SQLSelectStatementNextColumn()
        amount = NLSapp.SQLSelectStatementNextColumn()
        loannum = NLSapp.SQLSelectStatementNextColumn()

        revtransxml = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;utf-8&quot;&quot;?&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;NLS EnforceTagExistence=&quot;&quot;1&quot;&quot;&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;TRANSACTIONS&gt;&quot; &amp; chr(13) &amp; _
        &quot;    &lt;TRANSACTIONCODE TransactionCode=&quot;&quot;125&quot;&quot; EffectiveDate=&quot;&quot;&quot; &amp; effdate &amp; &quot;&quot;&quot; LoanNumber=&quot;&quot;&quot; &amp; loannum &amp; &quot;&quot;&quot;  Amount=&quot;&quot;&quot; &amp; amount &amp; &quot;&quot;&quot; DateDue=&quot;&quot;&quot; &amp; duedate &amp; &quot;&quot;&quot; TransactionDate=&quot;&quot;&quot; &amp; transdate &amp; &quot;&quot;&quot; TransRefNo=&quot;&quot;&quot; &amp; TranRefNo &amp; &quot;&quot;&quot;/&gt;&quot; &amp; chr(13) &amp; _
        &quot;  &lt;/TRANSACTIONS&gt;&quot; &amp; chr(13) &amp; _
        &quot;&lt;/NLS&gt;&quot;

        ImportXML(revtransxml)

        TranRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &quot;PDFP Proccessing&quot;, &quot;Loans Processed &quot; &amp; Lcount
    End if
End Sub**###Before Save###****###Before Activate###**pastdue = NLSApp.GetField(&quot;LOAN_DAYSPASTDUE&quot;)
If pastdue = &quot;&quot; then 
 pastdue = 0
end if
udf18 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF18&quot;)
acctrefno = NLSApp.GetField (&quot;LOAN_REFNO&quot;)
POAststatussql = &quot;Select distinct l.acctrefno from loanacct l, loanacct_statuses ls where l.acctrefno = ls.acctrefno and ls.status_code_no = 39 and l.acctrefno = &quot; &amp; acctrefno
POAstatus = NLSApp.SQLSelectStatement(POAststatussql)
POABox = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF18&quot;)
ValidPOAYN = POADocExists(acctrefno)
NLSapp.SetToolTip &quot;LOAN_DETAIL2_UDF51&quot;, &quot;Right Click to add a new row.&quot;

If pastdue &gt;= 120 Then
	NLSapp.HideFields &quot;LOAN_DETAIL2_UDF4&quot;, false
Else
	NLSapp.HideFields &quot;LOAN_DETAIL2_UDF4&quot;, true
End If

&apos;---------------------------------------------------------------------------------------------------------------
If right(NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF37&quot;),9) =  &quot;COMPLETED&quot; THEN
	NLSapp.HideFields &quot;LOAN_DETAIL1_UDF44&quot;, False
Else
	NLSapp.HideFields &quot;LOAN_DETAIL1_UDF44&quot;, True
End If

If len(groupno) &gt; 0 Then

	If groupno = 11 or Userno = 39   Then
		NLSapp.HideFields &quot;LOAN_DETAIL2_UDF14&quot;, false
		NLSapp.HideFields &quot;LOAN_DETAIL2_UDF19&quot;, false
		NLSapp.EnableFields &quot;LOAN_DETAIL2_UDF19&quot;, true
	End If

End if


PrepTransitionLet()

Sub PrepTransitionLet()
    &apos;---------------------------------------------------------------------------------------------------------------
    &apos;Prepare Transition Letter
    &apos;Event- Before activate
    &apos;---------------------------------------------------------------------------------------------------------------
    loanref = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
    prepyesno = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF48&quot;)
    WCcalledyesno = NLSApp.GetField(&quot;LOAN_DETAIL1_UDF37&quot;)
    Currmatdate = NLSApp.GetField(&quot;LOAN_MATURITYDATE&quot;)
    Currmatdate49 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF49&quot;)

    If Currmatdate &lt;&gt; Currmatdate49 Then
        loanref = NLSapp.GetField(&quot;LOAN_REFNO&quot;)

        strSQL2 = &quot;select la.loan_number, la.curr_maturity_date, lp.first_principal_payment_date&quot; &amp; chr(13) &amp; _
            &quot;from loanacct la, loanacct_payment lp &quot; &amp; chr(13) &amp; _
            &quot;where la.acctrefno = lp.acctrefno&quot; &amp; chr(13) &amp; _
            &quot;AND la.acctrefno = &apos;&quot; &amp; loanref &amp; &quot;&apos;&quot;

        loannumber = NLSapp.SQLSelectStatement(strSQL2)
        maturity = NLSApp.SQLSelectStatementNextColumn()
        FirstPayment = NLSApp.SQLSelectStatementNextColumn()
        TotalPayments = NLSapp.AmortizeLoanInMemory(maturity, loanref)

        NLSApp.SetField &quot;LOAN_DETAIL2_UDF47&quot;, TotalPayments
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF48&quot;, FirstPayment
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF49&quot;, maturity
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF50&quot;, loannumber
        NLSApp.SaveScreen()

    End If
End Sub

&apos;---------------------------------------------------------------------------------------------------------------


Userno = NLSApp.GetCurrentUserNo( )
userauthsql = &quot;select convert(varchar(3),groupno) from nlsgroupmembers where groupno in (&apos;11&apos;) and userno = &quot; &amp; Userno

groupno = NLSApp.SQLSelectStatement(userauthsql)
&apos;NLSApp.MessageBox(groupno)

If len(groupno) &gt; 0 Then
	If groupno = 11 Then
		NLSapp.HideFields &quot;LOAN_DETAIL2_UDF14&quot;, false

	End If
End If

&apos;---------------------------------------------------------------------------------------------------------------
&apos;Settlement and POA Maintenance
&apos;---------------------------------------------------------------------------------------------------------------
&apos;MAINTAIN POA Check box
	brokenyn =  NLSApp.SQLSelectStatement(&quot;SELECT distinct convert(varchar(12),acctrefno) from loanacct_statuses where status_code_no IN (34, 38) and acctrefno = &quot; &amp; acctrefno )  
	&apos;Check POA box if POA exist and box is not checked
	If ValidPOAYN = &quot;Y&quot; and Not POABox = &quot;CHECK&quot; Then
		If not brokenyn = acctrefno Then
			NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;, &quot;CHECK&quot;
		End if
	End if

	&apos;UnCheck POA box if no POA exist and box is checked
	If (not ValidPOAYN = &quot;Y&quot; or brokenyn = acctrefno) and POABox = &quot;CHECK&quot;  Then
		NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;,&quot;UNCHECK&quot;
	End if

&apos;Validate POA and loan Status
If not POAstatus = &quot;&quot;  Then
	If ValidPOAYN = &quot;Y&quot; Then
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF21&quot;, True
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF22&quot;, True
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF23&quot;, True
		&apos;NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF51&quot;, True

	Else
		POAmissingNote =  &quot;Loan has &apos;POA RECEIVED&apos; status, however the required documentation is missing in comments!&quot; &amp; chr(13) &amp; chr(13) &amp; _  
		&quot;Please go to the Comments Tab and upload a copy of the documentation.&quot; &amp; chr(13) &amp; chr(13) &amp; _
		&quot;It MUST be saved in the DOCUMENTS category and Settlement POA must be selected from the Reason Code drop-down list.&quot;   &amp; chr(13) &amp; chr(13) &amp; &quot;Thank you.&quot;
		NLSApp.MessageBox(POAmissingNote)
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF21&quot;, false
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF22&quot;, false
		NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF23&quot;, false
		&apos;NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF51&quot;, false

	End if

Else 
	DSinputisnull = NLSApp.GetField (&quot;LOAN_DETAIL2_UDF21&quot;) &amp; NLSApp.GetField (&quot;LOAN_DETAIL2_UDF22&quot;) &amp; NLSApp.GetField (&quot;LOAN_DETAIL2_UDF23&quot;)
&apos; 	If Not DSinputisnull = &quot;&quot; Then
&apos; 		NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
&apos; 		NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
&apos; 		NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
&apos; 	End If

	NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF21&quot;, false
	NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF22&quot;, false
	NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF23&quot;, false
	&apos;NLSApp.EnableFields &quot;LOAN_DETAIL2_UDF51&quot;, false

End if

NLSapp.SetToolTip &quot;LOAN_DETAIL2_UDF51&quot;, &quot;Right Click to add a new row.&quot;
**###Before Activate###****###Before Create###****###Before Create###****###On Delete###****###On Delete###****###After Save###**acctrefno = NLSApp.Getfield(&quot;LOAN_REFNO&quot;)
WCAgent= NLSApp.Getfield(&quot;LOAN_DETAIL1_UDF37&quot;)
udf18 = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF18&quot;)

If right(WCAgent,9) =  &quot;COMPLETED&quot; THEN
	NLSapp.HideFields &quot;LOAN_DETAIL1_UDF44&quot;, False
End If

If udf18 = &quot;CHECK&quot;  Then
   NLSApp.HideFields &quot;LOAN_DETAIL2_UDF20&quot;, False 

End if



userid = REPLACE( NLSApp.GetSignedOnID(),&quot;NLS.LOCAL\&quot;,&quot;&quot;)
acctrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)

newbalchecksql = NLSApp.SQLSelectStatement(&quot;select left(cd.userdef27,95)  from cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &apos;DEBT SETTLEMENT TASK&apos;&quot;)
newDSbalcheck = NLSApp.SQLSelectStatement(newbalchecksql &amp;  acctrefno)

If newDSbalcheck &lt;&gt; &quot;&quot; then
   newbaleditsqlpart1 = NLSApp.SQLSelectStatement(&quot;select cd.userdef04  from cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &apos;DEBT SETTLEMENT TASK&apos;&quot;)
   newbaleditsqlpart2 = NLSApp.SQLSelectStatement(&quot;select cd.userdef03 from cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &apos;DEBT SETTLEMENT TASK&apos;&quot;)
   newDSbaledit = NLSApp.SQLSelectStatement(newbaleditsqlpart1 &amp; userid &amp; newbaleditsqlpart2 &amp; acctrefno)
   newDSbaledit = Replace(newDSbaledit,&quot;&quot;&quot;&quot;,&quot;&apos;&quot;)
   
   XMLstring = &quot;&lt;NLS&gt;&lt;LOAN UpdateFlag=&quot;&quot;1&quot;&quot; AcctRefno=&quot;&quot;&quot; &amp; acctrefno &amp; &quot;&quot;&quot;&gt;&lt;LOANDETAIL2 UserDefined51=&quot;&quot;&quot; &amp; newDSbaledit &amp;  &quot;&quot;&quot;/&gt;&lt;/LOAN&gt;&lt;/NLS&gt;&quot;

   ImportXML(XMLstring)
   NLSApp.RefreshScreen()
End if
**###After Save###****###After Create###****###After Create###****###On Transaction Entry###****###On Transaction Entry###****###After Transaction Entry###**loanpayoff = NLSapp.GetField(&quot;LOAN_CURRPAYOFF&quot;)
&apos;NextRun = NLSapp.SQLSelectStatement(&quot;SELECT substring(cd.userdef03,11,25) FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;)
&apos;
&apos;    If CDate(NextRun) &lt; CDate(Now()) Then
&apos;       NextRuntime = NOW() + 1     
&apos;       SetNextRun = &quot;SELECT 0; UPDATE cif_detail SET userdef03 = &apos;Next Run: &quot; &amp; NextRuntime &amp; &quot;&apos; FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;
&apos;       NLSapp.SQLSelectStatement(SetNextRun)
&apos;       
&apos;       AutoWOaddCompletePending()
&apos;       AutoCloseaddCompleted()
&apos;
&apos;       NextRuntime = NOW()     
&apos;       SetNextRun = &quot;SELECT 0; UPDATE cif_detail SET userdef03 = &apos;Next Run: &quot; &amp; NextRuntime &amp; &quot;&apos; FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;AUTO WRITEOFFCLOSE&apos;&quot;
&apos;       NLSapp.SQLSelectStatement(SetNextRun)
&apos;       
&apos;    End If


    NLSapp.RefreshScreen()**###After Transaction Entry###****###On Add Button Clicked###****###On Add Button Clicked###****###Local Functions###**&apos;---------------------------------------------------------------------------------------------------------------
&apos;Port form Subs
&apos;---------------------------------------------------------------------------------------------------------------


Function canceladdemail(portfolio,refno)
     NLSApp.SaveScreen()
    If portfolio = &quot;PLUS PORTFOLIO&quot; Then
        NLSApp.SQLSelectStatement &quot;SELECT 0; UPDATE loanacct_detail SET userdef18 = &apos;1&apos; where acctrefno = &quot; &amp; refno
    Else
        NLSApp.SQLSelectStatement &quot;SELECT 0; UPDATE loanacct_detail SET userdef17 = &apos;1&apos; where acctrefno = &quot; &amp; refno
    End If            
    NLSApp.MessageBox(&quot;Process Canceled.&quot;)
     NLSApp.RefreshScreen()
End Function

Function addnewemail(contactnum,emailno)
    retry = True
    
    commprefidsql = &quot;select Distinct convert(varchar,lcp.LoanCommunicationPreferencesID)&quot; &amp; chr(13) &amp; _  
                    &quot;from cif c,loanacct l, LoanCommunicationPreferences lcp&quot; &amp; chr(13) &amp; _  
                    &quot;where l.cifno = c.cifno and l.acctrefno = lcp.acctrefno and c.cifnumber = &apos;&quot; &amp; contactnum &amp; &quot;&apos;&quot;
 &apos;NLSApp.MessageBox(commprefidsql)
    commprefid = NLSApp.SQLSelectStatement(commprefidsql)          
 &apos;NLSApp.MessageBox(commprefidsql)
    Do  
     eaddress = InputBox(&quot;Please enter a valid email address.&quot;,&quot;New Email&quot; &amp; emailno, &quot;some.thing@somewhere.com&quot;)
     &apos; email format check
     exchnage = InStrRev(eaddress, &quot;@&quot;)
     domain = InStrRev(eaddress, &quot;.&quot;)

     If (Not exchnage = 0 and Not domain = 0) And (exchnage &lt; domain) Then
        
        If emailno = 1 Then
            addressedits1 = &quot;SELECT 0; UPDATE cif SET email = &apos;&quot; &amp; eaddress &amp; &quot;&apos;  where cifnumber = &apos;&quot; &amp; contactnum &amp; &quot;&apos;&quot; &amp; chr(13)&amp; _
                        &quot;DELETE FROM LoanCommunicationAddress where  LoanCommunicationPreferencesID = &quot; &amp; commprefid   &amp; chr(13) &amp; _         
                        &quot;INSERT INTO LoanCommunicationAddress Values (&quot; &amp; commprefid &amp; &quot;, &apos;&quot; &amp; eaddress &amp; &quot;&apos;, 0)&quot;
        Else
            addressedits1 = &quot;SELECT 0; UPDATE cif SET email2 = &apos;&quot; &amp; eaddress &amp; &quot;&apos;  where cifnumber = &apos;&quot; &amp; contactnum &amp; &quot;&apos;&quot; &amp; chr(13)
        End If        
        &apos;NLSApp.MessageBox(addressedits1)
        NLSApp.SQLSelectStatement addressedits1
        retry = False
     Else
        retry = NLSApp.YesNoMessageBox(&quot;Invalid Email format&quot; &amp; chr(10) &amp; chr(10) &amp;&quot;Retry? (Y/N)&quot;)

         If retry = false Then
            addnewemail = &quot;&quot;
            Exit Do
         End if
     End if
     addnewemail = eaddress
     Loop while retry = True
End Function

Sub startnewDSoffer()
  &apos;NLSApp.SaveScreen()
   acctrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
   currco = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF21&quot;)
   loanstatus = NLSApp.GetField(&quot;LOAN_STATUS&quot;)
   poa =  POADocExists(acctrefno)
   proceednext = 1

    If loanstatus = &quot;ACTIVE&quot; Then
        If poa = &quot;Y&quot; Then
            If currco &lt;&gt; &quot;&quot; Then
                addDSofferLOANv2()
            Else
                NLSApp.MessageBox(&quot;A valid Debt Settlement Company must be selected to Proceed.&quot;)
                proceednext = 0
            End If

        Else
            NLSApp.MessageBox(&quot;Power of Attorney Documentation has not been recorded.&quot; &amp; chr(13) &amp; &quot;Please complete to Proceed.&quot;)
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
            proceednext = 0
        End If
    Else
        NLSApp.MessageBox(&quot;Invalid account. Loan must be open for Settlement.&quot;)
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF18&quot;,&quot;UNCHECK&quot;
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
        NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
        proceednext = 0
    End If
         
End Sub

Sub addDSofferLOANv2()
    monthtseqtxt = &quot;starting&quot;
    nextmonthyr = Year(NOW())
    nextmonth = Monthtext(month(now())) &amp; &quot; &quot; &amp; nextmonthyr
    rowno = 0
    cifnumb = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)

    &apos;**XML set up ***To avoid loan record locks, The contact record udf grid fields associated with the active loan will be used as a temporary holding place to build the settlement schedule.
    xxmlheader = &quot;&lt;NLS&gt;&lt;CIF UpdateFlag=&quot;&quot;1&quot;&quot; CIFNumber=&quot;&quot;&quot; &amp; cifnumb &amp; &quot;&quot;&quot; Entity=&quot;&quot;INDIVIDUAL&quot;&quot; &gt;&lt;CIFDETAIL CIFDetail51=&quot;&quot;&lt;DATA&gt;&quot;
    xxmlfooter = &quot;&lt;/DATA&gt;&quot;&quot; /&gt;&lt;/CIF&gt;&lt;/NLS&gt;&quot;

    firstpass = True
    
    Do Until firstmonth = &quot;END&quot;
        &apos;**INPUTS
       Do
            If firstpass = True Then
                firstmonth = InputBox(&quot;If the first payment will be in &quot; &amp; nextmonth &amp; &quot; Select [OK].&quot; &amp; chr(13) &amp; &quot;If payments will start another month, Type below.&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;Select CANCEL To quit.&quot;, &quot;Settlement Offer Set Up&quot;, nextmonth)
            Else
                firstmonth = InputBox(&quot;Select [OK] to enter payments starting &quot; &amp; nextmonth &amp; &quot;.&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;Select [CANCEL] To quit.&quot; &amp; chr(13) &amp; chr(13) &amp; &quot;Type &apos;END&apos; to Finish.&quot;, &quot;Settlement Offer Set Up&quot;, nextmonth)
            End If
            
            If  Not len(firstmonth) = 0 and  Not (firstmonth = &quot;END&quot; Or firstmonth = &quot;end&quot; Or firstmonth = &quot;End&quot;) Then
                If DateFormat(firstmonth,10077) = -1 Then
                    NLSApp.MessageBox(&quot;Invalid Entry or Date Format.&quot; &amp; chr(13) &amp; &quot;Please re-enter&quot;)
                End if
            End If 

        Loop Until  len(firstmonth) = 0 OR  IsDate(firstmonth) = True OR (firstmonth = &quot;END&quot; Or firstmonth = &quot;end&quot; Or firstmonth = &quot;End&quot;)

        firstpass = False

        If IsDate(firstmonth) = True  Then
            firstmonth = DateFormat(firstmonth,10077)
        End if

        &apos;Check for select CANCEL
        If len(firstmonth) = 0 Then
            NLSApp.MessageBox(&quot;Canceling.&quot;)
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF21&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF22&quot;, &quot;&quot;
            NLSApp.SetField &quot;LOAN_DETAIL2_UDF23&quot;, &quot;&quot;
            Exit Sub
        End If
        
        &apos;Check for select END
        If firstmonth = &quot;END&quot; Or firstmonth = &quot;end&quot; Or firstmonth = &quot;End&quot; Then
            Endproc = 1
            curramount = CStr(totpayments)
           repeat = 1

        Else
            Endproc = 0
            curramount = InputBox(&quot;Enter payment amount starting &quot; &amp; firstmonth &amp; &quot;. &quot;, &quot;Settlement Offer Set Up&quot;, &quot;0.00&quot;)
           repeat = CDbl(InputBox(&quot;Repeat $&quot; &amp; curramount &amp; &quot; payment how many Times? &quot;, &quot;Settlement Offer Set Up&quot;, &quot;1&quot;))

           &apos;**VARIABLES
           monthtseqtxt = &quot;Next&quot;
           nextmonth = firstmonth
           nextmonthno = MonthNo(firstmonth)
           nextmonthyr = right(firstmonth, 4)
           monthstopno = CDbl(nextmonthno) + CDbl(repeat)

        End If
        

        &apos;**CREATE SECTION ROWS
        Do While repeatcnt &lt; repeat
            repeatcnt = repeatcnt + 1

            If Endproc = 1 Then
                nextgridrow = &quot;&lt;ROW RowNumber=&apos;&quot; &amp; rowno &amp; &quot;&apos;&gt;&lt;COLUMN Name=&apos;&apos; Value=&apos;&apos;/&gt;&lt;COLUMN Name=&apos;Month&apos; Value=&apos;TOTAL&apos;/&gt;&lt;COLUMN Name=&apos;Amount&apos; Value=&apos;&quot; &amp; totpayments &amp; &quot;&apos;/&gt;&lt;/ROW&gt;&quot;
            Else
                nextgridrow = &quot;&lt;ROW RowNumber=&apos;&quot; &amp; rowno &amp; &quot;&apos;&gt;&lt;COLUMN Name=&apos;&apos; Value=&apos;&apos;/&gt;&lt;COLUMN Name=&apos;Month&apos; Value=&apos;&quot; &amp; nextmonth &amp; &quot;&apos;/&gt;&lt;COLUMN Name=&apos;Amount&apos; Value=&apos;&quot; &amp; curramount &amp; &quot;&apos;/&gt;&lt;/ROW&gt;&quot;
            End If

            allgridrows = allgridrows &amp; nextgridrow

            rowno = rowno + 1

            &apos;Check if next month begins a new year
            If nextmonthno = &quot;12&quot; Then
                nextmonthno = &quot;1&quot;
                nextmonthyr = nextmonthyr + 1
                nextmonth = &quot;January&quot; &amp; &quot; &quot; &amp; nextmonthyr
            Else
                nextmonthno = MonthNo(nextmonth) + 1
                nextmonth = Monthtext(MonthNo(nextmonth) + 1) &amp; &quot; &quot; &amp; nextmonthyr
            End If
            rowcnt = rowcnt + 1
            
            If rowcnt = 1 Then   &apos;Set default 1st paymentdate
              
                firstpayment = DateForm111(firstmonth)
                If CDate(firstpayment) &lt; CDate(Now()) Then
                    firstpayment = DateForm111(CDate(firstmonth)+ Day(Now()))
                End If
             
            End If
            
            totpayments = CDbl(totpayments) + CDbl(curramount)

        Loop
        repeatcnt = 0

        xxml = xxmlheader &amp; allgridrows &amp; xxmlfooter

        ImportXML(xxml)

        If Endproc = 1 Then
            NLSApp.SaveScreen()
            Exit Do
        End If

    Loop

    &apos;**CREATE TASK
    If proceednext = &quot;&quot; Then
        &apos;TASK variables
        createuser = NLSApp.GetSignedOnID()
        loannumber = NLSApp.GetField(&quot;LOAN_NUMBER&quot;)
        loanrefno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
        cifnum = NLSApp.GetField(&quot;LOAN_CIFNUMBER&quot;)
        coname = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF21&quot;)
        repname = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF22&quot;)
        reason = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF23&quot;)
        cifudf51 = NLSApp.SQLSelectStatement(&quot;SELECT userdef51 from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;&quot; &amp; cifnum &amp; &quot;&apos;&quot;)
        currbal = NLSApp.GetField(&quot;LOAN_CURRPAYOFF&quot;)
        minbal = 0
        currtime = NOW()
        offer = GetMonthsFromtaskGrid101(cifudf51) &amp; &quot; payments for a total of $&quot; &amp; GetTotalFromtaskGrid101(cifudf51, &quot;Amount&quot;) &amp; &quot;.&quot;
        TotalOffer = GetTotalFromtaskGrid101(cifudf51, &quot;Amount&quot;)
        Expiredate = DateForm111(Month(firstpayment) &amp; &quot;/&quot; &amp; DaysInMonth(Month(firstpayment),Year(firstpayment)) &amp; &quot;/&quot; &amp; Year(firstpayment))


        Companylookupsql = &quot;select &apos;Contact ID:  &apos; + cifnumber  + &apos;     &apos; + &apos;Entry Date:  &apos; + convert(char(11),c.setupdate) + char(13)  + char(13) + &quot; &amp; _
        &quot;&apos;Name:  &apos; + company + char(13)  + char(13) + &apos;ADDRESS :&apos; + char(13) + mail_name1 + char(13) + street_address1 + char(13) + &quot; &amp; _
        &quot;city + &apos;, &apos; + state + &apos; &apos; + zip + char(13) + char(13) + &apos;Phone: (&apos; + phone_area_code + &apos;) &apos; + phone_number + char(13)  + char(13) + &apos;Standard Offer - &apos; + cast(convert(dec(4,2),cd.userdef01) as varchar) +&apos;%&apos; &quot; &amp; _
        &quot;from  cif_detail cd, cif c left outer join cif_phone_nums cp on  c.cifno = cp.cifno &quot; &amp; _
        &quot;where c.cifno = cd.cifno and cp.phone_description = &apos;Business&apos; and c.company = &apos;&quot; &amp; coname &amp; &quot;&apos;&quot;


        workerlookupsql = &quot;select &apos;Contact ID:  &apos; + cifnumber  + &apos;     &apos; + &apos;Entry Date:  &apos; + convert(char(11),c.setupdate) + char(13)  + char(13) + &quot; &amp; _
        &quot;&apos;Name:  &apos; + shortname + char(13)  + char(13) + &apos;EMAIL1 :&apos; + case when email is null then &apos;&apos; else email end + char(13) + &quot; &amp; _
        &quot;&apos;EMAIL2 :&apos; + case when email2 is null then &apos;&apos; else email end + char(13) + char(13)  + &apos;Phone: (&apos; + phone_area_code + &apos;) &apos; + phone_number &quot; &amp; _
        &quot;from  cif_detail cd, cif c left outer join cif_phone_nums cp on  c.cifno = cp.cifno where c.cifno = cd.cifno and cp.phone_description = &apos;Business&apos; and c.shortname = &apos;&quot; &amp; repname &amp; &quot;&apos;&quot;

        coinfo = NLSapp.SQLSelectStatement(Companylookupsql)
        repinfo = NLSapp.SQLSelectStatement(workerlookupsql)
        useremail = NLSapp.SQLSelectStatement(&quot;SELECT email FROM NLSusers where signonid = &apos;&quot; &amp; createuser &amp; &quot;&apos;&quot;)


        &apos;TASK OBJECT CREATION
        If CDbl(currbal) &gt; minbal Then
            Set Task = NLSApp.Tasks.New(6)
            NLSApp.Tasks.BeginTransaction
            Task.StatusCodeID = 6
            Task.NLSRefno = loanrefno
            Task.WorkQueueCodeID = 4
            Task.DueDate = Expiredate
            Task.UDF1 = coname
            Task.UDF2 = repname
            Task.UDF3 = reason
            Task.UDF4 = 1
            Task.UDF5 = currbal
            Task.UDF6 = offer
            Task.UDF7 = round(TotalOffer / currbal * 100, 2)
            Task.UDF8 = currtime
            Task.UDF9 = firstpayment           
            Task.UDF10 = coinfo
            Task.UDF12 = repinfo
            Task.UDF13 = currtime
            Task.UDF14 = &quot;NEW&quot;
            Task.UDF15 = useremail
            Task.UDF101 = cifudf51
            If (Task.Save = -1) Then
                NLSApp.Tasks.RollbackTransaction
                NLSApp.MessageBox(&quot;Task not created&quot;)
            Else
                NLSApp.Tasks.CommitTransaction
                subjectstring1 = &quot;Debt Settlement Task Needs Approval - Loan #&quot; &amp; loannumber
                emailbody1 = &quot;There is a debt settlement agreement that needs approval. Please review Loan #&quot; &amp; loannumber &amp; &quot; and approve or decline. If approved, please reschedule the terms of the loan.&quot;
                &apos;serverName = &quot;Servicing CPlus&quot;
                &apos;emailtoaddr = &quot;somebody@gmail.com&quot;
                &apos;emailfromaddr = &quot;consolplus-servicing@consolplus.com&quot;
                serverName = &quot;Loan Servicing3&quot;
                emailtoaddr =  &quot;NLSApprovers@freedomfinancialnetwork.com&quot;
                emailfromaddr = &quot;svc.loanservicing@freedomdebtrelief.com&quot;
                NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, subjectstring1, emailbody1
                NLSApp.MessageBox(&quot;TASK created.&quot;)
            End If
        Else
            NLSApp.MessageBox(&quot;Minimum loan balance must be greater than $&quot; &amp; minbal &amp; &quot;.&quot; &amp; chr(13) &amp; &quot;Request not submitted.&quot;)
        End If
    End If
End Sub

&apos;---------------------------------------------------------------------------------------------------------------
&apos;Port form function #1
&apos;XML Import
&apos;---------------------------------------------------------------------------------------------------------------
Function ImportXML(xml)
	NLSApp.ClearErrorString()

	If Not NLSApp.ImportXMLRecord(xml) Then
		If True Then
		NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
		End If
	ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
	Else
              &apos; NLSApp.MessageBox(&quot;Payment Added&quot;)
		ImportXML = &quot;&quot;
	End If
End Function

Function DateForm111(sourcedate)

	If len(DAY(sourcedate)) = 1 Then
	   daytext = &quot;0&quot; &amp; DAY(sourcedate) 
	Else 
	   daytext = DAY(sourcedate) 
	End if 
	
	If len(MONTH(sourcedate)) = 1 Then
	   mnthtext = &quot;0&quot; &amp; MONTH(sourcedate) 
	Else 
	   mnthtext = MONTH(sourcedate) 
	End if 
	
	DateForm111 = YEAR(sourcedate)&amp;&quot;/&quot;&amp; mnthtext&amp;&quot;/&quot;&amp; daytext
	
End Function

Function ACHCoIDUDF45(class2, portfolio)
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;ACH Company UDF Maintainance
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    achid = &quot;&quot;

    Select Case class2

        Case &quot;1 - VULCAN&quot;
            If portfolio = &quot;PLUS PORTFOLIO&quot; Then
                achid = &quot;1&quot;
            Else
                achid = &quot;4&quot;
            End If

        Case &quot;3 - FFNAM FUND&quot;
            achid = &quot;3&quot;
        Case &quot;4 - RANGER&quot;
            achid = &quot;7&quot;
        Case &quot;5 - ATALAYA CAPITAL&quot;
            achid = &quot;8&quot;
        Case &quot;6 - RANGER DLT&quot;
            achid = &quot;9&quot;
        Case &quot;7 - BLUE ELEPHANT&quot;
            achid = &quot;10&quot;
        Case &quot;8 - TIDEPOOL&quot;
            achid = &quot;11&quot;
        Case &quot;9 - AEQUITAS ACC5&quot;
            If portfolio = &quot;PLUS PORTFOLIO&quot; Then
                achid = &quot;12&quot;
            Else
                achid = &quot;15&quot;
            End If
        Case &quot;5A - ATALAYA V-B&quot;
            achid = &quot;13&quot;
        Case &quot;5B - ATALAYA VI&quot;
            achid = &quot;14&quot;
        Case &quot;5C - ATALAYA MW&quot;
            achid = &quot;16&quot;
        Case &quot;7A - BLUE ELEPHANT OFFSHO&quot;
            achid = &quot;17&quot;
        Case &quot;5D - ATALAYA II-C&quot;
            achid = &quot;18&quot;
        Case &quot;10 - KEYSTONE&quot;
            achid = &quot;19&quot;
        Case &quot;11 - CRESTLINE&quot;
            achid = &quot;20&quot;
        Case &quot;12 - FCCF-SERIES 1&quot;
            achid = &quot;21&quot;
        Case &quot;13 - FCCF-SERIES 2&quot;
            achid = &quot;22&quot;
        Case &quot;14 - ACM III&quot;
            achid = &quot;23&quot;
        Case &quot;15 - ACM MW II&quot;
            achid = &quot;24&quot;
        Case &quot;16 - CRESTLINE II&quot;
            achid = &quot;25&quot;
        Case &quot;17 - DAKOY&quot;
            achid = &quot;26&quot;
        Case &quot;18 - STONERIDGE&quot;
            achid = &quot;27&quot;
        Case &quot;19 - ACM ALAMOSA I&quot;
            achid = &quot;32&quot;
        Case &quot;20 - ACM ALAMOSA I-A&quot;
            achid = &quot;28&quot;
        Case &quot;21 - ACM GATEWAY&quot;
            achid = &quot;30&quot;
        Case &quot;22 - ACM F ACQUISITION&quot;
            achid = &quot;31&quot;
        Case &quot;23 - 590 CONSUMER LENDING&quot;
            achid = &quot;29&quot;

    End Select

    ACHCoIDUDF45 = achid

End Function

Function Monthtext(monthval)
    mtext = &quot;&quot;
    Select Case monthval
        Case &quot;1&quot;
            mtext = &quot;January&quot;
        Case &quot;2&quot;
            mtext = &quot;February&quot;
        Case &quot;3&quot;
            mtext = &quot;March&quot;
        Case &quot;4&quot;
            mtext = &quot;April&quot;
        Case &quot;5&quot;
            mtext = &quot;May&quot;
        Case &quot;6&quot;
            mtext = &quot;June&quot;
        Case &quot;7&quot;
            mtext = &quot;July&quot;
        Case &quot;8&quot;
            mtext = &quot;August&quot;
        Case &quot;9&quot;
            mtext = &quot;September&quot;
        Case &quot;10&quot;
            mtext = &quot;October&quot;
        Case &quot;11&quot;
            mtext = &quot;November&quot;
        Case &quot;12&quot;
            mtext = &quot;December&quot;
        Case Else
            mtext = &quot;Invalid Month value&quot;
    End Select
    Monthtext = mtext
End Function

Function MonthNo(monthtxt)
    mthno = &quot;&quot;
    Select Case left(monthtxt, 3)
        Case &quot;Jan&quot;
            mthno = &quot;1&quot;
        Case &quot;Feb&quot;
            mthno = &quot;2&quot;
        Case &quot;Mar&quot;
            mthno = &quot;3&quot;
        Case &quot;Apr&quot;
            mthno = &quot;4&quot;
        Case &quot;May&quot;
            mthno = &quot;5&quot;
        Case &quot;Jun&quot;
            mthno = &quot;6&quot;
        Case &quot;Jul&quot;
            mthno = &quot;7&quot;
        Case &quot;Aug&quot;
            mthno = &quot;8&quot;
        Case &quot;Sep&quot;
            mthno = &quot;9&quot;
        Case &quot;Oct&quot;
            mthno = &quot;10&quot;
        Case &quot;Nov&quot;
            mthno = &quot;11&quot;
        Case &quot;Dec&quot;
            mthno = &quot;12&quot;
        Case Else
            mthno = &quot;Invalid Month&quot;
    End Select
    MonthNo = mthno
End Function

Function GetTotalFromtaskGrid101(strXMl, colname)
    strXMl = Replace(strXMl, &quot;&amp;&quot;, &quot;&amp;amp;&quot;)
    Set xmlDoc = CreateObject(&quot;Msxml2.DOMDocument&quot;)
    xmlDoc.setProperty &quot;SelectionLanguage&quot;, &quot;XPath&quot;

    Err.Clear
    On Error Resume Next
    xmlDoc.loadxml(strXMl)
    If Err.Number &lt;&gt; 0 Then
        &apos;Exit Function
        NLSapp.MessageBox(Err.Description)
    End If
    On Error GoTo 0
                
    Set nodesList = xmlDoc.documentelement.selectNodes(&quot;/DATA/ROW&quot;) 
    counter = nodesList.length

    dblTotal = 0

    For x = 1 To counter
                                        
        Set currNode=nodesList.nextNode 
        CurrNodeName = currNode.nodename
                                
        Set cnode = currNode.childnodes
                
        For Each c In cnode

            name = c.getAttribute(&quot;Name&quot;)
            value = c.getAttribute(&quot;Value&quot;)

            If name = colname Then
                dblTotal = dblTotal + value
            End If

        Next
    Next

    GetTotalFromtaskGrid101 = dblTotal / 2 
End Function

Function GetmonthsFromtaskGrid101(strXMl)
    strXMl = Replace(strXMl, &quot;&amp;&quot;, &quot;&amp;amp;&quot;)
    Set xmlDoc = CreateObject(&quot;Msxml2.DOMDocument&quot;)
    xmlDoc.setProperty &quot;SelectionLanguage&quot;, &quot;XPath&quot;

    Err.Clear
    On Error Resume Next
    xmlDoc.loadxml(strXMl)
    If Err.Number &lt;&gt; 0 Then
        &apos;Exit Function
        NLSapp.MessageBox(Err.Description)
    End If
    On Error GoTo 0
                
    Set nodesList = xmlDoc.documentelement.selectNodes(&quot;/DATA/ROW&quot;) 
    counter = nodesList.length

    GetmonthsFromtaskGrid101 = counter-1
End Function

Function setAdminuser(acctrefno)
    setAdminuser = -1
    &apos;COMMENT UPDATE
	    commentupdatetxt = &quot;Select 0; update loanacct_comments set created_by = 0,userdef01 = &apos;Outbound&apos;,userdef02 = &apos;Zero Balance Letter&apos;,userdef03 = &apos;Email&apos; &quot; &amp; _
	                 &quot;where comment_description in (&apos;CPLUS ZERO BALANCE LETTER&apos;,&apos;FPLUS ZERO BALANCE LETTER&apos;) &quot; &amp; _
	                 &quot;and created_by &lt;&gt; 0 and created &gt;= left(getdate(),11) and acctrefno IN &quot;
	    
	    Nlsapp.sqlselectstatement(commentupdatetxt &amp; acctrefno)                 
    
    &apos;Mod HISTORY UPDATE             
	    modhistupdatetxt = &quot;SELECT 0; UPDATE loanacct_mod_history SET mod_uid = 0, modification_description = &apos;//VBScript// &apos;+ char(13) + modification_description where row_id IN &quot;
	    modIDlist = &quot;&quot;
	    modsqllookup1 = &quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;UIDADMINUPDATES&apos; &quot;    
	    
	    modupdatesql = NLSapp.SQLSelectStatement(modsqllookup1)    
	    modID = NLSapp.SQLSelectStatement(modupdatesql &amp; acctrefno)
	    Do Until modID = &quot;stop&quot;
	
	        If modID = &quot;***END OF RESULT***&quot; Then
	            modIDlist = &quot;(&quot; &amp; Left(modIDlist, Len(modIDlist) - 2) &amp; &quot;)&quot;
	            modID = &quot;stop&quot;
	        Else
	            modIDlist = modIDlist &amp; modID &amp; &quot;, &quot;
	            modID = NLSApp.SQLSelectStatementReadNext()
	        End If
	
	    Loop 
  
	    NLSapp.SQLSelectStatement(modhistupdatetxt &amp; modIDlist)  
    
    &apos;TRANSACTION HISTORY UPDATE 
	    transhistupdatetxt = &quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0, user_reference = &apos;//VBScript//&apos; where transrefno IN &quot;
	    transrefnolist = &quot;&quot;
	    transqllookup2 = &quot;SELECT cd.userdef27 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &apos;UIDADMINUPDATES&apos; &quot;
	    
	    transupdatesql = NLSapp.SQLSelectStatement(transqllookup2)
	    tranrefno = NLSapp.SQLSelectStatement(transupdatesql &amp; acctrefno)
	    Do Until tranrefno = &quot;stop&quot;
	
	        If tranrefno = &quot;***END OF RESULT***&quot; Then
	            transrefnolist = &quot;(&quot; &amp; Left(transrefnolist, Len(transrefnolist) - 2) &amp; &quot;)&quot;
	            tranrefno = &quot;stop&quot;
	        Else
	            transrefnolist = transrefnolist &amp; tranrefno &amp; &quot;, &quot;
	            tranrefno = NLSApp.SQLSelectStatementReadNext()
	        End If
	
	    Loop
	    NLSapp.SQLSelectStatement(transhistupdatetxt &amp; transrefnolist)

    setAdminuser = &quot;&quot;

End Function

&apos;DATE FORMATTING--------------------------------------------------------------------

Function DateFormat(datestring,formatcode)

	If IsDate(datestring) = true Then
		If len(DAY(datestring)) = 1 Then
		   daytext = &quot;0&quot; &amp; DAY(datestring) 
		Else 
		   daytext = DAY(datestring) 
		End if 

		If len(MONTH(datestring)) = 1 Then
		   mnthtext = &quot;0&quot; &amp; MONTH(datestring) 
		Else 
		   mnthtext = MONTH(datestring) 
		End if 

		Select case formatcode
		&apos;U.S. = mm/dd/yyyy
		case 1	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp; Right(YEAR(datestring),2)

		case 101	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp;	YEAR(datestring) 

		&apos;JAPAN	= yyyy/mm/dd	
		case 11	
			DateFormat = Right(YEAR(datestring),2) &amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext
		case 111	
			DateFormat = YEAR(datestring)&amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext

		&apos;Default with Day and timestamp removed	= mon yyyy	
		case 10077	
			DateFormat =  MonthName(Month(datestring), False) &amp; &quot; &quot; &amp; YEAR(datestring)
			

		Case Else

			DateFormat = -1

		End Select

	Else	

		DateFormat = -1

	End if

	

End Function

Function DaysInMonth(monthno,yearno)

     Select Case monthno
           Case 1, 3, 5, 7, 8, 10, 12
              DaysInMonth = 31

          Case 4, 6, 9, 11
              DaysInMonth = 30  

          Case 2
              &apos;Is Year a leap year?
              If  (yearno Mod 400 = 0) or (yearno Mod 4 = 0 and not yearno Mod 100 = 0) Then  
                 DaysInMonth = 29
              Else
                 DaysInMonth = 28
              End If
     End Select

End Function

Function MonthNo(monthtxt)
    mthno = &quot;&quot;
    Select Case left(monthtxt, 3)
        Case &quot;Jan&quot;
            mthno = &quot;1&quot;
        Case &quot;Feb&quot;
            mthno = &quot;2&quot;
        Case &quot;Mar&quot;
            mthno = &quot;3&quot;
        Case &quot;Apr&quot;
            mthno = &quot;4&quot;
        Case &quot;May&quot;
            mthno = &quot;5&quot;
        Case &quot;Jun&quot;
            mthno = &quot;6&quot;
        Case &quot;Jul&quot;
            mthno = &quot;7&quot;
        Case &quot;Aug&quot;
            mthno = &quot;8&quot;
        Case &quot;Sep&quot;
            mthno = &quot;9&quot;
        Case &quot;Oct&quot;
            mthno = &quot;10&quot;
        Case &quot;Nov&quot;
            mthno = &quot;11&quot;
        Case &quot;Dec&quot;
            mthno = &quot;12&quot;
        Case Else
            mthno = &quot;Invalid Month&quot;
    End Select
    MonthNo = mthno
End Function**###Local Functions###**"/>
</LOAN_PORTFOLIO_CODE>
</SETUP>
