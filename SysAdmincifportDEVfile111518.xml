<SETUP>
<CONTACT_PORTFOLIO_CODE code="SYS ADMIN" description="Created for use by Sys Admin Group only" numbering_mask="%d" option_flags="32705" disabled_flag="0" allow_documents_flag="0" show_description_flag="0" comment_type="0" ecoa_code="" relationship_type="0" field_order="0" collateral_type="0" location_flag="0" taxes_flag="0" insurance_flag="0" object_def="&lt;NLSObjectDef&gt;
&lt;ScreenObject/&gt;
&lt;/NLSObjectDef&gt;
" class_1_label="" class_2_label="">
<USERDEFFIELDS field_id="151" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="150" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="149" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="148" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="147" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="146" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="145" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="144" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="143" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="142" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="141" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="140" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="139" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="138" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="137" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="136" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="182" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="181" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="180" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="179" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="178" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="177" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="176" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="175" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="174" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="173" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="172" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="171" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="170" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="169" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="168" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5205" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="198" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="197" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="196" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="195" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="194" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="193" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="192" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="191" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="190" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="189" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="188" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="187" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="186" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="185" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="184" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="183" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="167" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="166" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="165" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="164" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="163" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="162" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="161" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="160" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="159" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="158" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="157" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="156" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="155" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="154" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="153" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="152" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="135" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="134" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="133" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="132" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="131" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="130" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="129" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="128" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="127" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="126" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="125" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="124" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="123" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="122" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="121" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="103" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="102" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="101" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="120" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="46.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="46.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="119" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="24.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="24.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="118" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;230&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;293&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="230.0000000000" StaticTopPos="2.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="293.0000000000" FieldTopPos="2.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="117" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="354.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="354.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="116" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="115" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="114" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="288.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="288.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="113" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="266.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="266.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="112" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="244.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="244.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="111" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="222.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="222.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="110" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="200.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="200.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="109" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="178.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="178.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="108" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="156.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="156.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="107" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="134.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="134.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="106" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="112.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="112.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="105" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="90.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="90.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="104" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;11&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;74&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="11.0000000000" StaticTopPos="68.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="74.0000000000" FieldTopPos="68.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5204" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5203" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5202" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5201" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5105" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5104" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5103" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5102" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="5101" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;0&quot; StaticTopPos=&quot;0&quot; StaticWidth=&quot;0&quot; StaticHeight=&quot;0&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;0&quot; FieldHeight=&quot;0&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="0.0000000000" StaticTopPos="0.0000000000" StaticWidth="0.0000000000" StaticHeight="0.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="0.0000000000" FieldHeight="0.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="200" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="332.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="332.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="199" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;449&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;60&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;512&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;150&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;0&quot; ScreenWidth=&quot;0&quot; ZOrder=&quot;0&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="449.0000000000" StaticTopPos="310.0000000000" StaticWidth="60.0000000000" StaticHeight="20.0000000000" FieldLeftPos="512.0000000000" FieldTopPos="310.0000000000" FieldWidth="150.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="0.0000000000" ScreenWidth="0.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="0"/>
<USERDEFFIELDS field_id="77" field_type="0" field_attribute="0" label_text="User Defined 27 SQL 03" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;205&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;168&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;1&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="200.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="205.0000000000" FieldWidth="279.0000000000" FieldHeight="168.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="1"/>
<USERDEFFIELDS field_id="68" field_type="0" field_attribute="0" label_text="User Defined 18 SQL01" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;191&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;3&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="2.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="2.0000000000" FieldWidth="279.0000000000" FieldHeight="191.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="3"/>
<USERDEFFIELDS field_id="5005" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;168&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;92&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;5&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="973.0000000000" StaticWidth="168.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="92.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="5"/>
<USERDEFFIELDS field_id="5004" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;168&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;92&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;7&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="973.0000000000" StaticWidth="168.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="92.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="7"/>
<USERDEFFIELDS field_id="5003" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;168&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;92&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;9&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="973.0000000000" StaticWidth="168.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="92.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="9"/>
<USERDEFFIELDS field_id="5002" field_type="8" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;168&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;0&quot; FieldTopPos=&quot;0&quot; FieldWidth=&quot;92&quot; FieldHeight=&quot;25&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;11&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="973.0000000000" StaticWidth="168.0000000000" StaticHeight="25.0000000000" FieldLeftPos="0.0000000000" FieldTopPos="0.0000000000" FieldWidth="92.0000000000" FieldHeight="25.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="11"/>
<USERDEFFIELDS field_id="5001" field_type="8" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;973&quot; StaticWidth=&quot;168&quot; StaticHeight=&quot;25&quot; FieldLeftPos=&quot;549&quot; FieldTopPos=&quot;438&quot; FieldWidth=&quot;247&quot; FieldHeight=&quot;117&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;13&quot; ReadOnly=&quot;0&quot;&gt;
&lt;TABLE DoNotSave=&quot;False&quot; DoNotDirty=&quot;False&quot; StretchLastColumn=&quot;False&quot; GridType=&quot;Generic&quot;/&gt;
&lt;ROW NumberOfRows=&quot;Grow as needed&quot;/&gt;
&lt;COLUMN Name=&quot;CodeName&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;125&quot; ReadOnly=&quot;True&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;CodeNo&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;45&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Port_Id&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;45&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;COLUMN Name=&quot;Target&quot; TableLink=&quot;None&quot; Type=&quot;Text&quot; DecimalPlaces=&quot;0&quot; ComboData=&quot;&quot; Alignment=&quot;Left&quot; Width=&quot;45&quot; ReadOnly=&quot;False&quot; UseComma=&quot;False&quot; SubTotal=&quot;False&quot; SQLStatement=&quot;&quot;/&gt;
&lt;/UDF&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="973.0000000000" StaticWidth="168.0000000000" StaticHeight="25.0000000000" FieldLeftPos="549.0000000000" FieldTopPos="438.0000000000" FieldWidth="247.0000000000" FieldHeight="117.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="13"/>
<USERDEFFIELDS field_id="100" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;15&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="332.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="332.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="15"/>
<USERDEFFIELDS field_id="99" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;17&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="310.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="310.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="17"/>
<USERDEFFIELDS field_id="98" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;19&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="288.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="288.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="19"/>
<USERDEFFIELDS field_id="97" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;21&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="266.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="266.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="21"/>
<USERDEFFIELDS field_id="96" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;23&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="244.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="244.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="23"/>
<USERDEFFIELDS field_id="95" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;25&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="222.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="222.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="25"/>
<USERDEFFIELDS field_id="94" field_type="0" field_attribute="0" label_text="User Defined 44 SQL04" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;176&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;27&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="200.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="200.0000000000" FieldWidth="281.0000000000" FieldHeight="176.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="27"/>
<USERDEFFIELDS field_id="93" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;29&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="178.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="178.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="29"/>
<USERDEFFIELDS field_id="92" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;31&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="156.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="156.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="31"/>
<USERDEFFIELDS field_id="91" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;33&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="134.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="134.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="33"/>
<USERDEFFIELDS field_id="90" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;35&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="112.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="112.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="35"/>
<USERDEFFIELDS field_id="89" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;37&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="90.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="90.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="37"/>
<USERDEFFIELDS field_id="88" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;39&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="68.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="68.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="39"/>
<USERDEFFIELDS field_id="87" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;41&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="46.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="46.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="41"/>
<USERDEFFIELDS field_id="86" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;43&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="24.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="24.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="43"/>
<USERDEFFIELDS field_id="85" field_type="0" field_attribute="0" label_text="User Defined 35 SQL03" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;837&quot; StaticTopPos=&quot;2&quot; StaticWidth=&quot;115&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;955&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;194&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;45&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="837.0000000000" StaticTopPos="2.0000000000" StaticWidth="115.0000000000" StaticHeight="20.0000000000" FieldLeftPos="955.0000000000" FieldTopPos="2.0000000000" FieldWidth="281.0000000000" FieldHeight="194.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="45"/>
<USERDEFFIELDS field_id="84" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;47&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="354.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="354.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="47"/>
<USERDEFFIELDS field_id="83" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;49&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="332.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="332.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="49"/>
<USERDEFFIELDS field_id="82" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;51&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="310.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="310.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="51"/>
<USERDEFFIELDS field_id="81" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;53&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="288.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="288.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="53"/>
<USERDEFFIELDS field_id="80" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;55&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="266.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="266.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="55"/>
<USERDEFFIELDS field_id="79" field_type="6" field_attribute="0" label_text="User Defined 29" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Debt Validation Letter&quot; Script=&quot;&amp;apos;NLS objects
Set DT10 = NLSApp.GetDocumentTemplates(TEMPLATE_DOCTEMPL_CPLUS_DEBT_VALIDATION_LETTER)
Set DT11= NLSApp.GetDocumentTemplates(TEMPLATE_DOCTEMPL_FPLUS_DEBT_VALIDATION_LETTER)

rowcnt = NLSApp.SQLSelectStatement(firstdpdlookupsql)
rowcnt = 8
redim loanlist(rowcnt)

loanlist(0) = &amp;quot;60803,APP-00455510,0,748.36,05/24/2018,Jun 10 2016 12:00AM&amp;quot;
loanlist(1) = &amp;quot;60804,APP-00455510,0,748.36,05/24/2018,Jun 10 2016 12:00AM&amp;quot;
loanlist(2) = &amp;quot;78591,APP-00655556,0,888.22,05/24/2018,Nov 29 2016 12:00AM&amp;quot;
loanlist(3) = &amp;quot;78592,APP-00655556,0,888.22,05/24/2018,Nov 29 2016 12:00AM&amp;quot;
loanlist(4) = &amp;quot;95159,APP-00865890,0,689.82,05/25/2018,Apr  7 2017 12:00AM&amp;quot;
loanlist(5) = &amp;quot;105888,APP-01000085,0,367.06,04/25/2018,Jun  8 2017 12:00AM&amp;quot;
loanlist(6) = &amp;quot;76089,CP0184736,1,469.00,05/25/2018,Mar 27 2017 12:00AM&amp;quot;
loanlist(7) = &amp;quot;81918,CP0192183,1,429.69,05/25/2018,Mar 31 2017 12:00AM&amp;quot;

    &amp;apos;For each selected contact, update the cif udf fields that will be used for the document merge fields
    &amp;apos;Then generate the document, saving a copy to contact comments and sending to the print queue

    For rownumb = 0 to rowcnt-1
        letterdetail = Split(loanlist(rownumb),&amp;quot;,&amp;quot;)

        docmergedetailsql = &amp;quot;select 0; UPDATE cif_detail &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SET userdef12 = &amp;apos;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;apos;, userdef13 = &amp;apos;&amp;quot; &amp;amp; letterdetail(1) &amp;amp; &amp;quot;&amp;apos;, userdef14 = &amp;apos;&amp;quot; &amp;amp; letterdetail(3) &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;, userdef15 = &amp;apos;&amp;quot; &amp;amp; letterdetail(4) &amp;amp; &amp;quot;&amp;apos;, userdef16 = &amp;apos;&amp;quot; &amp;amp; letterdetail(5) &amp;amp; _ 
        &amp;quot;&amp;apos; WHERE cifno = &amp;quot;  &amp;amp; letterdetail(0)
        &amp;apos;NLSApp.SQLSelectStatement(docmergedetailsql)
        NLSApp.MessageBox(docmergedetailsql)

        &amp;apos;generate doc
        If letterdetail(2) = &amp;quot;0&amp;quot; then
            DT10.GenerateDocument letterdetail(0), &amp;quot;TRUE&amp;quot;, &amp;quot;COMPLIANCE COM&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
        Else
            DT11.GenerateDocument letterdetail(0), &amp;quot;TRUE&amp;quot;, &amp;quot;COMPLIANCE COM&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
        End if
    Next&quot;/&gt;
&lt;BUTTON Name=&quot;Investor Transfers&quot; Script=&quot;&amp;apos;###TBD
&amp;apos;on Button click option selection or on application start for selected users/groups
&amp;apos;For selected file in designated directory, processes list of loans for updates to class2 (investor) field

Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\PendingTransfers&amp;quot;
completefolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\CompletedTransfers\&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid class2 codes
redim class2list(1)
class2lookupsql = &amp;quot;SELECT distinct code from loan_class where class_specifier = 2&amp;quot;
    &amp;apos;Populate array with current class2 list in NLS
    Do until nextinvestor = &amp;quot;***END OF RESULT***&amp;quot;
        rowcnt = UBound(class2list,1)
        
        If rowcnt = 1 Then
            class2list(rowcnt) = NLSApp.SQLSelectStatement(class2lookupsql)
        else
            class2list(rowcnt) = nextinvestor
        end if
        
        nextinvestor = NLSApp.SQLSelectStatementReadNext()
    
        If not nextinvestor = &amp;quot;***END OF RESULT***&amp;quot; Then
           redim Preserve class2list(rowcnt + 1)
        End if
    
    Loop

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim loanlist(1)
    
&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file to process.&amp;quot;, &amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    strExcelPath = CStr(objShellFolderFile.Self.path)
    
    Folderitemscnt = objShellFolderFileItems.count
    
    &amp;apos;Filesys Objects
    set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
    set objFsFolder = objFs.GetFolder(targetfolder)
    Foldersize = objFsFolder.size
    If Foldersize &amp;gt; 0 Then 
        &amp;apos;msgBox(objFsFolder.size)
        &amp;apos;msgBox(objShellFolderFileItems.count)
    End If
    
    &amp;apos;Excel objects
    Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)
    Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)
    objExcel.DisplayAlerts = False
    
        &amp;apos;Evaluate selected excel file and mark rows with valid records for processing
        Do Until CellVal = &amp;quot;&amp;quot;
            allrowcount = allrowcount+1
            CellVal = objExcel.Cells(allrowcount,1).Value
            InvVal = objExcel.Cells(allrowcount,3).Value
            validloan = NLSApp.SQLSelectStatement(&amp;quot;Select count(*) from loanacct where loan_number = &amp;apos;&amp;quot; &amp;amp; CellVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
            validclass2 = 1        
    		If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
                datarows = datarows + 1		
    
                If StrComp(&amp;quot;APP-&amp;quot;, left(CellVal,4),1 ) = 0 Then
                    fplusrows = fplusrows + 1
                   objExcel.Cells(allrowcount, 4).Value = &amp;quot;F&amp;quot;
                End if
                If StrComp(&amp;quot;CP&amp;quot;, left(CellVal,2),1 ) = 0 Then
                    cplusrows = cplusrows + 1
                   objExcel.Cells(allrowcount, 4).Value = &amp;quot;C&amp;quot;
                End if
                If UBound(Filter (class2list,InvVal),1)= -1 Then
                    validclass2 = 0
                    Invalidclass2 = Invalidclass2 + 1
                End if
                If validloan = 0 Then
                    Invalidloans = Invalidloans + 1
                End if
                If validloan &amp;amp; validclass2 = &amp;quot;11&amp;quot; Then
                    validrecords = validrecords + 1
                   objExcel.Cells(allrowcount, 2).Value = &amp;quot;Y&amp;quot;
                Else
                   objExcel.Cells(allrowcount, 2).Value = &amp;quot;N&amp;quot;
                End If
    			
                loanlist(datarows-1) = CellVal &amp;amp; validloan &amp;amp; validclass2	
                redim preserve loanlist(datarows)
            End if
        Loop
    
        &amp;apos;Summary message
        msgheader =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13)
        msgline1 = &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(13) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13)
        msgline2 = &amp;quot;Invalid Loan Numbers: &amp;quot; &amp;amp; Invalidloans &amp;amp; chr(13)
        msgline3 = &amp;quot;Invalid Investor Designations: &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13)
        msgline4 = &amp;quot;Total valid transferable loan records submitted: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13)
        msgfooter = &amp;quot;Continue (Y/N)&amp;quot;
        &amp;apos;Save summary message to worksheet
        objExcel.Cells(1, 6).Value = &amp;quot;PROCESSING SUMARY &amp;quot; &amp;amp; NOW()
        objExcel.Cells(2, 6).Value = msgheader
        objExcel.Cells(3, 6).Value = msgline1
        objExcel.Cells(4, 6).Value = msgline2
        objExcel.Cells(5, 6).Value = msgline3
        objExcel.Cells(6, 6).Value = msgline4
    	
    If Not NLSApp.YesNoMessageBox(msgheader &amp;amp; msgline1 &amp;amp; msgline2 &amp;amp; msgline3 &amp;amp; msgline4 &amp;amp; msgfooter)Then
        &amp;apos;Close without processing
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
    Else
        &amp;apos;Process valid records then close and move file to Completed folder
        If processtransfers (allrowcount,Startrowno,1) = 1 Then
            objWorkbook.Save 
            objWorkbook.Close
            objExcel.quit
            set objExcel = nothing
            set objShell = nothing
            objFs.GetFolder(targetfolder)
            objFs.MoveFile strExcelPath,completefolder &amp;amp; &amp;quot;InvestorTrans&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
            msgbox(&amp;quot;Transfers Completed!&amp;quot;)
        Else
            msgbox(&amp;quot;There was a problem with the Transfers and all were not Completed!&amp;quot;)
        End if
        
    End If
Else
  set objShell = nothing
  NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)  
End If

Function processtransfers (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
        LoanNumber = objExcel.Cells(rowno, colno).Value
        refno = objExcel.Cells(rowno, colno+1).Value
        class2 = objExcel.Cells(rowno, colno+2).Value
        portfolio = objExcel.Cells(rowno, colno+3).Value
        transtype =  1
        target =  objExcel.Cells(rowno, colno+4).Value
        If UBound(Filter (loanlist,LoanNumber &amp;amp; &amp;quot;11&amp;quot;),1) = 0 Then
            SyncACHCompanyupdate LoanNumber, refno, class2, portfolio, target,transtype,DateFormat(NOW(),1)
        End if
        rowno = rowno +1
    Next
    processtransfers = 1
End Function

Sub SyncACHCompanyupdate(loannumber,refno,Investor,Portfolio,targetACH,bulktransfer,effectivedate)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &amp;apos;Triggered when individual loan account is chnaged or updated.
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    
    &amp;apos;Declare variables
    runtimestamp = Now()
    emailyn = &amp;quot;N&amp;quot;
    userno = NLSApp.GetCurrentUserNo()
    If Not loannumber = &amp;quot;&amp;quot; Then
    	refno = NLSApp.SQLSelectStatement(&amp;quot;SELECT acctrefno FROM loanacct WHERE loan_number = &amp;apos;&amp;quot; &amp;amp; loannumber &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
    End if
	If Portfolio = &amp;quot;C&amp;quot; Then 
		Portfolio = 1
	End if
	If Portfolio = &amp;quot;F&amp;quot; Then 
		Portfolio = 0
	End if
    &amp;apos;refno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
    &amp;apos;Investor = NLSApp.GetField(&amp;quot;LOAN_CLASS2&amp;quot;)
    &amp;apos;Portfolio = NLSApp.GetField(&amp;quot;LOAN_PORTFOLIO&amp;quot;)
    WebACH = NLSApp.GetField(&amp;quot;LOAN_DETAIL2_UDF45&amp;quot;)
    If targetACH = &amp;quot;&amp;quot; Then 
    	targetACH =  InvestorACHSync(Investor, Portfolio)
    End If
    &amp;apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &amp;quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &amp;quot; &amp;amp; refno &amp;amp; &amp;quot; and ach_company_id &amp;lt;&amp;gt; &amp;quot; &amp;amp; targetACH
    &amp;apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 
    class2code = NLSapp.SQLSelectStatement(&amp;quot;select convert(varchar(4),codenum) from loan_class where code = &amp;apos;&amp;quot; &amp;amp; Investor &amp;amp; &amp;quot;&amp;apos;&amp;quot;)


    &amp;apos;Other variables
    modhistupdatesql = &amp;quot;&amp;quot;  
    loanach = &amp;quot;&amp;quot;
    loandetail = &amp;quot;&amp;quot;
    achxml = &amp;quot;&amp;quot;
    Detail2pdatesql = &amp;quot;&amp;quot;
    ACHUpdatesql = &amp;quot;&amp;quot;
    
    &amp;apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &amp;quot;&amp;quot; Then
        Do Until nomatchACHrowID = &amp;quot;&amp;quot; &amp;apos;&amp;quot;***END OF RESULT***&amp;quot;
            ACHUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot; Where row_id = &amp;quot; &amp;amp; nomatchACHrowID
            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &amp;apos;MsgBox(&amp;quot;all match&amp;quot;)
    End If    
    
    &amp;apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &amp;apos;&amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
    &amp;apos;Is loan part of a bulf transafer?
    If Bulktransfer = 1 Then
    	Select Case Portfolio 
    	Case 0
	        Investortransdatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail SET userdef19 = &amp;apos;&amp;quot; &amp;amp; DateFormat(effectivedate, 111) &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
	        
        Case 1
	        Investortransdatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail SET userdef29 = &amp;apos;&amp;quot; &amp;amp; DateFormat(effectivedate, 111) &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
	        
        End Select
        
        NLSapp.SQLSelectStatement(Investortransdatesql)
    End If

	NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct SET loan_class2_no = &amp;quot; &amp;amp; class2code &amp;amp; &amp;quot; where acctrefno = &amp;quot; &amp;amp; refno)
      
End Sub
&quot;/&gt;
&lt;BUTTON Name=&quot;inv trans&quot; Script=&quot;&amp;apos;###TBD
&amp;apos;on Button click option selection or on application start for selected users/groups
&amp;apos;For selected file in designated directory, processes list of loans for updates to class2 (investor) field

Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\PendingTransfers&amp;quot;
completefolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\CompletedTransfers\&amp;quot;

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid class2 codes
redim class2list(1)
class2lookupsql = &amp;quot;SELECT distinct code from loan_class where class_specifier = 2&amp;quot;
&amp;apos;Populate array with current class2 list
    Do until nextinvestor = &amp;quot;***END OF RESULT***&amp;quot;
        rowcnt = UBound(class2list,1)
        
        If rowcnt = 1 Then
            class2list(rowcnt) = NLSApp.SQLSelectStatement(class2lookupsql)
        else
            class2list(rowcnt) = nextinvestor
        end if
        
        nextinvestor = NLSApp.SQLSelectStatementReadNext()
    
        If not nextinvestor = &amp;quot;***END OF RESULT***&amp;quot; Then
           redim Preserve class2list(rowcnt + 1)
        End if
    
    Loop

&amp;apos;Dim dynamic array to hold sql lookup results of list of valid loan numbers
redim loanlist(1)
    
&amp;apos;object management
Dim objExcel, objShell, objShellFolderFile, objFsFolder,odjFs,objFsFolderItems

&amp;apos;Shell objects
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
set objshellFolder = objShell.NameSpace(targetfolder)
set objShellFolderFileItems = objshellFolder.Items
Set objShellFolderFile = objShell.BrowseForFolder(0, &amp;quot;Please select the file to process.&amp;quot;, &amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
If Not (objShellFolderFile Is Nothing) Then
    &amp;apos;msgbox(objShellFolderFile.Self.path)
    strExcelPath = CStr(objShellFolderFile.Self.path)
End If
Folderitemscnt = objShellFolderFileItems.count

&amp;apos;Filesys Objects
set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
set objFsFolder = objFs.GetFolder(targetfolder)
Foldersize = objFsFolder.size
If Foldersize &amp;gt; 0 Then 
    &amp;apos;msgBox(objFsFolder.size)
    &amp;apos;msgBox(objShellFolderFileItems.count)
End If


&amp;apos;Excel objects
Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)
Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)
objExcel.DisplayAlerts = False

    Do Until CellVal = &amp;quot;&amp;quot;
        allrowcount = allrowcount+1
        CellVal = objExcel.Cells(allrowcount,1).Value
        InvVal = objExcel.Cells(allrowcount,3).Value
        validloan = NLSApp.SQLSelectStatement(&amp;quot;Select count(*) from loanacct where loan_number = &amp;apos;&amp;quot; &amp;amp; CellVal &amp;amp; &amp;quot;&amp;apos;&amp;quot;)
        validclass2 = 1        
		If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
            datarows = datarows + 1		

            If StrComp(&amp;quot;APP-&amp;quot;, left(CellVal,4),1 ) = 0 Then
                fplusrows = fplusrows + 1
            End if
            If StrComp(&amp;quot;CP&amp;quot;, left(CellVal,2),1 ) = 0 Then
                cplusrows = cplusrows + 1
            End if
            If UBound(Filter (class2list,InvVal),1)= -1 Then
                validclass2 = 0
                Invalidclass2 = Invalidclass2 + 1
            End if
            If validloan = 0 Then
                Invalidloans = Invalidloans + 1
            End if
            If validloan &amp;amp; validclass2 = &amp;quot;11&amp;quot; Then
                validrecords = validrecords + 1
               objExcel.Cells(allrowcount, 2).Value = &amp;quot;Y&amp;quot;
            Else
               objExcel.Cells(allrowcount, 2).Value = &amp;quot;N&amp;quot;
            End If
			
            loanlist(datarows-1) = CellVal &amp;amp; validloan &amp;amp; validclass2	
            redim preserve loanlist(datarows)
			
        End if

    Loop

	
    message1 =  datarows &amp;amp; &amp;quot; Records Submitted for Processing.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
    &amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(13) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Invalid Loan Numbers: &amp;quot; &amp;amp; Invalidloans &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Invalid Investor Designations: &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Total valid transferable loan records submitted: &amp;quot;  &amp;amp; 0 + validrecords &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Continue (Y/N)&amp;quot;

If Not NLSApp.YesNoMessageBox(message1)Then
    &amp;apos;objWorkbook.RejectAllChanges
    objWorkbook.Close
    objExcel.quit
    set objExcel = nothing
    set objShell = nothing
    NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
Else
    If processtransfers (allrowcount,Startrowno,1) = 1 Then
        objWorkbook.Save 
        objWorkbook.Close
        objExcel.quit
        set objExcel = nothing
        set objShell = nothing
        &amp;apos;msgbox(strExcelPath &amp;amp; chr(13) &amp;amp; completefolder &amp;amp; &amp;quot;InvestorTrans&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;)
        objFs.GetFolder(targetfolder)
        objFs.MoveFile strExcelPath,completefolder &amp;amp; &amp;quot;InvestorTrans&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
        msgbox(&amp;quot;Transfers Completed!&amp;quot;)
    Else
        msgbox(&amp;quot;There was a problem with the Transfers and all were not Completed!&amp;quot;)
    End if
    
End If

Function processtransfers (rowstoproc,rowno,colno)
    For Counter = 1 to rowstoproc
        LoanNumber = objExcel.Cells(rowno, colno).Value
        refno = objExcel.Cells(rowno, colno+1).Value
        class2 = objExcel.Cells(rowno, colno+2).Value
        portfolio = objExcel.Cells(rowno, colno+3).Value
        transtype =  1
        target =  objExcel.Cells(rowno, colno+4).Value
        If UBound(Filter (loanlist,LoanNumber &amp;amp; &amp;quot;11&amp;quot;),1) = 0 Then
            ACHCompanySyncatupdateB LoanNumber, refno, class2, portfolio, target,transtype,DateFormat(NOW(),1)
       &amp;apos;msgbox(LoanNumber &amp;amp; chr(13) &amp;amp; refno &amp;amp; chr(13) &amp;amp; class2 &amp;amp; chr(13) &amp;amp; portfolio)
        End if
        rowno = rowno +1
    Next
    processtransfers = 1
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;test6b inv trans&quot; Script=&quot;Startrowno = 2
CellVal = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
fplusrows = 0
cplusrows = 0
Invalidclass2 = 0
secsnow = &amp;quot;&amp;quot;
timestring = &amp;quot;&amp;quot;
targetfolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\PendingTransfers&amp;quot;
completefolder = &amp;quot;\\tsclient\T\FreedomPlus Servicing\Transfers\CompletedTransfers\&amp;quot;

&amp;apos;dim dynamic array to hold sql results
redim class2list(1)
class2lookupsql = &amp;quot;SELECT distinct code from loan_class where class_specifier = 2&amp;quot;

Do until nextinvestor = &amp;quot;***END OF RESULT***&amp;quot;
    rowcnt = UBound(class2list,1)
    
    If rowcnt = 1 Then
        class2list(rowcnt) = NLSApp.SQLSelectStatement(class2lookupsql)
    else
        class2list(rowcnt) = nextinvestor
    end if
    
    nextinvestor = NLSApp.SQLSelectStatementReadNext()

    If not nextinvestor = &amp;quot;***END OF RESULT***&amp;quot; Then
       redim Preserve class2list(rowcnt + 1)
    End if

Loop


Dim objExcel, objShell, objFolder, objFsFolder,odjFs,objFsFolderItems
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)
set objFs = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)

Set objFolder = objShell.BrowseForFolder(0, &amp;quot;Please select the Transfer list Folder.&amp;quot;, &amp;amp;H0020+&amp;amp;H4000+&amp;amp;H0200, targetfolder)
set objFsFolder = objFs.GetFolder(targetfolder)

set objshellFolder = objShell.NameSpace(targetfolder)
set objFolderItems = objshellFolder.Items

If objFsFolder.size &amp;gt; 0 Then 
    &amp;apos;msgBox(objFsFolder.size)
    &amp;apos;msgBox(objFolderItems.count)
End If


If Not (objFolder Is Nothing) Then
    msgbox(objFolder.Self.path)
    strExcelPath = CStr(objFolder.Self.path)
End If

Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

    Do Until CellVal = &amp;quot;&amp;quot;
        allrowcount = allrowcount+1
        CellVal = objExcel.Cells(allrowcount,1).Value
        InvVal = objExcel.Cells(allrowcount,3).Value

        If (allrowcount &amp;gt; 1) and (not  CellVal = &amp;quot;&amp;quot;) Then
            datarows = datarows + 1
            If StrComp(&amp;quot;APP-&amp;quot;, left(CellVal,4),1 ) = 0 Then
                fplusrows = fplusrows + 1
            End if
            If StrComp(&amp;quot;CP&amp;quot;, left(CellVal,2),1 ) = 0 Then
                cplusrows = cplusrows + 1
            End if
           If UBound(Filter (class2list,InvVal),1)= -1 Then
                Invalidclass2 = Invalidclass2 + 1
            End if
        End if

    Loop

    message1 = &amp;quot;There are &amp;quot; &amp;amp; datarows &amp;amp; &amp;quot; Loans to process.&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;CPlus Loans: &amp;quot; &amp;amp; cplusrows &amp;amp; chr(13) &amp;amp; &amp;quot;FPlus Loans: &amp;quot; &amp;amp; fplusrows &amp;amp; chr(13) &amp;amp; _
	&amp;quot;Invalid Investor Designations: &amp;quot; &amp;amp; Invalidclass2 &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
	&amp;quot;Continue (Y/N)&amp;quot;
If Not NLSApp.YesNoMessageBox(message1)Then
	objWorkbook.Close
                objExcel.quit
                 set objShell = nothing
	NLSApp.MessageBox(&amp;quot;Process Canceled.&amp;quot;)
	Else
	If processtransfers (Totalrows,Startrowno,1) = 1 Then
	objWorkbook.Close
                objExcel.quit
               set objShell = nothing

msgbox(strExcelPath &amp;amp; chr(13) &amp;amp; completefolder &amp;amp; &amp;quot;InvestorTrans&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;)
            &amp;apos;objFs.GetFile strExcelPath
            objFs.GetFolder(targetfolder)
            objFs.MoveFile strExcelPath,completefolder &amp;amp; &amp;quot;InvestorTrans&amp;quot; &amp;amp; DateFormat(NOW(),1012) &amp;amp; &amp;quot;.xlsx&amp;quot;
	    msgbox(&amp;quot;Transfers Completed!&amp;quot;)
	Else
	    msgbox(&amp;quot;There was a problem with the Transfers and all were not Completed!&amp;quot;)
	End if
	objWorkbook.Close
End If

Function processtransfers (rowstoproc,rowno,colno)
	For Counter = 1 to rowstoproc
	    LoanNumber = objExcel.Cells(rowno, colno).Value
	    refno = objExcel.Cells(rowno, colno+1).Value
	    class2 = objExcel.Cells(rowno, colno+2).Value
	    portfolio = objExcel.Cells(rowno, colno+3).Value
	    transtype =  1
	    target =  objExcel.Cells(rowno, colno+4).Value
	
	    ACHCompanySyncatupdateB LoanNumber, refno, class2, portfolio, target,transtype,&amp;quot;03/27/2018&amp;quot;
	   &amp;apos; msgbox(LoanNumber &amp;amp; chr(13) &amp;amp; refno &amp;amp; chr(13) &amp;amp; class2 &amp;amp; chr(13) &amp;amp; portfolio)
	    rowno = rowno +1
	Next
	processtransfers = 1
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;test 10 arrays&quot; Script=&quot;maxrows = InputBox(&amp;quot;limit&amp;quot;)
cols = 4
dem1 = cols-1
dem2 = maxrows-1

Redim cifdata(dem1,dem2)


For counter = 0 to maxrows-1
	&amp;apos;cifno
	if counter = 0 Then
		cifdata(0,counter) = NLSapp.SQLSelectStatement(&amp;quot;select distinct top &amp;quot; &amp;amp; maxrows &amp;amp; &amp;quot; convert(varchar,cifno), cifnumber, shortname, zip  from cif&amp;quot;)
	Else
		cifdata(0,counter) = NLSapp.SQLSelectStatementReadNext()
	End if
	&amp;apos;cifnumber 
	cifdata(1,counter)= NLSapp.SQLSelectStatementNextColumn() 
	&amp;apos;shortname 
	cifdata(2,counter)= NLSapp.SQLSelectStatementNextColumn()
	&amp;apos;zip 
	cifdata(3,counter)= NLSapp.SQLSelectStatementNextColumn()
	

next

rowno = InputBox(&amp;quot;ROW?&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Max limit:&amp;quot; &amp;amp; maxrows )-1

msgbox(cifdata(0,rowno) &amp;amp; &amp;quot;, &amp;quot; &amp;amp; cifdata(1,rowno) &amp;amp; &amp;quot;, &amp;quot; &amp;amp; cifdata(2,rowno) &amp;amp; &amp;quot;, &amp;quot; &amp;amp; cifdata(3,rowno))
&quot;/&gt;
&lt;BUTTON Name=&quot;test4&quot; Script=&quot;rowno = 2
colno = 1
strExcelPath = &amp;quot;\\tsclient\X\NLS\Excel\TransferList20180328.xlsx&amp;quot;
LoanNumber = &amp;quot;unassigned&amp;quot;
Const xlExcel7 = 39
Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

Set objWorkbook = objExcel.Workbooks.Open(strExcelPath)

Do Until LoanNumber = &amp;quot;&amp;quot;
    rowcount = rowcount+1
     LoanNumber = objExcel.Cells(rowno, colno).Value
     rowno = rowno +1
Loop
Totalrows = rowcount-1
msgbox(Totalrows &amp;amp; &amp;quot; Loans to process&amp;quot;)

Sub xyz
Do Until LoanNumber = &amp;quot;&amp;quot;
    LoanNumber = objExcel.Cells(rowno, colno).Value
    refno = objExcel.Cells(rowno, colno+1).Value
    class2 = objExcel.Cells(rowno, colno+2).Value
    portfolio = objExcel.Cells(rowno, colno+3).Value
    transtype =  1
    target =  objExcel.Cells(rowno, colno+4).Value

    &amp;apos;ACHCompanySyncatupdateB LoanNumber, refno, class2, portfolio, target,transtype,&amp;quot;03/27/2018&amp;quot;
    msgbox(LoanNumber &amp;amp; chr(13) &amp;amp; refno &amp;amp; chr(13) &amp;amp; class2 &amp;amp; chr(13) &amp;amp; portfolio)
    rowno = rowno +1
Loop
End sub

&amp;apos;objExcel.ActiveWorkbook.SaveAs strExcelPath
objExcel.ActiveWorkbook.Close

&amp;apos;objExcel.ActiveWorkbook.SaveAs strExcelPath, xlExcel7
&amp;apos;objExcel.ActiveWorkbook.Close

&amp;apos;set fso = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
&amp;apos;Set Form1 = CreateObject(&amp;quot;Forms.form&amp;quot;)




&quot;/&gt;
&lt;BUTTON Name=&quot;test3&quot; Script=&quot;starttime =NOW()
NLSApp.SetField &amp;quot;CIF_DETAIL_UDF35&amp;quot;,&amp;quot;&amp;quot;
getloandetailsql = &amp;quot;SELECT  Top 1000 cast(l.acctrefno as varchar), l.curr_maturity_date, cast(lp.next_payment_total_amount as varchar)  &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;from loanacct l, loanacct_payment lp &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;where l.acctrefno = lp.acctrefno and l.status_code_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;and l.loan_type = 0 and l.open_date between &amp;apos;6/01/17&amp;apos; and &amp;apos;7/01/17&amp;apos;&amp;quot;

amortstring = &amp;quot;&amp;lt;ALLAMORTS&amp;gt;&amp;quot; &amp;amp; chr(13)

acctrefno = NLSapp.SQLSelectStatement(getloandetailsql)

Do Until acctrefno = &amp;quot;***END OF RESULT***&amp;quot;
    currmaturity = NLSApp.SQLSelectStatementNextColumn()
    nextpayment = NLSApp.SQLSelectStatementNextColumn()
    amortstring = amortstring &amp;amp; &amp;quot;&amp;lt;LOAN Loanrefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; acctrefno &amp;amp; &amp;quot;&amp;quot;&amp;quot; CurrentMaturity=&amp;quot;&amp;quot;&amp;quot; &amp;amp; currmaturity &amp;amp; &amp;quot;&amp;quot;&amp;quot;  NextRegularPIPymnt=&amp;quot;&amp;quot;&amp;quot; &amp;amp; nextpayment &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; rtrim(NLSApp.AmortizationScheduleAsXML(acctrefno)) &amp;amp;  &amp;quot;&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13)
    acctrefno = NLSApp.SQLSelectStatementReadNext()
Loop
amortstring = amortstring &amp;amp;&amp;quot;&amp;lt;/ALLAMORTS&amp;gt;&amp;quot;

&amp;apos;NLSApp.MessageBox(amortstring)
&amp;apos;NLSApp.SetField &amp;quot;CIF_DETAIL_UDF35&amp;quot;,amortstring
endtime = NOW()

hrs = Format(Round(DateDiff(&amp;quot;s&amp;quot; ,starttime,endtime)/3600) MOD 60)
min = Format((Round(DateDiff(&amp;quot;s&amp;quot; ,starttime,endtime)/60) MOD 60) -1)
sec = Format( DateDiff(&amp;quot;s&amp;quot; ,starttime,endtime) MOD 60)

Runtime2 = DateDiff(&amp;quot;s&amp;quot; ,starttime,endtime)
Runtime =  hrs &amp;amp; &amp;quot;:&amp;quot; &amp;amp; min &amp;amp; &amp;quot;:&amp;quot; &amp;amp;  sec
NLSApp.MessageBox(&amp;quot;Completed!&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Runtime - &amp;quot; &amp;amp; Runtime &amp;amp; chr(13) &amp;amp; Runtime2)
NLSApp.SaveScreen()

Function Format(intiger)
    If len(intiger) = 1 Then
        Format = &amp;quot;0&amp;quot; &amp;amp; intiger
    Else 
        Format =intiger
    End if
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;test2&quot; Script=&quot;&amp;apos;Maintenace script to catch any DS payments not associated to a 7228 trans code

DebtsetTransMaint

Sub DebtsetTransMaint()
     runtimestamp = Now()
     CreateTC802sql = &amp;quot;SELECT distinct l.loan_number,&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lph.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lph.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lph.row_id)  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;, &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history SET userdef02 = &amp;apos;&amp;apos;&amp;apos;+ &amp;apos;YES&amp;apos;+&amp;apos;&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lph.row_id) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when lph.userdef01  not like &amp;apos;%Debt Settlement Payment%&amp;apos; Then &amp;apos; UPDATE loanacct_payment_history SET userdef01 = &amp;apos;&amp;apos;Debt Settlement Payment&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lph.row_id) end&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct_payment_history lph,&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct l,loanacct_trans_history lth,&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;(SELECT distinct acctrefno, convert(datetime,Convert(char(8),max(mod_datestamp),1)) as effective_date &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot; from loanacct_mod_history &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot; where item_changed = &amp;apos;Status&amp;apos; and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot; group by acctrefno ) settlement_acctrefnos&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where lph.acctrefno = l.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and lph.transaction_reference_no = lth.transaction_reference_no &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;--and lph.userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and lph.userdef02  not like &amp;apos;%YES%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and lph.payment_type = &amp;apos;ZZ&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and lph.acctrefno = settlement_acctrefnos.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and lth.transaction_date &amp;gt; &amp;apos;01/01/18&amp;apos; /*These updates should not be retroactive at the date of implementation*/ &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and left(lth.transaction_date, 19) &amp;gt;= settlement_acctrefnos.effective_date &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and lph.acctrefno IN (SELECT ls.acctrefno from loanacct_statuses ls, loan_status_codes lsc where lsc.status_code_no = ls.status_code_no and  lsc.status_code in (&amp;apos;ACTIVE SETTLEMENT&amp;apos;))&amp;quot;
 
    
    
    Do 
        loanNumber = NLSapp.SQLSelectStatement(CreateTC802sql)
        If Not loanNumber = &amp;quot;&amp;quot; Then
            addtrans = NLSapp.SQLSelectStatementNextColumn()
            updatepmnt = NLSapp.SQLSelectStatementNextColumn()

            If ImportXML(addtrans) = &amp;quot;&amp;quot; Then
               NLSapp.SQLSelectStatement(updatepmnt)
               
            End If
        End if
            
    Loop Until loanNumber = &amp;quot;&amp;quot;
    
    MsgBox(runtimestamp)
    &amp;apos;Update loan trans history to show ADMIN as user and add notation for VBScript for any loans processed
    transhistupdatesql = &amp;quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0, user_reference = &amp;apos;//VBScript//&amp;apos; where enteredby_uid NOT IN (0) and transaction_code = &amp;apos;802&amp;apos;  and transaction_date &amp;gt;= &amp;apos;&amp;quot; &amp;amp; runtimestamp &amp;amp; &amp;quot;&amp;apos;&amp;quot;
    NLSapp.SQLSelectStatement(transhistupdatesql)
    
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;test1&quot; Script=&quot;insert802sql = &amp;quot;SELECT 0;                                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;INSERT loanacct_trans_history (                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;acctrefno                                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;--,  transaction_reference_no /*is this autogenerated??*/    &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;, transaction_code                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;, associated_transrefno                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,reversal_transrefno                                         &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,participant_reference_no                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,loan_group_no/***/                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,participant_detail_flag                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,transaction_date                                            &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,effective_date,batch_no                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,transaction_amount                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,enteredby_uid                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,comment_indicator                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,transaction_type /*OL1CN  CU9 DNA CNA CNA CX*/              &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,gl_date                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,transaction_description /*Debt Settlement Pmnt*/            &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,payment_method_no                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,userdef01                                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,memoentry                                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,payment_number)                                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;                                                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;values                                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;(41027,&amp;apos;1234567&amp;apos;,&amp;apos;802&amp;apos;,0,0,0,2,0,&amp;apos;2018-07-16 00:00:00.000&amp;apos;,&amp;apos;2018-07-16 00:00:00.000&amp;apos;,0, &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;400.00,0,0,&amp;apos;OL1CN  CU9 DNA CNA CNA CX&amp;apos;,&amp;apos;2018-07-16 00:00:00.000&amp;apos;,&amp;apos;Debt Settlement Pmnt&amp;apos;,0,&amp;apos;3783753&amp;apos;,0,0) &amp;quot;





Msgbox(NLSapp.SQLSelectStatement(insert802sq))
&quot;/&gt;
&lt;BUTTON Name=&quot;test5&quot; Script=&quot;
set fetched_loan = NLSapp.GetLoan(49351)

msgbox(fetched_loan.PortfolioCodeID)
fetched_loan.Shortname = &amp;quot;Blah Blah&amp;quot;
&amp;apos;fetched_loan.Save
fetched_loan.Close()
set fetchedloan = nothing&quot;/&gt;
&lt;BUTTON Name=&quot;test6&quot; Script=&quot;SourceFilePath = &amp;quot;\\tsclient\C\Users\SMUHAMMAD\Downloads\report1522248538705.csv&amp;quot;
RowNumber = &amp;quot;unassigned&amp;quot;
&amp;apos;Const xlExcel7 = 39
Set objExcel = CreateObject(&amp;quot;Excel.Application&amp;quot;)

Set objWorkbook = objExcel.Workbooks.Open(SourceFilePath)

RowCount = objExcel.ActiveWorkbook.Sheets(1).UsedRange.Rows.count
MsgBox(RowCount)
objExcel.ActiveWorkbook.Close

Set objFSO = CreateObject(&amp;quot;Scripting.FileSystemObject&amp;quot;)
Set SourceFile = objFSO.GetFile(SourceFilePath)

DestinationFolder = &amp;quot;\\tsclient\C\Users\SMUHAMMAD\Downloads\NLS files\&amp;quot;
SourceFile.Move DestinationFolder
&quot;/&gt;
&lt;BUTTON Name=&quot;test7&quot; Script=&quot;
Set wsh = CreateObject(&amp;quot;WScript.Application&amp;quot;)
&amp;apos;Set wsh = CreateObject(&amp;quot;WScript.Shell&amp;quot;)
wsh.Run &amp;quot;\\tsclient\C\Users\SMUHAMMAD\Downloads\&amp;quot;
&amp;apos;wsh.Run &amp;quot;https://www.box.com//&amp;quot;&quot;/&gt;
&lt;BUTTON Name=&quot;test8&quot; Script=&quot;LoanDetail2udf46Maint()

sub LoanDetail2udf46Maint()
&amp;apos;maintains the next ACH payment date field in LoanDeatail2 udf46 field

	d2_userdef46sql = &amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef46 = u.next_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;FROM loanacct_detail_2 ld2,&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;(&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;SELECT top 10  convert(int, l.acctrefno) as acctrefno, ld2.userdef46, convert(char(10),max(ach.billing_next_date),101) as next_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;from loanacct_ach ach, loanacct l, loanacct_detail_2 ld2&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;where l.acctrefno = ach.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ach.status = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;group by  l.acctrefno,ld2.userdef46&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;having (case when ld2.userdef46 is null then&amp;apos;&amp;apos; else ld2.userdef46 end ) &amp;lt;&amp;gt; convert(char(10),max(ach.billing_next_date),101)&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;) u&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;Where ld2.acctrefno = u.acctrefno&amp;quot;

NLSApp.SQLSelectStatement(d2_userdef46sql)
End sub&quot;/&gt;
&lt;BUTTON Name=&quot;test9&quot; Script=&quot;msgbox(DateFormat(NOW(),1012))

hrshh = hour(now())
minsmm = minute(now())
secsss = second(now())

If len(hrshh) = 1 Then
   hrshh =  &amp;quot;0&amp;quot; &amp;amp; hrshh
end if
If len(minsmm) = 1 Then
   minsmm = &amp;quot;0&amp;quot; &amp;amp; minsmm
End if
If len(secsss) = 1 Then
   secsss = &amp;quot;0&amp;quot; &amp;amp; secsss
End if
hhmmss =  hrshh&amp;amp;minsmm&amp;amp;secsss
timestring = Replace (DateFormat(date,1)&amp;amp; secsnow,&amp;quot;:&amp;quot;,&amp;quot;&amp;quot;)
msgbox(FormatDateTime(date,1))
msgbox(Replace (DateFormat(date,1)&amp;amp; hhmmss,&amp;quot;/&amp;quot;,&amp;quot;&amp;quot;))
&quot;/&gt;
&lt;BUTTON Name=&quot;test11 constants&quot; Script=&quot;msgbox(Approve_Loan_Modification)&quot;/&gt;
&lt;BUTTON Name=&quot;test12 folder lookup&quot; Script=&quot;Dim objFolder, objShell
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
Set objFolder = objShell.BrowseForFolder(0, &amp;quot;Please select the folder.&amp;quot;,&amp;quot;&amp;amp;H4000&amp;quot;, &amp;quot;&amp;quot;)
If Not (objFolder Is Nothing) Then
  msgbox( &amp;quot;Folder: &amp;quot; &amp;amp; objFolder.title)
msgbox( &amp;quot;Full Path: &amp;quot; &amp;amp; objFolder.Self.path )
End If&quot;/&gt;
&lt;BUTTON Name=&quot;test6c&quot; Script=&quot;Dim objFolder, objShell
Set objShell = CreateObject(&amp;quot;Shell.Application&amp;quot;)
Set objFolder = objShell.BrowseForFolder(0, &amp;quot;Please select the folder.&amp;quot;, &amp;amp;H4000+&amp;amp;H0200 , &amp;quot;&amp;quot;)
If Not (objFolder Is Nothing) Then
  msgbox( &amp;quot;Folder: &amp;quot; &amp;amp; objFolder.title)
 strExcelPath = objFolder.Self.path
  msgbox(strExcelPath )
End If&quot;/&gt;
&lt;BUTTON Name=&quot;test13&quot; Script=&quot;loanrefno = 121635

   NLSApp.Messagebox( getborrowercifdetails (loanrefno) &amp;amp;  getborrowerphndetails (loanrefno))

    NLSApp.Messagebox( getcoborrowercifdetails (loanrefno) &amp;amp; getcoborrowerphndetails (loanrefno))
    If coborrowerinfo = &amp;quot;&amp;quot; Then
        coborrowerinfo = &amp;quot;N/A&amp;quot;
    End if
Function getborrowercifdetails (refno)
&amp;apos;Looks up loan primary contact details (required)
    lookupdetailssql =  &amp;quot;select &amp;apos;Contact Number:  &amp;apos; + c.cifnumber  + char(13) + &amp;apos;Entry Date:  &amp;apos; + convert(char(11),c.setupdate) + char(13)  + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;Name:  &amp;apos; + c.firstname1 + &amp;apos; &amp;apos; +c.lastname1  + char(13)  + street_address1 + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when street_address2 is null Then &amp;apos;&amp;apos; Else  street_address2 +  char(13) end + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;city + &amp;apos;, &amp;apos; +  state + &amp;apos; &amp;apos; + zip +  char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL1 :&amp;apos; + case when c.email is null then &amp;apos;&amp;apos; else c.email end + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL2 :&amp;apos; + case when c.email2 is null then &amp;apos;&amp;apos; else c.email end + char(13) &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.cifno = c.cifno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno

    getborrowercifdetails = NLSapp.SQLSelectStatement(lookupdetailssql)
End function

Function getcoborrowercifdetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select &amp;apos;Contact Number:  &amp;apos; + c.cifnumber  + char(13) + &amp;apos;Entry Date:  &amp;apos; + convert(char(11),c.setupdate) + char(13)  + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;Name:  &amp;apos; + c.firstname1 + &amp;apos; &amp;apos; +c.lastname1  + char(13)  + street_address1 + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when street_address2 is null Then &amp;apos;&amp;apos; Else  street_address2 +  char(13) end + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;city + &amp;apos;, &amp;apos; +  state + &amp;apos; &amp;apos; + zip +  char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL1 :&amp;apos; + case when c.email is null then &amp;apos;&amp;apos; else c.email end + char(13) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;apos;EMAIL2 :&amp;apos; + case when c.email2 is null then &amp;apos;&amp;apos; else c.email end + char(13) &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c, cif_loan_relationship clr &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = clr.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and clr.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno

    getcoborrowercifdetails = NLSapp.SQLSelectStatement(lookupdetailssql)
End function




Function getborrowerphndetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select distinct phone_raw + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when primary_flag = 1 Then &amp;apos; Primary&amp;apos; Else &amp;apos; &amp;apos; + (case when comments is null then &amp;apos;&amp;apos; else comments end) end,primary_flag&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct l, cif c&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join cif_phone_nums cp&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on  c.cifno = cp.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and len(cp.phone_raw) in (10,12,11)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno &amp;amp; chr(13) &amp;amp; _
        &amp;quot;order by primary_flag desc&amp;quot;

    phoneheader  = chr(13) &amp;amp; &amp;quot;Phone Number(s)/Type&amp;quot;        
    currphn = NLSapp.SQLSelectStatement(lookupdetailssql) 

    If not IsNull(currphn) = True Then
        Do until currphn = &amp;quot;***END OF RESULT***&amp;quot;
        
        phonelist = phonelist &amp;amp; chr(13) &amp;amp; currphn
        currphn = NLSApp.SQLSelectStatementReadNext()
        
	    Loop
	Else
	    phonelist = &amp;quot;N/A&amp;quot;
	End if
    getborrowerphndetails =    phoneheader &amp;amp;  phonelist
   
    
    
End function

Function getcoborrowerphndetails (refno)
&amp;apos;Looks up loan secondary contact details if they exist. Returns NULL if not
    lookupdetailssql =  &amp;quot;select distinct phone_raw + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;case when primary_flag = 1 Then &amp;apos; Primary&amp;apos; Else &amp;apos; &amp;apos; + case when comments is null then &amp;apos;&amp;apos; else comments end end,primary_flag&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from  loanacct l, cif c, cif_loan_relationship clr &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join cif_phone_nums cp &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on  clr.cifno = cp.cifno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = clr.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and clr.cifno = c.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and len(phone_raw) in (10,12)&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.acctrefno =  &amp;quot; &amp;amp; refno &amp;amp; chr(13) &amp;amp; _
        &amp;quot;order by primary_flag desc&amp;quot;

    phoneheader  = chr(13) &amp;amp; &amp;quot;Phone Number(s)/Type&amp;quot;        
    currphn = NLSapp.SQLSelectStatement(lookupdetailssql) 

    If not IsNull(currphn) = True Then
        Do until currphn = &amp;quot;***END OF RESULT***&amp;quot;
        
        phonelist = phonelist &amp;amp; chr(13) &amp;amp; currphn
        currphn = NLSApp.SQLSelectStatementReadNext()
        
	    Loop
	Else
	    phonelist = &amp;quot;N/A&amp;quot;
	End if
 
    getcoborrowerphndetails = phoneheader &amp;amp;  phonelist
End function&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;428&quot; StaticTopPos=&quot;25&quot; StaticWidth=&quot;109&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;427&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;117&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;57&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="428.0000000000" StaticTopPos="25.0000000000" StaticWidth="109.0000000000" StaticHeight="20.0000000000" FieldLeftPos="427.0000000000" FieldTopPos="46.0000000000" FieldWidth="117.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="57"/>
<USERDEFFIELDS field_id="78" field_type="6" field_attribute="0" label_text="Testing 2" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;xxxxxxxx&quot; Script=&quot;loanlistsql = &amp;quot;select convert(varchar(3),ach_company_id)+&amp;apos;,&amp;apos;+aba_number+&amp;apos;,&amp;apos;+substring(account_number,10,24)+&amp;apos;,&amp;apos;+right(account_number,24)+&amp;apos;,&amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;Case when account_type = 0 then &amp;apos;CHECKING&amp;apos; else &amp;apos;SAVINGS&amp;apos; End +&amp;apos;,&amp;apos;+ convert(varchar,amount_fixed)+&amp;apos;,&amp;apos;+ convert(varchar,acctrefno)+&amp;apos;,&amp;apos;+ &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(varchar,account_type)+&amp;apos;,&amp;apos;+convert(varchar,row_id)&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;from loanacct_ach WHERE status = 0 AND billing_type = 0  AND acctrefno in                                                                                         &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;(159165,127583,196015,228358,230128,181571,150999,69957 ,146361,154215,146362,56307 ,97919 ,161111,54733 ,204220,44036 ,103815,136998,      &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;240369,187664,174865,104294,154222,140669,110835,237520,146371,254028,187882,255132,151380,192332,154221,95297 ,235184,54106 ,146369,       &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;77474 ,123325,168033,56313 ,110834,191450,154220,146365,242023,103753,151018,161939,78890 ,97926 ,174856,149055,110862,46806 ,147892,213788,&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;187682,181800,69674 ,128327,142751,147891,218088,139774,168065,196063,248859,68595 ,165954,156253,165936,35269 ,155347,85697 ,130238,175037,&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;248858,247070,175045,168070,94547 ,81151 ,143776)&amp;quot;

ekey = &amp;quot;180175EFDC223018110F4ED14F1DA1D066D73380F0E99A0C0E0AE337052C8BB8&amp;quot;

dim  loanlist(7)    
loanlist(0) = NLSapp.SQLSelectStatement(loanlistsql)
msgbox(loanlist(0))
For x = 1 to  UBound(loanlist)
     loanlist(X) = NLSApp.SQLSelectStatementReadNext()
Next

For Each row in  loanlist

details = split(row,&amp;quot;,&amp;quot;)
achco = details(0)
abanum = details(1)
acctnumEncrptIV = details(2)
acctnumEncrpt = details(3)
bnkacctnum = NLSApp.NLSAESDecrypt(acctnumEncrpt, ekey, acctnumEncrptIV)       
accttypeno = details(7)
accttypetxt = details(4)
amount = details(5)
refno = details(6)
achrowid = details(8)

ACHimportxml = &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; refno &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;    &amp;lt;ACH ACHCompanyID=&amp;quot;&amp;quot;&amp;quot;&amp;amp; achco &amp;amp;&amp;quot;&amp;quot;&amp;quot; ABANumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; abanum &amp;amp; &amp;quot;&amp;quot;&amp;quot; AccountNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; bnkacctnum &amp;amp;_
&amp;quot;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;quot; &amp;amp; amount &amp;amp; &amp;quot;&amp;quot;&amp;quot; BillingStartDate=&amp;quot;&amp;quot;11/04/18&amp;quot;&amp;quot; Description=&amp;quot;&amp;quot;Rescheduled Recurring Payment&amp;quot;&amp;quot; AmountType=&amp;quot;&amp;quot;0&amp;quot;&amp;quot; AccountType=&amp;quot;&amp;quot;&amp;quot; &amp;amp; accttypeno &amp;amp; &amp;quot;&amp;quot;&amp;quot; DebitOrCredit=&amp;quot;&amp;quot;D&amp;quot;&amp;quot; BillingType=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

&amp;apos;NLSApp.MessageBox(ACHimportxml)

ImportXML(ACHimportxml)

refnolist = refnolist &amp;amp; refno  &amp;amp; chr(13)

Next

msgbox(refnolist)&quot;/&gt;
&lt;BUTTON Name=&quot;#3&quot; Script=&quot;&amp;apos;SQL looks up late notices generated in the last 3 days for loans with assiciated co-borroweres on recordand 
&amp;apos;stores the details in the output to use in the merge doc that will be the co-borrower late notice.

coborrowernoticedetailssql = &amp;quot;Select  distinct top 5&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(varchar,ll.statement_code)+&amp;apos; &amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(char(1),l.portfolio_code_id)+&amp;apos; &amp;apos;+l.loan_number+&amp;apos; &amp;apos;+convert(varchar,ll.print_run_number)+&amp;apos; &amp;apos;+convert(varchar,clr.cifno)+&amp;apos; &amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(char(10),ll.printed_date,101)+&amp;apos; &amp;apos;+convert(varchar,ll.statement_row_id)+&amp;apos; &amp;apos;+convert(varchar,ll.sequence_in_run)+&amp;apos; &amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(char(10),ll.statement_date,101)+&amp;apos; &amp;apos;+convert(char(10), l.curr_maturity_date,101)+&amp;apos; &amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(varchar,cast(ll.current_rate as decimal(8,2)))+&amp;apos;% $&amp;apos;+convert(varchar,cast(ll.current_principal_balance AS money),1)+&amp;apos; $&amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(varchar,cast(ll.current_interest_balance AS money),1)+&amp;apos; $&amp;apos;+convert(varchar,cast(ll.total_past_due_balance AS money),1)+&amp;apos; $&amp;apos;+&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;convert(varchar,cast(ll.total_current_due_balance AS money),1) as details   &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;INTO  #coborrowerlatenotlist             &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;from loanacct l , loanacct_latenotice ll,&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;cif_loan_relationship clr&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;where ll.acctrefno = l.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;and clr.acctrefno = l.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;and clr.forward_latenotice = 1&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;and ll.printed_date &amp;gt;= dateadd(dd,-3,convert(char(10),getdate(),101))&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;and  ll.statement_row_id NOT IN (SELECT new_value from cif_modification_history where item_changed = &amp;apos;Co-borrower Notice&amp;apos; )&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;   &amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;SELECT (select count(*) from #coborrowerlatenotlist) as size, details from #coborrowerlatenotlist&amp;quot; &amp;amp; chr(13) &amp;amp;_
&amp;quot;DROP TABLE #coborrowerlatenotlist&amp;quot;


listUB = NLSApp.SQLSelectStatement(coborrowernoticedetailssql)-1


&amp;apos;Populate array
Redim coborrowernoticedetail(listUB)
For row = 0 to listUB
    coborrowernoticedetail(row) = NLSapp.SQLSelectStatementNextColumn()
    NLSapp.SQLSelectStatementReadNext()
Next

For Each contact in coborrowernoticedetail

    currentcoborrower = split(contact,&amp;quot; &amp;quot;)
    docno = currentcoborrower(0)
    portfolio = currentcoborrower(1)
    loan_numb = currentcoborrower(2)
    cifno = currentcoborrower(4)
    stmnt_date = currentcoborrower(8)
    mat_date = currentcoborrower(9)
    rate = currentcoborrower(10)
    prin = currentcoborrower(11)
    intr = currentcoborrower(12)
    tot_pd = currentcoborrower(13)
    tot_cd = currentcoborrower(14)
    Miscdetails = &amp;quot;Print run: &amp;quot; &amp;amp; chr(9) &amp;amp; currentcoborrower(3) &amp;amp; chr(10) &amp;amp; &amp;quot;Print date: &amp;quot; &amp;amp; chr(9)  &amp;amp; currentcoborrower(5) &amp;amp; chr(10) &amp;amp; _
    &amp;quot;Sequence No: &amp;quot; &amp;amp; chr(9)  &amp;amp;  currentcoborrower(7) &amp;amp; chr(10) &amp;amp; &amp;quot;Stmnt Row ID: &amp;quot; &amp;amp; chr(9) &amp;amp; currentcoborrower(6)
    commentheader = &amp;quot;Primary Borrower Late Notice print details&amp;quot;

    &amp;apos;Update Contact detail UDF fields that hold statement info
    cifupdatesql = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UPDATE cif_detail SET userdef35 = &amp;apos;&amp;quot; &amp;amp;  stmnt_date &amp;amp; &amp;quot;&amp;apos;,userdef36 =&amp;apos;&amp;quot; &amp;amp; loan_numb &amp;amp; &amp;quot;&amp;apos;,&amp;quot; &amp;amp; Chr(13) &amp;amp; _
    &amp;quot;userdef37 = &amp;apos;&amp;quot; &amp;amp;  mat_date &amp;amp; &amp;quot;&amp;apos;, userdef38 = &amp;apos;&amp;quot; &amp;amp;  rate &amp;amp; &amp;quot;&amp;apos;,userdef39 =&amp;apos;&amp;quot; &amp;amp; prin &amp;amp; &amp;quot;&amp;apos;,&amp;quot; &amp;amp; Chr(13) &amp;amp; _
	&amp;quot;userdef40 = &amp;apos;&amp;quot; &amp;amp;  intr &amp;amp; &amp;quot;&amp;apos;,userdef41 = &amp;apos;&amp;quot; &amp;amp;  tot_pd &amp;amp; &amp;quot;&amp;apos;,userdef42 =&amp;apos;&amp;quot; &amp;amp; tot_cd &amp;amp; &amp;quot;&amp;apos;&amp;quot; &amp;amp; Chr(13) &amp;amp; _
    &amp;quot; WHERE cifno = &amp;quot; &amp;amp; cifno


NLSApp.SQLSelectStatement(cifupdatesql)

 &amp;apos;Generate late notice Document and send to print queue
    template = getdoctempidno(docno)
    Set DT = NLSApp.GetDocumentTemplates(template)
    DT.GenerateDocument cifno, &amp;quot;TRUE&amp;quot;, &amp;quot;LATE NOTICE&amp;quot;, &amp;quot;TRUE&amp;quot;, &amp;quot;T:\Temp\&amp;quot;
    Set DT = nothing
    &amp;apos;Update Que record details          
    docqueueID = NLSapp.SQLSelectStatement(&amp;quot;SELECT cast(MAX(documentqueueid) as varchar) from DocumentQueue where len(DocumentName) = 0 and parentrefno = &amp;quot; &amp;amp; cifno)
    commentrowID = NLSapp.SQLSelectStatement(&amp;quot;SELECT cast(MAX(row_id) as varchar) from cif_comments where category_id = 14 and cifno = &amp;quot; &amp;amp; cifno)    
    NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE DocumentQueue SET DocumentName = &amp;apos;CO-BORROWER LATE NOTICES&amp;apos;, DocumentPageCount = 1 where DocumentQueueID = &amp;quot; &amp;amp; docqueueID)
    NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE cif_comments SET comments = &amp;apos;&amp;quot; &amp;amp; commentheader &amp;amp; chr(10) &amp;amp; Miscdetails &amp;amp; &amp;quot;&amp;apos; where row_id = &amp;quot; &amp;amp; commentrowID)
    &amp;apos;Update contact History
    NLSapp.AddModificationHistory 0, cifno, &amp;quot;&amp;quot;, currentcoborrower(6), &amp;quot;Co-borrower Notice&amp;quot;
    ciflist = ciflist &amp;amp; cifno &amp;amp; chr(10)
Next

msgbox(ciflist)


Function getdoctempidno(statementcode)

    SELECT Case statementcode
        CASE &amp;quot;14&amp;quot;    &amp;apos;CPLUS 3 DAY NOTICE
            getdoctempidno = &amp;quot;12&amp;quot;
        CASE &amp;quot;13&amp;quot;    &amp;apos;CPLUS 11 DAY NOTICE
            getdoctempidno = &amp;quot;13&amp;quot;
        CASE &amp;quot;15&amp;quot;    &amp;apos;CPLUS 22 DAY NOTICE
            getdoctempidno = &amp;quot;14&amp;quot;
        CASE &amp;quot;16&amp;quot;    &amp;apos;CPLUS 52 DAY NOTICE
            getdoctempidno = &amp;quot;15&amp;quot;
        CASE &amp;quot;17&amp;quot;    &amp;apos;CPLUS 82 DAY NOTICE
            getdoctempidno = &amp;quot;16&amp;quot;
        CASE &amp;quot;18&amp;quot;    &amp;apos;FPLUS 3 DAY NOTICE
            getdoctempidno = &amp;quot;17&amp;quot;
        CASE &amp;quot;19&amp;quot;    &amp;apos;FPLUS 11 DAY NOTICE
            getdoctempidno = &amp;quot;18&amp;quot;
        CASE &amp;quot;19&amp;quot;    &amp;apos;FPLUS 22 DAY NOTICE
            getdoctempidno = &amp;quot;18&amp;quot;
        CASE &amp;quot;20&amp;quot;    &amp;apos;FPLUS 52 DAY NOTICE
            getdoctempidno = &amp;quot;19&amp;quot;
        CASE &amp;quot;22&amp;quot;    &amp;apos;FPLUS 82 DAY NOTICE
            getdoctempidno = &amp;quot;20&amp;quot;

    End Select    
    getdoctempidno = &amp;quot;12&amp;quot;
End Function

&quot;/&gt;
&lt;BUTTON Name=&quot;#9DS Maint&quot; Script=&quot;
UpdatepaymentHist()

AddDSpaymentTrans()

AddDSpayments()

UpdateDSbillingDueDates()


msgbox(&amp;quot;Completed!&amp;quot;)

Sub UpdatepaymentHist()
	&amp;apos;updates userdef01 for any records in the payment_history table that paid after the loan when into active settlement
	&amp;apos;and havent already been set to &amp;apos;Debt Settlement Payment&amp;apos;
	pmntudf1updatesql = &amp;quot;SELECT 0;                         &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;UPDATE loanacct_payment_history                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
 	&amp;quot;SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;            &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_payment_history lph, loanacct l,                                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;(                                                                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	SELECT lmh.acctrefno, max(lmh.mod_datestamp) as effective_date                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	from loanacct_mod_history lmh,                                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	loanacct_statuses ls,                                                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	loan_status_codes lsc                                                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	where lmh.acctrefno = ls.acctrefno                                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	and lmh.item_changed = &amp;apos;Status&amp;apos; and lmh.new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;             &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	and lsc.status_code_no = ls.status_code_no and  lsc.status_code in (&amp;apos;ACTIVE SETTLEMENT&amp;apos;) &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;	group by lmh.acctrefno                                                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;) activedsl                                                                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;                                                                                            &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;where l.acctrefno  = lph.acctrefno                                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and l.current_ol1_balance &amp;gt; 0                                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lph.payment_type = &amp;apos;ZZ&amp;apos;                                                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lph.userdef01  not like &amp;apos;%Debt Settlement Payment%&amp;apos;                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and activedsl.acctrefno = lph.acctrefno                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lph.date_paid &amp;gt;= activedsl.effective_date&amp;quot;



&amp;apos;	&amp;quot;FROM loanacct l,                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;loanacct_payment_history lph,                         &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;(                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot; SELECT  acctrefno, effective_date                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot; from loanacct_statuses ls, loan_status_codes lsc     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot; where ls.status_code_no = lsc.status_code_no         &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot; and  lsc.status_code = &amp;apos;ACTIVE SETTLEMENT&amp;apos;           &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;) asl                                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;                                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;Where l.acctrefno = lph.acctrefno                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;and lph.acctrefno = asl.acctrefno                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;and lph.userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;and lph.payment_type = &amp;apos;ZZ&amp;apos;                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;and lph.date_paid &amp;gt; asl.effective_date                &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;and l.current_ol1_balance &amp;gt; 0                         &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;apos;	&amp;quot;order by lph.acctrefno,lph.transaction_reference_no   &amp;quot;

	&amp;apos;msgbox(&amp;quot;Update payment&amp;quot;)
	NLSapp.SQLSelectStatement(pmntudf1updatesql)
End Sub

	&amp;apos;====================================================================
sub AddDSpaymentTrans()
	 CreateTC802sql2 = &amp;quot;Select distinct left(th.transaction_code,1),&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +                                                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number +                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.row_id)  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,        &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history SET userdef02 = &amp;apos;&amp;apos;&amp;apos;+ &amp;apos;YES&amp;apos;+&amp;apos;&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lth.row_id)  +                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;UPDATE loanacct_trans_history SET enteredby_uid = 0 Where transaction_code IN (&amp;apos;&amp;apos;802&amp;apos;&amp;apos;) and  enteredby_uid = 39&amp;apos;                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_payment_history lth, loanacct l,                                                                                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct_statuses ls, loanacct_trans_history th, loan_status_codes lsc                                                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;                                                                                                                                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;where lth.acctrefno = l.acctrefno                                                                                                                &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and th.transaction_reference_no = lth.transaction_reference_no                                                                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lsc.status_code_no = ls.status_code_no                                                                                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth.acctrefno = ls.acctrefno                                                                                                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth.userdef01 like &amp;apos;%Debt Settlement Payment%&amp;apos;                                                                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth.userdef02 = &amp;apos;&amp;apos;                                                                                                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and convert(varchar,lth.row_id)+ convert(varchar,lth.acctrefno) NOT IN                                                                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;(SELECT userdef01 + convert(varchar,acctrefno) From loanacct_trans_history where transaction_code IN (&amp;apos;802&amp;apos;, &amp;apos;7220&amp;apos;) and userdef01 is not null ) &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lsc.status_code in (&amp;apos;ACTIVE SETTLEMENT&amp;apos;)&amp;quot;  


	createTC802xml = NLSapp.SQLSelectStatement(CreateTC802sql2)
 
	Do Until createTC802xml = &amp;quot;&amp;quot;
		If Not createTC802xml = &amp;quot;&amp;quot; Then
			addtrans = NLSapp.SQLSelectStatementNextColumn()
			updatepmnt = NLSapp.SQLSelectStatementNextColumn()
			If ImportXML(addtrans) = &amp;quot;&amp;quot; Then
			   NLSapp.SQLSelectStatement(updatepmnt)
			End if
		Else
		End if
		createTC802xml = NLSapp.SQLSelectStatement(CreateTC802sql2)
	Loop
End Sub

Sub addDSpayments()
	ACTIVE_ACCTREFNO = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
	&amp;apos;msgbox(&amp;quot;GUI RULE&amp;quot;)
	pmntudf1updatesql = &amp;quot;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_payment_history where acctrefno =  &amp;quot; &amp;amp; ACTIVE_ACCTREFNO  &amp;amp; chr(13) &amp;amp; _ 
	&amp;quot;and userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and payment_type = &amp;apos;ZZ&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and date_paid &amp;gt;=&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    (SELECT convert(datetime,Convert(char(8),max(mod_datestamp),1))&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    from loanacct_mod_history&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    where item_changed = &amp;apos;Status&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    and acctrefno =&amp;quot; &amp;amp; ACTIVE_ACCTREFNO &amp;amp; &amp;quot;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and transaction_reference_no = &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    (select max(transaction_reference_no)&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    from loanacct_payment_history&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    where acctrefno =  &amp;quot; &amp;amp; ACTIVE_ACCTREFNO  &amp;amp; chr(13) &amp;amp; _
	&amp;quot;    and payment_type = &amp;apos;ZZ&amp;apos;) &amp;quot;
	
	&amp;apos;msgbox(&amp;quot;Update payment&amp;quot;)
	NLSapp.SQLSelectStatement(pmntudf1updatesql)
	
	&amp;apos;====================================================================
	
	 CreateTC802sql2 = &amp;quot;Select distinct left(th.transaction_code,1),&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.row_id)  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history SET userdef02 = &amp;apos;&amp;apos;&amp;apos;+ &amp;apos;YES&amp;apos;+&amp;apos;&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lth.row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;from loanacct_payment_history lth, loanacct l, &amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;loanacct_statuses ls, loanacct_trans_history th, loan_status_codes lsc&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;where lth.acctrefno = l.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and th.transaction_reference_no = lth.transaction_reference_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and lsc.status_code_no = ls.status_code_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and lth.acctrefno = ls.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and lth.userdef01 like &amp;apos;%Debt Settlement Payment%&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and lth.userdef02 = &amp;apos;&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and convert(varchar,lth.row_id) NOT IN (SELECT userdef01 From loanacct_trans_history where transaction_code IN (&amp;apos;802&amp;apos;, &amp;apos;7220&amp;apos;) and userdef01 is not null and l.acctrefno = &amp;quot; &amp;amp; ACTIVE_ACCTREFNO &amp;amp; &amp;quot;)&amp;quot;  &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and lsc.status_code in (&amp;apos;ACTIVE SETTLEMENT&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and  lth.date_paid &amp;gt;= &amp;quot; &amp;amp; _ 
	 &amp;quot; (SELECT convert(datetime,Convert(char(8),max(mod_datestamp),1)) from loanacct_mod_history where item_changed = &amp;apos;Status&amp;apos; and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos; and acctrefno =  &amp;quot;  &amp;amp; ACTIVE_ACCTREFNO &amp;amp; &amp;quot;)&amp;quot;  &amp;amp; chr(13) &amp;amp; _
	 &amp;quot;and l.acctrefno = &amp;quot; &amp;amp; ACTIVE_ACCTREFNO
	
	
	createTC802xml = NLSapp.SQLSelectStatement(CreateTC802sql2)
	
	
	If Not createTC802xml = &amp;quot;&amp;quot; Then
	    addtrans = NLSapp.SQLSelectStatementNextColumn()
	    updatepmnt = NLSapp.SQLSelectStatementNextColumn()
	    &amp;apos;msgbox(&amp;quot;add 802 trans&amp;quot;)
	    If ImportXML(addtrans) = &amp;quot;&amp;quot; Then
	       &amp;apos;msgbox(&amp;quot;edit 802 trans&amp;quot;)
	       NLSapp.SQLSelectStatement(updatepmnt)
	    End if
	Else
	End If
End sub

Sub UpdateDSbillingDueDates()
	Updatesqlpymntsduesql = &amp;quot;SELECT 0; UPDATE loanacct_payments_due SET date_due = dateadd(dd,16,date_due)&amp;quot; &amp;amp; chr(13)  &amp;amp; _
	                        &amp;quot;from loanacct_payments_due where payment_reference_no IN &amp;quot; &amp;amp; chr(13)  &amp;amp; _
	                        &amp;quot;(Select distinct convert(varchar, th.transaction_reference_no) &amp;quot; &amp;amp; chr(13)  &amp;amp; _
	                        &amp;quot; from loanacct_trans_history th, loanacct l, loan_transaction_codes ltc&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot; where l.acctrefno = th.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
	                        &amp;quot; and ltc.transaction_code = th.transaction_code&amp;quot; &amp;amp; chr(13) &amp;amp; _
	                        &amp;quot;and ltc.transaction_description = &amp;apos;Debt Settlement Billing&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot; and th.reversal_transrefno = 0&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot; and th.effective_date = th.date_due)&amp;quot;
	                        
	Updatesqltranssql     = &amp;quot;SELECT 0; UPDATE loanacct_trans_history SET date_due = dateadd(dd,17,th.date_due)&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot; from loanacct_trans_history th, loanacct l, loan_transaction_codes ltc&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot;where l.acctrefno = th.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot;and ltc.transaction_code = th.transaction_code&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot;and ltc.transaction_description = &amp;apos;Debt Settlement Billing&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot;and th.reversal_transrefno = 0 &amp;quot; &amp;amp; chr(13) &amp;amp;  _
	                        &amp;quot;and th.effective_date = th.date_due&amp;quot;
	
	                       
	NLSapp.SQLSelectStatement(Updatesqlpymntsduesql)
	NLSapp.SQLSelectStatement(Updatesqltranssql)
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;#1&quot; Script=&quot;Do
        If firstpass = True Then
            firstmonth = InputBox(&amp;quot;If the first payment will be in &amp;quot; &amp;amp; nextmonth &amp;amp; &amp;quot; Select [OK].&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;If payments will start another month, Type below.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Select CANCEL To quit.&amp;quot;, &amp;quot;Settlement Offer Set Up&amp;quot;, nextmonth)
        Else
            firstmonth = InputBox(&amp;quot;Select [OK] to enter payments starting &amp;quot; &amp;amp; nextmonth &amp;amp; &amp;quot;.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Select [CANCEL] To quit.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; &amp;quot;Type &amp;apos;END&amp;apos; to Finish.&amp;quot;, &amp;quot;Settlement Offer Set Up&amp;quot;, nextmonth)
        End If
        If len(firstmonth) = 0 Then
            NLSApp.MessageBox(&amp;quot;Canceling.&amp;quot;)
            &amp;apos;NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF21&amp;quot;, &amp;quot;&amp;quot;
            &amp;apos;NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF22&amp;quot;, &amp;quot;&amp;quot;
            &amp;apos;NLSApp.SetField &amp;quot;LOAN_DETAIL2_UDF23&amp;quot;, &amp;quot;&amp;quot;
            &amp;apos;Exit Sub
        End If
        firstmonth = DateFormat(firstmonth,10077)
        If firstmonth = -1 Then
           msgbox(&amp;quot;Invalid date format entered.&amp;quot;)
        End If
        msgbox(firstmonth)
  
Loop Until IsDate(firstmonth) = True






&amp;apos;Converts a valid date string input to output date format by code

&amp;apos;Resident VB date format functions are restricted in NLSapp.

&amp;apos;Additional formats can be added in the future as needed.



Function DateFormat(datestring,formatcode)

    If IsDate(datestring) = true Then

        If len(DAY(datestring)) = 1 Then
           daytext = &amp;quot;0&amp;quot; &amp;amp; DAY(datestring)
        Else
           daytext = DAY(datestring)
        End if
  
        If len(MONTH(datestring)) = 1 Then
           mnthtext = &amp;quot;0&amp;quot; &amp;amp; MONTH(datestring)
        Else
           mnthtext = MONTH(datestring)
        End if

        Select case formatcode

        &amp;apos;U.S. = mm/dd/yyyy
        case 1    
            DateFormat = mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; Right(YEAR(datestring),2)
        case 101    
            DateFormat = mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext &amp;amp;&amp;quot;/&amp;quot;&amp;amp;    YEAR(datestring)

        &amp;apos;JAPAN    = yyyy/mm/dd    
        case 11    
            DateFormat = Right(YEAR(datestring),2) &amp;amp;&amp;quot;/&amp;quot;&amp;amp; mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext
        case 111    
            DateFormat = YEAR(datestring)&amp;amp;&amp;quot;/&amp;quot;&amp;amp; mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext

        &amp;apos;Default time format with Day and timestamp removed    = Mon yyyy    
        case 10077    
            DateFormat =  MonthName(Month(datestring), False) &amp;amp; &amp;quot; &amp;quot; &amp;amp; YEAR(datestring)
           
        Case Else
            DateFormat = -1

        End Select

    Else    

        DateFormat = -1

    End if
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;#5&quot; Script=&quot;
ACHCompanyUDFclose()

msgbox(&amp;quot;done&amp;quot;)

Sub ACHCompanyUDFclose()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    emailyn = &amp;quot;N&amp;quot;
    userno = NLSApp.GetCurrentUserNo()
    runtimestamp = Now()
    &amp;apos;SQL query looks up out-of-sync loans
    refnosql = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef35 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)

    &amp;apos;Has process made any emails the current day and for what loans?
    lastemailday = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef07 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)

    &amp;apos;If  no emails the current day reset refno list
    If NOW() - CDate(lastemailday) &amp;gt; 1 Then
        NLSapp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE cif_detail SET  userdef06 = &amp;apos; &amp;apos; From cif_detail cd, cif c where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
    End If

    &amp;apos;If emails have been sent the current day, include the refno list in the sql statement
    lastrefnos = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef06 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
    If CDate(lastemailday) = DateValue(NOW()) Then
        acctfilter = &amp;quot;AND nonachUDFs.acctrefno NOT IN (&amp;quot; &amp;amp; lastrefnos &amp;amp; &amp;quot; 0)&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;order by acctrefno,[updateach] desc&amp;quot;
         RefNolist = lastrefnos
    Else
        acctfilter = &amp;quot;order by acctrefno,[updateach] desc&amp;quot;
    End If

    prevLoanRefNo = 0
    
    &amp;apos;Run SQL lookup
    LoanRefNo = NLSapp.SQLSelectStatement(refnosql &amp;amp; chr(13) &amp;amp; acctfilter)

    If Len(LoanRefNo) = 0 Then
        LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
        RefNolist = RefNolist &amp;amp; LoanRefNo &amp;amp; &amp;quot;, &amp;quot;
        Lcount = Lcount + 1
        achid = NLSApp.SQLSelectStatementNextColumn()
        updateweb = NLSApp.SQLSelectStatementNextColumn()
        updateach = NLSApp.SQLSelectStatementNextColumn()
        achrowid = NLSApp.SQLSelectStatementNextColumn()

        &amp;apos;Never update loan detail twice
        If prevLoanRefNo = LoanRefNo Then
            loandetail = &amp;quot;&amp;quot;
&amp;apos;            emailyn = &amp;quot;Y&amp;quot;
        Else
            &amp;apos;If only loan detail is updated do not send email
            If updateweb = 1 Then
                loandetail = &amp;quot;    &amp;lt;LOANDETAIL2 UserDefined45=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achid &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13)
&amp;apos;                emailyn = &amp;quot;N&amp;quot;
            End If

        End If
        &amp;apos;If ACH set up is updated send email
        If updateach = 1 Then
            loanach = &amp;quot;    &amp;lt;ACH Operation=&amp;quot;&amp;quot;UPDATE&amp;quot;&amp;quot; ACHCompanyID=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achid &amp;amp; &amp;quot;&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achrowid &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13)
&amp;apos;            emailyn = &amp;quot;Y&amp;quot;
        Else
            loanach = &amp;quot;&amp;quot;
        End If

        &amp;apos;Build xml import string
        If loandetail = &amp;quot;&amp;quot; And loanach = &amp;quot;&amp;quot; Then
            &amp;apos;NLSApp.MessageBox(&amp;quot;No import&amp;quot;)  
        Else

            achxml = &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; loandetail &amp;amp; loanach &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot; &amp;amp; LoanRefNo &amp;amp; emailyn

            ACHcorrectionNotice(achxml)
        End If

        prevLoanRefNo = LoanRefNo

        &amp;apos;Update last email day and append current loan to refno list
        lastemailday = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef07 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
        &amp;apos;lastrefnos = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef06 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)

        &amp;apos;Reset sgl statement for next loan
         acctfilter = &amp;quot;AND nonachUDFs.acctrefno NOT IN (&amp;quot; &amp;amp; RefNolist &amp;amp; &amp;quot; 0)&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;order by acctrefno,[updateach] desc&amp;quot;

        LoanRefNo = NLSapp.SQLSelectStatement(refnosql &amp;amp; chr(13) &amp;amp; acctfilter)

        If Len(LoanRefNo) = 0 Then
            LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
        End If
    Loop

    &amp;apos;Update field that list refnos processed the current day
    newrefnolistsql = &amp;quot;SELECT 0; Update cif_detail SET userdef06 = &amp;apos;&amp;quot; &amp;amp; RefNolist &amp;amp; &amp;quot;&amp;apos;, userdef07 = convert(char(8),getdate(),1) from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;
    NLSapp.SQLSelectStatement(newrefnolistsql)
 
    &amp;apos;Update loan mod history to show ADMIN as user and add notation for VBScript for any loans processed
    modhistupdatesql = &amp;quot;SELECT 0; UPDATE loanacct_mod_history SET mod_uid = 0, modification_description = &amp;apos;//VBScript//&amp;apos; +char(13) + modification_description where mod_uid = &amp;quot; &amp;amp; userno &amp;amp; &amp;quot; and (item_changed = &amp;apos;ACH Setup&amp;apos;  or item_changed like &amp;apos;%Tab 2 Loan Userdef45%&amp;apos;) and mod_datestamp &amp;gt;= &amp;apos;&amp;quot; &amp;amp; runtimestamp &amp;amp; &amp;quot;&amp;apos;&amp;quot;
    NLSapp.SQLSelectStatement(modhistupdatesql)
     
End Sub

Function ACHcorrectionNotice(xml)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Function processes the data updates to sync Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &amp;apos; as well as sending the email notification that an update has occured or if there is an error in processing
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    NLSApp.ClearErrorString()
    &amp;apos;Get list of any accounts that have been processed by this script and sent an email the current day
    refnostodaysql = &amp;quot;SELECT distinct case when cd.userdef07 &amp;lt; convert(char(8),getdate(),1) then &amp;apos;0,&amp;apos; Else cd.userdef06 End  from cif c, cif_detail cd where c.cifno = cd.cifno  and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos; &amp;quot;
    refnostoday = left(NLSapp.SQLSelectStatement(refnostodaysql), 1)

    &amp;apos;Get Email body text ---
    bodyheada = NLSapp.SQLSelectStatement(&amp;quot;select cd.userdef02 from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
    bodyhead1 = NLSapp.SQLSelectStatement(&amp;quot;select cd.userdef03 from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
    bodyhead2 = NLSapp.SQLSelectStatement(&amp;quot;select cd.userdef04 from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
    bodyhead3 = NLSapp.SQLSelectStatement(&amp;quot;select cd.userdef05 from cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
    endmark = &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

    &amp;apos;Parse xml string passed to Func for  &amp;quot;Y&amp;quot; or &amp;quot;N&amp;quot; code to send an email for active loan and loanrefno ID
    emailyn = right(xml, 1)
    refnoyn = Mid(xml, InStr(xml, endmark) + len(endmark), len(xml) - InStr(xml, endmark) + len(endmark))
    refno = left(refnoyn, len(refnoyn) - 1)


    &amp;apos;Do not send an email if one has already been sent the current day
    If emailyn = &amp;quot;Y&amp;quot; Then
        &amp;apos;emailyn = NLSapp.SQLSelectStatement(&amp;quot;SELECT case when &amp;apos;&amp;quot; &amp;amp; refno &amp;amp; &amp;quot;&amp;apos; NOT IN (&amp;quot; &amp;amp; Left(refnostoday, Len(refnostoday)-1) &amp;amp; &amp;quot;) then &amp;apos;Y&amp;apos; else &amp;apos;N&amp;apos; end&amp;quot;)
        &amp;apos;msgbox(&amp;quot;SELECT case when &amp;apos;&amp;quot; &amp;amp; refno &amp;amp; &amp;quot;&amp;apos; NOT IN (&amp;quot; &amp;amp; Left(refnostoday, Len(refnostoday)-1) &amp;amp; &amp;quot;) then &amp;apos;Y&amp;apos; else &amp;apos;N&amp;apos; end&amp;quot;)
    End If

    &amp;apos;Perform Import
    If Not NLSApp.ImportXMLRecord(xml) Then

        If True Then
            &amp;apos;FOR IMPORT ERRORS ONLY and email should get sent
            errormsg = NLSApp.GetErrorString()
            emailyn = &amp;quot;Y&amp;quot;
        End If
        ACHcorrectionNotice = errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
        NLSApp.SendEmailMessage &amp;quot;Servicing CPlus&amp;quot;, &amp;quot;stanley.muhammad@gmail.com&amp;quot;, &amp;quot;consolplus-servicing@consolplus.com&amp;quot;,  &amp;quot;XML Import ACH update ERROR&amp;quot;, ACHcorrectionNotice
        NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot;, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, &amp;quot;XML Import ACH update ERROR&amp;quot;, ACHcorrectionNotice
    Else

        ACHcorrectionNotice = &amp;quot;&amp;quot;
    End If

End Function&quot;/&gt;
&lt;BUTTON Name=&quot;#4&quot; Script=&quot;DSdpdemailnote()


Sub DSdpdemailnote()
    DSdpdlookupsql = &amp;quot;SELECT l.loan_number,convert(varchar(10),l.days_past_due), td.userdef02,td.userdef01 &amp;quot; &amp;amp; _
               &amp;quot;from loanacct l, loanacct_statuses ls, task t, &amp;quot; &amp;amp; _
               &amp;quot;task_detail td &amp;quot; &amp;amp; _
               &amp;quot;where ls.acctrefno = l.acctrefno &amp;quot; &amp;amp; _
               &amp;quot;and t.NLS_refno = l.acctrefno &amp;quot; &amp;amp; _
               &amp;quot;and td.task_refno = t.task_refno &amp;quot; &amp;amp; _
               &amp;quot;and ls.status_code_no = 33 &amp;quot; &amp;amp; _
               &amp;quot;and l.days_past_due &amp;gt;= 10 &amp;quot; 
 

    DSdpdlookup = NLSApp.SQLSelectStatement(DSdpdlookupsql)



        Do Until DSdpdlookup = &amp;quot;***END OF RESULT***&amp;quot;
  
            DPS  = NLSapp.SQLSelectStatementNextColumn()
            Rep  = NLSapp.SQLSelectStatementNextColumn()
            Co  = NLSapp.SQLSelectStatementNextColumn()
            DSDPSmessageSubject = DSdpdlookup &amp;amp; &amp;quot; is &amp;quot; &amp;amp;  DPS &amp;amp; &amp;quot; days past due on their settlement&amp;quot;
            DSDPSmessageBody =  &amp;quot;Loan &amp;quot; &amp;amp; DSdpdlookup &amp;amp; &amp;quot; is &amp;quot; &amp;amp;  DPS &amp;amp; &amp;quot; days past due on their settlement. Please reach out to &amp;quot; &amp;amp; Rep &amp;amp; &amp;quot; at &amp;quot; &amp;amp;  Co &amp;amp; &amp;quot;  and make arrangements for a payment.&amp;quot;

           &amp;apos;If  DPS = &amp;quot;10&amp;quot; or DPS = &amp;quot;31&amp;quot; Then
            If  DPS = &amp;quot;116&amp;quot; or DPS = &amp;quot;133&amp;quot; Then
              &amp;apos;NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;,&amp;quot;settlements@freedomplus.com-Need to confirm&amp;quot;, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, DSDPSmessageSubject,DSDPSmessageBody
               NLSApp.SendEmailMessage &amp;quot;Servicing CPlus&amp;quot;,&amp;quot;Stanley.muhammad@gmail.com&amp;quot;, &amp;quot;consolplus-servicing@consolplus.com&amp;quot;, DSDPSmessageSubject,DSDPSmessageBody
            End if

            DSdpdlookup = NLSApp.SQLSelectStatementReadNext()

        Loop
End Sub


&quot;/&gt;
&lt;BUTTON Name=&quot;Create recurring pmts&quot; Script=&quot; strXML = NLSApp.SQLSelectStatement(&amp;quot;SELECT userdef101 from task_detail_grid where task_refno = 6855&amp;quot;)
colname = &amp;quot;Month&amp;quot;
        recurr = 0

    strXML = Replace(strXML, &amp;quot;&amp;amp;&amp;quot;, &amp;quot;&amp;amp;amp;&amp;quot;)
    Set xmlDoc = CreateObject(&amp;quot;Msxml2.DOMDocument&amp;quot;)
    xmlDoc.setProperty &amp;quot;SelectionLanguage&amp;quot;, &amp;quot;XPath&amp;quot;

    Err.Clear
    On Error Resume Next
    xmlDoc.loadxml(strXML)
    If Err.Number &amp;lt;&amp;gt; 0 Then
        &amp;apos;Exit Function
        NLSapp.MessageBox(Err.Description)
    End If
    On Error GoTo 0
                
    Set nodesList = xmlDoc.documentelement.selectNodes(&amp;quot;/DATA/ROW&amp;quot;) 
    counter = nodesList.length

    dblTotal = 0

       For x = 1 To counter

        Set currNode=nodesList.nextNode 
        CurrNodeName = currNode.nodename
                                
        Set cnode = currNode.childnodes
                
       For Each c In cnode
     
                &amp;apos;row = c.getAttribute(&amp;quot;RowNumber&amp;quot;)
                name = c.getAttribute(&amp;quot;Name&amp;quot;)
                value = c.getAttribute(&amp;quot;Value&amp;quot;)

                If CDbl(len(name)) &amp;gt; 0 Then

                   If name = &amp;quot;Month&amp;quot; Then
                        If recurr = 0 Then
                            Monthx = value
                            Monthy = value
                        Else
                            Monthy = value
                        End If
 
                    End If

                    If Monthx &amp;lt;&amp;gt; &amp;quot;TOTAL&amp;quot; Then

                        If name = &amp;quot;Amount&amp;quot; Then

                            If recurr = 0 Then
                                Amountx = value
                                Amounty = value
                            Else
                                Amounty = value

                            End If
                            msgbox(Monthx &amp;amp; &amp;quot; &amp;quot; &amp;amp; Monthy &amp;amp; &amp;quot; &amp;quot; &amp;amp; Amounty)
                            msgbox(Monthx &amp;amp; &amp;quot; &amp;quot; &amp;amp; Amountx &amp;amp; &amp;quot; &amp;quot; &amp;amp; recurr &amp;amp; &amp;quot; times&amp;quot;)
                            If Amountx = Amounty Then
                                recurr = recurr + 1
                            Else
                                msgtxtx = Monthx &amp;amp; &amp;quot; &amp;quot; &amp;amp; Amountx &amp;amp; &amp;quot; &amp;quot; &amp;amp; recurr &amp;amp; &amp;quot; times&amp;quot;
                                msgbox(msgtxtx)
                                Monthx = Monthy
                                recurr = 1
                            End If
                        End If

                    End If

                End If
            Next
        Next&quot;/&gt;
&lt;BUTTON Name=&quot;#2&quot; Script=&quot;strXML = NLSApp.SQLSelectStatement(&amp;quot;SELECT userdef101 from task_detail_grid where task_refno = 6855&amp;quot;)
        colname = &amp;quot;Month&amp;quot;
        recurr = 0

        strXML = Replace(strXML, &amp;quot;&amp;amp;&amp;quot;, &amp;quot;&amp;amp;amp;&amp;quot;)
        Set xmlDoc = CreateObject(&amp;quot;Msxml2.DOMDocument&amp;quot;)
        xmlDoc.setProperty &amp;quot;SelectionLanguage&amp;quot;, &amp;quot;XPath&amp;quot;

        Err.Clear
        On Error Resume Next
        xmlDoc.loadxml(strXML)
        If Err.Number &amp;lt;&amp;gt; 0 Then
            &amp;apos;Exit Function
            NLSapp.MessageBox(Err.Description)
        End If
        On Error GoTo 0
                
        Set nodesList = xmlDoc.documentelement.selectNodes(&amp;quot;/DATA/ROW&amp;quot;) 
        counter = nodesList.length

        dblTotal = 0

        For x = 1 To counter

             Set currNode=nodesList.nextNode 
             CurrNodeName = currNode.nodename
                                
             Set cnode = currNode.childnodes
                
            For Each c In cnode

                &amp;apos;row = c.getAttribute(&amp;quot;RowNumber&amp;quot;)
                name = c.getAttribute(&amp;quot;Name&amp;quot;)
                value = c.getAttribute(&amp;quot;Value&amp;quot;)
                If name = &amp;quot;Amount&amp;quot; Then
                    paymnt = value
                End If
                For value = paymnt To value &amp;lt;&amp;gt; paymnt
                    count = count + 1

                Next
                msgbox(count)
            Next
        Next&quot;/&gt;
&lt;BUTTON Name=&quot;#6&quot; Script=&quot;firstmonth = &amp;quot;February 22, 2020&amp;quot;
&amp;apos;firstpayment = DateForm111(firstmonth)
&amp;apos;firstpayment =firstmonth
&amp;apos;MsgBox(firstmonth &amp;amp; Chr(13) &amp;amp; Day(Now()) &amp;amp; chr(13) &amp;amp; CDate(firstpayment) &amp;amp; chr(13) &amp;amp; &amp;quot;CDate(firstpayment)+ Day(Now()) - 1 = &amp;quot; &amp;amp; DateForm111(CDate(firstpayment)+ Day(Now()) - 1))

msgbox(DateFormat(firstmonth,111) &amp;amp; chr(13) &amp;amp;DateFormat(firstmonth,1)  )


Function DateFormat(datestring,formatcode)

	If IsDate(datestring) = true Then
		
		If len(DAY(datestring)) = 1 Then
		   daytext = &amp;quot;0&amp;quot; &amp;amp; DAY(datestring) 
		Else 
		   daytext = DAY(datestring) 
		End if 
		
		If len(MONTH(datestring)) = 1 Then
		   mnthtext = &amp;quot;0&amp;quot; &amp;amp; MONTH(datestring) 
		Else 
		   mnthtext = MONTH(datestring) 
		End if 
		
		Select case formatcode
		
		&amp;apos;U.S. = mm/dd/yyyy
		case 1	
			DateFormat = mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; Right(YEAR(datestring),2)
		case 101	
			DateFormat = mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext &amp;amp;&amp;quot;/&amp;quot;&amp;amp;	YEAR(datestring) 
			
		&amp;apos;JAPAN	= yyyy/mm/dd	
		case 11	
			DateFormat = Right(YEAR(datestring),2) &amp;amp;&amp;quot;/&amp;quot;&amp;amp; mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext
		case 111	
			DateFormat = YEAR(datestring)&amp;amp;&amp;quot;/&amp;quot;&amp;amp; mnthtext &amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext
			
		Case Else
			DateFormat = -1
		End Select
	Else	
		DateFormat = -1
	End if
	
End Function

Function DateForm111(sourcedate)

	If len(DAY(sourcedate)) = 1 Then
	   daytext = &amp;quot;0&amp;quot; &amp;amp; DAY(sourcedate) 
	Else 
	   daytext = DAY(sourcedate) 
	End if 
	
	If len(MONTH(sourcedate)) = 1 Then
	   mnthtext = &amp;quot;0&amp;quot; &amp;amp; MONTH(sourcedate) 
	Else 
	   mnthtext = MONTH(sourcedate) 
	End if 
	
	DateForm111 = YEAR(sourcedate)&amp;amp;&amp;quot;/&amp;quot;&amp;amp; mnthtext&amp;amp;&amp;quot;/&amp;quot;&amp;amp; daytext
	
End Function

NLSApp.RefreshScreen()&quot;/&gt;
&lt;BUTTON Name=&quot;#7&quot; Script=&quot;firstpayment =&amp;quot;February 2020&amp;quot;

Expiredate = Month(firstpayment) &amp;amp; &amp;quot;/&amp;quot; &amp;amp; DaysInMonth(MonthNo(firstpayment),Year(firstpayment)) &amp;amp; &amp;quot;/&amp;quot; &amp;amp; Year(firstpayment)

msgbox(Expiredate)

Function MonthNo(monthtxt)
    mthno = &amp;quot;&amp;quot;
    Select Case left(monthtxt, 3)
        Case &amp;quot;Jan&amp;quot;
            mthno = &amp;quot;1&amp;quot;
        Case &amp;quot;Feb&amp;quot;
            mthno = &amp;quot;2&amp;quot;
        Case &amp;quot;Mar&amp;quot;
            mthno = &amp;quot;3&amp;quot;
        Case &amp;quot;Apr&amp;quot;
            mthno = &amp;quot;4&amp;quot;
        Case &amp;quot;May&amp;quot;
            mthno = &amp;quot;5&amp;quot;
        Case &amp;quot;Jun&amp;quot;
            mthno = &amp;quot;6&amp;quot;
        Case &amp;quot;Jul&amp;quot;
            mthno = &amp;quot;7&amp;quot;
        Case &amp;quot;Aug&amp;quot;
            mthno = &amp;quot;8&amp;quot;
        Case &amp;quot;Sep&amp;quot;
            mthno = &amp;quot;9&amp;quot;
        Case &amp;quot;Oct&amp;quot;
            mthno = &amp;quot;10&amp;quot;
        Case &amp;quot;Nov&amp;quot;
            mthno = &amp;quot;11&amp;quot;
        Case &amp;quot;Dec&amp;quot;
            mthno = &amp;quot;12&amp;quot;
        Case Else
            mthno = &amp;quot;Invalid Month&amp;quot;
    End Select
    MonthNo = mthno
End Function


&amp;apos;Returns numeric value of last day of selected month

Function DaysInMonth(monthno,yearno)



     Select Case monthno

	

           Case 1, 3, 5, 7, 8, 10, 12

              DaysInMonth = 31

	     

          Case 4, 6, 9, 11

              DaysInMonth = 30  

	     

          Case 2

              &amp;apos;Is Year a leap year?

              If  (yearno Mod 400 = 0) or (yearno Mod 4 = 0 and not yearno Mod 100 = 0) Then  

                 DaysInMonth = 29

              Else

                 DaysInMonth = 28

              End If

	   

     End Select



End Function&quot;/&gt;
&lt;BUTTON Name=&quot;#8&quot; Script=&quot;UpdateDSBillingduedates()
msgbox(&amp;quot;completed!&amp;quot;)

Sub UpdateDSBillingduedates
	&amp;apos;SQL to Update loanacct_payments_due table for DS payments
	Updatesqlpymntsduesql = &amp;quot;SELECT 0; UPDATE loanacct_payments_due SET date_due = dateadd(dd,16,date_due)&amp;quot; &amp;amp; chr(13)  &amp;amp; _
							&amp;quot;from loanacct_payments_due where payment_reference_no IN &amp;quot; &amp;amp; chr(13)  &amp;amp; _
							&amp;quot;(Select distinct convert(varchar, th.transaction_reference_no) &amp;quot; &amp;amp; chr(13)  &amp;amp; _
							&amp;quot; from loanacct_trans_history th, loanacct l, loan_transaction_codes ltc&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot; where l.acctrefno = th.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
							&amp;quot; and ltc.transaction_code = th.transaction_code&amp;quot; &amp;amp; chr(13) &amp;amp; _
							&amp;quot;and ltc.transaction_description = &amp;apos;Debt Settlement Billing&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot; and th.reversal_transrefno = 0&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot; and th.effective_date = th.date_due)&amp;quot;
	 
	&amp;apos;SQL to Update loanacct_trans_history table for DS billing transaction                       
	Updatesqltranssql     = &amp;quot;SELECT 0; UPDATE loanacct_trans_history SET date_due = dateadd(dd,17,th.date_due)&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot; from loanacct_trans_history th, loanacct l, loan_transaction_codes ltc&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot;where l.acctrefno = th.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot;and ltc.transaction_code = th.transaction_code&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot;and ltc.transaction_description = &amp;apos;Debt Settlement Billing&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot;and th.reversal_transrefno = 0 &amp;quot; &amp;amp; chr(13) &amp;amp;  _
							&amp;quot;and th.effective_date = th.date_due&amp;quot;

	NLSApp.Messagebox(Updatesqlpymntsduesql &amp;amp; chr(13) &amp;amp; Updatesqltranssql)					   
	NLSapp.SQLSelectStatement(Updatesqlpymntsduesql)
	NLSapp.SQLSelectStatement(Updatesqltranssql)
End sub&quot;/&gt;
&lt;BUTTON Name=&quot;#10 DS add History&quot; Script=&quot;updatepayhistudfssql  = &amp;quot;SELECT 0;                                                                                                                                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 5068427&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 4802744&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 2539784&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 4073848&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 3046111&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 3223069&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 4546569&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 3843538&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 4300647&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 2869538&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 2700050&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 3423369&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_payment_history SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where payment_type = &amp;apos;ZZ&amp;apos; and transaction_reference_no = 3627788&amp;quot; 


addtransxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;800&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;12/30/2016&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0153804&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;12587.53&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;12/30/2016&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;01/30/2017&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0153804&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;100&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;01/30/2017&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;2539784&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp;chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;04/30/2017&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0153804&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;100&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;04/30/2017&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;3046111&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp;chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;05/30/2017&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0153804&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;100&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;05/30/2017&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;3223069&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp;chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/30/2017&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0153804&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;100&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;03/30/2017&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;2869538&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp;chr(13) &amp;amp; _
&amp;quot;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;802&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;02/28/2017&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0153804&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;100&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;02/28/2017&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;2700050&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp;chr(13) &amp;amp; _
&amp;quot;&amp;lt;/TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

NLSApp.MessageBox(updatepayhistudfssql)
NLSApp.MessageBox(addtransxml)
ImportXML(addtransxml)

&amp;apos;NLSApp.SQLSelectStatement(updatepayhistudfssql)

updatetrans =  &amp;quot;SELECT 0;   &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  5068427&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  4802744&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  2539784&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  4073848&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  3046111&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  3223069&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  4546569&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  3843538&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  4300647&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  2869538&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  2700050&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  3423369&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;UPDATE loanacct_trans_history SET userdef01  = lph.row_id from  loanacct_payment_history lph, loanacct_trans_history lth  where lph.transaction_reference_no = lth.transaction_reference_no and payment_type = &amp;apos;ZZ&amp;apos; and lth.transaction_reference_no =  3627788&amp;quot;

&amp;apos;NLSApp.MessageBox(updatepayhistudfs)
&amp;apos;NLSApp.MessageBox(addtrans)
&quot;/&gt;
&lt;BUTTON Name=&quot;#11 DS add TC&quot; Script=&quot;TCInsertsx = &amp;quot;SELECT 0; Insert loan_transaction_codes &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;values (&amp;apos;8200&amp;apos;,&amp;apos;Debt Settlement Pmnt&amp;apos;,&amp;apos;Settlement Payments&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;, (&amp;apos;8201&amp;apos;,&amp;apos;Reverse Debt Settlement Pmnt&amp;apos;,&amp;apos;Reverse Settlement Payments&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;, (&amp;apos;8124&amp;apos;, &amp;apos;Debt Settlement Billing&amp;apos;,&amp;apos;Debt Settlement P+I Billing&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;2&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;R&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;PI&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;8200&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;32768&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement P+I Billing&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,NULL,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;, (&amp;apos;8125&amp;apos;, &amp;apos;Reverse Debt Settlement P+I Billing&amp;apos;,&amp;apos;Reverse Debt Settlement P+I Billing&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;2&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;R&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;PI&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;8200&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement P+I Billing&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,NULL,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot;


  TCInsertsx = &amp;quot;SELECT 0; Insert loan_transaction_codes &amp;quot; &amp;amp; chr(13) &amp;amp; _                                                                                                                                                                                                                        
  &amp;quot;values (&amp;apos;8460&amp;apos;,&amp;apos;Active Debt Settlement Suspense&amp;apos;,&amp;apos;Active Debt Settlement Suspense&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
  &amp;quot;,(&amp;apos;8461&amp;apos;,&amp;apos;Reverse Active Debt Settlement Suspense&amp;apos;,&amp;apos;Reverse Active Debt Settlement Suspense&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
  &amp;quot;, (&amp;apos;8440&amp;apos;,&amp;apos;Debt Settlement Accepted Write Down&amp;apos;,&amp;apos;Debt Settlement Accepted Write Down&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Accepted Write Down&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
  &amp;quot;, (&amp;apos;8441&amp;apos;,&amp;apos;Reverse Debt Settlement Accepted Write Down&amp;apos;,&amp;apos;Reverse Debt Settlement Accepted Write Down&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Accepted Write Down&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot;                                                                                                                                                                                                                                                                                          
  
  TCInserts = &amp;quot;SELECT 0; Insert loan_transaction_codes &amp;quot; &amp;amp; chr(13) &amp;amp; _                                                                                                                                                                                                                        
  &amp;quot;values (&amp;apos;8442&amp;apos;, &amp;apos;Debt Settlement Bal Write Off&amp;apos;, &amp;apos;Debt Settlement Bal Write Off&amp;apos;, &amp;apos;OL1&amp;apos;, &amp;apos;6&amp;apos;, &amp;apos;C&amp;apos;, &amp;apos;N&amp;apos;, &amp;apos;U10&amp;apos;, &amp;apos;D&amp;apos;, &amp;apos;C&amp;apos;, &amp;apos;N&amp;apos;, &amp;apos;NA&amp;apos;, &amp;apos;N&amp;apos;, &amp;apos;NA&amp;apos;, &amp;apos;NA&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;C&amp;apos;, &amp;apos;C&amp;apos;, &amp;apos;C&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;Debt Settlement Bal Write Off&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
 &amp;quot;, (&amp;apos;8443&amp;apos;, &amp;apos;Reverse Debt Settlement Bal Write Off&amp;apos;, &amp;apos;Reverse Debt Settlement Bal Write Off&amp;apos;, &amp;apos;OL1&amp;apos;, &amp;apos;6&amp;apos;, &amp;apos;D&amp;apos;, &amp;apos;N&amp;apos;, &amp;apos;U10&amp;apos;, &amp;apos;C&amp;apos;, &amp;apos;D&amp;apos;, &amp;apos;N&amp;apos;, &amp;apos;NA&amp;apos;, &amp;apos;N&amp;apos;, &amp;apos;NA&amp;apos;, &amp;apos;NA&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;D&amp;apos;, &amp;apos;D&amp;apos;, &amp;apos;D&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;Debt Settlement Bal Write Off&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;, &amp;apos;0&amp;apos;)&amp;quot;                                                                                                                                                                                                                                                                                          
  

  NLSapp.SQLSelectStatement(TCInserts)

&quot;/&gt;
&lt;BUTTON Name=&quot;#12&quot; Script=&quot; Stoneridgeaclass2s = &amp;quot;|26|32|&amp;quot;
 
   If InStr(Stoneridgeaclass2s, &amp;quot;|&amp;quot; &amp;amp; 26 &amp;amp;  &amp;quot;|&amp;quot;) &amp;lt;&amp;gt; 0 Then 
     msgbox(&amp;quot;Yeah!&amp;quot;)  
else
     msgbox(&amp;quot;Boooo!&amp;quot;)  
   End if

&quot;/&gt;
&lt;BUTTON Name=&quot;#13 DS add TC2&quot; Script=&quot;TCInsertsx = &amp;quot;SELECT 0; Insert loan_transaction_codes values &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot; (&amp;apos;8280&amp;apos;,&amp;apos;Debt Settlement NSF Fee Payment&amp;apos;,&amp;apos;Settlement NSF Fee Payment&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8281&amp;apos;,&amp;apos;Reverse Debt Settlement NSF Fee Payment&amp;apos;,&amp;apos;Reverse Settlement NSF Fee Payment&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8250&amp;apos;,&amp;apos;Debt Settlement Late Fee Payment&amp;apos;,&amp;apos;Settlement Late Fee Payment&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8251&amp;apos;,&amp;apos;Reverse Debt Settlement Late Fee Payment&amp;apos;,&amp;apos;Reverse Settlement Late Fee Payment&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8506&amp;apos;,&amp;apos;Debt Settlement Check Fee Payment&amp;apos;,&amp;apos;Settlement Check Fee Payment&amp;apos;	,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8507&amp;apos;,&amp;apos;Reverse Debt Settlement Check Fee Payment&amp;apos;,&amp;apos;Reverse Settlement Check Fee Payment&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;3&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U9&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;Debt Settlement Payment&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8180&amp;apos;,&amp;apos;Debt Settlement NSF Fee&amp;apos;,&amp;apos;Debt Settlement NSF Fee&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8181&amp;apos;,&amp;apos;Reverse Debt Settlement NSF Fee&amp;apos;,&amp;apos;Reverse Debt Settlement NSF Fee&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8150&amp;apos;,&amp;apos;Debt Settlement Late Fee&amp;apos;,&amp;apos;Debt Settlement Late Fee&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8151&amp;apos;,&amp;apos;Reverse Debt Settlement Late Fee&amp;apos;,&amp;apos;Reverse Debt Settlement Late Fee&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8504&amp;apos;,&amp;apos;Debt Settlement Check Fee&amp;apos;,&amp;apos;Debt Settlement Check Fee&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;,(&amp;apos;8505&amp;apos;,&amp;apos;Reverse Debt Settlement Check Fee&amp;apos;,&amp;apos;Reverse Debt Settlement Check Fee&amp;apos;,&amp;apos;OL1&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;U8&amp;apos;,&amp;apos;C&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;N&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;NA&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;D&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;NULL&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;,&amp;apos;0&amp;apos;)&amp;quot;

NLSApp.MessageBox(TCInsertsx)

NLSapp.SQLSelectStatement(TCInsertsx)&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;435&quot; StaticTopPos=&quot;417&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;418&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;59&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="435.0000000000" StaticTopPos="417.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="418.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="59"/>
<USERDEFFIELDS field_id="76" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;510&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;135&quot; FieldTopPos=&quot;510&quot; FieldWidth=&quot;282&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;61&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="510.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="135.0000000000" FieldTopPos="510.0000000000" FieldWidth="282.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="61"/>
<USERDEFFIELDS field_id="75" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;488&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;135&quot; FieldTopPos=&quot;488&quot; FieldWidth=&quot;282&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;63&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="488.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="135.0000000000" FieldTopPos="488.0000000000" FieldWidth="282.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="63"/>
<USERDEFFIELDS field_id="74" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;466&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;135&quot; FieldTopPos=&quot;466&quot; FieldWidth=&quot;282&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;65&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="466.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="135.0000000000" FieldTopPos="466.0000000000" FieldWidth="282.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="65"/>
<USERDEFFIELDS field_id="73" field_type="0" field_attribute="3" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;444&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;135&quot; FieldTopPos=&quot;444&quot; FieldWidth=&quot;282&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;67&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="444.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="135.0000000000" FieldTopPos="444.0000000000" FieldWidth="282.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="67"/>
<USERDEFFIELDS field_id="72" field_type="2" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;422&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;135&quot; FieldTopPos=&quot;422&quot; FieldWidth=&quot;282&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;69&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="422.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="135.0000000000" FieldTopPos="422.0000000000" FieldWidth="282.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="69"/>
<USERDEFFIELDS field_id="71" field_type="6" field_attribute="0" label_text="Daily Maint Processes" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;0&quot;&gt;
&lt;BUTTON Name=&quot;Daily Maintenance&quot; Script=&quot;NLSApp.SetScriptTimeOut(1200000)
&amp;apos;AutoCloseaddCompleted2018()
&amp;apos;AutoWOaddCompletePending2018()
SyncACHWebpay()
ACHCompanyUDF()
&amp;apos;NonACHDetail2udf45Maint()
&amp;apos;LoanCommPrefs()
&amp;apos;PDFP()
&amp;apos;FirstPayDefaultFlag()
&amp;apos;WebPayments()
DSpaymntMaint()
DSBilltransMaint()
reverseDSpayments()

&amp;apos;Task edit trailing period(.). see INCCRM-417
	NLSapp.SQLSelectStatement(&amp;quot;Select 0; UPDATE task_detail SET userdef06 = left(userdef06,len(userdef06)-1) from task_detail where task_refno IN (Select t.task_refno from task_detail td, task t  where t.task_refno = td.task_refno and t.task_template_no = 6 and right(td.userdef06,1) = &amp;apos;.&amp;apos;)&amp;quot;)

NLSApp.MessageBox(&amp;quot;Completed!&amp;quot;)




&amp;apos;SUBS AND FUNCTIONS
&amp;apos;----------------------------------------------------------------------------------------------

&amp;apos;SUBS-------------------------------------------------------------

&amp;apos;ReverseDSpayments.vb
&amp;apos;Looks for un-reversed debt settlement payment transactions (TC8200) and their corresponding loan payment transactions 
&amp;apos;that have been reversed. it then uses XML import to reverse the TC8200 transaction

Sub reverseDSpayments()

	revtranslookupsql = &amp;quot;select distinct  &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8201&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),getdate(),1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;apos;&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;&amp;apos; + + convert(varchar,lth1.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth1.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;&amp;apos; + lth1.userdef01  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_trans_history lth1,  	/*lth1 represents the DS transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct_trans_history lth2, 			/*lth2 represents the loan payment transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;loanacct l &amp;quot; &amp;amp; chr(13) &amp;amp; _								
	&amp;quot;where lth1.userdef04 is not null &amp;quot; &amp;amp; chr(13) &amp;amp; _		
	&amp;quot;and lth1.acctrefno = l.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and cast(lth2.transaction_reference_no as varchar) = lth1.userdef04  		/*pairs DS transaction to it loan payment transaction*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and (lth1.reversal_transrefno = 0 and not lth2.reversal_transrefno = 0) 	/*DS transaction has not been reversed but the loan payment has been reversed*/&amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth2.transaction_date &amp;gt; &amp;apos;02/01/18&amp;apos; 									/*not valid for transactions prior to implementation date*/&amp;quot;

		Do 	
			RevtransXML = NLSApp.SQLSelectStatement(revtranslookupsql)

			&amp;apos;Sample output
			&amp;apos;RevtransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8201&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/21/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00553272&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;5256551&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;500.00&amp;quot;&amp;quot; RowID=&amp;quot;&amp;quot;3089124&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

			If Not RevtransXML = &amp;quot;&amp;quot; Then
				ImportXML(RevtransXML)
			End If

		Loop Until RevtransXML = &amp;quot;&amp;quot;
	
End Sub

Sub AutoCloseaddCompleted2018()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Close Loans in COMPLETE PENDING status for prescribed waiting period or more and queue up ZERO Balance letter for printing or email
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    xmlsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef27 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)
        Set DT5 = NLSApp.GetDocumentTemplates(5)
        Set DT6 = NLSApp.GetDocumentTemplates(6)
    closurexml = NLSapp.SQLSelectStatement(xmlsql)
   &amp;apos;nlsapp.messagebox(closurexml)
    If not closurexml = &amp;quot;&amp;quot; then
        If len(closurexml) = 0 Then
            Exit Sub
            closurexml = &amp;quot;***END OF RESULT***&amp;quot;
        End If
     Else
        Exit Sub
     End if

    Do Until closurexml = &amp;quot;***END OF RESULT***&amp;quot;
        refno = NLSapp.SQLSelectStatementNextColumn()
        refnolist = refnolist &amp;amp; refno &amp;amp; &amp;quot;, &amp;quot;
        template = NLSapp.SQLSelectStatementNextColumn()
        SendToQueue = NLSapp.SQLSelectStatementNextColumn()
        emailtoaddr = NLSapp.SQLSelectStatementNextColumn()
        name = NLSapp.SQLSelectStatementNextColumn()


        &amp;apos;NLSApp.SQLSelectStatement(&amp;quot;select 0; UPDATE loanacct_statuses SET  status_code_no = 13,  effective_date = getdate() where  loanacct_statuses = 30 and  acctrefno = &amp;quot; &amp;amp; refno)
        
   If PendingCompleteClosureImportXML(closurexml&amp;amp;refno) = &amp;quot;&amp;quot; Then
       &amp;apos; NLSApp.MessageBox(closurexml&amp;amp;refno)
        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                           
        &amp;apos;  &amp;lt;TRANSACTIONS&amp;gt;                                                                                                
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;462&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot; LoanNumber=&amp;quot;APP-00999999&amp;quot; Amount=&amp;quot;537.43&amp;quot; /&amp;gt;
        &amp;apos;  &amp;lt;/TRANSACTIONS&amp;gt;                                                                                               
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-00999999&amp;quot; LoanStatusCode=&amp;quot;CLOSED&amp;quot; ClosedDate=&amp;quot;07/21/17&amp;quot; &amp;gt;                
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;DELETE&amp;quot; LoanStatusCode=&amp;quot;PENDING COMPLETE&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;               
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;ADD&amp;quot; LoanStatusCode=&amp;quot;COMPLETED&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;                         
        &amp;apos;  &amp;lt;/LOAN&amp;gt;                                                                                                       
        &amp;apos;&amp;lt;/NLS&amp;gt;

               &amp;apos;NLSApp.MessageBox(template &amp;amp; chr(13) &amp;amp; SendToQueue)

            If template = 5 Then
                 DT5.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
            End if
            If template = 6 Then
                 DT6.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
            End if

            If SendToQueue = &amp;quot;FALSE&amp;quot; Then
                If template = 5 Then
                &amp;apos;FPlus
                    emailbody = &amp;quot;Dear &amp;quot; &amp;amp; name &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Your Freedom Plus loan now has a $0 balance, and any automatic ACH payments have been discontinued.&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Thank you for being a valued client and for choosing Freedom Plus.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Warmest regards,&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;FreedomPlus Servicing&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Phone: 800-297-5897&amp;quot;

                    NLSApp.SendEmailMessage &amp;quot;Servicing FPlus&amp;quot;, emailtoaddr, &amp;quot;customersupport@freedomplus.com&amp;quot;, &amp;quot;Your loan now has a $0 balance&amp;quot;, emailbody 
                 End If
                If template = 6 Then
                &amp;apos;CPlus
                    emailbody = &amp;quot;Dear &amp;quot; &amp;amp; name &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Your Consolidation Plus loan now has a $0 balance, and any automatic ACH payments have been discontinued.&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Thank you for being a valued client and for choosing Consolidation Plus.&amp;quot; &amp;amp; chr(13) &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Warmest regards,&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Consolidation Plus Servicing&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;Phone: 888-950-4829&amp;quot;

                    NLSApp.SendEmailMessage &amp;quot;Servicing CPlus&amp;quot;, emailtoaddr, &amp;quot;consolplus-servicing@consolplus.com&amp;quot;, &amp;quot;Your loan now has a $0 balance&amp;quot;, emailbody 
                 End If

            End If

        Else
            &amp;apos;PLACEHOLDER
            NLSApp.MessageBox(&amp;quot;There was a problem with refno &amp;quot; &amp;amp;  refno &amp;amp; &amp;quot;.&amp;quot;)
        End If
        closurexml = NLSApp.SQLSelectStatementReadNext()

    Loop
    
    If not refnolist = &amp;quot;&amp;quot; Then
        refnolist = &amp;quot;(&amp;quot; &amp;amp; Left(refnolist, Len(refnolist) - 2) &amp;amp; &amp;quot;)&amp;quot;
    End if

   &amp;apos; NLSApp.messagebox(refnolist)
    
    &amp;apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    If SetAdminuser(refnolist) = -1 Then
       subject = &amp;quot;Pending Complete Admin update FAILURE!&amp;quot;
       toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
       body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Update Error setting script user to Admin. Please investigate.&amp;quot;
       NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
    End if
    
End Sub

Sub AutoWOaddCompletePending2018()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automatic Write-off loan balances $10 or less set loan status to COMPLETE PENDING
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    userno = NLSApp.GetCurrentUserNo()
    authuser = NLSapp.SQLSelectStatement(&amp;quot;select convert(varchar(12),groupno) from nlsgroupmembers where userno = &amp;quot; &amp;amp; userno &amp;amp; &amp;quot; and groupno IN (11)&amp;quot;)
    &amp;apos;Current Authrized User group(s) 11-Admin

    lookupallloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)
    lookuponeloansql =  lookupallloanssql &amp;amp; Chr(13) &amp;amp; &amp;quot;and l.acctrefno in (&amp;quot; &amp;amp; NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;) &amp;amp; &amp;quot;)&amp;quot;  
    lookupsql = lookuponeloansql
    
    &amp;apos;Members of authorized user groups can opt to process all eligible loans
    If authuser &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
        &amp;apos;If NLSApp.YseNoMessageBox(&amp;quot;Select Yes to process all available loans.&amp;quot;) Then 
            lookupsql = lookupallloanssql
        &amp;apos;End If           
    End If
 
    writeoffxml = NLSapp.SQLSelectStatement(lookupsql)

    If len(writeoffxml) = 0 Then
        writeoffxml = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until writeoffxml = &amp;quot;***END OF RESULT***&amp;quot;
        refno = NLSapp.SQLSelectStatementNextColumn()
        refnolist = refnolist &amp;amp; refno &amp;amp; &amp;quot;, &amp;quot;

       AddWOandPendingComplete(writeoffxml &amp;amp; refno)
        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                         
        &amp;apos;  &amp;lt;TRANSACTIONS&amp;gt;                                                                                              
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;540&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;544&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;448&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;
        &amp;apos;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;452&amp;quot; EffectiveDate=&amp;quot;07/05/17&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot; Amount=&amp;quot;8.84&amp;quot; /&amp;gt;                        
        &amp;apos;  &amp;lt;/TRANSACTIONS&amp;gt;                                                                                             
        &amp;apos;  &amp;lt;LOAN UpdateFlag=&amp;quot;1&amp;quot; LoanNumber=&amp;quot;APP-00099999&amp;quot;&amp;gt;                                                             
        &amp;apos;    &amp;lt;LOANSTATUSES Operation=&amp;quot;ADD&amp;quot; LoanStatusCode=&amp;quot;PENDING COMPLETE&amp;quot; EffectiveDate=&amp;quot;07/21/17&amp;quot;/&amp;gt;
        &amp;apos;    &amp;lt;LOANCOMMENTS Comment=&amp;quot;Remaining loan balance written-off due to balance below $10. &amp;quot; Category=&amp;quot;SERVICING NOTES&amp;quot; CommentDescription=&amp;quot;Balance write-off&amp;quot; CreatedBy=&amp;quot;0&amp;quot;/&amp;gt;              
        &amp;apos;  &amp;lt;/LOAN&amp;gt;                                                                                                     
        &amp;apos;&amp;lt;/NLS&amp;gt;

        writeoffxml = NLSApp.SQLSelectStatementReadNext()

    Loop

    If not refnolist = &amp;quot;&amp;quot; Then
        refnolist = &amp;quot;(&amp;quot; &amp;amp; Left(refnolist, Len(refnolist) - 2) &amp;amp; &amp;quot;)&amp;quot;
    End if 

    &amp;apos;RESET COMMENT, TRANSAcTION and MOD HISTORY userid  to ADMINISTRATOR
    If SetAdminuser(refnolist) = -1 Then
       subject = &amp;quot;Pending Complete Admin update FAILURE!&amp;quot;
       toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
       body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Update Error setting script user to Admin. Please investigate.&amp;quot;
       NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
    End If
    
End Sub

Sub SyncACHWebpay()
	acctrefno = 9999
	acctsyncsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT  userdef44 from  cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ACH MONITOR&amp;apos;&amp;quot;)
	
	
	Do Until acctrefno = &amp;quot;&amp;quot;
	    acctrefno =  NLSapp.SQLSelectStatement(acctsyncsql)
	
	    investorname = NLSApp.SQLSelectStatementNextColumn()
	    port_code = NLSApp.SQLSelectStatementNextColumn()
	    If port_code = &amp;quot;0&amp;quot; Then
	         port_code = &amp;quot;PLUS PORTFOLIO&amp;quot;
	     Else
	         port_code = &amp;quot;CONSOL PLUS&amp;quot;
	    End If
	    detail2udf45 = NLSApp.SQLSelectStatementNextColumn()
	
	    ACHCompanySyncatupdate2018 acctrefno,investorname,port_code,detail2udf45
	    loopcnt = loopcnt + 1
	Loop 
	&amp;apos;Loop until loopcnt = 4

End Sub

Sub ACHCompanyUDF()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;ACH Company UDF Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    refnosql = &amp;quot;SELECT nonachUDFs.acctrefno,nonachUDFs.UDFtarget&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(SELECT distinct &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;convert(varchar(10),la.acctrefno) as acctrefno,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;la.loan_class2_no,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lach.ach_company_id,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;la.portfolio_code_id,ld2.userdef45,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;&amp;apos;UDFtarget&amp;apos;= CASE&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 0 THEN 1&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 2 AND la.portfolio_code_id = 1 THEN 4&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 4 THEN 3&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 7 THEN 7&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 8 THEN 8&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 9 THEN 9&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 10 THEN 10&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 11 THEN 11&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 0 THEN 12&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 12 AND la.portfolio_code_id = 1 THEN 15&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 13 THEN 13&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 15 THEN 16&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 16 THEN 17&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 17 THEN 18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 18 THEN 19&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 19 THEN 20&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 20 THEN 21&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 21 THEN 22&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 22 THEN 23&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 23 THEN 24&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 24 THEN 25&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHEN la.loan_class2_no = 25 THEN 26&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 26 THEN 27&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 27 THEN 32&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 28 THEN 28&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 29 THEN 30&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 30 THEN 31&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 31 THEN 29&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 32 THEN 34&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 33 AND la.portfolio_code_id = 0 THEN 35&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 33 AND la.portfolio_code_id = 1 THEN 38&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;WHEN la.loan_class2_no = 34 AND la.portfolio_code_id = 0 THEN 36&amp;quot; &amp;amp; chr(13) &amp;amp;_ 
    &amp;quot;WHEN la.loan_class2_no = 34 AND la.portfolio_code_id = 1 THEN 37&amp;quot; &amp;amp; chr(13) &amp;amp;_  
    &amp;quot;WHEN la.loan_class2_no = 35 THEN 39&amp;quot; &amp;amp; chr(13) &amp;amp;_
    &amp;quot;ELSE 9999&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;END&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct_ach lach, loanacct_detail_2 ld2, loanacct la, loan_class lc,ach_company ach&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE lach.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lc.codenum = la.loan_class2_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lach.ach_company_id = ach.ach_company_id&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;and lach.status = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;/*AND la.loan_class1_no 1*/) nonachUDFs&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE nonachUDFs.UDFtarget &amp;lt;&amp;gt; nonachUDFs.userdef45 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;OR nonachUDFs.userdef45  IS NULL&amp;quot;

    LoanRefNo = NLSapp.SQLSelectStatement(refnosql)
    &amp;apos;NLSApp.MessageBox( LoanRefNo)

    If LoanRefNo = &amp;quot;&amp;quot; Then
        LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
        Lcount = Lcount + 1
        achid = NLSApp.SQLSelectStatementNextColumn()

        achxml = &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;    &amp;lt;LOANDETAIL2 UserDefined45=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achid &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;


        ImportXML(achxml)


        LoanRefNo = NLSApp.SQLSelectStatementReadNext()

    Loop
    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;ACH Company UDF Proccessing&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount
        &amp;apos;NLSApp.MessageBox(&amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount)
    End If

End Sub


Sub LoanCommPrefs()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Communication Preferences Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    Commsetuplookupsqltxt = &amp;quot;SELECT distinct  la.loan_number, convert(varchar(15),la.acctrefno) as acctrefno,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;convert(char(1),lcp.StatementOptionFlags),lca.Address,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;&amp;apos;MailOptIn&amp;apos; = CASE When la.portfolio_code_id=0 THEN ld1.userdef18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;cif.email, cif.cifnumber&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;from cif cif, loanacct_detail ld1,loanacct la&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;LoanCommunicationPreferences lcp&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;on &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;la.acctrefno = lcp.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;LoanCommunicationAddress lca&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;on&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lca.LoanCommunicationPreferencesID = lcp.LoanCommunicationPreferencesID&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;Where ld1.acctrefno = la.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND cif.cifno = la.cifno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ((lcp.StatementOptionFlags IS NULL AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;OR (lcp.StatementOptionFlags = 2 AND lca.Address IS NULL)&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;OR (lcp.StatementOptionFlags = 1 AND (CASE When la.portfolio_code_id=0 THEN ld1.userdef18&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;When la.portfolio_code_id=1 THEN  ld1.userdef17 END)= 0) )&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.loan_number  not like &amp;apos;CP%A&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.loan_number not like &amp;apos;%dummy%&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;order by acctrefno ,mailoptin desc&amp;quot;

    LoanNumber = NLSapp.SQLSelectStatement(Commsetuplookupsqltxt)
    loopcnt = 0

    If LoanNumber = &amp;quot;&amp;quot; Then
        LoanNumber = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until LoanNumber = &amp;quot;***END OF RESULT***&amp;quot;

        Loanrefno = NLSapp.SQLSelectStatementNextColumn()
        Flag = NLSapp.SQLSelectStatementNextColumn()
        Commemail = NLSapp.SQLSelectStatementNextColumn()
        Optin = NLSapp.SQLSelectStatementNextColumn()
        Cntemail = NLSapp.SQLSelectStatementNextColumn()

        If Optin = 1 Then
            Optinflag = 1
        Else
            Optinflag = 2
        End If
        CIFNum = NLSapp.SQLSelectStatementNextColumn()

        If Cntemail = &amp;quot;&amp;quot; Then
            Optinflag = 1
            Cntemail = &amp;quot;LScontact@ffn.com&amp;quot;
            cifemailxml = &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;   &amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; CIFNum &amp;amp; &amp;quot;&amp;quot;&amp;quot; Entity=&amp;quot;&amp;quot;INDIVIDUAL&amp;quot;&amp;quot; EmailAddress1=&amp;quot;&amp;quot;LScontact@ffn.com&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
            &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

            ImportXML(cifemailxml)

        End If


        commprefxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;UTF-8&amp;quot;&amp;quot; standalone=&amp;quot;&amp;quot;yes&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;	&amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanNumber &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;		&amp;lt;COMMUNICATION&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;EMAILADDRESSES&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;				&amp;lt;EMAILADDRESS Operation=&amp;quot;&amp;quot;ADD&amp;quot;&amp;quot; Address=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Cntemail &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;/EMAILADDRESSES&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;ALERTS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;				&amp;lt;ALERT AlertType=&amp;quot;&amp;quot;Statement&amp;quot;&amp;quot; OptionFlags=&amp;quot;&amp;quot;&amp;quot; &amp;amp; Optinflag &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;			&amp;lt;/ALERTS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;		&amp;lt;/COMMUNICATION&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;	&amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        &amp;apos;NLSApp.MessageBox(loopcnt &amp;amp; &amp;quot; - &amp;quot; &amp;amp; LoanNumber)

        ImportXML(commprefxml)
        LoanNumber = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;Loan Comm Prefs Proccessing&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount 
        &amp;apos; NLSApp.MessageBox( &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount)
    End If
End Sub

Sub WebPayments()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Web payments Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;SET PENDING STATUSES-----------------------------------------------------------

    sqlstring1 = &amp;quot;select convert(varchar(10),la.acctrefno) as acctrefno, pt.ach_trace_number,&amp;apos;PENDING&amp;apos; as Status,ld2.userdef41,null&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM pending_transactions pt, loanacct la, loanacct_detail_2 ld2&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = pt.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef35 = &amp;apos;SUBMITTED&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND convert(datetime,ld2.userdef41) = pt.effective_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;select convert(varchar(10),la.acctrefno) as acctrefno, lph.ach_trace_number,&amp;apos;COMPLETED&amp;apos;, ld2.userdef41,lph.date_paid&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct_payment_history lph, loanacct la, loanacct_detail_2 ld2&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = lph.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef35 = &amp;apos;SUBMITTED&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;select convert(varchar(10),ld2.acctrefno) ,null,&amp;apos;COMPLETED&amp;apos;,ld2.userdef41,lph.date_paid&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct_payment_history lph, loanacct_detail_2 ld2 &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE ld2.acctrefno = lph.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef35 = &amp;apos;PENDING&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND ld2.userdef34 =lph.ach_trace_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND convert(datetime,ld2.userdef41) = lph.date_paid&amp;quot;


    LoanRefNo = NLSapp.SQLSelectStatement(sqlstring1)

    If LoanRefNo = &amp;quot;&amp;quot; Then
        LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;
    End If
    Lcount = 0
    Do Until LoanRefNo = &amp;quot;***END OF RESULT***&amp;quot;

        achtrace = NLSapp.SQLSelectStatementNextColumn()
        status = NLSapp.SQLSelectStatementNextColumn()

        If status = &amp;quot;PENDING&amp;quot; Then

            xmlstrng1 = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;  standalone=&amp;quot;&amp;quot;yes&amp;quot;&amp;quot; ?&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;    &amp;lt;LOANDETAIL2  UserDefined34=&amp;quot;&amp;quot;&amp;quot; &amp;amp; achtrace &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined35=&amp;quot;&amp;quot;&amp;quot; &amp;amp; status &amp;amp; &amp;quot;&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
        End If

        If status = &amp;quot;COMPLETED&amp;quot; Then

            xmlstrng1 = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;  standalone=&amp;quot;&amp;quot;yes&amp;quot;&amp;quot; ?&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; AcctRefno=&amp;quot;&amp;quot;&amp;quot; &amp;amp; LoanRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;    &amp;lt;LOANDETAIL2  UserDefined35=&amp;quot;&amp;quot;&amp;quot; &amp;amp; status &amp;amp; &amp;quot;&amp;quot;&amp;quot; /&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; _
                    &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
        End If

        &amp;apos;NLSApp.MessageBox(xmlstrng1)

        &amp;apos;XML Imports
        ImportXML(xmlstrng1)

        LoanRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;Web Payments&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount 
    End If
&amp;apos;-------------------------------------------------------------------------------------------------------------------------------------------------
&amp;apos;WebPay Clean up -- to catch any remaining loans that were not updated by previous process
&amp;apos;-------------------------------------------------------------------------------------------------------------------------------------------------

 sysadmincifnum = &amp;quot;WEB PAY MAINT&amp;quot;
 userdefno = &amp;quot;18&amp;quot;
 Targetsql1 = &amp;quot;SELECT cd.userdef&amp;quot; &amp;amp; userdefno &amp;amp; &amp;quot; from cif c, cif_detail cd where c.cifno = cd.cifno  AND c.cifnumber = &amp;apos;&amp;quot; &amp;amp; sysadmincifnum &amp;amp; &amp;quot;&amp;apos;&amp;quot;
 
 acctrefno = NLSApp.SQLSelectStatement(NLSApp.SQLSelectStatement(Targetsql1))

    If acctrefno = &amp;quot;&amp;quot; Then
        acctrefno = &amp;quot;***END OF RESULT***&amp;quot;
    End If
    Lcount = 0

    Do Until acctrefno = &amp;quot;***END OF RESULT***&amp;quot;
    	      wpxml = &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;apos;1&amp;apos;&amp;gt;&amp;lt;LOAN UpdateFlag=&amp;apos;1&amp;apos; AcctRefno=&amp;apos;&amp;quot; &amp;amp; acctrefno &amp;amp; &amp;quot;&amp;apos;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;&amp;lt;LOANDETAIL2 UserDefined35=&amp;apos;COMPLETED&amp;apos;/&amp;gt;&amp;lt;/LOAN&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
     
              ImportXML(wpxml)
              acctrefno = NLSApp.SQLSelectStatementReadNext()
    
    Loop

End Sub

Sub PDFP()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;PDFP Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    TranRefNosql = &amp;quot;SELECT convert(varchar(12),lth.transrefno),lth.transaction_date,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lth.effective_date,lth.date_due,la.current_suspense,la.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct la,loanacct_trans_history lth,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;(SELECT DISTINCT la.loan_number,max(lth.transaction_date) as transaction_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct la,loanacct_trans_history lth WHERE la.acctrefno = lth.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lth.transaction_code = &amp;apos;124&amp;apos; AND la.current_suspense &amp;gt; 0 AND la.current_suspense = la.total_past_due_balance&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0 AND lth.date_due &amp;lt; getdate() group by  la.loan_number) lt&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = lth.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lt.loan_number = la.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lt.transaction_date = lth.transaction_date&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lth.transaction_code = &amp;apos;124&amp;apos;  &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;UNION &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;SELECT distinct convert(varchar(12),lth.transrefno),lth.transaction_date,&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;lth.effective_date,lth.date_due,la.total_past_due_balance,la.loan_number&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;FROM loanacct la,loanacct_trans_history lth, loanacct_payments_due lpd&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;WHERE la.acctrefno = lth.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lpd.payment_reference_no = lth.transaction_reference_no&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND lth.transaction_code = &amp;apos;124&amp;apos;&amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.status_code_no = 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _
    &amp;quot;AND la.total_past_due_balance between .000010 and .01&amp;quot;

    TranRefNo = NLSapp.SQLSelectStatement(TranRefNosql)

    If  TranRefNo = &amp;quot;&amp;quot; Then
           TranRefNo =  &amp;quot;***END OF RESULT***&amp;quot;
    End If
    
    Lcount = 0

    Do Until TranRefNo =&amp;quot;***END OF RESULT***&amp;quot;
       
        transdate = NLSapp.SQLSelectStatementNextColumn()
        effdate = NLSapp.SQLSelectStatementNextColumn()
        duedate = NLSapp.SQLSelectStatementNextColumn()
        amount = NLSapp.SQLSelectStatementNextColumn()
        loannum = NLSapp.SQLSelectStatementNextColumn()

        revtransxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;    &amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;125&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; effdate &amp;amp; &amp;quot;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannum &amp;amp; &amp;quot;&amp;quot;&amp;quot;  Amount=&amp;quot;&amp;quot;&amp;quot; &amp;amp; amount &amp;amp; &amp;quot;&amp;quot;&amp;quot; DateDue=&amp;quot;&amp;quot;&amp;quot; &amp;amp; duedate &amp;amp; &amp;quot;&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;&amp;quot; &amp;amp; transdate &amp;amp; &amp;quot;&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;&amp;quot; &amp;amp; TranRefNo &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        ImportXML(revtransxml)

        TranRefNo = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop

    If Lcount &amp;gt; 0 Then
        NLSapp.AddNotification 0, 0, CDate(NOW()), 0, &amp;quot;PDFP Proccessing&amp;quot;, &amp;quot;Loans Processed &amp;quot; &amp;amp; Lcount
    End if
End Sub

Sub NonACHDetail2udf45Maint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;For Updating Detail2 UDF45 with the ACH Company ID to be utilized by web portal one-tine ACH payment function
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    importsxml = NLSApp.SQLSelectStatement(NLSApp.SQLSelectStatement(&amp;quot;SELECT cd.userdef35 FROM cif c, cif_detail cd Where c.cifno = cd.cifno and cifnumber = &amp;apos;WEB PAY MAINT&amp;apos;&amp;quot;))
    If len(importsxml) = 0 Then
        importsxml = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until importsxml = &amp;quot;***END OF RESULT***&amp;quot;

        ImportXML(importsxml)
        &amp;apos;Expected XML string output Format:
        &amp;apos;&amp;lt;NLS&amp;gt;                                                                                                           
        &amp;apos;  &amp;lt;LOAN  UpdateFlag = &amp;quot;1&amp;quot; AcctRefno=&amp;quot;155190&amp;quot; &amp;gt;
        &amp;apos;   &amp;lt;LOANDETAIL2 UserDefined45 = &amp;quot;31&amp;quot; /&amp;gt;
        &amp;apos;  &amp;lt;/LOAN&amp;gt;
        &amp;apos;&amp;lt;/NLS&amp;gt;

        importsxml = NLSApp.SQLSelectStatementReadNext()
    Loop
End Sub

Sub FirstPayDefaultFlag()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;First Pay Default Flag UDF Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    timecheck = NLSapp.SQLSelectStatement(&amp;quot;SELECT Case When substring(cd.userdef03,10,25) &amp;gt; getdate() Then &amp;apos;N&amp;apos; Else &amp;apos;Y&amp;apos; End FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;FIRST PAY DEFAULTS&amp;apos;&amp;quot;)
    
    If timecheck = &amp;quot;Y&amp;quot; Then
        xmlsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;FIRST PAY DEFAULTS&amp;apos;&amp;quot;)
        
        detail2udf13xml = NLSapp.SQLSelectStatement(xmlsql)
        
        If detail2udf13xml = &amp;quot;&amp;quot; Then
            detail2udf13xml = &amp;quot;***END OF RESULT***&amp;quot;
        End If
        
        Do Until detail2udf13xml = &amp;quot;***END OF RESULT***&amp;quot;
        
           ImportXML(detail2udf13xml)
            &amp;apos;Expected XML string output Format:
            &amp;apos;&amp;lt;NLS EnforceTagExistence=&amp;quot;1&amp;quot;&amp;gt;
            &amp;apos;  &amp;lt;LOAN  UpdateFlag=&amp;quot;1&amp;quot; AcctRefno=&amp;quot;999999&amp;quot; &amp;gt;
            &amp;apos;    &amp;lt;LOANDETAIL2 UserDefined13 = &amp;quot;1&amp;quot; /&amp;gt;
            &amp;apos;  &amp;lt;/LOAN&amp;gt;
            &amp;apos;&amp;lt;/NLS&amp;gt;
        
            detail2udf13xml = NLSApp.SQLSelectStatementReadNext()
        
        Loop
        &amp;apos;Update last/Next Run datetime and Last user record
        Runstamp = NOW()
        NextRun = Date() + 1 &amp;amp; &amp;quot; 8:00:00 AM&amp;quot;
         NextRun = NOW()
        UID = NLSApp.GetCurrentUserNo()
        
        Cifupdate = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;apos;1&amp;apos;CIFNumber=&amp;apos;FIRST PAY DEFAULTS&amp;apos;&amp;gt;&amp;lt;CIFDETAIL CIFDetail3=&amp;apos;Next Run: &amp;quot; &amp;amp; NextRun &amp;amp; _
            &amp;quot;&amp;apos; CIFDetail4=&amp;apos;Last Run: &amp;quot; &amp;amp; Runstamp &amp;amp; &amp;quot;&amp;apos; CIFDetail5=&amp;apos; UserID: &amp;quot; &amp;amp; UID &amp;amp; &amp;quot;&amp;apos; /&amp;gt;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
        
        ImportXML(Cifupdate)
    End if

End Sub



Sub DSpaymntMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Settlement payment TC Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	paymentlookupsql = &amp;quot;Select                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +                                                                                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number +                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.row_id) + &amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;&amp;apos;Debt Settlement Payment&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lth.row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;from loanacct_payment_history lth,                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct l,                                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct_statuses ls,                                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;(                                                                  &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	Select acctrefno, max(mod_datestamp) as activetime              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from (                                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	SELECT row_id,acctrefno,mod_datestamp                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from loanacct_mod_history                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	where item_changed = &amp;apos;Status&amp;apos;                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	group by acctrefno) times                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;where times.acctrefno = lth.acctrefno                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.acctrefno = lth.acctrefno                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.acctrefno = lth.acctrefno                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.status_code_no IN  (32, 34)                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos;                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and payment_type = &amp;apos;ZZ&amp;apos;                                            &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and lth.nsf_flag = 0                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.current_ol1_balance &amp;gt; 0                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and date_paid &amp;gt;= times.activetime &amp;quot;



		
	Do 	
		AddDStransXML = NLSApp.SQLSelectStatement(paymentlookupsql)
		payHistUpdatesql = NLSapp.SQLSelectStatementNextColumn()
		
		&amp;apos;Sample output
		&amp;apos;AddDStransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/07/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0162960&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;463.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;5138899&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
		&amp;apos;payHistUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where row_id = 5138899&amp;quot;

		If Not AddDStransXML = &amp;quot;&amp;quot; Then
			ImportXML(AddDStransXML)
			NLSApp.SQLSelectStatement(payHistUpdatesql)
		End If
		count = count + 1
	Loop Until AddDStransXML = &amp;quot;&amp;quot;
	
	&amp;apos;USER ID update 
	NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0 Where transaction_code IN (&amp;apos;8460&amp;apos;,&amp;apos;8440&amp;apos;,&amp;apos;8100&amp;apos;,&amp;apos;8200&amp;apos;) and  enteredby_uid in (39)&amp;quot;)

	
End Sub


Sub DSBilltransMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Billing Transaction (124) TC Maintainance
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	translookupsql = &amp;quot;Select distinct &amp;apos;UPDATE loanacct_recurring_trans set event_transaction_due_date = &amp;apos;&amp;apos;&amp;apos; + convert(char(10),event_startdate+16,101) + &amp;apos;&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar(10),row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;from loanacct_recurring_trans                             &amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;where rec_trans_description = &amp;apos;Debt Settlment Billing Transactions&amp;apos;          &amp;quot; &amp;amp; chr(13) &amp;amp; _
                     &amp;quot;and event_startdate+16 &amp;lt;&amp;gt; event_transaction_due_date&amp;quot;

	 
    transupdatesrow = NLSApp.SQLSelectStatement(translookupsql)
      
    If Not  transupdatesrow = &amp;quot;&amp;quot; Then  
                 	
		Do 	Until  transupdatesrow = &amp;quot;***END OF RESULT***&amp;quot;
		&amp;apos;Do 	Until count = 2  
			transupdates =  transupdates &amp;amp; chr(13) &amp;amp;  transupdatesrow
                                                transupdatesrow = NLSApp.SQLSelectStatementReadNext()
        count = count + 1
		Loop 
    End If
    &amp;apos;NLSapp.MessageBox(&amp;quot;SELECT 0; &amp;quot; &amp;amp; transupdates)	
    NLSapp.SQLSelectStatement(&amp;quot;SELECT 0;  &amp;quot; &amp;amp; transupdates)

End Sub

&amp;apos;FUNCTIONS-------------------------------------------------------------

Function AddWOandPendingComplete(xml)
    NLSApp.ClearErrorString()
    endmark =  &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;
    refno = Mid(xml, InStr(xml, endmark) + len(endmark), len(xml) - InStr(xml, endmark) + len(endmark))
    
    If Not NLSApp.ImportXMLRecord(xml) Then
        If True Then
            errormsg = NLSApp.GetErrorString()
            subject = &amp;quot;Pending Complete Loan Closure process IMPORT FAILURE!&amp;quot;
            toaddress = &amp;quot;NLSErrors@freedomdebtrelief.com&amp;quot; &amp;apos;&amp;quot;somebody@bills.com&amp;quot; 
            body1 = &amp;quot;Acctrefno: &amp;quot; &amp;amp; refno &amp;amp; CHR(13) &amp;amp; &amp;quot;Import Error: &amp;quot; &amp;amp; chr(13) &amp;amp; errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
            NLSApp.SendEmailMessage &amp;quot;Loan Servicing3&amp;quot;, toaddress, &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;, subject, body1
        End If
        AddWOandPendingComplete = errormsg &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; xml &amp;amp; CHR(13)
    Else
        &amp;apos; NLSApp.MessageBox(&amp;quot;&amp;quot;)
        AddWOandPendingComplete = &amp;quot;&amp;quot;
    End If
End Function

Function ACHCompanySyncatupdate2018(refno,Investor,Portfolio,WebACH)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &amp;apos;Triggered when individual loan account is changed or updated.
    &amp;apos;
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    
    &amp;apos;Declare variables
    runtimestamp = Now()
    emailyn = &amp;quot;N&amp;quot;
    userno = NLSApp.GetCurrentUserNo()
    &amp;apos;refno = NLSApp.GetField(&amp;quot;LOAN_REFNO&amp;quot;)
    &amp;apos;Investor = NLSApp.GetField(&amp;quot;LOAN_CLASS2&amp;quot;)
    &amp;apos;Portfolio = NLSApp.GetField(&amp;quot;LOAN_PORTFOLIO&amp;quot;)
    &amp;apos;WebACH = NLSApp.GetField(&amp;quot;LOAN_DETAIL2_UDF45&amp;quot;)
    targetACH =  InvestorACHSync(Investor, Portfolio)
    &amp;apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &amp;quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &amp;quot; &amp;amp; refno &amp;amp; &amp;quot; and ach_company_id &amp;lt;&amp;gt; &amp;quot; &amp;amp; targetACH
    &amp;apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 

    &amp;apos;Other variables
    modhistupdatesql = &amp;quot;&amp;quot;  
    loanach = &amp;quot;&amp;quot;
    loandetail = &amp;quot;&amp;quot;
    achxml = &amp;quot;&amp;quot;
    Detail2pdatesql = &amp;quot;&amp;quot;
    ACHUpdatesql = &amp;quot;&amp;quot;

    &amp;apos;MsgBox(&amp;quot;acctrefno = &amp;quot; &amp;amp; acctrefno &amp;amp; chr(13) &amp;amp; &amp;quot;Port = &amp;quot; &amp;amp; Portfolio)
   &amp;apos; MsgBox(&amp;quot;target ach = &amp;quot; &amp;amp; targetACH)
    &amp;apos;MsgBox(&amp;quot;ach row id = &amp;quot; &amp;amp; nomatchACHrowID)
   &amp;apos; MsgBox(&amp;quot;udf 45 = &amp;quot; &amp;amp; WebACH)

    &amp;apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &amp;quot;&amp;quot; Then
        Do Until nomatchACHrowID = &amp;quot;&amp;quot; &amp;apos;&amp;quot;***END OF RESULT***&amp;quot;
            ACHUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot; Where row_id = &amp;quot; &amp;amp; nomatchACHrowID

            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &amp;apos;MsgBox(&amp;quot;all match&amp;quot;)
    End If    

    &amp;apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &amp;quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &amp;apos;&amp;quot; &amp;amp; targetACH &amp;amp; &amp;quot;&amp;apos; Where acctrefno = &amp;quot; &amp;amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
    ACHCompanySyncatupdate2018 = &amp;quot;&amp;quot;  
End Function


&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;14&quot; StaticTopPos=&quot;400&quot; StaticWidth=&quot;87&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;166&quot; FieldTopPos=&quot;400&quot; FieldWidth=&quot;95&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;71&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="14.0000000000" StaticTopPos="400.0000000000" StaticWidth="87.0000000000" StaticHeight="20.0000000000" FieldLeftPos="166.0000000000" FieldTopPos="400.0000000000" FieldWidth="95.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="71"/>
<USERDEFFIELDS field_id="70" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;19&quot; StaticTopPos=&quot;376&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;376&quot; FieldWidth=&quot;280&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;73&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="19.0000000000" StaticTopPos="376.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="376.0000000000" FieldWidth="280.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="73"/>
<USERDEFFIELDS field_id="69" field_type="6" field_attribute="0" label_text="Testing" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="0" script="**###BEFORE_INPUT###****###BEFORE_INPUT###****###AFTER_INPUT###****###AFTER_INPUT###****###WHEN_FIELD_CHANGE###****###WHEN_FIELD_CHANGE###****###BUTTON_CLICKED###**&lt;BUTTONS ExecScriptOnChange=&quot;1&quot;&gt;
&lt;BUTTON Name=&quot;test11&quot; Script=&quot; msgbox(getdoctempidno(20))

Function getdoctempidno(statementcode)

	SELECT Case statementcode
		CASE &amp;quot;14&amp;quot;	&amp;apos;CPLUS 3 DAY NOTICE
			getdoctempidno = &amp;quot;12&amp;quot;
		CASE &amp;quot;13&amp;quot;	&amp;apos;CPLUS 11 DAY NOTICE
			getdoctempidno = &amp;quot;13&amp;quot;
		CASE &amp;quot;15&amp;quot;	&amp;apos;CPLUS 22 DAY NOTICE
			getdoctempidno = &amp;quot;14&amp;quot;
		CASE &amp;quot;16&amp;quot;	&amp;apos;CPLUS 52 DAY NOTICE
			getdoctempidno = &amp;quot;15&amp;quot;
		CASE &amp;quot;17&amp;quot;	&amp;apos;CPLUS 82 DAY NOTICE
			getdoctempidno = &amp;quot;16&amp;quot;
		CASE &amp;quot;18&amp;quot;	&amp;apos;FPLUS 3 DAY NOTICE
			getdoctempidno = &amp;quot;17&amp;quot;
		CASE &amp;quot;19&amp;quot;	&amp;apos;FPLUS 11 DAY NOTICE
			getdoctempidno = &amp;quot;18&amp;quot;
		CASE &amp;quot;19&amp;quot;	&amp;apos;FPLUS 22 DAY NOTICE
			getdoctempidno = &amp;quot;18&amp;quot;
		CASE &amp;quot;20&amp;quot;	&amp;apos;FPLUS 52 DAY NOTICE
			getdoctempidno = &amp;quot;19&amp;quot;
		CASE &amp;quot;22&amp;quot;	&amp;apos;FPLUS 82 DAY NOTICE
			getdoctempidno = &amp;quot;20&amp;quot;

	End Select	
	
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;test8&quot; Script=&quot;
firstskip =&amp;quot;x&amp;quot;

				If NOT firstskip = &amp;quot;&amp;quot; Then
				    xmlOperation = &amp;quot;Operation=&amp;quot;&amp;quot;UPDATE&amp;quot;&amp;quot;&amp;quot;
				Else
					xmlOperation = &amp;quot;&amp;quot;
				End If

				addskipphonesxml =  &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
				&amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 1&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip1 &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
				&amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 2&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip2 &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
				&amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 3&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip3 &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
				&amp;quot;&amp;lt;CIFPHONENUMBER &amp;quot; &amp;amp; xmlOperation &amp;amp; &amp;quot; PhoneDescription=&amp;quot;&amp;quot;Skip Phone 4&amp;quot;&amp;quot; PhoneNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; skip4 &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt; &amp;quot; &amp;amp; chr(13) &amp;amp; _
				&amp;quot;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;

NLSApp.MessageBox(addskipphonesxml)

&amp;apos;ImportXML(addskipphonesxml)&quot;/&gt;
&lt;BUTTON Name=&quot;ACHCompanysync()&quot; Script=&quot;ACHCompanysync()

Sub ACHCompanysync()
    loanACHlistsql = &amp;quot;SELECT distinct convert(varchar,l.acctrefno) + &amp;apos;,&amp;apos;+ convert(varchar,l.portfolio_code_id) + &amp;apos;,&amp;apos;+  convert(varchar,l.loan_class2_no) + &amp;apos;,&amp;apos; + &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;CASE WHEN lach.row_id IS NULL THEN &amp;apos;&amp;apos; Else convert(varchar,lach.row_id) END + &amp;apos;,&amp;apos;+  &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;CASE WHEN lach.ach_company_id IS NULL THEN &amp;apos;&amp;apos; Else convert(varchar,lach.ach_company_id) END + &amp;apos;,&amp;apos;+ &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;CASE WHEN ld2.userdef45 IS NULL THEN &amp;apos;&amp;apos; Else convert(varchar,ld2.userdef45) END as list &amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Into #loanachlist&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;from loanacct_detail_2 ld2,&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct l&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;left outer join&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;loanacct_ach lach&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;on&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;l.acctrefno = lach.acctrefno and lach.status = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;where l.acctrefno = ld2.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;and l.status_code_no = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;SELECT (Select count(*) from #loanachlist),list from #loanachlist /*where list like &amp;apos;111618%&amp;apos;*/ order by list&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;Drop table #loanachlist&amp;quot;

    p = 0
    u = 0

    &amp;apos;Disable ALL outside scripting
    NLSapp.ScriptOn(false)

    loanACHlistcnt = NLSapp.SQLSelectStatement(loanACHlistsql )

    ReDim loanACHlist(loanACHlistcnt-1)

    start = Time()
    For rowno = 1 to loanACHlistcnt
        r = rowno-1
        loanACHlist(r) = NLSapp.SQLSelectStatementNextColumn()

        nextrow = NLSapp.SQLSelectStatementReadNext()
    Next

    For Each record in loanACHlist

        loandetail = split(record,&amp;quot;,&amp;quot;)
        sourceclass2no = loandetail(2)
        targetinvestor = split(investormatrix(sourceclass2no),&amp;quot;,&amp;quot;)
        
        If Not loandetail(2) = 0 Then
            If loandetail(1) = 0 Then
                targetACHno = targetinvestor(2)
            Else 
                targetACHno = targetinvestor(4)
            End if 
            
            If NOT Len(loandetail(4)) = 0 then
                If NOT loandetail(4) = targetACHno Then
                    p = P + 1
                    achidupdatesqlp = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;UPDATE loanacct_ach SET ach_company_id = &amp;quot; &amp;amp; targetACHno &amp;amp; chr(13) &amp;amp; _
                    &amp;quot;where row_id = &amp;quot; &amp;amp; loandetail(3)
                    
                    NLSapp.SQLSelectStatement(achidupdatesqlp)
                    
                End If
            End If
            
            If NOT loandetail(5) = targetACHno Then
                u = u + 1
                achidupdatesqlu = &amp;quot;SELECT 0;&amp;quot; &amp;amp; chr(13) &amp;amp; _
                &amp;quot;UPDATE loanacct_detail_2 SET userdef45 = &amp;quot; &amp;amp; targetACHno &amp;amp; chr(13) &amp;amp; _
                &amp;quot;WHERE acctrefno = &amp;quot; &amp;amp; loandetail(0)
                
                NLSapp.SQLSelectStatement(achidupdatesqlu)
                
            End If
        End If
    Next

    &amp;apos;Re-Enable outside scripting
    NLSapp.ScriptOn(true)

    finish = Time()

    msgbox(&amp;quot;Miss-matched ACH setups: &amp;quot; &amp;amp; p &amp;amp; chr(13) &amp;amp; &amp;quot;Miss-matched UDF45s: &amp;quot; &amp;amp; u &amp;amp; chr(13) &amp;amp; &amp;quot;Start time: &amp;quot; &amp;amp; FormatDateTime(start,vbLongTime) &amp;amp; chr(13) &amp;amp; &amp;quot;Finish time: &amp;quot; &amp;amp; FormatDateTime(finish,vbLongTime))

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;test12&quot; Script=&quot;msgbox ( InvestortransACHSync(&amp;quot;13B-FCCF-ABS1&amp;quot;,0))


Function InvestortransACHSync(class2, portfolio)
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Matches the class2 field (Investor)in a loan with the corresponding ACH company ID
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    achid = &amp;quot;&amp;quot;
If CStr(portfolio) = &amp;quot;0&amp;quot; Then
   portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot;
End if 

    Select Case class2

        Case &amp;quot;1 - VULCAN&amp;quot;
            If portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot; Then
                achid = &amp;quot;1&amp;quot;
            Else
                achid = &amp;quot;4&amp;quot;
            End If

        Case &amp;quot;3 - FFNAM FUND&amp;quot;
            achid = &amp;quot;3&amp;quot;
        Case &amp;quot;4 - RANGER&amp;quot;
            achid = &amp;quot;7&amp;quot;
        Case &amp;quot;5 - ATALAYA CAPITAL&amp;quot;
            achid = &amp;quot;8&amp;quot;
        Case &amp;quot;6 - RANGER DLT&amp;quot;
            achid = &amp;quot;9&amp;quot;
        Case &amp;quot;7 - BLUE ELEPHANT&amp;quot;
            achid = &amp;quot;10&amp;quot;
        Case &amp;quot;8 - TIDEPOOL&amp;quot;
            achid = &amp;quot;11&amp;quot;
        Case &amp;quot;9 - AEQUITAS ACC5&amp;quot;
            If portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot; Then
                achid = &amp;quot;12&amp;quot;
            Else
                achid = &amp;quot;15&amp;quot;
            End If
        Case &amp;quot;5A - ATALAYA V-B&amp;quot;
            achid = &amp;quot;13&amp;quot;
        Case &amp;quot;5B - ATALAYA VI&amp;quot;
            achid = &amp;quot;14&amp;quot;
        Case &amp;quot;5C - ATALAYA MW&amp;quot;
            achid = &amp;quot;16&amp;quot;
        Case &amp;quot;7A - BLUE ELEPHANT OFFSHO&amp;quot;
            achid = &amp;quot;17&amp;quot;
        Case &amp;quot;5D - ATALAYA II-C&amp;quot;
            achid = &amp;quot;18&amp;quot;
        Case &amp;quot;10 - KEYSTONE&amp;quot;
            achid = &amp;quot;19&amp;quot;
        Case &amp;quot;11 - CRESTLINE&amp;quot;
            achid = &amp;quot;20&amp;quot;
        Case &amp;quot;12 - FCCF-SERIES 1&amp;quot;
            achid = &amp;quot;21&amp;quot;
        Case &amp;quot;13 - FCCF-SERIES 2&amp;quot;
            achid = &amp;quot;22&amp;quot;
        Case &amp;quot;14 - ACM III&amp;quot;
            achid = &amp;quot;23&amp;quot;
        Case &amp;quot;15 - ACM MW II&amp;quot;
            achid = &amp;quot;24&amp;quot;
        Case &amp;quot;16 - CRESTLINE II&amp;quot;
            achid = &amp;quot;25&amp;quot;
        Case &amp;quot;17 - DAKOY&amp;quot;
            achid = &amp;quot;26&amp;quot;
        Case &amp;quot;18 - STONERIDGE&amp;quot;
            achid = &amp;quot;27&amp;quot;
        Case &amp;quot;19 - ACM ALAMOSA I&amp;quot;
            achid = &amp;quot;32&amp;quot;
        Case &amp;quot;20 - ACM ALAMOSA I-A&amp;quot;
            achid = &amp;quot;28&amp;quot;
        Case &amp;quot;21 - ACM GATEWAY&amp;quot;
            achid = &amp;quot;30&amp;quot;
        Case &amp;quot;22 - ACM F ACQUISITION&amp;quot;
            achid = &amp;quot;31&amp;quot;
        Case &amp;quot;23 - 590 CONSUMER LENDING&amp;quot;
            achid = &amp;quot;29&amp;quot;
        Case &amp;quot;18A - STONE RIDGE II&amp;quot;
            achid = &amp;quot;34&amp;quot;
        Case &amp;quot;24 - ACM IV ON&amp;quot;
            If portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot; Then
                achid = &amp;quot;36&amp;quot;
            Else
                achid = &amp;quot;37&amp;quot;
            End If            
        Case &amp;quot;25 - ACM IV OFF&amp;quot;
            If portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot; Then
                achid = &amp;quot;35&amp;quot;
            Else
                achid = &amp;quot;38&amp;quot;
            End If
        Case &amp;quot;13A - FCCF - CS&amp;quot;
            achid = &amp;quot;39&amp;quot;
        Case &amp;quot;13B-FCCF-ABS1&amp;quot;
            If portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot; Then
                achid = &amp;quot;41&amp;quot;
            Else
                achid = &amp;quot;40&amp;quot;
            End If
        Case &amp;quot;13Z-FCCF-INEL&amp;quot;
            If portfolio = &amp;quot;PLUS PORTFOLIO&amp;quot; Then
                achid = &amp;quot;43&amp;quot;
            Else
                achid = &amp;quot;42&amp;quot;
            End If
        Case Else
            If Not class2 = &amp;quot;&amp;quot; Then
                NLSApp.MessageBox(&amp;quot;Cannot Locate Class2/ACH company ID for &amp;quot; &amp;amp; class2 &amp;amp; &amp;quot;.&amp;quot;)
            End if
            achid = &amp;quot;9999&amp;quot;
    End Select

    InvestortransACHSync = achid
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;test2&quot; Script=&quot;&amp;apos;-------------------------------------------------------------------------------------------------------------------------
&amp;apos; Client: Freedom Financial 
&amp;apos; Location: Button Click
&amp;apos; Created: 02/20/2018 by Larry Z
&amp;apos; Deployment Date: 02/21/2018 
&amp;apos; Description: Example for calling an externall HTTP site.
&amp;apos; Specification: 
&amp;apos; Installation instructions: Modify/setup a UDF as a button and copy this script into the button click event.
&amp;apos; Dependencies: None
&amp;apos; Modification History: 
&amp;apos;                      
&amp;apos;-------------------------------------------------------------------------------------------------------------------------
Dim strIPAddress, strCity, strState, ipAPIURL
&amp;apos;Set parameters
strIPAddress = &amp;quot;24.249.13.69&amp;quot;
strCity = &amp;quot;&amp;quot;
strState = &amp;quot;&amp;quot;
ipAPIURL = &amp;quot;https://freegeoip.net/xml&amp;quot;    

Main

Sub Main
   strXMLRespone = SendRequest(strIPAddress)
    
    If strXMLRespone = &amp;quot;&amp;quot; Then
        exit sub
    End if
    &amp;apos;Parse XML
    RetreiveValuesFromXML strXMLRespone
   NLSapp.Messagebox(&amp;quot;City: &amp;quot; &amp;amp;  CSTR(strCity) &amp;amp;    &amp;quot; State: &amp;quot; &amp;amp; CStr(strState))
End Sub
Function RetreiveValuesFromXML(strXML)
    set xmlDoc=CreateObject(&amp;quot;Microsoft.XMLDOM&amp;quot;)
    xmlDoc.async=&amp;quot;false&amp;quot;
    
    Err.Clear
    On Error Resume Next
        xmlDoc.loadxml(strXML)
    If Err.Number &amp;lt;&amp;gt; 0 Then
        NLSapp.Messagebox(&amp;quot;Error parsing XML: &amp;quot; &amp;amp; Err.Description)
       exit function
    End if
    
    strCity = xm
End Function&quot;/&gt;
&lt;BUTTON Name=&quot;test4&quot; Script=&quot;set parser = NLSapp.GetXMLParser()

header = &amp;quot;shortname, zip&amp;quot; &amp;amp; chr(13)

firstcol = NLSapp.SQLSelectStatement(&amp;quot;select distinct top 100  shortname, zip  from cif&amp;quot;)

do until firstcol = &amp;quot;***END OF RESULT***&amp;quot;
	secondcol = NLSapp.SQLSelectStatementNextColumn()
	tabledata = tabledata &amp;amp; firstcol &amp;amp; &amp;quot;, &amp;quot; &amp;amp; secondcol &amp;amp; chr(13)
	firstcol = NLSapp.SQLSelectStatementReadNext()
loop

parser.SetDoc(header &amp;amp; tabledata)
parser.Save(&amp;quot;\\tsclient\X\NLS\savetest.txt&amp;quot;)

msgbox(&amp;quot;complete.&amp;quot;)&quot;/&gt;
&lt;BUTTON Name=&quot;Doc gen&quot; Script=&quot;Set DT = NLSApp.GetDocumentTemplates(6)
DT.GenerateDocument &amp;quot;49350&amp;quot;, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, &amp;quot;FALSE&amp;quot;, &amp;quot;T:\Temp\&amp;quot;&quot;/&gt;
&lt;BUTTON Name=&quot;test5&quot; Script=&quot;testprocess()

Sub testprocess()
    sqlpart2 = &amp;quot;FROM cif_detail cd, cif c Where c.cifno = cd.cifno and c.cifnumber = &amp;apos;SUB WC EMAIL AUTO()&amp;apos;&amp;quot;
    emailfromaddr = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef01 &amp;quot; &amp;amp; sqlpart2)
    serverName = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef02 &amp;quot; &amp;amp; sqlpart2)
    wcloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef18 &amp;quot; &amp;amp; sqlpart2)
    attempt1message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef03  &amp;quot; &amp;amp; sqlpart2)
    attempt2message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef04  &amp;quot; &amp;amp; sqlpart2)
    attempt3message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef05  &amp;quot; &amp;amp; sqlpart2)
    loanstoprocesssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef35  &amp;quot; &amp;amp; sqlpart2)
    loanstoprocess = NLSapp.SQLSelectStatement(loanstoprocesssql)
    loannumb = NLSapp.SQLSelectStatement(wcloanssql)

    processmsg1 = &amp;quot;There are &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans to process at this time.&amp;quot; 
    processmsg2 = &amp;quot;Do you want to process all &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans?&amp;quot;

    &amp;apos;-------Proccessing payload warning
    If CDbl(loanstoprocess) &amp;gt;= 1 Then
            If MsgBox(processmsg1 &amp;amp; chr(13) &amp;amp; processmsg2, 4, &amp;quot;WARNING!  Processing payload.&amp;quot;) = 7 Then
                validcnt = 0
                Do
                    processmax = InputBox(invalidText &amp;amp; &amp;quot;Please  Enter the number of loans to Process.&amp;quot;  &amp;amp; chr(13) &amp;amp; &amp;quot;Click Cancel to quit.&amp;quot; , &amp;quot;Set Processing size.&amp;quot;, loanstoprocess)
                    invalidText = &amp;quot;Invalid quantity/value entered.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Entry must be a number between 0 and &amp;quot; &amp;amp; loanstoprocess &amp;amp; chr(13) &amp;amp; chr(13)
	                If processmax &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
                        If isnumeric(processmax) = True Then
                            If CDbl(processmax) &amp;gt; 0 And CDbl(processmax) &amp;lt;= CDbl(loanstoprocess) Then
                                loanstoprocess = processmax
                                validcnt = 1
                            End If
                        End If
                    Else
                         NLSApp.MessageBox(&amp;quot;Canceling Welcome Call processing.&amp;quot;)
                         Exit sub
                    End if
                Loop Until validcnt = 1
            End If
            NLSApp.MessageBox(loanstoprocess &amp;amp; &amp;quot; loans will be processed.&amp;quot;)
    Else
       NLSApp.MessageBox(&amp;quot;There are no loans to process.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Canceling Welcome Call Email processing.&amp;quot;)
    End If
 

     &amp;apos;-------Begin welcome call Proccessing.
     Lcount = 0    
    
     Do Until CDbl(Lcount) = CDbl(loanstoprocess)

         emailtoaddr = NLSApp.SQLSelectStatementNextColumn()
         msgbox(&amp;quot;address:  &amp;quot; &amp;amp;  emailtoaddr)
         borrowername = NLSApp.SQLSelectStatementNextColumn()

         Riskcode = NLSApp.SQLSelectStatementNextColumn()

         attemptno = NLSApp.SQLSelectStatementNextColumn()

 

         If attemptno = &amp;quot;EMAIL - ATTEMPT 1&amp;quot; Then

             attemptmessage = attempt1message

         End If

         If attemptno = &amp;quot;EMAIL - ATTEMPT 2&amp;quot; Then

             attemptmessage = attempt2message

         End If

         If attemptno = &amp;quot;EMAIL - ATTEMPT 3&amp;quot; Then

             attemptmessage = attempt3message

         End If

 

         emailbody = &amp;quot;Dear &amp;quot; &amp;amp; borrowername &amp;amp; &amp;quot;,&amp;quot; &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; attemptmessage

         msgbox(emailbody)

         &amp;apos;NLSApp.MessageBox( loannumb &amp;amp; CHR(13) &amp;amp; emailbody )

 

         emailfromaddr = &amp;quot;customersupport@freedomplus.com&amp;quot;

         serverName = &amp;quot;Servicing FPlus&amp;quot;        

        emailxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANCOMMENTS Date=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot; Category=&amp;quot;&amp;quot;SERVICING NOTES&amp;quot;&amp;quot; CommentDescription=&amp;quot;&amp;quot;WC Activity&amp;quot;&amp;quot; &amp;quot; &amp;amp; _
        &amp;quot;Comment=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; CHR(13) &amp;amp; &amp;quot;SENT TO: &amp;quot; &amp;amp; emailtoaddr &amp;amp; CHR(13) &amp;amp; emailbody &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot; 
         
         msgbox(emailxml)

 

         loannumb = NLSApp.SQLSelectStatementReadNext()

         Lcount = Lcount + 1

     Loop
End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;test6&quot; Script=&quot;FPAutoemailWC()
NLSApp.MessageBox(&amp;quot;Complete!&amp;quot;)

Sub FPAutoemailWC()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automate the Welcome Call request FFLS-86, 87, 88 https://billsdev.atlassian.net/browse/FFLS-86, https://billsdev.atlassian.net/browse/FFLS-87, https://billsdev.atlassian.net/browse/FFLS-88
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    emailfromaddr = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef01 FROM cif_detail Where cifno = 95728&amp;quot;)
    serverName = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef02 FROM cif_detail Where cifno = 95728&amp;quot;)
    wcloanssql =  NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef18 FROM cif_detail Where cifno = 95728&amp;quot;)
    attempt1message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef03 FROM cif_detail Where cifno = 95728&amp;quot;)
    attempt2message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef04 FROM cif_detail Where cifno = 95728&amp;quot;)
    attempt3message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef05 FROM cif_detail Where cifno = 95728&amp;quot;)
    loannumb = NLSapp.SQLSelectStatement(wcloanssql)

    If loannumb = &amp;quot;&amp;quot; Then
        loannumb = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until loannumb = &amp;quot;***END OF RESULT***&amp;quot;
        emailtoaddr = NLSApp.SQLSelectStatementNextColumn()
         msgbox(&amp;quot;address:  &amp;quot; &amp;amp;  emailtoaddr)
exit sub
        borrowername = NLSApp.SQLSelectStatementNextColumn()
        Riskcode = NLSApp.SQLSelectStatementNextColumn()
        attemptno = NLSApp.SQLSelectStatementNextColumn()

        If attemptno = &amp;quot;EMAIL - ATTEMPT 1&amp;quot; Then
        	attemptmessage = attempt1message
        End If
        If attemptno = &amp;quot;EMAIL - ATTEMPT 2&amp;quot; Then
        	attemptmessage =attempt2message
        End If
        If attemptno = &amp;quot;EMAIL - ATTEMPT 3&amp;quot; Then
        	attemptmessage = attempt3message
        End If
		
        emailbody = &amp;quot;Dear &amp;quot; &amp;amp; borrowername &amp;amp; &amp;quot;,&amp;quot; &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; attemptmessage

&amp;apos;NLSApp.MessageBox( loannumb &amp;amp; CHR(13) &amp;amp; emailbody )

        emailfromaddr = &amp;quot;customersupport@freedomplus.com&amp;quot;
        serverName = &amp;quot;Servicing FPlus&amp;quot;

        &amp;apos;**UnComment next 3rows for testing email sending. Add comment for go-live**
        &amp;apos;emailtoaddr = &amp;quot;stanley.muhammad@gmail.com&amp;quot;
        &amp;apos;emailfromaddr = &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;
        &amp;apos;serverName = &amp;quot;Loan Servicing3&amp;quot;
        &amp;apos;************************************************************************************
        NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody 

        emailxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANCOMMENTS Date=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot; Category=&amp;quot;&amp;quot;SERVICING NOTES&amp;quot;&amp;quot; CommentDescription=&amp;quot;&amp;quot;WC Activity&amp;quot;&amp;quot; &amp;quot; &amp;amp; _
        &amp;quot;Comment=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; CHR(13) &amp;amp; &amp;quot;SENT TO: &amp;quot; &amp;amp; emailtoaddr &amp;amp; CHR(13) &amp;amp; emailbody &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        ImportXML(emailxml)

        loannumb = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &amp;gt; 0 Then
        &amp;apos;        NLSapp.AddNotification(0, 0, CDate(NOW()), 0, &amp;quot;Late Fee Processing&amp;quot;, &amp;quot;Late Fees* reversed - &amp;quot; &amp;amp; Lcount)
    End If

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;test3&quot; Script=&quot;FPAutoemailWC()
NLSApp.MessageBox(&amp;quot;Complete!&amp;quot;)

Sub FPAutoemailWC()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automate the Welcome Call request FFLS-86, 87, 88 https://billsdev.atlassian.net/browse/FFLS-86, https://billsdev.atlassian.net/browse/FFLS-87, https://billsdev.atlassian.net/browse/FFLS-88
    &amp;apos;Updated via FFLS-265 https://billsdev.atlassian.net/browse/FFLS-265
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    sqlpart2 = &amp;quot;FROM cif_detail cd, cif c Where c.cifno = cd.cifno and c.cifnumber = &amp;apos;SUB WC EMAIL AUTO()&amp;apos;&amp;quot;
    emailfromaddr = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef01 &amp;quot; &amp;amp; sqlpart2)
    serverName = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef02 &amp;quot; &amp;amp; sqlpart2)
    wcloanssql = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef18 &amp;quot; &amp;amp; sqlpart2)
    attempt1message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef03 FROM &amp;quot; &amp;amp; sqlpart2)
    attempt2message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef04 FROM &amp;quot; &amp;amp; sqlpart2)
    attempt3message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef05 FROM &amp;quot; &amp;amp; sqlpart2)
    loanstoprocess = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef35 FROM &amp;quot; &amp;amp; sqlpart2)
    loannumb = NLSapp.SQLSelectStatement(wcloanssql)
    processmsg = &amp;quot;There are &amp;quot; &amp;amp; loanstoprocess &amp;amp; &amp;quot; loans to process at this time.&amp;quot; &amp;amp; chr(13) &amp;amp; &amp;quot;Do you want to continue?&amp;quot;

    MsgBox  processmsg, 3, &amp;quot;WARNING!&amp;quot;

    If loannumb = &amp;quot;&amp;quot; Then
        loannumb = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until loannumb = &amp;quot;***END OF RESULT***&amp;quot;
        emailtoaddr = NLSApp.SQLSelectStatementNextColumn()
        borrowername = NLSApp.SQLSelectStatementNextColumn()
        Riskcode = NLSApp.SQLSelectStatementNextColumn()
        attemptno = NLSApp.SQLSelectStatementNextColumn()

        If attemptno = &amp;quot;EMAIL - ATTEMPT 1&amp;quot; Then
            attemptmessage = attempt1message
        End If
        If attemptno = &amp;quot;EMAIL - ATTEMPT 2&amp;quot; Then
            attemptmessage = attempt2message
        End If
        If attemptno = &amp;quot;EMAIL - ATTEMPT 3&amp;quot; Then
            attemptmessage = attempt3message
        End If

        emailbody = &amp;quot;Dear &amp;quot; &amp;amp; borrowername &amp;amp; &amp;quot;,&amp;quot; &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; attemptmessage

        &amp;apos;NLSApp.MessageBox( loannumb &amp;amp; CHR(13) &amp;amp; emailbody )

        emailfromaddr = &amp;quot;customersupport@freedomplus.com&amp;quot;
        serverName = &amp;quot;Servicing FPlus&amp;quot;

        &amp;apos;**UnComment next 3rows for testing email sending. Add comment for go-live**
        &amp;apos;emailtoaddr = &amp;quot;stanley.muhammad@gmail.com&amp;quot;
        &amp;apos;emailfromaddr = &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;
        &amp;apos;serverName = &amp;quot;Loan Servicing3&amp;quot;
        &amp;apos;************************************************************************************
        &amp;apos;NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody 

        emailxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANCOMMENTS Date=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot; Category=&amp;quot;&amp;quot;SERVICING NOTES&amp;quot;&amp;quot; CommentDescription=&amp;quot;&amp;quot;WC Activity&amp;quot;&amp;quot; &amp;quot; &amp;amp; _
        &amp;quot;Comment=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; CHR(13) &amp;amp; &amp;quot;SENT TO: &amp;quot; &amp;amp; emailtoaddr &amp;amp; CHR(13) &amp;amp; emailbody &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        ImportXML(emailxml)

        loannumb = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &amp;gt; 0 Then
        &amp;apos;        NLSapp.AddNotification(0, 0, CDate(NOW()), 0, &amp;quot;Late Fee Processing&amp;quot;, &amp;quot;Late Fees* reversed - &amp;quot; &amp;amp; Lcount)
    End If

End Sub
&quot;/&gt;
&lt;BUTTON Name=&quot;AutoWOaddCompletePending&quot; Script=&quot;timecheck1 = NLSapp.SQLSelectStatement(&amp;quot;SELECT Case When substring(cd.userdef03,10,25) &amp;gt; getdate() Then &amp;apos;N&amp;apos; Else &amp;apos;Y&amp;apos; End FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)
timecheck2 = NLSapp.SQLSelectStatement(&amp;quot;SELECT Case When substring(cd.userdef06,10,25) &amp;gt; getdate() Then &amp;apos;N&amp;apos; Else &amp;apos;Y&amp;apos; End FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)

If timecheck1 = &amp;quot;Y&amp;quot; Then
    &amp;apos; AutoWOaddCompletePending()
End If

If timecheck2 = &amp;quot;Y&amp;quot; Then
   &amp;apos; AutoCloseaddCompleted()
End If

&quot;/&gt;
&lt;BUTTON Name=&quot;DSpaymntMaint()&quot; Script=&quot;DSpaymntMaint()

Sub DSpaymntMaint()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Debt Settlement payment TC Maintainance
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
	paymentlookupsql = &amp;quot;Select                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +                                                                                                                     &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.date_paid,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number +                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.payment_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.row_id)  + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;&amp;apos;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;&amp;apos;Debt Settlement Payment&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where row_id = &amp;apos; + convert(varchar,lth.row_id)&amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;from loanacct_payment_history lth,                                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct l,                                                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;loanacct_statuses ls,                                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;(                                                                  &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	Select acctrefno, max(mod_datestamp) as activetime              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from (                                                          &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	SELECT row_id,acctrefno,mod_datestamp                           &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	from loanacct_mod_history                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	where item_changed = &amp;apos;Status&amp;apos;                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;                        &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;	group by acctrefno) times                                       &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;where times.acctrefno = lth.acctrefno                              &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.acctrefno = lth.acctrefno                                    &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.acctrefno = lth.acctrefno                                   &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and ls.status_code_no = 32                                         &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and userdef01 not like &amp;apos;%Debt Settlement Payment%&amp;apos;                 &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and payment_type = &amp;apos;ZZ&amp;apos;                                            &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and lth.nsf_flag = 0                                               &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and l.current_ol1_balance &amp;gt; 0                                      &amp;quot; &amp;amp; chr(13) &amp;amp; _
		&amp;quot;and date_paid &amp;gt;= times.activetime &amp;quot;



		
	Do 	
		AddDStransXML = NLSApp.SQLSelectStatement(paymentlookupsql)
		payHistUpdatesql = NLSapp.SQLSelectStatementNextColumn()
		
		&amp;apos;Sample output
		&amp;apos;AddDStransXML = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8200&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;03/07/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;CP0162960&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;463.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;5138899&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
		&amp;apos;payHistUpdatesql = &amp;quot;SELECT 0; UPDATE loanacct_payment_history  SET userdef01  = &amp;apos;Debt Settlement Payment&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where row_id = 5138899&amp;quot;

		If Not AddDStransXML = &amp;quot;&amp;quot; Then
			ImportXML(AddDStransXML)
			NLSApp.SQLSelectStatement(payHistUpdatesql)
		End If
		count = count + 1
	Loop Until AddDStransXML = &amp;quot;&amp;quot;
	
	&amp;apos;USER ID update 
	NLSApp.SQLSelectStatement(&amp;quot;SELECT 0; UPDATE loanacct_trans_history SET enteredby_uid = 0 Where transaction_code IN (&amp;apos;8460&amp;apos;,&amp;apos;8440&amp;apos;,&amp;apos;8100&amp;apos;,&amp;apos;8200&amp;apos;) and  enteredby_uid in (39)&amp;quot;)

	
End Sub

&quot;/&gt;
&lt;BUTTON Name=&quot;test1&quot; Script=&quot;If Weekday(NOW()) &amp;lt; 5 Then
    &amp;apos; FPAutoemailWC()
End if

Sub FPAutoemailWC()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;Automate the Welcome Call request 
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    emailfromaddr = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef01 FROM cif_detail Where cifno = 95728&amp;quot;)
    serverName = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef02 FROM cif_detail Where cifno = 95728&amp;quot;)
    wcloanssql =  NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef18 FROM cif_detail Where cifno = 95728&amp;quot;)
    attempt1message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef03 FROM cif_detail Where cifno = 95728&amp;quot;)
    attempt2message = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef04 FROM cif_detail Where cifno = 95728&amp;quot;)
    attemp3tmessage = NLSapp.SQLSelectStatement(&amp;quot;SELECT userdef05 FROM cif_detail Where cifno = 95728&amp;quot;)
    loannumb = NLSapp.SQLSelectStatement(wcloanssql)
    
        &amp;apos;**UnComment next 3rows for testing email sending. Add comment for go-live**
        &amp;apos;emailtoaddr = &amp;quot;stanley.muhammad@gmail.com&amp;quot;
        &amp;apos;emailfromaddr = &amp;quot;svc.loanservicing@freedomdebtrelief.com&amp;quot;
        &amp;apos;serverName = &amp;quot;Loan Servicing3&amp;quot;
        &amp;apos;************************************************************************************
        
    If loannumb = &amp;quot;&amp;quot; Then
        loannumb = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Lcount = 0

    Do Until loannumb = &amp;quot;***END OF RESULT***&amp;quot;
        emailtoaddr = NLSApp.SQLSelectStatementNextColumn()
        borrowername = NLSApp.SQLSelectStatementNextColumn()
        Riskcode = NLSApp.SQLSelectStatementNextColumn()
        attemptno = NLSApp.SQLSelectStatementNextColumn()
 
        If attemptno = &amp;quot;EMAIL - ATTEMPT 1&amp;quot; Then
        	attemptmessage = attempt1message
        End If
        If attemptno = &amp;quot;EMAIL - ATTEMPT 2&amp;quot; Then
        	attemptmessage =attempt2message
        End If
        If attemptno = &amp;quot;EMAIL - ATTEMPT 3&amp;quot; Then
        	attemptmessage = attempt3message
        End If
		
        emailbody = &amp;quot;Dear &amp;quot; &amp;amp; borrowername &amp;amp; &amp;quot;,&amp;quot; &amp;amp; CHR(13) &amp;amp; CHR(13) &amp;amp; attemptmessage

        NLSApp.SendEmailMessage serverName, emailtoaddr, emailfromaddr, &amp;quot;Welcome to FreedomPlus&amp;quot;, emailbody 

        emailxml = &amp;quot;&amp;lt;?xml version=&amp;quot;&amp;quot;1.0&amp;quot;&amp;quot; encoding=&amp;quot;&amp;quot;utf-8&amp;quot;&amp;quot;?&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;NLS EnforceTagExistence=&amp;quot;&amp;quot;1&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;LOAN UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; loannumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANDETAIL1 UserDefined11=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; &amp;quot;&amp;quot;&amp;quot; UserDefined12=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;   &amp;lt;LOANCOMMENTS Date=&amp;quot;&amp;quot;&amp;quot; &amp;amp; NOW() &amp;amp; &amp;quot;&amp;quot;&amp;quot; Category=&amp;quot;&amp;quot;SERVICING NOTES&amp;quot;&amp;quot; CommentDescription=&amp;quot;&amp;quot;WC Activity&amp;quot;&amp;quot; &amp;quot; &amp;amp; _
        &amp;quot;Comment=&amp;quot;&amp;quot;&amp;quot; &amp;amp; attemptno &amp;amp; CHR(13) &amp;amp; &amp;quot;SENT TO: &amp;quot; &amp;amp; emailtoaddr &amp;amp; CHR(13) &amp;amp; emailbody &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;  &amp;lt;/LOAN&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; _
        &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

        ImportXML(emailxml)

        loannumb = NLSApp.SQLSelectStatementReadNext()
        Lcount = Lcount + 1
    Loop
    If Lcount &amp;gt; 0 Then
        &amp;apos;        NLSapp.AddNotification(0, 0, CDate(NOW()), 0, &amp;quot;Late Fee Processing&amp;quot;, &amp;quot;Late Fees* reversed - &amp;quot; &amp;amp; Lcount)
    End If

End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;test7&quot; Script=&quot;somevariable = &amp;quot;100685&amp;quot;

paymentsduesql = &amp;quot;Select distinct &amp;apos;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;&amp;apos; + convert(varchar(8),convert(int,lth.transaction_code)+1) +&amp;apos;&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(10),getdate(),101) &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;+ &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar(10),lth.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; DateDue=&amp;quot;&amp;quot;&amp;apos; + convert(char(10),lth.date_due, 101) &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;+ &amp;apos;&amp;quot;&amp;quot; TransactionDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(10),lth.transaction_date,101) + &amp;apos;&amp;quot;&amp;quot; TransRefNo=&amp;quot;&amp;quot;&amp;apos; + convert(varchar(12),lth.transrefno) &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;+ &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;Debt Settlement Curing&amp;quot;&amp;quot;/&amp;gt;&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;from loanacct_trans_history lth,loanacct_payments_due lpd, loanacct l &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;where lth.acctrefno = lpd.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and l.acctrefno = lpd.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lpd.payment_reference_no = lth.transaction_reference_no /* This is how payments tables are linked to the transaction table*/&amp;quot; &amp;amp; chr(13) &amp;amp;_
	&amp;quot;and lpd.acctrefno = &amp;quot; &amp;amp; somevariable &amp;amp; chr(13) &amp;amp; _
	&amp;quot;and lth.transaction_code IN (&amp;apos;120&amp;apos;,&amp;apos;122&amp;apos;,&amp;apos;124&amp;apos;,&amp;apos;126&amp;apos;,&amp;apos;150&amp;apos;,&amp;apos;180&amp;apos;,&amp;apos;320&amp;apos;,&amp;apos;500&amp;apos;,&amp;apos;504&amp;apos;)&amp;quot;

	transactionXML = NLSApp.SQLSelectStatement(paymentsduesql)
	
Do 	Until transactionXML = &amp;quot;***END OF RESULT***&amp;quot;

                cureloanXML = cureloanXML &amp;amp; chr(13) &amp;amp; transactionXML
	transactionXML = NLSApp.SQLSelectStatementReadNext()
	
	count = count + 1
Loop

NLSApp.MessageBox(&amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; cureloanXML &amp;amp; chr(13) &amp;amp; &amp;quot;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;)
	
	If not count = 0  Then
		ImportXML(&amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;quot; &amp;amp; chr(13) &amp;amp; cureloanXML &amp;amp; chr(13) &amp;amp; &amp;quot;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;)
	End If&quot;/&gt;
&lt;BUTTON Name=&quot;stringCompare&quot; Script=&quot; endmark =  &amp;quot;&amp;lt;/NLS&amp;gt;&amp;quot;

s2 = &amp;quot;abdscerdanima&amp;lt;/NLS&amp;gt;123456&amp;quot; &amp;amp; &amp;quot;Y&amp;quot;

refnoYN = Mid(s2, InStr(s2, endmark) + len(endmark), len(s2) - InStr(s2, endmark) + len(endmark))
YN = right(s2,1)
refno = left(refnoYN,len(refnoYN)-1)

&amp;apos;msgbox(String.Compare(s1, s2))

msgbox(refno &amp;amp; chr(13) &amp;amp; YN)&quot;/&gt;
&lt;BUTTON Name=&quot;onetimetransupdate&quot; Script=&quot;modhistsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ONETIMEUPDATES&amp;apos;&amp;quot;)
transhistsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef27 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;ONETIMEUPDATES&amp;apos;&amp;quot;)
nlsapp.messagebox(modhistsql)
nlsapp.messagebox(transhistsql)

modhistrowid = NLSapp.SQLSelectStatement(modhistsql)
transhistrefno = NLSapp.SQLSelectStatement(transhistsql)

nlsapp.messagebox(modhistrowid)
nlsapp.messagebox(transhistrefno)&quot;/&gt;
&lt;BUTTON Name=&quot;onetimemodhistupdate&quot; Script=&quot;xmlsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef44 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;AUTO WRITEOFFCLOSE&amp;apos;&amp;quot;)

nlsapp.messagebox(xmlsql)

acctrefno = NLSapp.SQLSelectStatement(xmlsql)
modrowid = NLSapp.SQLSelectStatement(modhistsql)
modtype = NLSapp.SQLSelectStatement(transhistsql)

nlsapp.messagebox(acctrefno &amp;amp; Chr(13) &amp;amp; modrowid &amp;amp; Chr(13) &amp;amp; modtype)&quot;/&gt;
&lt;BUTTON Name=&quot;feedisclosure&quot; Script=&quot;Feedislosuredocsend()


Sub Feedislosuredocsend()
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    &amp;apos;CPlus Loans Fee disclosure document queued up for printing or email
    &amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;&amp;apos;
    Cplusloanlookupsql = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef18 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;FEE DISCLOSURE&amp;apos;&amp;quot;)

    emailbody = NLSapp.SQLSelectStatement(&amp;quot;SELECT cd.userdef35 FROM cif c, cif_detail cd where c.cifno = cd.cifno and c.cifnumber = &amp;apos;FEE DISCLOSURE&amp;apos;&amp;quot;)
    refno = NLSapp.SQLSelectStatement(Cplusloanlookupsql)
    template = &amp;quot;7&amp;quot;
    
    If len(refno) = 0 Then
        refno = &amp;quot;***END OF RESULT***&amp;quot;
    End If

    Do Until refno = &amp;quot;***END OF RESULT***&amp;quot;
        msgbox(refno)
        SendToQueue = NLSapp.SQLSelectStatementNextColumn()
        emailtoaddr = NLSapp.SQLSelectStatementNextColumn()
        emailtoaddr = &amp;quot;stanley.muhammad@gmail.com&amp;quot;
        name = NLSapp.SQLSelectStatementNextColumn()

            Set DT = NLSApp.GetDocumentTemplates(template)
            DT.GenerateDocument refno, &amp;quot;TRUE&amp;quot;, &amp;quot;SERVICING NOTES&amp;quot;, SendToQueue, &amp;quot;T:\Temp\&amp;quot;
            
            &amp;apos;Update to set Zero bal letter userID to internal Admin user = &amp;apos;0&amp;apos;as well as set direction (userdef01), reason code (userdef02) and type (userdef03)
            commentupdatesql = &amp;quot;Select 0; update loanacct_comments set created_by = 0,userdef01 = &amp;apos;Outbound&amp;apos;,userdef02 = &amp;apos;FEE DISCLOSURE&amp;apos;,userdef03 = &amp;apos;Email&amp;apos; &amp;quot; &amp;amp; _
            &amp;quot;where comment_description in (&amp;apos;CPLUS FEE DISCLOSURE DOC&amp;apos;) &amp;quot; &amp;amp; _
            &amp;quot;and created_by &amp;lt;&amp;gt; 0 and created &amp;gt; left(getdate(),11) and acctrefno = &amp;quot; &amp;amp; refno
            
            nlsapp.sqlselectstatement(commentupdatesql)


            If SendToQueue = &amp;quot;FALSE&amp;quot; Then
                    emailbody =  name &amp;amp; emailbody
                    NLSApp.SendEmailMessage &amp;quot;Servicing CPlus&amp;quot;, emailtoaddr, &amp;quot;consolplus-servicing@consolplus.com&amp;quot;, &amp;quot;CPlus Loan Fee disclosure notification&amp;quot;, emailbody 
             End If
 
        refno = NLSApp.SQLSelectStatementReadNext()

    Loop


End Sub&quot;/&gt;
&lt;BUTTON Name=&quot;test9&quot; Script=&quot;courtcifinsertsql = &amp;quot;SELECT 0; INSERT cif (portfolio_code_id, cifnumber, setupdate, shortname, address_type, company, city, state, mail_name1&amp;quot;  &amp;amp; _
&amp;quot;,street_address1, zip, county, entity, email, officer_number, tin_hash, tin2_hash,override_mailname)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;values&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;(5,&amp;apos;ALABAMA SOUTHERN&amp;apos;,getdate(),&amp;apos;ALABAMA SOUTHERN&amp;apos;,2,&amp;apos;Southern District of Alabama&amp;apos;,&amp;apos;Mobile&amp;apos;,&amp;apos;AL&amp;apos;,&amp;apos;Southern District of Alabama&amp;apos;&amp;quot;  &amp;amp; _
&amp;quot;,&amp;apos;201 St. Louis Street&amp;apos;,&amp;apos;36602&amp;apos;,NULL,&amp;apos;COURT&amp;apos;,&amp;apos;alsbecf_helpdesk@alsb.uscourts.gov&amp;apos;,0,&amp;apos;47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=&amp;apos;,&amp;apos;47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=&amp;apos;,0)&amp;quot;

&amp;apos;NLSApp.SQLSelectStatement(courtcifinsertsql)

courtcifupdatesql=&amp;quot;SELECT 0; update cif set officer_number = 39 where cifno = 164366&amp;quot;

&amp;apos;NLSApp.SQLSelectStatement(courtcifupdatesql)

courtcifdelsql=&amp;quot;SELECT 0; delete from cif  where cifno = 164366&amp;quot;

NLSApp.SQLSelectStatement(courtcifdelsql)&quot;/&gt;
&lt;BUTTON Name=&quot;test10&quot; Script=&quot;&amp;apos;###Cif  Detail 1 UDF21/SysAdmin
&amp;apos;on Button click option selection
&amp;apos;Adds transaction codes that increase DS off loan balance when a fee is assesed while the loan is in active debt settlement or broken settlement status

transcodestrg1 = &amp;quot;&amp;apos;&amp;quot; &amp;amp; LOAN_TRANS_CODE_LATE_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_NSF_FEE &amp;amp; &amp;quot;&amp;apos;, &amp;apos;&amp;quot; &amp;amp;  LOAN_TRANS_CODE_CHECK_FEE &amp;amp; &amp;quot;&amp;apos;&amp;quot;

dsfeestblsql = &amp;quot;Select top 9 convert(varchar(15),l.acctrefno) as acctrefno,   &amp;apos;transimportxml&amp;apos; =  &amp;quot; &amp;amp; chr(13) &amp;amp; _                     
    &amp;quot;&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE &amp;apos; +    &amp;quot; &amp;amp; chr(13) &amp;amp; _                                                                                                                  
    &amp;quot;&amp;apos;TransactionCode=&amp;quot;&amp;quot;8&amp;apos; + convert(varchar,lth.transaction_code) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;&amp;apos;&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;&amp;apos; + convert(char(8),lth.transaction_date,1) + &amp;apos;&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;&amp;apos; + l.loan_number + &amp;quot; &amp;amp; chr(13) &amp;amp; _                                        
    &amp;quot;&amp;apos;&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_amount) + &amp;apos;&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transrefno) + &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;&amp;apos;&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;&amp;apos; + convert(varchar,lth.transaction_reference_no) + &amp;apos;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;&amp;apos;,   &amp;quot; &amp;amp; chr(13) &amp;amp; _                  
    &amp;quot;&amp;apos;transupdatesql&amp;apos; = &amp;apos;SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;&amp;apos;DEBT SETTLEMENT TRANS&amp;apos;&amp;apos;, userdef02  = &amp;apos;&amp;apos;YES&amp;apos;&amp;apos; where transrefno = &amp;apos; + convert(varchar,lth.transrefno)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;from loanacct_trans_history lth,  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;loanacct l, &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;loanacct_statuses ls,&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;(           &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	Select acctrefno, max(mod_datestamp) as activetime   &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	from (                &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	SELECT row_id,acctrefno,mod_datestamp  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	from loanacct_mod_history     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	where item_changed = &amp;apos;Status&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	and new_value like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos; &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	and old_value not like &amp;apos;%ACTIVE SETTLEMENT%&amp;apos;) activationtimes &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;	group by acctrefno) times  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;where times.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and l.acctrefno = lth.acctrefno &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and l.status_code_no = 0 &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and ls.acctrefno = lth.acctrefno  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and ls.status_code_no IN  (32, 34)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and (userdef01 not like &amp;apos;DEBT SETTLEMENT TRANS&amp;apos;   or userdef01 IS NULL)&amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and lth.transaction_code IN (&amp;quot; &amp;amp; transcodestrg1 &amp;amp; &amp;quot;)  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and lth.reversal_transrefno = 0     &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and l.current_ol1_balance &amp;gt; 0  &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot;and lth.transaction_date &amp;gt;= times.activetime &amp;quot; &amp;amp; chr(13) &amp;amp; _ 
    &amp;quot; order by l.acctrefno,[transimportxml]&amp;quot;
    
&amp;apos; Sample SQL output
&amp;apos;&amp;lt;NLS&amp;gt;&amp;lt;TRANSACTIONS&amp;gt;&amp;lt;TRANSACTIONCODE TransactionCode=&amp;quot;&amp;quot;8280&amp;quot;&amp;quot; EffectiveDate=&amp;quot;&amp;quot;02/26/18&amp;quot;&amp;quot; LoanNumber=&amp;quot;&amp;quot;APP-00463650&amp;quot;&amp;quot; Amount=&amp;quot;&amp;quot;15.00&amp;quot;&amp;quot; UserDefined1=&amp;quot;&amp;quot;7135687&amp;quot;&amp;quot; UserDefined4=&amp;quot;&amp;quot;5318695&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/TRANSACTIONS&amp;gt;&amp;lt;/NLS&amp;gt;
&amp;apos;SELECT 0; UPDATE loanacct_trans_history  SET userdef01  = &amp;apos;Debt Settlement transaction&amp;apos;, userdef02  = &amp;apos;YES&amp;apos; where transrefno = 7135687

&amp;apos;dim dynamic array to hold sql results
redim DSfeeslist(2,1)

&amp;apos;Fill array
Do until nextrefno = &amp;quot;***END OF RESULT***&amp;quot;
    rowcnt = UBound(DSfeeslist,2)
    
    If rowcnt = 1 Then
        DSfeeslist(0,rowcnt) = NLSApp.SQLSelectStatement(dsfeestblsql)
    else
        DSfeeslist(0,rowcnt) = nextrefno
    end if
    
    DSfeeslist(1,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
    DSfeeslist(2,rowcnt) = NLSapp.SQLSelectStatementNextColumn()
    nextrefno = NLSApp.SQLSelectStatementReadNext()

    If not nextrefno = &amp;quot;***END OF RESULT***&amp;quot; Then
       redim Preserve DSfeeslist(2,rowcnt + 1)
    End if

Loop 

&amp;apos;Add and Update transaction records
&amp;apos;For counter = 1 to rowcnt &amp;apos;Un-Comment for prod
For counter = 1 to 9
    ImportXML(DSfeeslist(1,counter))
    NLSApp.SQLSelectStatement(DSfeeslist(2,counter))
   
Next
&quot;/&gt;
&lt;BUTTON Name=&quot;printruntest&quot; Script=&quot;printrundelsqltest =&amp;quot;select row_id&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              into #report&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              from loanacct_comments_docs&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              where run_number = 5743 or run_number = 5743&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;       delete from loanacct_comments_docs&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              where row_id in (select row_id from #report)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;       delete from loanacct_comments &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              where row_id in (select row_id from #report)&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;       drop table #report            &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;       update loanacct_statements    &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              set print_run_number = null,&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;                     sequence_in_run = null,&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;                     printed_date = null,&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;                     printed_indicator = 0&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;              where print_run_number = 5743 or print_run_number = 5743&amp;quot;

NLSapp.SQLSelectStatement(printrundelsqltest)&quot;/&gt;
&lt;BUTTON Name=&quot;set latenotice CB&quot; Script=&quot;x = &amp;quot;SELECT 0; &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;Update cif_loan_relationship &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;SET forward_latenotice = 1 &amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;FROM loanacct l,cif_loan_relationship clr&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;WHERE l.acctrefno = clr.acctrefno&amp;quot; &amp;amp; chr(13) &amp;amp; _
&amp;quot;AND l.status_code_no = 0&amp;quot;

NLSapp.SQLSelectStatement(x)

&quot;/&gt;
&lt;BUTTON Name=&quot;encrypt1&quot; Script=&quot;Dim obj,arr,i,r,str,enc,asc
dim bytes,bytesd,s,sc,sd
set obj=CreateObject(&amp;quot;System.Security.Cryptography.RijndaelManaged&amp;quot;)
Set asc = CreateObject(&amp;quot;System.Text.UTF8Encoding&amp;quot;)
s=&amp;quot;This is a private message&amp;quot;
bytes=asc.GetBytes_4(s)
obj.GenerateKey()
obj.GenerateIV()
set enc=obj.CreateEncryptor()
set dec=obj.CreateDecryptor()

bytec=enc.TransformFinalBlock((bytes),0,lenb(bytes))
sc=asc.GetString((bytec))
msgbox (sc)

byted=dec.TransformFinalBlock((bytec),0,lenb(bytec))
sd=asc.GetString((byted))
msgbox (sd)&quot;/&gt;
&lt;BUTTON Name=&quot;encrypt2&quot; Script=&quot;key = &amp;quot;huasHIYhkasdho1&amp;quot;
temp = Encrypt(temp,key)
msgbox(temp)
temp = Decrypt(temp,key)
msgbox(temp)
Function encrypt(Str, key)
 Dim lenKey, KeyPos, LenStr, x, Newstr
 
 Newstr = &amp;quot;&amp;quot;
 lenKey = Len(key)
 KeyPos = 1
 LenStr = Len(Str)
 str = StrReverse(str)
 For x = 1 To LenStr
      Newstr = Newstr &amp;amp; chr(asc(Mid(str,x,1)) + Asc(Mid(key,KeyPos,1)))
      KeyPos = keypos+1
      If KeyPos &amp;gt; lenKey Then KeyPos = 1
 Next
 encrypt = Newstr
End Function
Function Decrypt(str,key)
 Dim lenKey, KeyPos, LenStr, x, Newstr
 
 Newstr = &amp;quot;&amp;quot;
 lenKey = Len(key)
 KeyPos = 1
 LenStr = Len(Str)
 
 str=StrReverse(str)
 For x = LenStr To 1 Step -1
      Newstr = Newstr &amp;amp; chr(asc(Mid(str,x,1)) - Asc(Mid(Key,KeyPos,1)))
      KeyPos = KeyPos+1
      If KeyPos &amp;gt; lenKey Then KeyPos = 1
      Next
      Newstr=StrReverse(Newstr)
      Decrypt = Newstr
End Function

&amp;apos;ref URL: https://itknowledgeexchange.techtarget.com/vbscript-systems-administrator/very-simple-encryption-example-with-vbscript/&quot;/&gt;
&lt;BUTTON Name=&quot;cifdetailudf15&quot; Script=&quot;cifnolistsql = &amp;quot;SELECT c.cifno &amp;quot;
cifnocntsql = &amp;quot;SELECT count(*) &amp;quot;
cifnofromsql = &amp;quot;from cif c, cif_detail cd where c.cifno = cd.cifno and (cd.userdef15 is null or len(cd.userdef15) = 0) and c.tin is not null&amp;quot;

cifnocnt = NLSApp.SQLSelectStatement(cifnocntsql &amp;amp; cifnofromsql)
cifnolist = NLSApp.SQLSelectStatement(cifnolistsql &amp;amp; cifnofromsql)

cifnocnt = 1000

Redim cifnoarray(cifnocnt-1)

For x = 0 to cifnocnt-1
    cifnoarray(x) = cifnolist
    cifnolist = NLSApp.SQLSelectStatementReadNext()
Next

For each cifno in cifnoarray
    set fetched_cif = NLSapp.GetCIF(cifno)
    cifnumb = fetched_cif.CIFNumber
    ssn = fetched_cif.Tin
    sqlstring = &amp;quot;SELECT 0; UPDATE cif_detail SET userdef15 = &amp;apos;&amp;quot; &amp;amp; ssn &amp;amp; &amp;quot;Z&amp;apos; WHERE cifno = &amp;quot; &amp;amp; cifno
    NLSApp.SQLSelectStatement sqlstring
    &amp;apos;xmlstring = &amp;quot;&amp;lt;NLS&amp;gt;&amp;lt;CIF UpdateFlag=&amp;quot;&amp;quot;1&amp;quot;&amp;quot; CIFNumber=&amp;quot;&amp;quot;&amp;quot; &amp;amp; cifnumb &amp;amp; &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;lt;CIFDETAIL CIFDetail1=&amp;quot;&amp;quot;&amp;quot; &amp;amp; ssn &amp;amp; &amp;quot;&amp;quot;&amp;quot;/&amp;gt;&amp;lt;/CIF&amp;gt;&amp;lt;/NLS&amp;gt;&amp;quot;
    &amp;apos;msgbox(cifnumb)
    &amp;apos;NLSApp.UpdateCIFRecord(xmlstring)
    set fetched_cif = nothing
next

msgbox(&amp;quot;Done!&amp;quot;)&quot;/&gt;
&lt;/BUTTONS&gt;
**###BUTTON_CLICKED###****###ON_FIELD_REFRESH###****###ON_FIELD_REFRESH###****###ON_INITIALIZE###****###ON_INITIALIZE###**" object_def="&lt;UDF StaticLeftPos=&quot;431&quot; StaticTopPos=&quot;399&quot; StaticWidth=&quot;110&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;548&quot; FieldTopPos=&quot;399&quot; FieldWidth=&quot;279&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;75&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="431.0000000000" StaticTopPos="399.0000000000" StaticWidth="110.0000000000" StaticHeight="20.0000000000" FieldLeftPos="548.0000000000" FieldTopPos="399.0000000000" FieldWidth="279.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="75"/>
<USERDEFFIELDS field_id="67" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;354&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;354&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;77&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="354.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="354.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="77"/>
<USERDEFFIELDS field_id="66" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;332&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;332&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;79&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="332.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="332.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="79"/>
<USERDEFFIELDS field_id="65" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;310&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;310&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;81&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="310.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="310.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="81"/>
<USERDEFFIELDS field_id="64" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;288&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;288&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;83&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="288.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="288.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="83"/>
<USERDEFFIELDS field_id="63" field_type="0" field_attribute="0" label_text="User Defined" min_value="0.0000000000" max_value="99,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;266&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;266&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;85&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="266.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="266.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="85"/>
<USERDEFFIELDS field_id="62" field_type="0" field_attribute="0" label_text="User Defined 12" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;244&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;244&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;87&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="244.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="244.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="87"/>
<USERDEFFIELDS field_id="61" field_type="0" field_attribute="0" label_text="User Defined 11" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;222&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;222&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;89&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="222.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="222.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="89"/>
<USERDEFFIELDS field_id="60" field_type="0" field_attribute="0" label_text="User Defined 10" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;200&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;200&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;91&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="200.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="200.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="91"/>
<USERDEFFIELDS field_id="59" field_type="0" field_attribute="0" label_text="User Defined 9" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;178&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;178&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;93&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="178.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="178.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="93"/>
<USERDEFFIELDS field_id="58" field_type="0" field_attribute="0" label_text="User Defined 8" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;156&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;156&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;95&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="156.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="156.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="95"/>
<USERDEFFIELDS field_id="57" field_type="0" field_attribute="0" label_text="User Defined 7" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;134&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;134&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;97&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="134.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="134.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="97"/>
<USERDEFFIELDS field_id="56" field_type="0" field_attribute="0" label_text="User Defined 6" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;112&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;112&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;99&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="112.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="112.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="99"/>
<USERDEFFIELDS field_id="55" field_type="0" field_attribute="0" label_text="User Defined 5" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;90&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;90&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;101&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="90.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="90.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="101"/>
<USERDEFFIELDS field_id="54" field_type="0" field_attribute="0" label_text="User Defined 4" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;68&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;68&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;103&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="68.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="68.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="103"/>
<USERDEFFIELDS field_id="53" field_type="0" field_attribute="0" label_text="User Defined 3" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;46&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;46&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;105&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="46.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="46.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="105"/>
<USERDEFFIELDS field_id="52" field_type="0" field_attribute="0" label_text="User Defined 2" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="3" script="" object_def="&lt;UDF StaticLeftPos=&quot;21&quot; StaticTopPos=&quot;24&quot; StaticWidth=&quot;111&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;24&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;107&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="21.0000000000" StaticTopPos="24.0000000000" StaticWidth="111.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="24.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="107"/>
<USERDEFFIELDS field_id="51" field_type="0" field_attribute="0" label_text="User Defined 1" min_value="0.0000000000" max_value="999,999,999.0000000000" field_precision="0" default_value="" script_type="0" option_flags="1" script="" object_def="&lt;UDF StaticLeftPos=&quot;432&quot; StaticTopPos=&quot;436&quot; StaticWidth=&quot;112&quot; StaticHeight=&quot;20&quot; FieldLeftPos=&quot;137&quot; FieldTopPos=&quot;2&quot; FieldWidth=&quot;281&quot; FieldHeight=&quot;20&quot; TabOrder=&quot;-1&quot; ScreenHeight=&quot;553&quot; ScreenWidth=&quot;1236&quot; ZOrder=&quot;109&quot; ReadOnly=&quot;0&quot;/&gt;
" StaticLeftPos="432.0000000000" StaticTopPos="436.0000000000" StaticWidth="112.0000000000" StaticHeight="20.0000000000" FieldLeftPos="137.0000000000" FieldTopPos="2.0000000000" FieldWidth="281.0000000000" FieldHeight="20.0000000000" TabOrder="-1" ScreenHeight="553.0000000000" ScreenWidth="1,236.0000000000" TaskHeaderName="" ReadOnlyFlag="false" ZOrder="109"/>
<KEYRECORD code_id="2" numbering_key="0"/>
<SCRIPTS code_id="2" script_type="0" script="**###Before Save###****###Before Save###****###Before Activate###****###Before Activate###****###Before Create###****###Before Create###****###On Delete###****###On Delete###****###After Save###****###After Save###****###After Create###****###After Create###****###On Add Button Clicked###****###On Add Button Clicked###****###Local Functions###**Function ImportXML(xml)
	NLSApp.ClearErrorString()

	If Not NLSApp.ImportXMLRecord(xml) Then
		If True Then
		NLSApp.MessageBox(xml &amp; CHR(13) &amp; NLSApp.GetErrorString())
		End If
	ImportXML = NLSApp.GetErrorString() &amp; CHR(13) &amp; CHR(13) &amp; xml &amp; CHR(13)
	Else
              &apos; NLSApp.MessageBox(&quot;Payment Added&quot;)
		ImportXML = &quot;&quot;
	End If
End Function

Sub ACHCompanySyncatupdateB(loannumber,refno,Investor,Portfolio,targetACH,bulktransfer,effectivedate)
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    &apos;Maintains sync with Class 2 (Investor) with ACH Company and detail 2 UDF45 (Web pay ACH company)
    &apos;Triggered when individual loan account is chnaged or updated.
    &apos;
    &apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;
    
    &apos;Declare variables
    runtimestamp = Now()
    emailyn = &quot;N&quot;
    userno = NLSApp.GetCurrentUserNo()
    If Not loannumber = &quot;&quot; Then
    	refno = NLSApp.SQLSelectStatement(&quot;SELECT acctrefno FROM loanacct WHERE loan_number = &apos;&quot; &amp; loannumber &amp; &quot;&apos;&quot;)
    End if
    &apos;refno = NLSApp.GetField(&quot;LOAN_REFNO&quot;)
    &apos;Investor = NLSApp.GetField(&quot;LOAN_CLASS2&quot;)
    &apos;Portfolio = NLSApp.GetField(&quot;LOAN_PORTFOLIO&quot;)
    WebACH = NLSApp.GetField(&quot;LOAN_DETAIL2_UDF45&quot;)
    If targetACH = &quot;&quot; Then 
    	targetACH =  InvestorACHSync(Investor, Portfolio)
    End If
    &apos;SQL to look up all active ACH records that do not match target ACH Company ID
    nomatchACHsql = &quot;select convert(varchar,row_id)  from loanacct_ach where status = 0 and acctrefno = &quot; &amp; refno &amp; &quot; and ach_company_id &lt;&gt; &quot; &amp; targetACH
    &apos;Hold query results here
    nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql) 
    class2code = NLSapp.SQLSelectStatement(&quot;select convert(varchar(4),codenum) from loan_class where code = &apos;&quot; &amp; Investor &amp; &quot;&apos;&quot;)


    &apos;Other variables
    modhistupdatesql = &quot;&quot;  
    loanach = &quot;&quot;
    loandetail = &quot;&quot;
    achxml = &quot;&quot;
    Detail2pdatesql = &quot;&quot;
    ACHUpdatesql = &quot;&quot;
    
    &apos;Did any ACH rows not match targetACH? 
    If Not nomatchACHrowID = &quot;&quot; Then
        Do Until nomatchACHrowID = &quot;&quot; &apos;&quot;***END OF RESULT***&quot;
            ACHUpdatesql = &quot;SELECT 0; UPDATE loanacct_ach SET ach_company_id = &quot; &amp; targetACH &amp; &quot; Where row_id = &quot; &amp; nomatchACHrowID
            NLSapp.SQLSelectStatement(ACHUpdatesql)
            nomatchACHrowID = NLSapp.SQLSelectStatement(nomatchACHsql)
        Loop

    Else
        &apos;MsgBox(&quot;all match&quot;)
    End If    
    
    &apos;Does the current Web Portal ACH Company ID match the correct ACH Company ID?
    If Not targetACH = WebACH Then
        Detail2updatesql = &quot;SELECT 0; UPDATE loanacct_detail_2 SET userdef45 = &apos;&quot; &amp; targetACH &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
        NLSapp.SQLSelectStatement(Detail2updatesql)
    End If
    &apos;Is loan part of a bulf transafer?
    If Bulktransfer = 1 Then
    	Select Case Portfolio 
    	Case 0
	        Investortransdatesql = &quot;SELECT 0; UPDATE loanacct_detail SET userdef19 = &apos;&quot; &amp; DateFormat(effectivedate, 111) &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
	        
        Case 1
	        Investortransdatesql = &quot;SELECT 0; UPDATE loanacct_detail SET userdef29 = &apos;&quot; &amp; DateFormat(effectivedate, 111) &amp; &quot;&apos; Where acctrefno = &quot; &amp; refno
	        
        End Select
        
        NLSapp.SQLSelectStatement(Investortransdatesql)
    End If

	NLSapp.SQLSelectStatement(&quot;SELECT 0; UPDATE loanacct SET loan_class2_no = &quot; &amp; class2code &amp; &quot; where acctrefno = &quot; &amp; refno)
      
End Sub

&apos;DATE FORMATTING--------------------------------------------------------------------

Function DateFormat(datestring,formatcode)

	If IsDate(datestring) = true Then
		If len(DAY(datestring)) = 1 Then
		   daytext = &quot;0&quot; &amp; DAY(datestring) 
		Else 
		   daytext = DAY(datestring) 
		End if 

		If len(MONTH(datestring)) = 1 Then
		   mnthtext = &quot;0&quot; &amp; MONTH(datestring) 
		Else 
		   mnthtext = MONTH(datestring) 
		End if 
		If len(HOUR(datestring)) = 1 Then
		   hrtext = &quot;0&quot; &amp; HOUR(datestring) 
		Else 
		   hrtext = HOUR(datestring) 
		End if 
		If len(MINUTE(datestring)) = 1 Then
		   mintext = &quot;0&quot; &amp; MINUTE(datestring) 
		Else 
		   mintext = MINUTE(datestring) 
		End if	
		If len(SECOND(datestring)) = 1 Then
		   sectext = &quot;0&quot; &amp; SECOND(datestring) 
		Else 
		   sectext = SECOND(datestring) 
		End if

		Select case formatcode
		&apos;U.S. = mm/dd/yyyy
		case 1	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp; Right(YEAR(datestring),2)

		case 101	
			DateFormat = mnthtext &amp;&quot;/&quot;&amp; daytext &amp;&quot;/&quot;&amp;	YEAR(datestring) 

		&apos;JAPAN	= yyyy/mm/dd	
		case 11	
			DateFormat = Right(YEAR(datestring),2) &amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext
		case 111	
			DateFormat = YEAR(datestring)&amp;&quot;/&quot;&amp; mnthtext &amp;&quot;/&quot;&amp; daytext

		&apos;Default with Day and timestamp removed	= mon yyyy	
		case 10077	
			DateFormat =  MonthName(Month(datestring), False) &amp; &quot; &quot; &amp; YEAR(datestring)

		&apos;MMDDYYHHMMSS	
		case 1012	
			DateFormat =  mnthtext &amp; daytext &amp; Right(YEAR(datestring),2) &amp; 	hrtext &amp; mintext &amp;	sectext	


		Case Else

			DateFormat = -1

		End Select

	Else	

		DateFormat = -1

	End if

	

End Function**###Local Functions###**"/>
</CONTACT_PORTFOLIO_CODE>
</SETUP>
